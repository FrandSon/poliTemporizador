<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>SonarQube Vulnerability Report</title>
  <style>
    /*
	The sss stylesheet is released under the MIT license.
	<https://github.com/Thiht/sss>
	*/
    .info{
    height: 50px;
}

pre,
td,
th {
    padding: 5px 10px
}

code,
hr,
pre,
thead {
    background: #EEE
}

.doubleSummary {
    display: flex;
    flex-direction: row;
    align-items: center;
    width: 100%;
    justify-content:center;

}

.Summary {
    margin-right: 5%;
    margin-left: 5%;



} 
body {
    color: #333;
    font-family: 'Segoe UI', 'Lucida Grande', Helvetica, sans-serif;
    line-height: 1.5;
}

div.summup {
    max-width: 800px;
    margin: 50px auto;
}

div.detail {
    padding: 20px;
}

h1,
h2,
h3,
h4,
h5,
h6 {
    font-weight: 400;
    line-height: 1em;
    margin: 20px 0
}

h1 {
    font-size: 2.25em
}

h2 {
    font-size: 1.75em
}

h3 {
    font-size: 1.5em
}

h4,
h5,
h6 {
    font-size: 1.25em
}

a {
    color: #08C;
    text-decoration: none
}

a:focus,
a:hover {
    text-decoration: underline
}

a:visited {
    color: #058
}

img {
    max-width: 100%
}

li + li {
    margin-top: 3px
}

dt {
    font-weight: 700
}

code {
    font-family: Consolas, "Lucida Console", monospace;
    padding: 1px 5px
}

pre {
    white-space: pre-wrap
}

pre code {
    padding: 0
}

blockquote {
    border-left: 5px solid #EEE;
    margin: 0;
    padding: 0 10px
}

table {
    border-collapse: collapse;
    width: 100%
}

table + table {
    margin-top: 1em
}

thead {
    text-align: left
}

td,
th {
    border: 1px solid #EEE
}

td.component {
    word-break: break-all;
}

hr {
    border: 0;
    height: 1px
}

.banner {
    text-align: center;
    display: flex;
    justify-content: space-evenly;
    align-items: center;

}

canvas {
    display: block;
    margin: 10px auto;
}

.statusOK {
    background-color: #0a0
}

.statusERROR {
    background-color: #d4333f
}

.sevBLOCKER {
    background-color: #2c3e50
}

.sevCRITICAL {
    background-color: #d43223
}

.sevMAJOR {
    background-color: #f39c12
}

.sevMINOR {
    background-color: #319ddb
}

.hidden {
    display: none;
}

.rulestable {
    table-layout: fixed; word-wrap: break-word
}


  </style>
</head>

<body>
  <div class="summup">
    <!-- insert your company banner here -->
    <p class="banner">
      <a class="top" href="https://www.invitalia.it/" target="_blank">
        <img src="data:image/png;base64,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" alt="Invitalia" height="100">
      </a>
      <a class="top" href="https://www.sonarsource.com/products/sonarqube/" target="_blank">
        <img src="data:image/png;base64,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" alt="SonarQube" height="40">
      </a>
    </p>

      <h1>
        Vulnerability Report
      </h1>

      <dl>
        <dt>Report Generated On</dt>
        <dd>
          Wednesday, Jun 25, 2025
        </dd>

        <dt>Project Name/URL</dt>
        <dd>
          <a href="http://localhost:9000/dashboard?id=vite-project" target="_blank">Mi Proyecto Vite</a>
        </dd>

        <dt>Application</dt>
        <dd>
          
        </dd>

        <dt>Release</dt>
        <dd>
          
        </dd>

        <dt>Branch</dt>
        <dd>
          
        </dd>
        <!--
      <dt>Delta Analysis</dt>
      <dd>
        No
      </dd>
      -->
        

        
      </dl>
    
      Perform another scan to retrieve Quality Gate metrics
    
  </div>

  <div class="doubleSummary">
    <div class="Summary">
      <h2>Summary of the Detected Security issues
      </h2>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>Severity</th>
            <th>Number of Issues</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="sevBLOCKER"></td>
            <td>BLOCKER</td>
            <td>
              0
            </td>
          </tr>
          <tr>
            <td class="sevCRITICAL"></td>
            <td>CRITICAL</td>
            <td>
              0
            </td>
          </tr>
          <tr>
            <td class="sevMAJOR"></td>
            <td>MAJOR</td>
            <td>
              0
            </td>
          </tr>
          <tr>
            <td class="sevMINOR"></td>
            <td>MINOR</td>
            <td>
              0
            </td>
          </tr>
        </tbody>
      </table>

      
    </div>
  <div class="Summary">
      <h2>Summary of the Detected Quality issues
      </h2>
      <table>
        <thead>
          <tr>
            <th></th>
            <th>Severity</th>
            <th>Number of Issues</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="sevBLOCKER"></td>
            <td>BLOCKER</td>
            <td>
              0
            </td>
          </tr>
          <tr>
            <td class="sevCRITICAL"></td>
            <td>CRITICAL</td>
            <td>
              0
            </td>
          </tr>
          <tr>
            <td class="sevMAJOR"></td>
            <td>MAJOR</td>
            <td>
              0
            </td>
          </tr>
          <tr>
            <td class="sevMINOR"></td>
            <td>MINOR</td>
            <td>
              0
            </td>
          </tr>
        </tbody>
      </table>
      
    </div>
  </div>
</div>


  <div class=detail id="hotspot">
    
  </div>

  <div class=detail id="bugs">
    
  </div>

  <div class=detail id="code_smell">
    
  </div>



  <div class=detail>
    
    <h3>Known Security Rules</h3>
    <table class="rulestable">
      <thead>
        <tr>
          <th>Rule</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        
          
        
          

        <tr>
          <td id="php:S4502"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4502">
              php:S4502
            </a>
          </td>
          <td >
            <details>
              <p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive
actions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the
application.</p>
<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a
hidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The web application uses cookies to authenticate users. </li>
  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>
  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Protection against CSRF attacks is strongly recommended:
    <ul>
      <li> to be activated by default for all <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">unsafe HTTP
      methods</a>. </li>
      <li> implemented, for example, with an unguessable CSRF token </li>
    </ul>  </li>
  <li> Of course all sensitive operations should not be performed with <a
  href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">safe HTTP</a> methods like <code>GET</code> which are designed to be
  used only for information retrieval. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://laravel.com/docs/8.x/csrf#csrf-excluding-uris">Laravel VerifyCsrfToken middleware</a></p>
<pre>
use Illuminate\Foundation\Http\Middleware\VerifyCsrfToken as Middleware;

class VerifyCsrfToken extends Middleware
{
    protected $except = [
        'api/*'
    ]; // Sensitive; disable CSRF protection for a list of routes
}
</pre>
<p>For <a href="https://symfony.com/doc/current/security/csrf.html#csrf-protection-in-symfony-forms">Symfony Forms</a></p>
<pre>
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;

class Controller extends AbstractController {

  public function action() {
    $this-&gt;createForm('', null, [
      'csrf_protection' =&gt; false, // Sensitive; disable CSRF protection for a single form
    ]);
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://laravel.com/docs/8.x/csrf#csrf-excluding-uris">Laravel VerifyCsrfToken middleware</a></p>
<pre>
use Illuminate\Foundation\Http\Middleware\VerifyCsrfToken as Middleware;

class VerifyCsrfToken extends Middleware
{
    protected $except = []; // Compliant
}
</pre>
<p>Remember to add <a href="https://laravel.com/docs/8.x/blade#csrf-field">@csrf</a> blade directive to the relevant forms when removing an element
from $except. Otherwise the form submission will stop working.</p>
<p>For <a href="https://symfony.com/doc/current/security/csrf.html#csrf-protection-in-symfony-forms">Symfony Forms</a></p>
<pre>
use Symfony\Bundle\FrameworkBundle\Controller\AbstractController;

class Controller extends AbstractController {

  public function action() {
    $this-&gt;createForm('', null, []); // Compliant; CSRF protection is enabled by default
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/352">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF) </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/csrf">OWASP: Cross-Site Request Forgery</a> </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4507">
              php:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> The application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers or applications distributed to end users.</p>
<h2>Sensitive Code Example</h2>
<p>CakePHP 1.x, 2.x:</p>
<pre>
Configure::write('debug', 1); // Sensitive: development mode
or
Configure::write('debug', 2); // Sensitive: development mode
or
Configure::write('debug', 3); // Sensitive: development mode
</pre>
<p>CakePHP 3.0:</p>
<pre>
use Cake\Core\Configure;

Configure::config('debug', true); // Sensitive: development mode
</pre>
<p>WordPress:</p>
<pre>
define( 'WP_DEBUG', true ); // Sensitive: development mode
</pre>
<h2>Compliant Solution</h2>
<p>CakePHP 1.2:</p>
<pre>
Configure::write('debug', 0); // Compliant; this is the production mode
</pre>
<p>CakePHP 3.0:</p>
<pre>
use Cake\Core\Configure;

Configure::config('debug', false); // Compliant:  "0" or "false" for CakePHP 3.x is suitable (production mode) to not leak sensitive data on the logs.
</pre>
<p>WordPress:</p>
<pre>
define( 'WP_DEBUG', false ); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4508"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4508">
              php:S4508
            </a>
          </td>
          <td >
            <details>
              <p>Deserializing objects is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-17672">CVE-2017-17672</a>: vBulletin: Unserialize PHP Code Execution </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1000167">CVE-2018-1000167</a>: Jenkins Pipeline: arbitrary code execution
  vulnerability </li>
</ul>
<p>Object deserialization from an untrusted source can lead to unexpected code execution. Deserialization takes a stream of bits and turns it into an
object. If the stream contains the type of object you expect, all is well. But if you’re deserializing data coming from untrusted input, and an
attacker has inserted some other type of object, you’re in trouble. Why? <a href="https://www.owasp.org/index.php/PHP_Object_Injection">A known attack
scenario</a> involves the creation of a serialized PHP object with crafted attributes which will modify your application’s behavior. This attack
relies on <a href="https://php.net/manual/en/language.oop5.magic.php">PHP magic methods</a> like <code>__desctruct</code>, <code>__wakeup</code> or
<code>__string</code>. The attacker doesn’t necessarily need the source code of the targeted application to exploit the vulnerability, he can also
rely on the presence of open-source component and use <a href="https://github.com/ambionics/phpggc">tools to craft malicious payloads</a>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> an attacker could have tampered with the source provided to the deserialization function </li>
  <li> you are using an unsafe deserialization function </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>To prevent insecure deserialization, it is recommended to:</p>
<ul>
  <li> Use safe libraries that do not allow code execution at deserialization. </li>
  <li> Not communicate with the outside world using serialized objects </li>
  <li> Limit access to the serialized source
    <ul>
      <li> if it is a file, restrict the access to it. </li>
      <li> if it comes from the network, restrict who has access to the process, such as with a Firewall or by authenticating the sender first. </li>
    </ul>  </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Deserialization_of_untrusted_data">OWASP - Deserialization of untrusted data</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization">OWASP Top 10 2017 Category A8</a> - Insecure
  Deserialization </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/502">MITRE, CWE-502</a> - Deserialization of Untrusted Data </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#OBJECT_DESERIALIZATION">OBJECT_DESERIALIZATION </a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S5042"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5042">
              php:S5042
            </a>
          </td>
          <td >
            <details>
              <p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can
lead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of
uncompressed data. To achieve this extreme <a href="https://en.wikipedia.org/wiki/Data_compression_ratio">compression ratio</a>, attackers will
compress irrelevant data (eg: a long string of repeated bytes).</p>
<h2>Ask Yourself Whether</h2>
<p>Archives to expand are untrusted and:</p>
<ul>
  <li> There is no validation of the number of entries in the archive. </li>
  <li> There is no validation of the total size of the uncompressed data. </li>
  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is
  1 to 3. </li>
  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>
  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in
  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://www.php.net/manual/en/class.ziparchive.php">ZipArchive</a> module:</p>
<pre>
$zip = new ZipArchive();
if ($zip-&gt;open($file) === true) {
    $zip-&gt;extractTo('.'); // Sensitive
    $zip-&gt;close();
}
</pre>
<p>For <a href="https://www.php.net/manual/en/ref.zip.php">Zip</a> module:</p>
<pre>
$zip = zip_open($file);
while ($file = zip_read($zip)) {
    $filename = zip_entry_name($file);
    $size = zip_entry_filesize($file);

    if (substr($filename, -1) !== '/') {
        $content = zip_entry_read($file, zip_entry_filesize($file)); // Sensitive - zip_entry_read() uses zip_entry_filesize()
        file_put_contents($filename, $content);
    } else {
        mkdir($filename);
    }
}
zip_close($zip);
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://www.php.net/manual/en/class.ziparchive.php">ZipArchive</a> module:</p>
<pre>
define('MAX_FILES', 10000);
define('MAX_SIZE', 1000000000); // 1 GB
define('MAX_RATIO', 10);
define('READ_LENGTH', 1024);

$fileCount = 0;
$totalSize = 0;

$zip = new ZipArchive();
if ($zip-&gt;open($file) === true) {
    for ($i = 0; $i &lt; $zip-&gt;numFiles; $i++) {
        $filename = $zip-&gt;getNameIndex($i);
        $stats = $zip-&gt;statIndex($i);

        // Prevent ZipSlip path traversal (S6096)
        if (strpos($filename, '../') !== false || substr($filename, 0, 1) === '/') {
            throw new Exception();
        }

        if (substr($filename, -1) !== '/') {
            $fileCount++;
            if ($fileCount &gt; MAX_FILES) {
                // Reached max. number of files
                throw new Exception();
            }

            $fp = $zip-&gt;getStream($filename); // Compliant
            $currentSize = 0;
            while (!feof($fp)) {
                $currentSize += READ_LENGTH;
                $totalSize += READ_LENGTH;

                if ($totalSize &gt; MAX_SIZE) {
                    // Reached max. size
                    throw new Exception();
                }

                // Additional protection: check compression ratio
                if ($stats['comp_size'] &gt; 0) {
                    $ratio = $currentSize / $stats['comp_size'];
                    if ($ratio &gt; MAX_RATIO) {
                        // Reached max. compression ratio
                        throw new Exception();
                    }
                }

                file_put_contents($filename, fread($fp, READ_LENGTH), FILE_APPEND);
            }

            fclose($fp);
        } else {
            mkdir($filename);
        }
    }
    $zip-&gt;close();
}
</pre>
<p>For <a href="https://www.php.net/manual/en/ref.zip.php">Zip</a> module:</p>
<pre>
define('MAX_FILES', 10000);
define('MAX_SIZE', 1000000000); // 1 GB
define('MAX_RATIO', 10);
define('READ_LENGTH', 1024);

$fileCount = 0;
$totalSize = 0;

$zip = zip_open($file);
while ($file = zip_read($zip)) {
    $filename = zip_entry_name($file);

    // Prevent ZipSlip path traversal (S6096)
    if (strpos($filename, '../') !== false || substr($filename, 0, 1) === '/') {
        throw new Exception();
    }

    if (substr($filename, -1) !== '/') {
        $fileCount++;
        if ($fileCount &gt; MAX_FILES) {
            // Reached max. number of files
            throw new Exception();
        }

        $currentSize = 0;
        while ($data = zip_entry_read($file, READ_LENGTH)) { // Compliant
            $currentSize += READ_LENGTH;
            $totalSize += READ_LENGTH;

            if ($totalSize &gt; MAX_SIZE) {
                // Reached max. size
                throw new Exception();
            }

            // Additional protection: check compression ratio
            if (zip_entry_compressedsize($file) &gt; 0) {
                $ratio = $currentSize / zip_entry_compressedsize($file);
                if ($ratio &gt; MAX_RATIO) {
                    // Reached max. compression ratio
                    throw new Exception();
                }
            }

            file_put_contents($filename, $data, FILE_APPEND);
        }
    } else {
        mkdir($filename);
    }
}
zip_close($zip);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/409">MITRE, CWE-409</a> - Improper Handling of Highly Compressed Data (Data Amplification)
  </li>
  <li> <a href="https://www.bamsoftware.com/hacks/zipbomb/">bamsoftware.com</a> - A better Zip Bomb </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S4787"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4787">
              php:S4787
            </a>
          </td>
          <td >
            <details>
              <p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902">CVE-2017-7902</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378">CVE-2006-1378</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376">CVE-2003-1376</a> </li>
</ul>
<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed
regularly. However these are not the only means to defeat or weaken an encryption.</p>
<p>This rule flags function calls that initiate encryption/decryption.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>
  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>
  <li> the key exchange is made without properly authenticating the receiver. </li>
  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time
  passes. </li>
  <li> the chosen encryption library is deemed unsafe. </li>
  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>
  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.
  </li>
  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random
  algorithm, or it is reused. </li>
  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.
  </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Generate encryption keys using secure random algorithms. </li>
  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force
  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.
  </li>
  <li> Regenerate the keys regularly. </li>
  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>
  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>
  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are
  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most
  probably have flaws. </li>
  <li> When a nonce is used, generate it randomly every time. </li>
  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>
  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks
  like "Chosen-Plaintext Attacks". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption
  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>
  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be
  preferred to the following combinations which are not secured:
    <ul>
      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it
      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in
      cryptographic protocols at all. </li>
      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>Builtin functions</p>
<pre>
function myEncrypt($cipher, $key, $data, $mode, $iv, $options, $padding, $infile, $outfile, $recipcerts, $headers, $nonce, $ad, $pub_key_ids, $env_keys)
{
    mcrypt_ecb ($cipher, $key, $data, $mode); // Sensitive
    mcrypt_cfb($cipher, $key, $data, $mode, $iv); // Sensitive
    mcrypt_cbc($cipher, $key, $data, $mode, $iv); // Sensitive
    mcrypt_encrypt($cipher, $key, $data, $mode); // Sensitive

    openssl_encrypt($data, $cipher, $key, $options, $iv); // Sensitive
    openssl_public_encrypt($data, $crypted, $key, $padding); // Sensitive
    openssl_pkcs7_encrypt($infile, $outfile, $recipcerts, $headers); // Sensitive
    openssl_seal($data, $sealed_data, $env_keys, $pub_key_ids); // Sensitive

    sodium_crypto_aead_aes256gcm_encrypt ($data, $ad, $nonce, $key); // Sensitive
    sodium_crypto_aead_chacha20poly1305_encrypt ($data, $ad, $nonce, $key); // Sensitive
    sodium_crypto_aead_chacha20poly1305_ietf_encrypt ($data, $ad, $nonce, $key); // Sensitive
    sodium_crypto_aead_xchacha20poly1305_ietf_encrypt ($data, $ad, $nonce, $key); // Sensitive
    sodium_crypto_box_seal ($data, $key); // Sensitive
    sodium_crypto_box ($data, $nonce, $key); // Sensitive
    sodium_crypto_secretbox ($data, $nonce, $key); // Sensitive
    sodium_crypto_stream_xor ($data, $nonce, $key); // Sensitive
}
</pre>
<p>CakePHP</p>
<pre>
use Cake\Utility\Security;

function myCakeEncrypt($key, $data, $engine)
{
    Security::encrypt($data, $key); // Sensitive

    // Do not use custom made engines and remember that Mcrypt is deprecated.
    Security::engine($engine); // Sensitive. Setting the encryption engine.
}
</pre>
<p>CodeIgniter</p>
<pre>
class EncryptionController extends CI_Controller
{
    public function __construct()
    {
        parent::__construct();
        $this-&gt;load-&gt;library('encryption');
    }

    public function index()
    {
        $this-&gt;encryption-&gt;create_key(16); // Sensitive. Review the key length.
        $this-&gt;encryption-&gt;initialize( // Sensitive.
            array(
                'cipher' =&gt; 'aes-256',
                'mode' =&gt; 'ctr',
                'key' =&gt; 'the key',
            )
        );
        $this-&gt;encryption-&gt;encrypt("mysecretdata"); // Sensitive.
    }
}
</pre>
<p>CraftCMS version 3</p>
<pre>
use Craft;

// This is similar to Yii as it used by CraftCMS
function craftEncrypt($data, $key, $password) {
    Craft::$app-&gt;security-&gt;encryptByKey($data, $key); // Sensitive
    Craft::$app-&gt;getSecurity()-&gt;encryptByKey($data, $key); // Sensitive
    Craft::$app-&gt;security-&gt;encryptByPassword($data, $password); // Sensitive
    Craft::$app-&gt;getSecurity()-&gt;encryptByPassword($data, $password); // Sensitive
}
</pre>
<p>Drupal 7 - Encrypt module</p>
<pre>
function drupalEncrypt() {
    $encrypted_text = encrypt('some string to encrypt'); // Sensitive
}
</pre>
<p>Joomla</p>
<pre>
use Joomla\Crypt\CipherInterface;

abstract class MyCipher implements CipherInterface // Sensitive. Implementing custom cipher class
{}

function joomlaEncrypt() {
    new Joomla\Crypt\Cipher_Sodium(); // Sensitive
    new Joomla\Crypt\Cipher_Simple(); // Sensitive
    new Joomla\Crypt\Cipher_Rijndael256(); // Sensitive
    new Joomla\Crypt\Cipher_Crypto(); // Sensitive
    new Joomla\Crypt\Cipher_Blowfish(); // Sensitive
    new Joomla\Crypt\Cipher_3DES(); // Sensitive
}
}
</pre>
<p>Laravel</p>
<pre>
use Illuminate\Support\Facades\Crypt;

function myLaravelEncrypt($data)
{
    Crypt::encryptString($data); // Sensitive
    Crypt::encrypt($data); // Sensitive
    // encrypt using the Laravel "encrypt" helper
    encrypt($data); // Sensitive
}
</pre>
<p>PHP-Encryption library</p>
<pre>
use Defuse\Crypto\Crypto;
use Defuse\Crypto\File;

function mypPhpEncryption($data, $key, $password, $inputFilename, $outputFilename, $inputHandle, $outputHandle) {
    Crypto::encrypt($data, $key); // Sensitive
    Crypto::encryptWithPassword($data, $password); // Sensitive
    File::encryptFile($inputFilename, $outputFilename, $key); // Sensitive
    File::encryptFileWithPassword($inputFilename, $outputFilename, $password); // Sensitive
    File::encryptResource($inputHandle, $outputHandle, $key); // Sensitive
    File::encryptResourceWithPassword($inputHandle, $outputHandle, $password); // Sensitive
}
</pre>
<p>PhpSecLib</p>
<pre>
function myphpseclib($mode) {
    new phpseclib\Crypt\RSA(); // Sensitive. Note: RSA can also be used for signing data.
    new phpseclib\Crypt\AES(); // Sensitive
    new phpseclib\Crypt\Rijndael(); // Sensitive
    new phpseclib\Crypt\Twofish(); // Sensitive
    new phpseclib\Crypt\Blowfish(); // Sensitive
    new phpseclib\Crypt\RC4(); // Sensitive
    new phpseclib\Crypt\RC2(); // Sensitive
    new phpseclib\Crypt\TripleDES(); // Sensitive
    new phpseclib\Crypt\DES(); // Sensitive

    new phpseclib\Crypt\AES($mode); // Sensitive
    new phpseclib\Crypt\Rijndael($mode); // Sensitive
    new phpseclib\Crypt\TripleDES($mode); // Sensitive
    new phpseclib\Crypt\DES($mode); // Sensitive
}
</pre>
<p>Sodium Compat library</p>
<pre>
function mySodiumCompatEncrypt($data, $ad, $nonce, $key) {
    ParagonIE_Sodium_Compat::crypto_aead_chacha20poly1305_ietf_encrypt($data, $ad, $nonce, $key); // Sensitive
    ParagonIE_Sodium_Compat::crypto_aead_xchacha20poly1305_ietf_encrypt($data, $ad, $nonce, $key); // Sensitive
    ParagonIE_Sodium_Compat::crypto_aead_chacha20poly1305_encrypt($data, $ad, $nonce, $key); // Sensitive

    ParagonIE_Sodium_Compat::crypto_aead_aes256gcm_encrypt($data, $ad, $nonce, $key); // Sensitive

    ParagonIE_Sodium_Compat::crypto_box($data, $nonce, $key); // Sensitive
    ParagonIE_Sodium_Compat::crypto_secretbox($data, $nonce, $key); // Sensitive
    ParagonIE_Sodium_Compat::crypto_box_seal($data, $key); // Sensitive
    ParagonIE_Sodium_Compat::crypto_secretbox_xchacha20poly1305($data, $nonce, $key); // Sensitive
}
</pre>
<p>Yii version 2</p>
<pre>
use Yii;

// Similar to CraftCMS as it uses Yii
function YiiEncrypt($data, $key, $password) {
    Yii::$app-&gt;security-&gt;encryptByKey($data, $key); // Sensitive
    Yii::$app-&gt;getSecurity()-&gt;encryptByKey($data, $key); // Sensitive
    Yii::$app-&gt;security-&gt;encryptByPassword($data, $password); // Sensitive
    Yii::$app-&gt;getSecurity()-&gt;encryptByPassword($data, $password); // Sensitive
}
</pre>
<p>Zend</p>
<pre>
use Zend\Crypt\FileCipher;
use Zend\Crypt\PublicKey\DiffieHellman;
use Zend\Crypt\PublicKey\Rsa;
use Zend\Crypt\Hybrid;
use Zend\Crypt\BlockCipher;

function myZendEncrypt($key, $data, $prime, $options, $generator, $lib)
{
    new FileCipher; // Sensitive. This is used to encrypt files

    new DiffieHellman($prime, $generator, $key); // Sensitive

    $rsa = Rsa::factory([ // Sensitive
        'public_key'    =&gt; 'public_key.pub',
        'private_key'   =&gt; 'private_key.pem',
        'pass_phrase'   =&gt; 'mypassphrase',
        'binary_output' =&gt; false,
    ]);
    $rsa-&gt;encrypt($data); // No issue raised here. The configuration of the Rsa object is the line to review.

    $hybrid = new Hybrid(); // Sensitive

    BlockCipher::factory($lib, $options); // Sensitive
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/321">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/322">MITRE, CWE-322</a> - Key Exchange without Entity Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/323">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/324">MITRE, CWE-324</a> - Use of a Key Past its Expiration Date </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/325">MITRE, CWE-325</a> - Missing Required Cryptographic Step </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=php%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=php%3AS5547'>S5547</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S2245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2245">
              php:S2245
            </a>
          </td>
          <td >
            <details>
              <p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386">CVE-2013-6386</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419">CVE-2006-3419</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102">CVE-2008-4102</a> </li>
</ul>
<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that
will be generated, and use this guess to impersonate another user or access sensitive information.</p>
<p>As the <code>rand()</code> and <code>mt_rand()</code> functions rely on a pseudorandom number generator, it should not be used for
security-critical applications or for protecting sensitive data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such
  as a password, is hashed. </li>
  <li> the function you use generates a value which can be predicted (pseudo-random). </li>
  <li> the generated value is used multiple times. </li>
  <li> an attacker can access the generated value. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use functions which rely on a cryptographically strong random number generator such as <code>random_int()</code> or <code>random_bytes()</code>
  or <code>openssl_random_pseudo_bytes()</code> </li>
  <li> When using <code>openssl_random_pseudo_bytes()</code>, provide and check the <code>crypto_strong</code> parameter </li>
  <li> Use the generated random values only once. </li>
  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
$random = rand();
$random2 = mt_rand(0, 99);
</pre>
<h2>Compliant Solution</h2>
<pre>
$randomInt = random_int(0,99); // Compliant; generates a cryptographically secure random integer
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/338">MITRE, CWE-338</a> - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1241">MITRE, CWE-1241</a> - Use of Predictable Algorithm in Random Number Generator </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM">Predictable Pseudo Random Number
  Generator</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S3330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3330">
              php:S3330
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will
be able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer
to decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target
the theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS
vulnerability to steal session-cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>
  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)
  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /
  sensitive-security cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>In <em>php.ini</em> you can specify the flags for the session cookie which is security-sensitive:</p>
<pre>
session.cookie_httponly = 0;  // Sensitive: this sensitive session cookie is created with the httponly flag set to false and so it can be stolen easily in case of XSS vulnerability
</pre>
<p>Same thing in PHP code:</p>
<pre>
session_set_cookie_params($lifetime, $path, $domain, true, false);  // Sensitive: this sensitive session cookie is created with the httponly flag (the fifth argument) set to false and so it can be stolen easily in case of XSS vulnerability
</pre>
<p>If you create a custom security-sensitive cookie in your PHP code:</p>
<pre>
$value = "sensitive data";
setcookie($name, $value, $expire, $path, $domain, true, false); // Sensitive: this sensitive cookie is created with the httponly flag (the seventh argument) set to false  and so it can be stolen easily in case of XSS vulnerability
</pre>
<p>By default <a href="https://www.php.net/manual/en/function.setcookie.php"><code>setcookie</code></a> and <a
href="https://www.php.net/manual/en/function.setrawcookie.php"><code>setrawcookie</code></a> functions set <code>httpOnly</code> flag to
<em>false</em> (the seventh argument) and so cookies can be stolen easily in case of XSS vulnerability:</p>
<pre>
$value = "sensitive data";
setcookie($name, $value, $expire, $path, $domain, true); // Sensitive: a sensitive cookie is created with the httponly flag  (the seventh argument) not defined (by default set to false)
setrawcookie($name, $value, $expire, $path, $domain, true); // Sensitive: a sensitive cookie is created with the httponly flag (the seventh argument) not defined  (by default set to false)
</pre>
<h2>Compliant Solution</h2>
<pre>
session.cookie_httponly = 1; // Compliant: the sensitive cookie is protected against theft thanks (cookie_httponly=1)
</pre>
<pre>
session_set_cookie_params($lifetime, $path, $domain, true, true); // Compliant: the sensitive cookie is protected against theft thanks to the fifth argument set to true (HttpOnly=true)
</pre>
<pre>
$value = "sensitive data";
setcookie($name, $value, $expire, $path, $domain, true, true); // Compliant: the sensitive cookie is protected against theft thanks to the seventh argument set to true (HttpOnly=true)
setrawcookie($name, $value, $expire, $path, $domain, true, true); // Compliant: the sensitive cookie is protected against theft thanks to the seventh argument set to true (HttpOnly=true)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/HttpOnly">OWASP HttpOnly</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1004">MITRE, CWE-1004</a> - Sensitive Cookie Without 'HttpOnly' Flag </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE">HTTPONLY_COOKIE</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S3331"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3331">
              php:S3331
            </a>
          </td>
          <td >
            <details>
              <p>A cookie’s domain specifies which websites should be able to read it. Left blank, browsers are supposed to only send the cookie to sites that
exactly match the sending domain. For example, if a cookie was set by <em>lovely.dream.com</em>, it should only be readable by that domain, and not by
<em>nightmare.com</em> or even <em>strange.dream.com</em>. If you want to allow sub-domain access for a cookie, you can specify it by adding a dot in
front of the cookie’s domain, like so: <em>.dream.com</em>. But cookie domains should always use at least two levels.</p>
<p>Cookie domains can be set either programmatically or via configuration. This rule raises an issue when any cookie domain is set with a single
level, as in <em>.com</em>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the <code>domain</code> attribute has only one level as domain naming. </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> You should check the <code>domain</code> attribute has been set and its value has more than one level of domain nanimg, like:
  <em>sonarsource.com</em> </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
setcookie("TestCookie", $value, time()+3600, "/~path/", ".com", 1); // Noncompliant
session_set_cookie_params(3600, "/~path/", ".com"); // Noncompliant

// inside php.ini
session.cookie_domain=".com"; // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
setcookie("TestCookie", $value, time()+3600, "/~path/", ".myDomain.com", 1);
session_set_cookie_params(3600, "/~path/", ".myDomain.com");

// inside php.ini
session.cookie_domain=".myDomain.com";
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="php:S4784"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4784">
              php:S4784
            </a>
          </td>
          <td >
            <details>
              <p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021">CVE-2017-16021</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863">CVE-2018-13863</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-8926">CVE-2018-8926</a> </li>
</ul>
<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as
<code>/(a+)+s/</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with
every additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular
expression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>
<p>Evaluating such regular expressions opens the door to <a
href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">Regular expression Denial of Service (ReDoS)</a> attacks.
In the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making
the service inaccessible to genuine users.</p>
<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and contains at at least two instances of any of
the following characters <code>*+{</code>.</p>
<p>Example: <code>(a+)*</code></p>
<p>The following functions are detected as executing regular expressions:</p>
<ul>
  <li> <a href="http://php.net/manual/en/book.pcre.php">PCRE</a>: Perl style regular expressions: <a
  href="http://php.net/manual/en/function.preg-filter.php">preg_filter</a>, <a href="http://php.net/manual/en/function.preg-grep.php">preg_grep</a>,
  <a href="http://php.net/manual/en/function.preg-match-all.php">preg_match_all</a>, <a
  href="http://php.net/manual/en/function.preg-match.php">preg_match</a>, <a
  href="http://php.net/manual/en/function.preg-replace-callback.php">preg_replace_callback</a>, <a
  href="http://php.net/manual/en/function.preg-replace.php">preg_replace</a>, <a
  href="http://php.net/manual/en/function.preg-split.php">preg_split</a> </li>
  <li> <a href="http://php.net/manual/en/book.regex.php">POSIX extended</a>, which are deprecated: <a
  href="http://php.net/manual/en/function.ereg-replace.php">ereg_replace</a>, <a href="http://php.net/manual/en/function.ereg.php">ereg</a>, <a
  href="http://php.net/manual/en/function.eregi-replace.php">eregi_replace</a>, <a href="http://php.net/manual/en/function.eregi.php">eregi</a>, <a
  href="http://php.net/manual/en/function.split.php">split</a>, <a href="http://php.net/manual/en/function.spliti.php">spliti</a>. </li>
  <li> <a href="http://php.net/manual/en/function.fnmatch.php">fnmatch</a> </li>
  <li> Any of the multibyte string regular expressions: <a href="http://php.net/manual/en/function.mb-eregi-replace.php">mb_eregi_replace</a>, <a
  href="http://php.net/manual/en/function.mb-ereg-match.php">mb_ereg_match</a>, <a
  href="http://php.net/manual/en/function.mb-ereg-replace-callback.php">mb_ereg_replace_callback</a>, <a
  href="http://php.net/manual/en/function.mb-ereg-replace.php">mb_ereg_replace</a>, <a
  href="http://php.net/manual/en/function.mb-ereg-search-init.php">mb_ereg_search_init</a>, <a
  href="http://php.net/manual/en/function.mb-ereg-search-pos.php">mb_ereg_search_pos</a>, <a
  href="http://php.net/manual/en/function.mb-ereg-search-regs.php">mb_ereg_search_regs</a>, <a
  href="http://php.net/manual/en/function.mb-ereg-search.php">mb_ereg_search</a>, <a href="http://php.net/manual/en/function.mb-ereg.php">mb_ereg</a>,
  <a href="http://php.net/manual/en/function.mb-eregi-replace.php">mb_eregi_replace</a>, <a
  href="http://php.net/manual/en/function.mb-eregi.php">mb_eregi</a> </li>
</ul>
<p>Note that <code>ereg*</code> functions have been removed in PHP 7 and <strong>PHP 5 end of life date is the 1st of January 2019. Using PHP 5 is
dangerous as there will be no security fix</strong>.</p>
<p>This rule’s goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>
  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not set the constant <code>pcre.backtrack_limit</code> to a high value as it will increase the resource consumption of PCRE functions.</p>
<p>Check the error codes of PCRE functions via <code>preg_last_error</code>.</p>
<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for
vulnerability reports mentioning the one engine you’re are using. Do not run vulnerable regular expressions on user input.</p>
<p>Use if possible a library which is not vulnerable to Redos Attacks such as <a href="https://github.com/google/re2">Google Re2</a>.</p>
<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>
<p>Avoid executing a user input string as a regular expression or use at least <code>preg_quote</code> to escape regular expression characters.</p>
<h2>Exceptions</h2>
<p>An issue will be created for the functions <code>mb_ereg_search_pos</code>, <code>mb_ereg_search_regs</code> and <code>mb_ereg_search</code> if and
only if at least the first argument, i.e. the $pattern, is provided.</p>
<p>The current implementation does not follow variables. It will only detect regular expressions hard-coded directly in the function call.</p>
<pre>
$pattern = "/(a+)+/";
$result = eregi($pattern, $input);  // No issue will be raised even if it is Sensitive
</pre>
<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,
<code>(a|a?)+</code>.</p>
<p>It is a good idea to test your regular expression if it has the same pattern on both side of a "<code>|</code>".</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">MITRE, CWE-624</a> - Executable Regular
  Expression Error </li>
  <li> OWASP Regular expression Denial of Service - ReDoS </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=phpsecurity%3AS2631'>S2631</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S2255"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2255">
              php:S2255
            </a>
          </td>
          <td >
            <details>
              <p>Using cookies is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11639">CVE-2018-11639</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6537">CVE-2016-6537</a> </li>
</ul>
<p>Attackers can use widely-available tools to read cookies. Any sensitive information they may contain will be exposed.</p>
<p>This rule flags code that writes cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sensitive information is stored inside the cookie. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Cookies should only be used to manage the user session. The best practice is to keep all user-related information server-side and link them to the
user session, never sending them to the client. In a very few corner cases, cookies can be used for non-sensitive information that need to live longer
than the user session.</p>
<p>Do not try to encode sensitive information in a non human-readable format before writing them in a cookie. The encoding can be reverted and the
original information will be exposed.</p>
<p>Using cookies only for session IDs doesn’t make them secure. Follow <a
href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies">OWASP best practices</a> when you configure your
cookies.</p>
<p>As a side note, every information read from a cookie should be <a
href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitized</a>.</p>
<h2>Sensitive Code Example</h2>
<pre>
$value = "1234 1234 1234 1234";

// Review this cookie as it seems to send sensitive information (credit card number).
setcookie("CreditCardNumber", $value, $expire, $path, $domain, true, true); // Sensitive
setrawcookie("CreditCardNumber", $value, $expire, $path, $domain, true, true); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/312">MITRE, CWE-312</a> - Cleartext Storage of Sensitive Information </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#COOKIE_USAGE">COOKIE_USAGE</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="php:S4790"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4790">
              php:S4790
            </a>
          </td>
          <td >
            <details>
              <p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,
<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,
<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little
computational effort is enough to find two or more different inputs that produce the same hash).</p>
<h2>Ask Yourself Whether</h2>
<p>The hashed value is used in a security context like:</p>
<ul>
  <li> User-password storage. </li>
  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>
  <li> To compute some message integrity. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even
better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>
because it slows down <code>brute force attacks</code>.</p>
<h2>Sensitive Code Example</h2>
<pre>
$hash = md5($data); // Sensitive
$hash = sha1($data);   // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
// for a password
$hash = password_hash($password, PASSWORD_BCRYPT); // Compliant

// other context
$hash = hash("sha512", $data);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1240">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4792"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4792">
              php:S4792
            </a>
          </td>
          <td >
            <details>
              <p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285">CVE-2018-0285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127">CVE-2000-1127</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113">CVE-2017-15113</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742">CVE-2015-5742</a> </li>
</ul>
<p>Logs are useful before, during and after a security incident.</p>
<ul>
  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it
  is the first step to prevent an attack from ever happening. </li>
  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>
</ul>
<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information
logged and how they are logged.</p>
<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives
  access to them. </li>
  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>
  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the
  user can perform the action as many times as he/she wants. </li>
  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)
  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>
  <li> the logs are only stored locally instead of being backuped or replicated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Check that your production deployment doesn’t have its loggers in "debug" mode as it might write sensitive information in logs. </li>
  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>
  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the
  hostname. </li>
  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the
  impact is known and limited. </li>
  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the
  service are secure too. </li>
  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control
  the logged information. An attacker could just repeat a logged action many times. </li>
</ul>
<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your
logs:</p>
<ul>
  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user
  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>
  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user
  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example
  use all your storage space or compromise your log indexing service. </li>
  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as
  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>
  <li> Monitor the logs for any suspicious activity. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>Basic PHP configuration:</p>
<pre>
function configure_logging() {
  error_reporting(E_RECOVERABLE_ERROR); // Sensitive
  error_reporting(32); // Sensitive

  ini_set('docref_root', '1'); // Sensitive
  ini_set('display_errors', '1'); // Sensitive
  ini_set('display_startup_errors', '1'); // Sensitive
  ini_set('error_log', "path/to/logfile"); // Sensitive - check logfile is secure
  ini_set('error_reporting', E_PARSE ); // Sensitive
  ini_set('error_reporting', 64); // Sensitive
  ini_set('log_errors', '0'); // Sensitive
  ini_set('log_errors_max_length', '512'); // Sensitive
  ini_set('ignore_repeated_errors', '1'); // Sensitive
  ini_set('ignore_repeated_source', '1'); // Sensitive
  ini_set('track_errors', '0'); // Sensitive

  ini_alter('docref_root', '1'); // Sensitive
  ini_alter('display_errors', '1'); // Sensitive
  ini_alter('display_startup_errors', '1'); // Sensitive
  ini_alter('error_log', "path/to/logfile"); // Sensitive - check logfile is secure
  ini_alter('error_reporting', E_PARSE ); // Sensitive
  ini_alter('error_reporting', 64); // Sensitive
  ini_alter('log_errors', '0'); // Sensitive
  ini_alter('log_errors_max_length', '512'); // Sensitive
  ini_alter('ignore_repeated_errors', '1'); // Sensitive
  ini_alter('ignore_repeated_source', '1'); // Sensitive
  ini_alter('track_errors', '0'); // Sensitive
}
</pre>
<p>Definition of custom loggers with <code>psr/log</code></p>
<pre>
abstract class MyLogger implements \Psr\Log\LoggerInterface { // Sensitive
    // ...
}

abstract class MyLogger2 extends \Psr\Log\AbstractLogger { // Sensitive
    // ...
}

abstract class MyLogger3 {
    use \Psr\Log\LoggerTrait; // Sensitive
    // ...
}
</pre>
<h2>Exceptions</h2>
<p>No issue will be raised for logger configuration when it follows <a href="https://www.loggly.com/ultimate-guide/php-logging-basics/">recommended
settings</a> for production servers. The following examples are all valid:</p>
<pre>
  ini_set('docref_root', '0');
  ini_set('display_errors', '0');
  ini_set('display_startup_errors', '0');

  error_reporting(0);
  ini_set('error_reporting', 0);

  ini_set('log_errors', '1');
  ini_set('log_errors_max_length', '0');
  ini_set('ignore_repeated_errors', '0');
  ini_set('ignore_repeated_source', '0');
  ini_set('track_errors', '1');
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring">OWASP Top 10 2017 Category A10</a> -
  Insufficient Logging &amp; Monitoring </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/117">MITRE, CWE-117</a> - Improper Output Neutralization for Logs </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/532">MITRE, CWE-532</a> - Information Exposure Through Log Files </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5332">
              php:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<pre>
$url = "http://example.com"; // Sensitive
$url = "ftp://anonymous@example.com"; // Sensitive
$url = "telnet://anonymous@example.com"; // Sensitive

$con = ftp_connect('example.com'); // Sensitive

$trans = (new Swift_SmtpTransport('XXX', 1234)); // Sensitive

$mailer = new PHPMailer(true); // Sensitive

define( 'FORCE_SSL_ADMIN', false); // Sensitive
define( 'FORCE_SSL_LOGIN', false); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
$url = "https://example.com";
$url = "sftp://anonymous@example.com";
$url = "ssh://anonymous@example.com";

$con = ftp_ssl_connect('example.com');

$trans = (new Swift_SmtpTransport('smtp.example.org', 1234))
  -&gt;setEncryption('tls')
;

$mailer = new PHPMailer(true);
$mailer-&gt;SMTPSecure = 'tls';

define( 'FORCE_SSL_ADMIN', true);
define( 'FORCE_SSL_LOGIN', true);
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2068">
              php:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
$password = "65DBGgwe4uazdWQA"; // Sensitive

$httpUrl = "https://example.domain?user=user&amp;password=65DBGgwe4uazdWQA" // Sensitive
$sshUrl = "ssh://user:65DBGgwe4uazdWQA@example.domain" // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
$user = getUser();
$password = getPassword(); // Compliant

$httpUrl = "https://example.domain?user=$user&amp;password=$password" // Compliant
$sshUrl = "ssh://$user:$password@example.domain" // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S5693"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5693">
              php:S5693
            </a>
          </td>
          <td >
            <details>
              <p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in
order to prevents DoS attacks.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> size limits are not defined for the different resources of the web application. </li>
  <li> the web application is not protected by <a href="https://en.wikipedia.org/wiki/Rate_limiting">rate limiting</a> features. </li>
  <li> the web application infrastructure has limited resources. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> For most of the features of an application, it is recommended to limit the size of requests to:
    <ul>
      <li> lower or equal to 8mb for file uploads. </li>
      <li> lower or equal to 2mb for other requests. </li>
    </ul>  </li>
</ul>
<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://symfony.com/doc/current/reference/constraints/File.html#maxsize">Symfony Constraints</a>:</p>
<pre>
use Symfony\Component\Validator\Constraints as Assert;
use Symfony\Component\Validator\Mapping\ClassMetadata;

class TestEntity
{
    public static function loadValidatorMetadata(ClassMetadata $metadata)
    {
        $metadata-&gt;addPropertyConstraint('upload', new Assert\File([
            'maxSize' =&gt; '100M', // Sensitive
        ]));
    }
}
</pre>
<p>For <a href="https://laravel.com/docs/8.x/validation#rule-max">Laravel Validator</a>:</p>
<pre>
use App\Http\Controllers\Controller;
use Illuminate\Http\Request;

class TestController extends Controller
{
    public function test(Request $request)
    {
        $validatedData = $request-&gt;validate([
            'upload' =&gt; 'required|file', // Sensitive
        ]);
    }
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://symfony.com/doc/current/reference/constraints/File.html#maxsize">Symfony Constraints</a>:</p>
<pre>
use Symfony\Component\Validator\Constraints as Assert;
use Symfony\Component\Validator\Mapping\ClassMetadata;

class TestEntity
{
    public static function loadValidatorMetadata(ClassMetadata $metadata)
    {
        $metadata-&gt;addPropertyConstraint('upload', new Assert\File([
            'maxSize' =&gt; '8M', // Compliant
        ]));
    }
}
</pre>
<p>For <a href="https://laravel.com/docs/8.x/validation#rule-max">Laravel Validator</a>:</p>
<pre>
use App\Http\Controllers\Controller;
use Illuminate\Http\Request;

class TestController extends Controller
{
    public function test(Request $request)
    {
        $validatedData = $request-&gt;validate([
            'upload' =&gt; 'required|file|max:8000', // Compliant
        ]);
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html">Owasp Cheat Sheet</a> - Owasp Denial of Service
  Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/770">MITRE, CWE-770</a> - Allocation of Resources Without Limits or Throttling </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S2077"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2077">
              php:S2077
            </a>
          </td>
          <td >
            <details>
              <p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the
query. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=php%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted queries.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some parts of the query come from untrusted values (like user inputs). </li>
  <li> The query is repeated/duplicated in other parts of the code. </li>
  <li> The application must support different types of relational databases. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">parameterized queries, prepared
  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>
  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
$id = $_GET['id'];
mysql_connect('localhost', $username, $password) or die('Could not connect: ' . mysql_error());
mysql_select_db('myDatabase') or die('Could not select database');

$result = mysql_query("SELECT * FROM myTable WHERE id = " . $id);  // Sensitive, could be susceptible to SQL injection

while ($row = mysql_fetch_object($result)) {
    echo $row-&gt;name;
}
</pre>
<h2>Compliant Solution</h2>
<pre>
$id = $_GET['id'];
try {
    $conn = new PDO('mysql:host=localhost;dbname=myDatabase', $username, $password);
    $conn-&gt;setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

    $stmt = $conn-&gt;prepare('SELECT * FROM myTable WHERE id = :id');
    $stmt-&gt;execute(array('id' =&gt; $id));

    while($row = $stmt-&gt;fetch(PDO::FETCH_OBJ)) {
        echo $row-&gt;name;
    }
} catch(PDOException $e) {
    echo 'ERROR: ' . $e-&gt;getMessage();
}
</pre>
<h2>Exceptions</h2>
<p>No issue will be raised if one of the functions is called with hard-coded string (no concatenation) and this string does not contain a "$"
sign.</p>
<pre>
$result = mysql_query("SELECT * FROM myTable WHERE id = 42") or die('Query failed: ' . mysql_error());  // Compliant
</pre>
<p>The current implementation does not follow variables. It will only detect SQL queries which are concatenated or contain a <code>$</code> sign
directly in the function call.</p>
<pre>
$query = "SELECT * FROM myTable WHERE id = " . $id;
$result = mysql_query($query);  // No issue will be raised even if it is Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/89">MITRE, CWE-89</a> - Improper Neutralization of Special Elements used in an SQL Command
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rules <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA">Potential SQL/JPQL Injection
  (JPA)</a>, <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO">Potential SQL/JDOQL Injection (JDO)</a>, <a
  href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE">Potential SQL/HQL Injection (Hibernate)</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4818"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4818">
              php:S4818
            </a>
          </td>
          <td >
            <details>
              <p>Using sockets is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1785">CVE-2011-178</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5645">CVE-2017-5645</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6597">CVE-2018-6597</a> </li>
</ul>
<p>Sockets are vulnerable in multiple ways:</p>
<ul>
  <li> They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive
  sensitive information or inject dangerous input. </li>
  <li> The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. </li>
</ul>
<p>This rules flags code that creates sockets. It matches only the direct use of sockets, not use through frameworks or high-level APIs such as the
use of http connections.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sockets are created without any limit every time a user performs an action. </li>
  <li> input received from sockets is used without being sanitized. </li>
  <li> sensitive data is sent via sockets without being encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols. </li>
  <li> Encrypt all data sent if it is sensitive. Usually it is better to encrypt it even if the data is not sensitive as it might change later. </li>
  <li> <a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> any input read from the socket. </li>
  <li> Limit the number of sockets a given user can create. Close the sockets as soon as possible. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
function handle_sockets($domain, $type, $protocol, $port, $backlog, $addr, $hostname, $local_socket, $remote_socket, $fd) {
    socket_create($domain, $type, $protocol); // Sensitive
    socket_create_listen($port, $backlog); // Sensitive
    socket_addrinfo_bind($addr); // Sensitive
    socket_addrinfo_connect($addr); // Sensitive
    socket_create_pair($domain, $type, $protocol, $fd);

    fsockopen($hostname); // Sensitive
    pfsockopen($hostname); // Sensitive
    stream_socket_server($local_socket); // Sensitive
    stream_socket_client($remote_socket); // Sensitive
    stream_socket_pair($domain, $type, $protocol); // Sensitive
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption ('Resource Exhaustion') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S5328"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5328">
              php:S5328
            </a>
          </td>
          <td >
            <details>
              <p>If a session ID can be guessed (not generated with a secure pseudo random generator, or with insufficient length …​) an attacker may be able to
hijack another user’s session.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the session ID is not unique. </li>
  <li> the session ID is set from a user-controlled input. </li>
  <li> the session ID is generated with not secure pseudo random generator. </li>
  <li> the session ID length is too short. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t manually generate session IDs, use instead language based native functionality.</p>
<h2>Sensitive Code Example</h2>
<pre>
session_id(bin2hex(random_bytes(4))); // Sensitive: 4 bytes is too short
session_id($_POST["session_id"]); // Sensitive: session ID can be specified by the user
</pre>
<h2>Compliant Solution</h2>
<pre>
session_regenerate_id(); ; // Compliant
session_id(bin2hex(random_bytes(16))); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/Session_fixation">OWASP Sesssion Fixation</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/340">MITRE, CWE-340</a> - Generation of Predictable Numbers or Identifiers </li>
  <li> <a href="https://www.php.net/random-bytes">PHP: random_bytes()</a> </li>
  <li> <a href="https://www.php.net/session-regenerate-id">PHP: session_regenerate_id()</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S1523"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S1523">
              php:S1523
            </a>
          </td>
          <td >
            <details>
              <p>Executing code dynamically is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807">CVE-2017-9807</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802">CVE-2017-9802</a> </li>
</ul>
<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific
meta-programming use-cases. However most of the time their use is frowned upon as they also increase the risk of <a
href="https://owasp.org/www-community/attacks/Code_Injection">Injected Code</a>. Such attacks can either run on the server or in the client (exemple:
XSS attack) and have a huge impact on an application’s security.</p>
<p>This rule marks for review each occurrence of the <a href="https://www.php.net/manual/en/function.eval.php"><code>eval</code> function</a>. This
rule does not detect code injections. It only highlights the use of APIs which should be used sparingly and very carefully. The goal is to guide
security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>
  <li> you really need to run code dynamically. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Regarding the execution of unknown code, the best solution is to not run code provided by an untrusted source. If you really need to do it, run the
code in a <a href="https://en.wikipedia.org/wiki/Sandbox_(computer_security)">sandboxed</a> environment. Use jails, firewalls and whatever means your
operating system and programming language provide (example: <a
href="https://wiki.sei.cmu.edu/confluence/display/java/SEC54-J.+Create+a+secure+sandbox+using+a+security+manager">Security Managers</a> in java, <a
href="https://www.w3schools.com/tags/att_iframe_sandbox.asp">iframes</a> and <a href="https://en.wikipedia.org/wiki/Same-origin_policy">same-origin
policy</a> for javascript in a web browser).</p>
<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>
<p>Avoid using dynamic code APIs whenever possible. Hard-coded code is always safer.</p>
<h2>Noncompliant Code Example</h2>
<pre>
eval($code_to_be_dynamically_executed)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/95">MITRE, CWE-95</a> - Improper Neutralization of Directives in Dynamically Evaluated Code
  ('Eval Injection') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S2612"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2612">
              php:S2612
            </a>
          </td>
          <td >
            <details>
              <p>In Unix, "<code>others</code>" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>
<p>Granting permissions to this group can lead to unintended access to files.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application is designed to be run on a multi-user environment. </li>
  <li> Corresponding files and directories may contain confidential information. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
<h2>Sensitive Code Example</h2>
<pre>
chmod("foo", 0777); // Sensitive
</pre>
<pre>
umask(0); // Sensitive
umask(0750); // Sensitive
</pre>
<p>For <a href="https://symfony.com/doc/current/components/filesystem.html">Symfony Filesystem</a>:</p>
<pre>
use Symfony\Component\Filesystem\Filesystem;

$fs = new Filesystem();
$fs-&gt;chmod("foo", 0777); // Sensitive
</pre>
<p>For <a href="https://laravel.com/api/8.x/Illuminate/Filesystem/Filesystem.html">Laravel Filesystem</a>:</p>
<pre>
use Illuminate\Filesystem\Filesystem;

$fs = new Filesystem();
$fs-&gt;chmod("foo", 0777); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
chmod("foo", 0750); // Compliant
</pre>
<pre>
umask(0027); // Compliant
</pre>
<p>For <a href="https://symfony.com/doc/current/components/filesystem.html">Symfony Filesystem</a>:</p>
<pre>
use Symfony\Component\Filesystem\Filesystem;

$fs = new Filesystem();
$fs-&gt;chmod("foo", 0750); // Compliant
</pre>
<p>For <a href="https://laravel.com/api/8.x/Illuminate/Filesystem/Filesystem.html">Laravel Filesystem</a>:</p>
<pre>
use Illuminate\Filesystem\Filesystem;

$fs = new Filesystem();
$fs-&gt;chmod("foo", 0750); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission">OWASP File Permission</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="php:S6345"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S6345">
              php:S6345
            </a>
          </td>
          <td >
            <details>
              <p>External requests initiated by a WordPress server should be considered as security-sensitive. They may contain sensitive data which is stored in
the files or in the database of the server. It’s important for the administrator of a WordPress server to understand what they contain and to which
server they are sent.</p>
<p>WordPress makes it possible to block external requests by setting the <code>WP_HTTP_BLOCK_EXTERNAL</code> option to <code>true</code>. It’s then
possible to authorize requests to only a few servers using another option named <code>WP_ACCESSIBLE_HOSTS</code>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Your WordPress website contains code which may call external requests to servers you don’t know. </li>
  <li> Your WordPress website may send sensitive data to other servers. </li>
  <li> Your WordPress website uses a lot of plugins or themes. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Uninstall WordPress plugins which send requests to servers you don’t know. </li>
  <li> Make sure that <code>WP_HTTP_BLOCK_EXTERNAL</code> is defined in <code>wp-config.php</code>. </li>
  <li> Make sure that <code>WP_HTTP_BLOCK_EXTERNAL</code> is set to <code>true</code>. </li>
  <li> Make sure that <code>WP_ACCESSIBLE_HOSTS</code> is configured to authorize requests to the servers you trust. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
define( 'WP_HTTP_BLOCK_EXTERNAL', false ); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
define( 'WP_HTTP_BLOCK_EXTERNAL', true );
define( 'WP_ACCESSIBLE_HOSTS', 'api.wordpress.org' );
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A10_2021-Server-Side_Request_Forgery_%28SSRF%29/">OWASP Top 10 2021 Category A10</a> - Server-Side Request
  Forgery (SSRF) </li>
  <li> <a href="https://wordpress.org/support/article/editing-wp-config-php/#block-external-url-requestsl">wordpress.org</a> - Block External URL
  Requests </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">OWASP Attack Category</a> - Server Side Request Forgery </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/918">MITRE, CWE-918</a> - Server-Side Request Forgery (SSRF) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S6348"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S6348">
              php:S6348
            </a>
          </td>
          <td >
            <details>
              <p>By default, the WordPress administrator and editor roles can add unfiltered HTML content in various places, such as post content. This includes the
capability to add JavaScript code.</p>
<p>If an account with such a role gets hijacked, this capability can be used to plant malicious JavaScript code that gets executed whenever somebody
visits the website.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You really need the possibility to add unfiltered HTML with editor or administrator roles. </li>
  <li> There’s a chance that the accounts of authorized users get compromised. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>The <code>unfiltered_html</code> capability should be granted to trusted roles that need to use markup when publishing dynamic content to the
WordPress website. If this capability is not required for all users, including administrators and editors roles, then it’s recommended to set
<code>DISALLOW_UNFILTERED_HTML</code> to <code>true</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
define( 'DISALLOW_UNFILTERED_HTML', false ); // sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
define( 'DISALLOW_UNFILTERED_HTML', true );
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S6341"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S6341">
              php:S6341
            </a>
          </td>
          <td >
            <details>
              <p>WordPress makes it possible to edit theme and plugin files directly in the Administration Screens. While it may look like an easy way to customize
a theme or do a quick change, it’s a dangerous feature. When visiting the theme or plugin editor for the first time, WordPress displays a warning to
make it clear that using such a feature may break the web site by mistake. More importantly, users who have access to this feature can trigger the
execution of any PHP code and may therefore take full control of the WordPress instance. This security risk could be exploited by an attacker who
manages to get access to one of the authorized users. Setting the <code>DISALLOW_FILE_EDIT</code> option to <code>true</code> in
<code>wp-config.php</code> disables this risky feature. The default value is <code>false</code>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You really need to use the theme and plugin editors. </li>
  <li> The theme and plugin editors are available to users who cannot be fully trusted. </li>
  <li> There’s a chance that the accounts of authorized users get compromised. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Modify the theme and plugin files using a local editor and deploy them to the server in a secure way. </li>
  <li> Make sure that <code>DISALLOW_FILE_EDIT</code> is defined in <code>wp-config.php</code>. </li>
  <li> Make sure that <code>DISALLOW_FILE_EDIT</code> is set to <code>true</code>. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
define( 'DISALLOW_FILE_EDIT', false ); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
define( 'DISALLOW_FILE_EDIT', true );
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://wordpress.org/support/article/editing-wp-config-php/#disable-the-plugin-and-theme-editor">wordpress.org</a> - Disable the
  Plugin and Theme Editor </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/94">MITRE, CWE-94</a> - Improper Control of Generation of Code ('Code Injection') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/95">MITRE, CWE-95</a> - Improper Neutralization of Directives in Dynamically Evaluated Code
  ('Eval Injection') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S6346"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S6346">
              php:S6346
            </a>
          </td>
          <td >
            <details>
              <p>WordPress has a database repair and optimization mode that can be activated by setting <code>WP_ALLOW_REPAIR</code> to <code>true</code> in the
configuration.</p>
<p>If activated, the repair page can be accessed by any user, authenticated or not. This makes sense because if the database is corrupted, the
authentication mechanism might not work.</p>
<p>Malicious users could trigger this potentially costly operation repeatadly slowing down the website, and making it unavailable.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database is not currently corrupted. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable automatic database repair mode only in case of database corruption. This feature should be deactivated again when the
database issue is resolved.</p>
<h2>Noncompliant Code Example</h2>
<pre>
define( 'WP_ALLOW_REPAIR', true ); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
// The default value is false, so the value does not have to be expilicitly set.
define( 'WP_ALLOW_REPAIR', false );
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://wordpress.org/support/article/editing-wp-config-php/#automatic-database-optimizing">wordpress.org</a> - Automatic Database
  Optimizing </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S6343"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S6343">
              php:S6343
            </a>
          </td>
          <td >
            <details>
              <p>Automatic updates are a great way of making sure your application gets security updates as soon as they are available. Once a vendor releases a
security update, it is crucial to apply it in a timely manner before malicious actors exploit the vulnerability. Relying on manual updates is usually
too late, especially if the application is publicly accessible on the internet.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> there is no specific reason for deactivating all automatic updates. </li>
  <li> you meant to deactivate only automatic major updates. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t deactivate automatic updates unless you have a good reason to do so. This way, you’ll be sure to receive security updates as soon as they are
available. If you are worried about an automatic update breaking something, check if it is possible to only activate automatic updates for minor or
security updates.</p>
<h2>Noncompliant Code Example</h2>
<pre>
define( 'WP_AUTO_UPDATE_CORE', false ); // Sensitive
define( 'AUTOMATIC_UPDATER_DISABLED', true ); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
define( 'WP_AUTO_UPDATE_CORE', true ); // Minor and major automatic updates enabled
define( 'WP_AUTO_UPDATE_CORE', 'minor' ); // Only minor updates are enabled
define( 'AUTOMATIC_UPDATER_DISABLED', false );
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://wordpress.org/support/article/editing-wp-config-php/#disable-wordpress-auto-updates">Wordpress.org</a> - Disable WordPress
  Auto Updates </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S1313">
              php:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
socket_connect($socket, '8.8.8.8', 23);  // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
$socket = socket_create(AF_INET, SOCK_STREAM, SOL_TCP);
socket_connect($socket, IP_ADDRESS, 23);  // Compliant
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4828"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4828">
              php:S4828
            </a>
          </td>
          <td >
            <details>
              <p>Signaling processes or process groups can seriously affect the stability of this application or other applications on the same system.</p>
<p>Accidentally setting an incorrect <code>PID</code> or <code>signal</code> or allowing untrusted sources to assign arbitrary values to these
parameters may result in a denial of service.</p>
<p>Also, the system treats the signal differently if the destination <code>PID</code> is less than or equal to 0. This different behavior may affect
multiple processes with the same (E)UID simultaneously if the call is left uncontrolled.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The parameters <code>pid</code> and <code>sig</code> are untrusted (they come from an external source). </li>
  <li> This function is triggered by non-administrators. </li>
  <li> Signal handlers on the target processes stop important functions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> For stateful applications with user management, ensure that only administrators trigger this code. </li>
  <li> Verify that the <code>pid</code> and <code>sig</code> parameters are correct before using them. </li>
  <li> Ensure that the process sending the signals runs with as few OS privileges as possible. </li>
  <li> Isolate the process on the system based on its (E)UID. </li>
  <li> Ensure that the signal does not interrupt any essential functions when intercepted by a target’s signal handlers. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
$targetPid = (int)$_GET["pid"];
posix_kill($targetPid, 9); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
$targetPid = (int)$_GET["pid"];

// Validate the untrusted PID,
// With a pre-approved list or authorization checks
if (isValidPid($targetPid)) {
    posix_kill($targetPid, 9);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/283">MITRE, CWE-283</a> - Unverified Ownership </li>
  <li> <a href="https://man7.org/linux/man-pages/man1/kill.1.html">kill(1) — Linux manual page</a> </li>
  <li> <a href="https://man7.org/linux/man-pages/man2/kill.2.html">kill(2) — Linux manual page</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4829"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4829">
              php:S4829
            </a>
          </td>
          <td >
            <details>
              <p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337">CVE-2005-2337</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449">CVE-2017-11449</a> </li>
</ul>
<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)
can be dangerous and should be validated.</p>
<p>This rule flags code that reads from the standard input.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> data read from the standard input is not sanitized before being used. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all data read from the standard input before using it.</p>
<h2>Sensitive Code Example</h2>
<pre>
// Any reference to STDIN is Sensitive
$varstdin = STDIN; // Sensitive
stream_get_line(STDIN, 40); // Sensitive
stream_copy_to_stream(STDIN, STDOUT); // Sensitive
// ...


// Except those references as they can't create an injection vulnerability.
ftruncate(STDIN, 5); // OK
ftell(STDIN); // OK
feof(STDIN); // OK
fseek(STDIN, 5); // OK
fclose(STDIN); // OK


// STDIN can also be referenced like this
$mystdin = 'php://stdin'; // Sensitive

file_get_contents('php://stdin'); // Sensitive
readfile('php://stdin'); // Sensitive

$input = fopen('php://stdin', 'r'); // Sensitive
fclose($input); // OK
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4823"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4823">
              php:S4823
            </a>
          </td>
          <td >
            <details>
              <p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281">CVE-2018-7281</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326">CVE-2018-12326</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198">CVE-2011-3198</a> </li>
</ul>
<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>
<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus
passing sensitive information via command line arguments should be considered as insecure.</p>
<p>This rule raises an issue when on every program entry points (<code>main</code> methods) when command line arguments are used. The goal is to guide
security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> any of the command line arguments are used without being sanitized first. </li>
  <li> your application accepts sensitive information via command line arguments. </li>
</ul>
<p>If you answered yes to any of these questions you are at risk.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all command line arguments before using them.</p>
<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing
sensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the
path to a file containing the information.</p>
<h2>Sensitive Code Example</h2>
<p>Builtin access to <code>$argv</code></p>
<pre>
function globfunc() {
    global $argv; // Sensitive. Reference to global $argv
    foreach ($argv as $arg) { // Sensitive.
        // ...
    }
}

function myfunc($argv) {
    $param = $argv[0]; // OK. Reference to local $argv parameter
    // ...
}

foreach ($argv as $arg) { // Sensitive. Reference to $argv.
    // ...
}

$myargv = $_SERVER['argv']; // Sensitive. Equivalent to $argv.

function serve() {
    $myargv = $_SERVER['argv']; // Sensitive.
    // ...
}

myfunc($argv); // Sensitive

$myvar = $HTTP_SERVER_VARS[0]; // Sensitive. Note: HTTP_SERVER_VARS has ben removed since PHP 5.4.

$options = getopt('a:b:'); // Sensitive. Parsing arguments.

$GLOBALS["argv"]; // Sensitive. Equivalent to $argv.

function myglobals() {
    $GLOBALS["argv"]; // Sensitive
}

$argv = [1,2,3]; // Sensitive. It is a bad idea to override argv.
</pre>
<p>Zend Console</p>
<pre>
new Zend\Console\Getopt(['myopt|m' =&gt; 'this is an option']); // Sensitive
</pre>
<p>Getopt-php library</p>
<pre>
new \GetOpt\Option('m', 'myoption', \GetOpt\GetOpt::REQUIRED_ARGUMENT); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/88">MITRE, CWE-88</a> - Argument Injection or Modification </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/214">MITRE, CWE-214</a> - Information Exposure Through Process Environment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S4834"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4834">
              php:S4834
            </a>
          </td>
          <td >
            <details>
              <p>The access control of an application must be properly implemented in order to restrict access to resources to authorized entities otherwise this
could lead to vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12999">CVE-2018-12999</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10285">CVE-2018-10285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7455">CVE-2017-7455</a> </li>
</ul>
<p>Granting correct permissions to users, applications, groups or roles and defining required permissions that allow access to a resource is
sensitive, must therefore be done with care. For instance, it is obvious that only users with administrator privilege should be authorized to
add/remove the administrator permission of another user.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Granted permission to an entity (user, application) allow access to information or functionalities not needed by this entity. </li>
  <li> Privileges are easily acquired (eg: based on the location of the user, type of device used, defined by third parties, does not require approval
  …​). </li>
  <li> Inherited permission, default permission, no privileges (eg: anonymous user) is authorized to access to a protected resource. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>At minimum, an access control system should:</p>
<ul>
  <li> Use a well-defined access control model like <a href="https://en.wikipedia.org/wiki/Role-based_access_control">RBAC</a> or <a
  href="https://en.wikipedia.org/wiki/Access-control_list">ACL</a>. </li>
  <li> Entities' permissions should be reviewed regularly to remove permissions that are no longer needed. </li>
  <li> Respect <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a> ("<em>an entity has access
  only the information and resources that are necessary for its legitimate purpose</em>"). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>CakePHP</p>
<pre>
use Cake\Auth\BaseAuthorize;
use Cake\Controller\Controller;

abstract class MyAuthorize extends BaseAuthorize { // Sensitive. Method extending Cake\Auth\BaseAuthorize.
    // ...
}

// Note that "isAuthorized" methods will only be detected in direct subclasses of Cake\Controller\Controller.
abstract class MyController extends Controller {
    public function isAuthorized($user) { // Sensitive. Method called isAuthorized in a Cake\Controller\Controller.
        return false;
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/276">MITRE, CWE-276</a> - Incorrect Default Permissions </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/277">MITRE, CWE-277</a> - Insecure Inherited Permissions </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S5122"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5122">
              php:S5122
            </a>
          </td>
          <td >
            <details>
              <p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269">CVE-2018-0269</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460">CVE-2017-14460</a> </li>
</ul>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same origin policy</a> in browsers prevents, by default and for
security-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)
from its own. The requested target can append additional HTTP headers in response, called <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>, that act like directives for the browser and change the access control policy
/ relax the same origin policy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>
  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>
  <li> Your access control policy is dynamically defined by a user-controlled input like <a
  href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin"><code>origin</code></a> header. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>
  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or
  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>PHP built-in header function:</p>
<pre>
header("Access-Control-Allow-Origin: *"); // Sensitive
</pre>
<p>Laravel:</p>
<pre>
response()-&gt;header('Access-Control-Allow-Origin', "*"); // Sensitive
</pre>
<p>Symfony:</p>
<pre>
use Symfony\Component\HttpFoundation\Response;

$response = new Response(
    'Content',
    Response::HTTP_OK,
    ['Access-Control-Allow-Origin' =&gt; '*'] // Sensitive
);
$response-&gt;headers-&gt;set('Access-Control-Allow-Origin', '*'); // Sensitive
</pre>
<p>User-controlled origin:</p>
<pre>
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\HttpFoundation\Request;

$origin = $request-&gt;headers-&gt;get('Origin');

$response-&gt;headers-&gt;set('Access-Control-Allow-Origin', $origin); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>PHP built-in header function:</p>
<pre>
header("Access-Control-Allow-Origin: $trusteddomain");
</pre>
<p>Laravel:</p>
<pre>
response()-&gt;header('Access-Control-Allow-Origin', $trusteddomain);
</pre>
<p>Symfony:</p>
<pre>
use Symfony\Component\HttpFoundation\Response;

$response = new Response(
    'Content',
    Response::HTTP_OK,
    ['Access-Control-Allow-Origin' =&gt; $trusteddomain]
);

$response-&gt;headers-&gt;set('Access-Control-Allow-Origin', $trusteddomain);
</pre>
<p>User-controlled origin validated with an allow-list:</p>
<pre>
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\HttpFoundation\Request;

$origin = $request-&gt;headers-&gt;get('Origin');

if (in_array($origin, $trustedOrigins)) {
    $response-&gt;headers-&gt;set('Access-Control-Allow-Origin', $origin);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">developer.mozilla.org</a> - CORS </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">developer.mozilla.org</a> - Same origin policy </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing">OWASP HTML5 Security
  Cheat Sheet</a> - Cross Origin Resource Sharing </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/346">MITRE, CWE-346</a> - Origin Validation Error </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/942">MITRE, CWE-942</a> - Overly Permissive Cross-domain Whitelist </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S2092"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2092">
              php:S2092
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP
request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>
  <li> it’s not sure that the website contains <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">mixed content</a> or not
  (ie HTTPS everywhere or not) </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour
  when creating cookies. </li>
  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>In <em>php.ini</em> you can specify the flags for the session cookie which is security-sensitive:</p>
<pre>
session.cookie_secure = 0; // Sensitive: this security-sensitive session cookie is created with the secure flag set to false (cookie_secure = 0)
</pre>
<p>Same thing in PHP code:</p>
<pre>
session_set_cookie_params($lifetime, $path, $domain, false);
// Sensitive: this security-sensitive session cookie is created with the secure flag (the fourth argument) set to _false_
</pre>
<p>If you create a custom security-sensitive cookie in your PHP code:</p>
<pre>
$value = "sensitive data";
setcookie($name, $value, $expire, $path, $domain, false);  // Sensitive: a security-sensitive cookie is created with the secure flag  (the sixth argument) set to _false_
</pre>
<p>By default <a href="https://www.php.net/manual/en/function.setcookie.php"><code>setcookie</code></a> and <a
href="https://www.php.net/manual/en/function.setrawcookie.php"><code>setrawcookie</code></a> functions set the sixth argument / <code>secure</code>
flag to <em>false:</em></p>
<pre>
$value = "sensitive data";
setcookie($name, $value, $expire, $path, $domain);  // Sensitive: a security-sensitive cookie is created with the secure flag (the sixth argument) not defined (by default to false)
setrawcookie($name, $value, $expire, $path, $domain);  // Sensitive: a security-sensitive cookie is created with the secure flag (the sixth argument) not defined (by default to false)
</pre>
<h2>Compliant Solution</h2>
<pre>
session.cookie_secure = 1; // Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to cookie_secure property set to 1
</pre>
<pre>
session_set_cookie_params($lifetime, $path, $domain, true); // Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to the secure flag (the fouth argument) set to true
</pre>
<pre>
$value = "sensitive data";
setcookie($name, $value, $expire, $path, $domain, true); // Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to the secure flag (the sixth  argument) set to true
setrawcookie($name, $value, $expire, $path, $domain, true);// Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to the secure flag (the sixth argument) set to true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/614">MITRE, CWE-614</a> - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="ruby:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=ruby:S1313">
              ruby:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
ip = "192.168.12.42"; // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
ip = IP_ADDRESS; // Compliant
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="ruby:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=ruby:S2068">
              ruby:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S6300"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S6300">
              kotlin:S6300
            </a>
          </td>
          <td >
            <details>
              <p>Storing files locally is a common task for mobile applications. Files that are stored unencrypted can be read out and modified by an attacker with
physical access to the device. Access to sensitive data can be harmful for the user of the application, for example when the device gets stolen.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The file contains sensitive data that could cause harm when leaked. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to password-encrypt local files that contain sensitive information. The class <a
href="https://developer.android.com/reference/androidx/security/crypto/EncryptedFile">EncryptedFile</a> can be used to easily encrypt files.</p>
<h2>Sensitive Code Example</h2>
<pre>
val targetFile = File(activity.filesDir, "data.txt")
targetFile.writeText(fileContent)  // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
val mainKey = MasterKeys.getOrCreate(MasterKeys.AES256_GCM_SPEC)

val encryptedFile = EncryptedFile.Builder(
    File(activity.filesDir, "data.txt"),
    activity,
    mainKey,
    EncryptedFile.FileEncryptionScheme.AES256_GCM_HKDF_4KB
).build()

encryptedFile.openFileOutput().apply {
    write(fileContent)
    flush()
    close()
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="kotlin:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S2068">
              kotlin:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
val params = "password=xxxx" // Sensitive
val writer = OutputStreamWriter(getOutputStream())
writer.write(params)
writer.flush()
...
val password = "xxxx" // Sensitive
...
</pre>
<h2>Compliant Solution</h2>
<pre>
val params = "password=${retrievePassword()}"
val writer = OutputStreamWriter(getOutputStream())
writer.write(params)
writer.flush()
...
val password = retrievePassword()
...
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S5332">
              kotlin:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<p>These clients from <a href="https://commons.apache.org/proper/commons-net/">Apache commons net</a> libraries are based on unencrypted protocols and
are not recommended:</p>
<pre>
val telnet = TelnetClient(); // Sensitive

val ftpClient = FTPClient(); // Sensitive

val smtpClient = SMTPClient(); // Sensitive
</pre>
<p>Unencrypted HTTP connections, when using <a href="https://square.github.io/okhttp/https/">okhttp</a> library for instance, should be avoided:</p>
<pre>
val spec: ConnectionSpec = ConnectionSpec.Builder(ConnectionSpec.CLEARTEXT) // Sensitive
  .build()
</pre>
<p>Android WebView can be configured to allow a secure origin to load content from any other origin, even if that origin is insecure (mixed
content);</p>
<pre>
import android.webkit.WebView

val webView: WebView = findViewById(R.id.webview)
webView.getSettings().setMixedContentMode(MIXED_CONTENT_ALWAYS_ALLOW) // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Use instead these clients from <a href="https://commons.apache.org/proper/commons-net/">Apache commons net</a> and <a
href="http://www.jcraft.com/jsch/">JSch/ssh</a> library:</p>
<pre>
JSch jsch = JSch();

if(implicit) {
  // implicit mode is considered deprecated but offer the same security than explicit mode
  val ftpsClient = FTPSClient(true);
}
else {
  val ftpsClient = FTPSClient();
}

if(implicit) {
  // implicit mode is considered deprecated but offer the same security than explicit mode
  val smtpsClient = SMTPSClient(true);
}
else {
  val smtpsClient = SMTPSClient();
  smtpsClient.connect("127.0.0.1", 25);
  if (smtpsClient.execTLS()) {
    // commands
  }
}
</pre>
<p>Perform HTTP encrypted connections, with <a href="https://square.github.io/okhttp/https/">okhttp</a> library for instance:</p>
<pre>
val spec: ConnectionSpec =ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)
  .build()
</pre>
<p>The most secure mode for Android WebView is <code>MIXED_CONTENT_NEVER_ALLOW</code>;</p>
<pre>
import android.webkit.WebView

val webView: WebView = findViewById(R.id.webview)
webView.getSettings().setMixedContentMode(MIXED_CONTENT_NEVER_ALLOW)
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="kotlin:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S4507">
              kotlin:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> the application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers or applications distributed to end users.</p>
<h2>Sensitive Code Example</h2>
<p><a
href="https://developer.android.com/reference/android/webkit/WebView#setWebContentsDebuggingEnabled(boolean)">WebView.setWebContentsDebuggingEnabled(true)</a>
for Android enables debugging support:</p>
<pre>
import android.webkit.WebView

WebView.setWebContentsDebuggingEnabled(true) // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a
href="https://developer.android.com/reference/android/webkit/WebView#setWebContentsDebuggingEnabled(boolean)">WebView.setWebContentsDebuggingEnabled(false)</a>
for Android disables debugging support:</p>
<pre>
import android.webkit.WebView

WebView.setWebContentsDebuggingEnabled(false)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S6362"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S6362">
              kotlin:S6362
            </a>
          </td>
          <td >
            <details>
              <p>WebViews can be used to display web content as part of a mobile application. A browser engine is used to render and display the content. Like a web
application a mobile application that uses WebViews can be vulnerable to Cross-Site Scripting if untrusted code is rendered. In the context of a
WebView JavaScript code can exfiltrate local files that might be sensitive or even worse, access exposed functions of the application that can result
in more severe vulnerabilities such as code injection. Thus JavaScript support should not be enabled for WebViews unless it is absolutely necessary
and the authenticity of the web resources can be guaranteed.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The WebWiew only renders static web content that does not require JavaScript code to be executed. </li>
  <li> The WebView contains untrusted data that could cause harm when rendered. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to disable JavaScript support for WebViews unless it is necessary to execute JavaScript code. Only trusted pages should be
rendered.</p>
<h2>Sensitive Code Example</h2>
<pre>
import android.webkit.WebView

val webView: WebView = findViewById(R.id.webview)
webView.getSettings().setJavaScriptEnabled(true) // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.webkit.WebView

val webView: WebView = findViewById(R.id.webview)
webView.getSettings().setJavaScriptEnabled(false)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S6363"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S6363">
              kotlin:S6363
            </a>
          </td>
          <td >
            <details>
              <p>WebViews can be used to display web content as part of a mobile application. A browser engine is used to render and display the content. Like a web
application a mobile application that uses WebViews can be vulnerable to Cross-Site Scripting if untrusted code is rendered.</p>
<p>If malicious JavaScript code in a WebView is executed this can leak the contents of sensitive files when access to local files is enabled.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> No local files have to be accessed by the Webview. </li>
  <li> The WebView contains untrusted data that could cause harm when rendered. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to disable access to local files for WebViews unless it is necessary. In the case of a successful attack through a Cross-Site
Scripting vulnerability the attackers attack surface decreases drastically if no files can be read out.</p>
<h2>Sensitive Code Example</h2>
<pre>
import android.webkit.WebView

val webView: WebView = findViewById(R.id.webview)
webView.getSettings().setAllowContentAccess(true) // Sensitive
webView.getSettings().setAllowFileAccess(true) // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.webkit.WebView

val webView: WebView = findViewById(R.id.webview)
webView.getSettings().setAllowContentAccess(false)
webView.getSettings().setAllowFileAccess(false)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S5322"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S5322">
              kotlin:S5322
            </a>
          </td>
          <td >
            <details>
              <p>Android applications can receive broadcasts from the system or other applications. Receiving intents is security-sensitive. For example, it has led
in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-1677">CVE-2019-1677</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1275">CVE-2015-1275</a> </li>
</ul>
<p>Receivers can be declared in the manifest or in the code to make them context specific. If the receiver is declared in the manifest Android will
start the application if it is not already running once a matching broadcast is received. The receiver is an entry point into the application.</p>
<p>Other applications can send potentially malicious broadcasts, so it is important to consider broadcasts as untrusted and to limit the applications
that can send broadcasts to the receiver.</p>
<p>Permissions can be specified to restrict broadcasts to authorized applications. Restrictions can be enforced by both the sender and receiver of a
broadcast. If permissions are specified when registering a broadcast receiver, then only broadcasters who were granted this permission can send a
message to the receiver.</p>
<p>This rule raises an issue when a receiver is registered without specifying any "broadcast permission".</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The data extracted from intents is not sanitized. </li>
  <li> Intents broadcast is not restricted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Restrict the access to broadcasted intents. See <a
href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> for more
information.</p>
<h2>Sensitive Code Example</h2>
<pre>
import android.content.BroadcastReceiver
import android.content.Context
import android.content.IntentFilter
import android.os.Build
import android.os.Handler
import androidx.annotation.RequiresApi

class MyIntentReceiver {
    @RequiresApi(api = Build.VERSION_CODES.O)
    fun register(
        context: Context, receiver: BroadcastReceiver?,
        filter: IntentFilter?,
        scheduler: Handler?,
        flags: Int
    ) {
        context.registerReceiver(receiver, filter) // Sensitive
        context.registerReceiver(receiver, filter, flags) // Sensitive

        // Broadcasting intent with "null" for broadcastPermission
        context.registerReceiver(receiver, filter, null, scheduler) // Sensitive
        context.registerReceiver(receiver, filter, null, scheduler, flags) // Sensitive
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.content.BroadcastReceiver
import android.content.Context
import android.content.IntentFilter
import android.os.Build
import android.os.Handler
import androidx.annotation.RequiresApi

class MyIntentReceiver {
    @RequiresApi(api = Build.VERSION_CODES.O)
    fun register(
        context: Context, receiver: BroadcastReceiver?,
        filter: IntentFilter?,
        broadcastPermission: String?,
        scheduler: Handler?,
        flags: Int
    ) {
        context.registerReceiver(receiver, filter, broadcastPermission, scheduler)
        context.registerReceiver(receiver, filter, broadcastPermission, scheduler, flags)
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  Platform Usage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/925">MITRE, CWE-925</a> - Improper Verification of Intent by Broadcast Receiver </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/926">MITRE, CWE-926</a> - Improper Export of Android Application Components </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> <a href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> -
  Broadcast Overview - Security considerations and best practices </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S5324"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S5324">
              kotlin:S5324
            </a>
          </td>
          <td >
            <details>
              <p>Storing data locally is a common task for mobile applications. Such data includes files among other things. One convenient way to store files is to
use the external file storage which usually offers a larger amount of disc space compared to internal storage.</p>
<p>Files created on the external storage are globally readable and writable. Therefore, a malicious application having the permissions
<code>WRITE_EXTERNAL_STORAGE</code> or <code>READ_EXTERNAL_STORAGE</code> could try to read sensitive information from the files that other
applications have stored on the external storage.</p>
<p>External storage can also be removed by the user (e.g when based on SD card) making the files unavailable to the application.</p>
<h2>Ask Yourself Whether</h2>
<p>Your application uses external storage to:</p>
<ul>
  <li> store files that contain sensitive data. </li>
  <li> store files that are not meant to be shared with other application. </li>
  <li> store files that are critical for the application to work. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use internal storage whenever possible as the system prevents other apps from accessing this location. </li>
  <li> Only use external storage if you need to share non-sensitive files with other applications. </li>
  <li> If your application has to use the external storage to store sensitive data, make sure it encrypts the files using <a
  href="https://developer.android.com/reference/androidx/security/crypto/EncryptedFile">EncryptedFile</a>. </li>
  <li> Data coming from external storage should always be considered untrusted and should be validated. </li>
  <li> As some external storage can be removed, make sure to never store files on it that are critical for the usability of your application. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
import android.content.Context

class AccessExternalFiles {

    fun accessFiles(Context context) {
        context.getExternalFilesDir(null) // Sensitive
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.content.Context
import android.os.Environment

class AccessExternalFiles {

    fun accessFiles(Context context) {
        context.getFilesDir()
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://developer.android.com/training/articles/security-tips#ExternalStorage">Android Security tips on external file storage</a>
  </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/312">MITRE, CWE-312</a> - Cleartext Storage of Sensitive Information </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="kotlin:S5320"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S5320">
              kotlin:S5320
            </a>
          </td>
          <td >
            <details>
              <p>In Android applications, broadcasting intents is security-sensitive. For example, it has led in the past to the following vulnerability:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9489">CVE-2018-9489</a> </li>
</ul>
<p>By default, broadcasted intents are visible to every application, exposing all sensitive information they contain.</p>
<p>This rule raises an issue when an intent is broadcasted without specifying any "receiver permission".</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The intent contains sensitive information. </li>
  <li> Intent reception is not restricted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Restrict the access to broadcasted intents. See <a
href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> for more
information.</p>
<h2>Sensitive Code Example</h2>
<pre>
import android.content.BroadcastReceiver
import android.content.Context
import android.content.Intent
import android.os.Bundle
import android.os.Handler
import android.os.UserHandle

public class MyIntentBroadcast {
    fun broadcast(intent: Intent,
                  context: Context,
                  user: UserHandle,
                  resultReceiver: BroadcastReceiver,
                  scheduler: Handler,
                  initialCode: Int,
                  initialData: String,
                  initialExtras: Bundle,
                  broadcastPermission: String) {
        context.sendBroadcast(intent) // Sensitive
        context.sendBroadcastAsUser(intent, user) // Sensitive

        // Broadcasting intent with "null" for receiverPermission
        context.sendBroadcast(intent, null) // Sensitive
        context.sendBroadcastAsUser(intent, user, null) // Sensitive
        context.sendOrderedBroadcast(intent, null) // Sensitive
        context.sendOrderedBroadcastAsUser(intent, user, null, resultReceiver,
            scheduler, initialCode, initialData, initialExtras) // Sensitive
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.content.BroadcastReceiver
import android.content.Context
import android.content.Intent
import android.os.Bundle
import android.os.Handler
import android.os.UserHandle

public class MyIntentBroadcast {
    fun broadcast(intent: Intent,
                  context: Context,
                  user: UserHandle,
                  resultReceiver: BroadcastReceiver,
                  scheduler: Handler,
                  initialCode: Int,
                  initialData: String,
                  initialExtras: Bundle,
                  broadcastPermission: String) {

        context.sendBroadcast(intent, broadcastPermission)
        context.sendBroadcastAsUser(intent, user, broadcastPermission)
        context.sendOrderedBroadcast(intent, broadcastPermission)
        context.sendOrderedBroadcastAsUser(intent, user,broadcastPermission, resultReceiver,
            scheduler, initialCode, initialData, initialExtras)
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  Platform Usage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/927">MITRE, CWE-927</a> - Use of Implicit Intent for Sensitive Communication </li>
  <li> <a href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> -
  Broadcast Overview - Security considerations and best practices </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="kotlin:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S1313">
              kotlin:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
val ip = "192.168.12.42"
val socket = ServerSocket(ip, 6667)
</pre>
<h2>Compliant Solution</h2>
<pre>
val ip = System.getenv("myapplication.ip")
val socket = ServerSocket(ip, 6667)
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
  <li> Addresses from ::ffff:0:127.0.0.1 to ::ffff:0:127.255.255.255 and from ::ffff:127.0.0.1 to ::ffff:127.255.255.255, which are local IPv4-mapped
  IPv6 addresses </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S2245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S2245">
              kotlin:S2245
            </a>
          </td>
          <td >
            <details>
              <p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386">CVE-2013-6386</a> </li>
  <li> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419">CVE-2006-3419</a> </li>
  <li> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102">CVE-2008-4102</a> </li>
</ul>
<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that
will be generated, and use this guess to impersonate another user or access sensitive information.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such
  as a password, is hashed. </li>
  <li> the function you use generates a value which can be predicted (pseudo-random). </li>
  <li> the generated value is used multiple times. </li>
  <li> an attacker can access the generated value. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Only use random number generators which are <a
  href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation">recommended by
  OWASP</a> or any other trusted organization. </li>
  <li> Use the generated random values only once. </li>
  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
val random = Random() // Noncompliant: Random() is not a secure random number generaotr
val bytes = ByteArray(20)
random.nextBytes(bytes)
</pre>
<h2>Compliant Solution</h2>
<pre>
val random = SecureRandom() // Compliant
val bytes = ByteArray(20)
random.nextBytes(bytes)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/338">MITRE, CWE-338</a> - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1241">MITRE, CWE-1241</a> - Use of Predictable Algorithm in Random Number Generator </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM">Predictable Pseudo Random Number
  Generator</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="kotlin:S6288"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S6288">
              kotlin:S6288
            </a>
          </td>
          <td >
            <details>
              <p>Android KeyStore is a secure container for storing key materials, in particular it prevents key materials extraction, i.e. when the application
process is compromised, the attacker cannot extract keys but may still be able to use them. It’s possible to enable an Android security feature, user
authentication, to restrict usage of keys to only authenticated users. The lock screen has to be unlocked with defined credentials
(pattern/PIN/password, biometric).</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application requires prohibiting the use of keys in case of compromise of the application process. </li>
  <li> The key material is used in the context of a highly sensitive application like a e-banking mobile app. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable user authentication (by setting <code>setUserAuthenticationRequired</code> to <code>true</code> during key generation)
to use keys for a limited duration of time (by setting appropriate values to <code>setUserAuthenticationValidityDurationSeconds</code>), after which
the user must re-authenticate.</p>
<h2>Noncompliant Code Example</h2>
<p>Any users can use the key:</p>
<pre>
val keyGenerator: KeyGenerator = KeyGenerator.getInstance(KeyProperties.KEY_ALGORITHM_AES, "AndroidKeyStore")

var builder: KeyGenParameterSpec = KeyGenParameterSpec.Builder("test_secret_key", KeyProperties.PURPOSE_ENCRYPT or KeyProperties.PURPOSE_DECRYPT) // Noncompliant
   .setBlockModes(KeyProperties.BLOCK_MODE_GCM)
   .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)
   .build()

keyGenerator.init(builder)
</pre>
<h2>Compliant Solution</h2>
<p>The use of the key is limited to authenticated users (for a duration of time defined to 60 seconds):</p>
<pre>
val keyGenerator: KeyGenerator = KeyGenerator.getInstance(KeyProperties.KEY_ALGORITHM_AES, "AndroidKeyStore")

var builder: KeyGenParameterSpec = KeyGenParameterSpec.Builder("test_secret_key", KeyProperties.PURPOSE_ENCRYPT or KeyProperties.PURPOSE_DECRYPT)
   .setBlockModes(KeyProperties.BLOCK_MODE_GCM)
   .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)
   .setUserAuthenticationRequired(true) // Compliant
   .setUserAuthenticationParameters (60, KeyProperties.AUTH_DEVICE_CREDENTIAL)
   .build()

keyGenerator.init(builder)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://developer.android.com/training/articles/keystore">developer.android.com</a> - Android keystore system </li>
  <li> <a href="https://developer.android.com/training/articles/keystore#UserAuthentication">developer.android.com</a> - Require user authentication
  for key use </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Authentication and Session Management Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication">OWASP Mobile Top 10 2016 Category M4</a> - Insecure
  Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/522">MITRE, CWE-522</a> - Insufficiently Protected Credentials </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="kotlin:S4790"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S4790">
              kotlin:S4790
            </a>
          </td>
          <td >
            <details>
              <p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is,
it takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash
value gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2,
MD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>
<p>The following APIs are tracked for use of obsolete crypto algorithms:</p>
<ul>
  <li> <code>java.security.AlgorithmParameters</code> (JDK) </li>
  <li> <code>java.security.AlgorithmParameterGenerator</code> (JDK) </li>
  <li> <code>java.security.MessageDigest</code> (JDK) </li>
  <li> <code>java.security.KeyFactory</code> (JDK) </li>
  <li> <code>java.security.KeyPairGenerator</code> (JDK) </li>
  <li> <code>java.security.Signature</code> (JDK) </li>
  <li> <code>javax.crypto.Mac</code> (JDK) </li>
  <li> <code>javax.crypto.KeyGenerator</code> (JDK) </li>
  <li> <code>org.apache.commons.codec.digest.DigestUtils</code> (Apache Commons Codec) </li>
  <li> <code>org.springframework.util.DigestUtils</code> </li>
  <li> <code>com.google.common.hash.Hashing</code> (Guava) </li>
  <li> <code>org.springframework.security.authentication.encoding.ShaPasswordEncoder</code> (Spring Security 4.2.x) </li>
  <li> <code>org.springframework.security.authentication.encoding.Md5PasswordEncoder</code> (Spring Security 4.2.x) </li>
  <li> <code>org.springframework.security.crypto.password.LdapShaPasswordEncoder</code> (Spring Security 5.0.x) </li>
  <li> <code>org.springframework.security.crypto.password.Md4PasswordEncoder</code> (Spring Security 5.0.x) </li>
  <li> <code>org.springframework.security.crypto.password.MessageDigestPasswordEncoder</code> (Spring Security 5.0.x) </li>
  <li> <code>org.springframework.security.crypto.password.NoOpPasswordEncoder</code> (Spring Security 5.0.x) </li>
  <li> <code>org.springframework.security.crypto.password.StandardPasswordEncoder</code> (Spring Security 5.0.x) </li>
</ul>
<h2>Ask Yourself Whether</h2>
<p>The hashed value is used in a security context like:</p>
<ul>
  <li> User-password storage. </li>
  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>
  <li> To compute some message integrity. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even
better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>
because it slows down <code>brute force attacks</code>.</p>
<h2>Sensitive Code Example</h2>
<pre>
val md1: MessageDigest = MessageDigest.getInstance("SHA");  // Sensitive:  SHA is not a standard name, for most security providers it's an alias of SHA-1
val md2: MessageDigest = MessageDigest.getInstance("SHA1");  // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
val md1: MessageDigest = MessageDigest.getInstance("SHA-512"); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1240">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S6291"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S6291">
              kotlin:S6291
            </a>
          </td>
          <td >
            <details>
              <p>Storing data locally is a common task for mobile applications. Such data includes preferences or authentication tokens for external services, among
other things. There are many convenient solutions that allow storing data persistently, for example SQLiteDatabase, SharedPreferences, and Realm. By
default these systems store the data unencrypted, thus an attacker with physical access to the device can read them out easily. Access to sensitive
data can be harmful for the user of the application, for example when the device gets stolen.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to password-encrypt local databases that contain sensitive information. Most systems provide secure alternatives to plain-text
storage that should be used. If no secure alternative is available the data can also be encrypted manually before it is stored.</p>
<p>The encryption password should not be hard-coded in the application. There are different approaches how the password can be provided to encrypt and
decrypt the database. In the case of <code>EncryptedSharedPreferences</code> the Android Keystore can be used to store the password. Other databases
can rely on <code>EncryptedSharedPreferences</code> to store passwords. The password can also be provided dynamically by the user of the application
or it can be fetched from a remote server if the other methods are not feasible.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://developer.android.com/reference/kotlin/android/database/sqlite/SQLiteDatabase">SQLiteDatabase</a>:</p>
<pre>
var db = activity.openOrCreateDatabase("test.db", Context.MODE_PRIVATE, null) // Sensitive
</pre>
<p>For <a href="https://developer.android.com/training/data-storage/shared-preferences">SharedPreferences</a>:</p>
<pre>
val pref = activity.getPreferences(Context.MODE_PRIVATE) // Sensitive
</pre>
<p>For <a href="https://docs.mongodb.com/realm/">Realm</a>:</p>
<pre>
val config = RealmConfiguration.Builder().build()
val realm = Realm.getInstance(config) // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Instead of SQLiteDatabase you can use <a href="https://www.zetetic.net/sqlcipher/sqlcipher-for-android/">SQLCipher</a>:</p>
<pre>
val db = SQLiteDatabase.openOrCreateDatabase("test.db", getKey(), null)
</pre>
<p>Instead of SharedPreferences you can use <a
href="https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences">EncryptedSharedPreferences</a>:</p>
<pre>
val masterKeyAlias = MasterKeys.getOrCreate(MasterKeys.AES256_GCM_SPEC)
EncryptedSharedPreferences.create(
    "secret",
    masterKeyAlias,
    context,
    EncryptedSharedPreferences.PrefKeyEncryptionScheme.AES256_SIV,
    EncryptedSharedPreferences.PrefValueEncryptionScheme.AES256_GCM
)
</pre>
<p>For Realm an encryption key can be specified in the config:</p>
<pre>
val config = RealmConfiguration.Builder()
    .encryptionKey(getKey())
    .build()
val realm = Realm.getInstance(config)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S6293"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S6293">
              kotlin:S6293
            </a>
          </td>
          <td >
            <details>
              <p>Android comes with Android KeyStore, a secure container for storing key materials. It’s possible to define certain keys to be unlocked when users
authenticate using biometric credentials. This way, even if the application process is compromised, the attacker cannot access keys, as presence of
the authorized user is required.</p>
<p>These keys can be used, to encrypt, sign or create a message authentication code (MAC) as proof that the authentication result has not been
tampered with. This protection defeats the scenario where an attacker with physical access to the device would try to hook into the application
process and call the <code>onAuthenticationSucceeded</code> method directly. Therefore he would be unable to extract the sensitive data or to perform
the critical operations protected by the biometric authentication.</p>
<h2>Ask Yourself Whether</h2>
<p>The application contains:</p>
<ul>
  <li> Cryptographic keys / sensitive information that need to be protected using biometric authentication. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to tie the biometric authentication to a cryptographic operation by using a <code>CryptoObject</code> during authentication.</p>
<h2>Noncompliant Code Example</h2>
<p>A <code>CryptoObject</code>is not used during authentication:</p>
<pre>
// ...
val biometricPrompt: BiometricPrompt = BiometricPrompt(activity, executor, callback)
// ...
biometricPrompt.authenticate(promptInfo) // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>A <code>CryptoObject</code> is used during authentication:</p>
<pre>
// ...
val biometricPrompt: BiometricPrompt = BiometricPrompt(activity, executor, callback)
// ...
biometricPrompt.authenticate(promptInfo, BiometricPrompt.CryptoObject(cipher)) // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.android.com/training/sign-in/biometric-auth">developer.android.com</a> - Use a cryptographic solution that depends
  on authentication </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication">OWASP Mobile Top 10 Category M4</a> - Insecure
  Authentication </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x09-v4-authentication_and_session_management_requirements">OWASP
  MASVS</a> - Authentication and Session Management Requirements </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/287">MITRE, CWE-287</a> - Improper Authentication </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="go:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=go:S1313">
              go:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
var (
  ip   = "192.168.12.42"
  port = 3333
)

SocketClient(ip, port)
</pre>
<h2>Compliant Solution</h2>
<pre>
config, err := ReadConfig("properties.ini")

ip := config["ip"]
port := config["ip"]

SocketClient(ip, port)
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="go:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=go:S2068">
              go:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
func connect()  {
  user := "root"
  password:= "supersecret" // Sensitive

  url := "login=" + user + "&amp;passwd=" + password
}
</pre>
<h2>Compliant Solution</h2>
<pre>
func connect()  {
  user := getEncryptedUser()
  password:= getEncryptedPass() // Compliant

  url := "login=" + user + "&amp;passwd=" + password
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="cloudformation:S6327"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6327">
              cloudformation:S6327
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)
communication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages
when they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to
access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The topic contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-topic.html">AWS::SNS::Topic</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Topic:  # Sensitive, encryption disabled by default
    Type: AWS::SNS::Topic
    Properties:
      DisplayName: "unencrypted_topic"
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sns-topic.html">AWS::SNS::Topic</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Topic:
    Type: AWS::SNS::Topic
    Properties:
      DisplayName: "encrypted_topic"
      KmsMasterKeyId:
        Fn::GetAtt:
          - TestKey
          - KeyId
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html">AWS Documentation</a> - Encryption at rest </li>
  <li> <a href="https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/">Encrypting messages published to
  Amazon SNS with AWS KMS</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6249"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6249">
              cloudformation:S6249
            </a>
          </td>
          <td >
            <details>
              <p>By default, S3 buckets can be accessed through HTTP and HTTPs protocols.</p>
<p>As HTTP is a clear-text protocol, it lack the encryption of transported data, as well as the capability to build an authenticated connection. It
means that a malicious actor who is able to intersept traffic from the network can read, modify or corrupt the transported content.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure has to comply with AWS Foundational Security Best Practices standard. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to deny all HTTP requests:</p>
<ul>
  <li> for all objects (<code>*</code>) of the bucket </li>
  <li> for all principals (<code>*</code>) </li>
  <li> for all actions (<code>*</code>) </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>No secure policy is attached to this S3 bucket:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Sensitive
</pre>
<p>A policy is defined but forces only HTTPs communication for some users:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Sensitive
    Properties:
      BucketName: "mynoncompliantbucket"

  S3BucketPolicy:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: !Ref S3Bucket
      PolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Deny
            Principal:
              AWS: # Sensitive: only one principal is forced to use https
                - 'arn:aws:iam::123456789123:root'
            Action: "*"
            Resource: arn:aws:s3:::mynoncompliantbuckets6249/*
            Condition:
              Bool:
                "aws:SecureTransport": false
</pre>
<h2>Compliant Solution</h2>
<p>A secure policy that denies the use of all HTTP requests:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Compliant
    Properties:
      BucketName: "mycompliantbucket"

  S3BucketPolicy:
    Type: 'AWS::S3::BucketPolicy'
    Properties:
      Bucket: "mycompliantbucket"
      PolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Deny
            Principal:
              AWS: "*" # all principals should use https
            Action: "*" # for any actions
            Resource: arn:aws:s3:::mycompliantbucket/* # for any resources
            Condition:
              Bool:
                "aws:SecureTransport": false
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit">AWS documentation</a> - Enforce encryption
  of data in transit </li>
  <li> <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5">AWS Foundational Security
  Best Practices controls</a> - S3 buckets should require requests to use Secure Socket Layer </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6304"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6304">
              cloudformation:S6304
            </a>
          </td>
          <td >
            <details>
              <p>A policy that allows identities to access all resources in an AWS account may violate <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity has permission to access
all resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive
information will occur.</p>
<h2>Ask Yourself Whether</h2>
<p>The AWS account has more than one resource with different levels of sensitivity.</p>
<p>A risk exists if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is
to organize or <a
href="https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/">tag</a>
resources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>
<h2>Noncompliant Code Example</h2>
<p>Update permission is granted for all policies using the wildcard (*) in the <code>Resource</code> property:</p>
<pre>
MyPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
        PolicyDocument:
            Version: "2012-10-17"
            Statement:
                - Effect: Allow
                Action:
                    - "iam:CreatePolicyVersion"
                Resource:
                    - "*" # Sensitive
        Roles:
            - !Ref MyRole
</pre>
<h2>Compliant Solution</h2>
<p>Restrict update permission to the appropriate subset of policies:</p>
<pre>
MyPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
        PolicyDocument:
            Version: "2012-10-17"
            Statement:
                - Effect: Allow
                Action:
                    - "iam:CreatePolicyVersion"
                Resource:
                    - !Sub "arn:aws:iam::${AWS::AccountId}:policy/team1/*"
        Roles:
            - !Ref MyRole
</pre>
<h2>Exceptions</h2>
<ul>
  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>
  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6329"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6329">
              cloudformation:S6329
            </a>
          </td>
          <td >
            <details>
              <p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft
or disruption.</p>
<p>Depending on the component, inbound access from the Internet can be enabled via:</p>
<ul>
  <li> a boolean value that explicitly allows access to the public network. </li>
  <li> the assignment of a public IP address. </li>
  <li> database firewall rules that allow public IP ranges. </li>
</ul>
<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>
<p>This decision increases the likelihood of attacks on the organization, such as:</p>
<ul>
  <li> data breaches. </li>
  <li> intrusions into the infrastructure to permanently steal from it. </li>
  <li> and various malicious traffic, such as DDoS attacks. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<p>This cloud resource:</p>
<ul>
  <li> should be publicly accessible to any Internet user. </li>
  <li> requires inbound traffic from the Internet to function properly. </li>
</ul>
<p>There is a risk if you answered no to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce
sites.</p>
<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud
components.</p>
<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the
absence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>
<h2>Noncompliant Code Example</h2>
<p>DMS and EC2 instances have a public IP address assigned to them:</p>
<pre>
DMSInstance:
    Type: AWS::DMS::ReplicationInstance
    Properties:
      PubliclyAccessible: true # sensitive, by default it's also set to true


EC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      NetworkInterfaces:
        - AssociatePublicIpAddress: true # sensitive, by default it's also set to true
          DeviceIndex: "0"
</pre>
<h2>Compliant Solution</h2>
<p>DMS and EC2 instances doesn’t have a public IP address:</p>
<pre>
DMSInstance:
    Type: AWS::DMS::ReplicationInstance
    Properties:
      PubliclyAccessible: false


EC2Instance:
    Type: AWS::EC2::Instance
    Properties:
      NetworkInterfaces:
        - AssociatePublicIpAddress: false
          DeviceIndex: "0"
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html">AWS Documentation</a> - Amazon EC2 instance IP
  addressing </li>
  <li> <a href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html">AWS Documentation</a> - Public and
  private replication instances </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html">AWS Documentation</a> - VPC Peering </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S5332">
              cloudformation:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://aws.amazon.com/kinesis/">AWS Kinesis</a> Data Streams, server-side encryption is disabled by default:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  KinesisStream: # Sensitive
    Type: AWS::Kinesis::Stream
    Properties:
      ShardCount: 1
      # No StreamEncryption
</pre>
<p>For <a href="https://aws.amazon.com/elasticache/">Amazon ElastiCache</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Example:
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupId: "example"
      TransitEncryptionEnabled: false  # Sensitive
</pre>
<p>For <a href="https://aws.amazon.com/ecs/">Amazon ECS</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  EcsTask:
    Type: AWS::ECS::TaskDefinition
    Properties:
      Family: "service"
      Volumes:
        -
          Name: "storage"
          EFSVolumeConfiguration:
            FilesystemId: !Ref FS
            TransitEncryption: "DISABLED"  # Sensitive
</pre>
<p>For <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Load Balancer Listeners</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  HTTPlistener:
   Type: "AWS::ElasticLoadBalancingV2::Listener"
   Properties:
     DefaultActions:
       - Type: "redirect"
         RedirectConfig:
           Protocol: "HTTP"
     Protocol: "HTTP" # Sensitive
</pre>
<p>For <a href="https://docs.aws.amazon.com/opensearch-service/index.html">Amazon OpenSearch domains</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Example:
    Type: AWS::OpenSearchService::Domain
    Properties:
      DomainName: example
      DomainEndpointOptions:
        EnforceHTTPS: false # Sensitive
      NodeToNodeEncryptionOptions:
        Enabled: false # Sensitive
</pre>
<p>For <a href="https://aws.amazon.com/msk/">Amazon MSK</a> communications between clients and brokers:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  MSKCluster:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: MSKCluster
      EncryptionInfo:
        EncryptionInTransit:
          ClientBroker: TLS_PLAINTEXT # Sensitive
          InCluster: false # Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://aws.amazon.com/kinesis/">AWS Kinesis</a> Data Streams server-side encryption:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  KinesisStream:
    Type: AWS::Kinesis::Stream
    Properties:
      ShardCount: 1
      StreamEncryption:
         EncryptionType: KMS
</pre>
<p>For <a href="https://aws.amazon.com/elasticache/">Amazon ElastiCache</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Example:
    Type: AWS::ElastiCache::ReplicationGroup
    Properties:
      ReplicationGroupId: "example"
      TransitEncryptionEnabled: true
</pre>
<p>For <a href="https://aws.amazon.com/ecs/">Amazon ECS</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  EcsTask:
    Type: AWS::ECS::TaskDefinition
    Properties:
      Family: "service"
      Volumes:
        -
          Name: "storage"
          EFSVolumeConfiguration:
            FilesystemId: !Ref FS
            TransitEncryption: "ENABLED"
</pre>
<p>For <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Load Balancer Listeners</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  HTTPlistener:
   Type: "AWS::ElasticLoadBalancingV2::Listener"
   Properties:
     DefaultActions:
       - Type: "redirect"
         RedirectConfig:
           Protocol: "HTTPS"
     Protocol: "HTTP"
</pre>
<p>For <a href="https://docs.aws.amazon.com/opensearch-service/index.html">Amazon OpenSearch domains</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Example:
    Type: AWS::OpenSearchService::Domain
    Properties:
      DomainName: example
      DomainEndpointOptions:
        EnforceHTTPS: true
      NodeToNodeEncryptionOptions:
        Enabled: true
</pre>
<p>For <a href="https://aws.amazon.com/msk/">Amazon MSK</a> communications between clients and brokers, data in transit is encrypted by default,
allowing you to omit writing the <code>EncryptionInTransit</code> configuration. However, if you need to configure it explicitly, this configuration
is compliant:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  MSKCluster:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: MSKCluster
      EncryptionInfo:
        EncryptionInTransit:
          ClientBroker: TLS
          InCluster: true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6245">
              cloudformation:S6245
            </a>
          </td>
          <td >
            <details>
              <p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is
read from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if
they were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure
itself.</p>
<p>There are three SSE options:</p>
<ul>
  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)
    <ul>
      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)
    <ul>
      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)
    <ul>
      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s
      encryption keys. </li>
    </ul>  </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>
<h2>Sensitive Code Example</h2>
<p>Server-side encryption is not used:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Server-side encryption with Amazon S3-Managed Keys is used:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Compliant
    Properties:
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html">AWS documentation</a> - Protecting data using
  server-side encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6303"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6303">
              cloudformation:S6303
            </a>
          </td>
          <td >
            <details>
              <p>Using unencrypted RDS DB resources exposes data to unauthorized access to the underlying storage.<br> This includes database data, logs, automatic
backups, read replicas, snapshots, and cluster metadata.</p>
<p>This situation can occur in a variety of scenarios, such as:</p>
<ul>
  <li> a malicious insider working at the cloud provider gains physical access to the storage device and exfiltrates data. </li>
  <li> unknown attackers penetrate the cloud provider’s logical infrastructure and systems for extortion. </li>
</ul>
<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is
required as encryption at rest is fully managed by AWS.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html">AWS::RDS::DBInstance</a> and
<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html">AWS::RDS::DBCluster</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  DatabaseInstance:
    Type: AWS::RDS::DBInstance
    Properties:
      StorageEncrypted: false  # Sensitive, disabled by default
  DatabaseCluster:
    Type: AWS::RDS:DBCluster:
    Properties:
      StorageEncrypted: false  # Sensitive, disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-rds-database-instance.html">AWS::RDS::DBInstance</a> and
<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-rds-dbcluster.html">AWS::RDS::DBCluster</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  DatabaseInstance:
    Type: AWS::RDS::DBInstance
    Properties:
      StorageEncrypted: true
  DatabaseCluster:
    Type: AWS::RDS:DBCluster:
    Properties:
      StorageEncrypted: false  # Sensitive, disabled by default
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html">AWS Documentation</a> - Encrypting Amazon RDS
  resources </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6302"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6302">
              cloudformation:S6302
            </a>
          </td>
          <td >
            <details>
              <p>A policy that grants all permissions may indicate an improper access control, which violates <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity is granted full
permissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources
may occur and therefore result in loss of information.</p>
<h2>Ask Yourself Whether</h2>
<p>Identities obtaining all the permissions:</p>
<ul>
  <li> only require a subset of these permissions to perform the intended function. </li>
  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start
with the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in
production, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>
<h2>Noncompliant Code Example</h2>
<p>A customer-managed policy that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>
<pre>
MyPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
        PolicyDocument:
            Version: "2012-10-17"
            Statement:
                - Effect: Allow
                Action:
                    - "*" # Sensitive
                Resource:
                    - !Ref MyResource
        Roles:
            - !Ref MyRole
</pre>
<h2>Compliant Solution</h2>
<p>A customer-managed policy that grants only the required permissions:</p>
<pre>
MyPolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
        PolicyDocument:
            Version: "2012-10-17"
            Statement:
                - Effect: Allow
                Action:
                    - "s3:GetObject"
                Resource:
                    - !Ref MyResource
        Roles:
            - !Ref MyRole
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cloud.google.com/iam/docs/understanding-roles">Google Cloud Documentation</a> - Understanding roles </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6308"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6308">
              cloudformation:S6308
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elasticsearch Service (ES) is a managed service to host Elasticsearch instances.</p>
<p>To harden domain (cluster) data in case of unauthorized access, ES provides data-at-rest encryption if the Elasticsearch version is 5.1 or above.
Enabling encryption at rest will help protect:</p>
<ul>
  <li> indices </li>
  <li> logs </li>
  <li> swap files </li>
  <li> data in the application directory </li>
  <li> automated snapshots </li>
</ul>
<p>Thus, if adversaries gain physical access to the storage medium, they cannot access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to encrypt Elasticsearch domains that contain sensitive information.</p>
<p>Encryption and decryption are handled transparently by ES, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html">AWS::Elasticsearch::Domain</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Elasticsearch:
    Type: AWS::Elasticsearch::Domain
    Properties:
      EncryptionAtRestOptions:
        Enabled: false  # Sensitive, disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-elasticsearch-domain.html">AWS::Elasticsearch::Domain</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Elasticsearch:
    Type: AWS::Elasticsearch::Domain
    Properties:
      EncryptionAtRestOptions:
        Enabled: true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html">AWS Documentation</a> - Encryption of
  data at rest for Amazon Elasticsearch Service </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="cloudformation:S6364"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6364">
              cloudformation:S6364
            </a>
          </td>
          <td >
            <details>
              <p>Reducing the backup retention duration can reduce an organization’s ability to re-establish service in case of a security incident.</p>
<p>Data backups allow to overcome corruption or unavailability of data by recovering as efficiently as possible from a security incident.</p>
<p>Backup retention duration, coverage, and backup locations are essential criteria regarding functional continuity.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This component is essential for the information system infrastructure. </li>
  <li> This component is essential for mission-critical functions. </li>
  <li> Compliance policies require this component to be backed up for a specific amount of time. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Increase the backup retention period to an amount of time sufficient enough to be able to restore service in case of an incident.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://aws.amazon.com/rds/">Amazon Relational Database Service</a> clusters and instances:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  relationaldatabase:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBName: NonCompliantDatabase
      BackupRetentionPeriod: 2 # Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://aws.amazon.com/rds/">Amazon Relational Database Service</a> clusters and instances:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  relationaldatabase:
    Type: 'AWS::RDS::DBInstance'
    Properties:
      DBName: CompliantDatabase
      BackupRetentionPeriod: 5
</pre>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6265"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6265">
              cloudformation:S6265
            </a>
          </td>
          <td >
            <details>
              <p>Predefined permissions, also known as <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">canned ACLs</a>,
are an easy way to grant large privileges to predefined groups or users.</p>
<p>The following canned ACLs are security-sensitive:</p>
<ul>
  <li> <code>PublicRead</code>, <code>PublicReadWrite</code> grant respectively "read" and "read and write" privileges to everyone in the world
  (<code>AllUsers</code> group). </li>
  <li> <code>AuthenticatedRead</code> grants "read" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege policy, ie to grant necessary permissions only to users for their required tasks. In the context
of canned ACL, set it to <code>private</code> (the default one) and if needed more granularity then use an appropriate S3 policy.</p>
<h2>Sensitive Code Example</h2>
<p>All users (ie: anyone in the world authenticated or not) have read and write permissions with the <code>PublicReadWrite</code> access control:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Sensitive
    Properties:
      BucketName: "mynoncompliantbucket"
      AccessControl: "PublicReadWrite"
</pre>
<h2>Compliant Solution</h2>
<p>With the <code>private</code> access control (default), only the bucket owner has the read/write permissions on the buckets and its ACL.</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Compliant
    Properties:
      BucketName: "mycompliantbucket"
      AccessControl: "Private"
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">AWS Documentation</a> - Access control list (ACL)
  overview (canned ACLs) </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html">AWS Documentation</a> - Controlling access to a bucket with
  user policies </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6281"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6281">
              cloudformation:S6281
            </a>
          </td>
          <td >
            <details>
              <p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>
<p>This access control can be relaxed with ACLs or policies.</p>
<p>To prevent permissive policies to be set on a S3 bucket the following settings can be configured:</p>
<ul>
  <li> <code>BlockPublicAcls</code>: to block or not public ACLs to be set to the S3 bucket. </li>
  <li> <code>IgnorePublicAcls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>
  <li> <code>BlockPublicPolicy</code>: to block or not public policies to be set to the S3 bucket. </li>
  <li> <code>RestrictPublicBuckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket
  owner account. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>
  <li> These settings are not already enforced to true at the account level. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to configure:</p>
<ul>
  <li> <code>BlockPublicAcls</code> to <code>true</code> to block new attempts to set public ACLs. </li>
  <li> <code>IgnorePublicAcls</code> to <code>true</code> to block existing public ACLs. </li>
  <li> <code>BlockPublicPolicy</code> to <code>true</code> to block new attempts to set public policies. </li>
  <li> <code>RestrictPublicBuckets</code> to <code>true</code> to restrict existing public policies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>By default, when not set, the <code>PublicAccessBlockConfiguration</code> is fully deactivated (nothing is blocked):</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucketdefault:
    Type: 'AWS::S3::Bucket' # Sensitive
    Properties:
      BucketName: "example"
</pre>
<p>This <code>PublicAccessBlockConfiguration</code> allows public ACL to be set:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Sensitive
    Properties:
      BucketName: "example"
      PublicAccessBlockConfiguration:
        BlockPublicAcls: false # should be true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
</pre>
<h2>Compliant Solution</h2>
<p>This <code>PublicAccessBlockConfiguration</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public
policies:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Compliant
    Properties:
      BucketName: "example"
      PublicAccessBlockConfiguration:
        BlockPublicAcls: true
        BlockPublicPolicy: true
        IgnorePublicAcls: true
        RestrictPublicBuckets: true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html">AWS Documentation</a> - Blocking public
  access to your Amazon S3 storage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6258"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6258">
              cloudformation:S6258
            </a>
          </td>
          <td >
            <details>
              <p>Disabling logging of this component can lead to missing traceability in case of a security incident.</p>
<p>Logging allows operational and security teams to get detailed and real-time feedback on an information system’s events. The logging coverage
enables them to quickly react to events, ranging from the most benign bugs to the most impactful security incidents, such as intrusions.</p>
<p>Apart from security detection, logging capabilities also directly influence future digital forensic analyses. For example, detailed logging will
allow investigators to establish a timeline of the actions perpetrated by an attacker.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This component is essential for the information system infrastructure. </li>
  <li> This component is essential for mission-critical functions. </li>
  <li> Compliance policies require this component to be monitored. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable the logging capabilities of this component. Depending on the component, new permissions might be required by the logging storage
components.<br> You should consult the official documentation to enable logging for the impacted components. For example, AWS Application Load
Balancer Access Logs <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html">require an additional
bucket policy</a>.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://aws.amazon.com/s3/">Amazon S3 access requests</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Sensitive
    Properties:
      BucketName: "mynoncompliantbucket"
</pre>
<p>For <a href="https://aws.amazon.com/api-gateway/">Amazon API Gateway</a> stages:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Prod: # Sensitive
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      TracingEnabled: false # Sensitive
</pre>
<p>For <a href="https://aws.amazon.com/neptune/">Amazon Neptune</a> clusters:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Cluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      EnableCloudwatchLogsExports: []  # Sensitive
</pre>
<p>For <a href="https://aws.amazon.com/msk/">Amazon MSK</a> broker logs:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  SensitiveCluster:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: Sensitive Cluster
      LoggingInfo:
        BrokerLogs: # Sensitive
          CloudWatchLogs:
            Enabled: false
            LogGroup: CWLG
          Firehose:
            DeliveryStream: DS
            Enabled: false
</pre>
<p>For <a href="https://aws.amazon.com/documentdb/">Amazon DocDB</a>:</p>
<pre>
AWSTemplateFormatVersion: "2010-09-09"
Resources:
  DocDBOmittingLogs: # Sensitive
    Type: "AWS::DocDB::DBCluster"
    Properties:
      DBClusterIdentifier : "DB Without Logs"
</pre>
<p>For <a href="https://aws.amazon.com/amazon-mq/">Amazon MQ</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Broker:
    Type: AWS::AmazonMQ::Broker
    Properties:
      Logs:  # Sensitive
        Audit: false
        General: false
</pre>
<p>For <a href="https://aws.amazon.com/redshift/">Amazon Redshift</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  ClusterOmittingLogging: # Sensitive
    Type: "AWS::Redshift::Cluster"
    Properties:
      DBName: "Redshift Warehouse Cluster"
</pre>
<p>For <a href="https://aws.amazon.com/opensearch-service/">Amazon OpenSearch</a> service or Amazon Elasticsearch service:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  OpenSearchServiceDomain:
    Type: 'AWS::OpenSearchService::Domain'
    Properties:
      LogPublishingOptions: # Sensitive
        ES_APPLICATION_LOGS:
          CloudWatchLogsLogGroupArn: 'arn:aws:logs:us-east-1:1234:log-group:es-application-logs'
          Enabled: true
        INDEX_SLOW_LOGS:
          CloudWatchLogsLogGroupArn: 'arn:aws:logs:us-east-1:1234:log-group:es-index-slow-logs'
          Enabled: true
</pre>
<p>For <a href="https://aws.amazon.com/cloudfront/">Amazon CloudFront</a> distributions:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
   cloudfrontdistribution: # Sensitive
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        DefaultRootObject: "index.html"
</pre>
<p>For <a href="https://aws.amazon.com/elasticloadbalancing/">Amazon Elastic Load Balancing</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  LoadBalancer:
      Type: AWS::ElasticLoadBalancing::LoadBalancer
      Properties:
        AccessLoggingPolicy:
          Enabled: false # Sensitive
</pre>
<p>For <a href="https://aws.amazon.com/elasticloadbalancing/">Amazon Load Balancing (v2)</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  ApplicationLoadBalancer:
   Type: AWS::ElasticLoadBalancingV2::LoadBalancer
   Properties:
     Name: CompliantLoadBalancer
     LoadBalancerAttributes:
       - Key: "access_logs.s3.enabled"
         Value: false # Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://aws.amazon.com/s3/">Amazon S3 access requests</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3BucketLogs:
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketName: "mycompliantloggingbucket"
      AccessControl: LogDeliveryWrite

  S3Bucket:
    Type: 'AWS::S3::Bucket'
    Properties:
      BucketName: "mycompliantbucket"
      LoggingConfiguration:
        DestinationBucketName: !Ref S3BucketLogs
        LogFilePrefix: testing-logs
</pre>
<p>For <a href="https://aws.amazon.com/api-gateway/">Amazon API Gateway</a> stages:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Prod:
    Type: AWS::ApiGateway::Stage
    Properties:
      StageName: Prod
      Description: Prod Stage
      TracingEnabled: true
      AccessLogSetting:
        DestinationArn: "arn:aws:logs:eu-west-1:123456789:test"
        Format: "..."
</pre>
<p>For <a href="https://aws.amazon.com/neptune/">Amazon Neptune</a> clusters:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Cluster:
    Type: AWS::Neptune::DBCluster
    Properties:
      EnableCloudwatchLogsExports: ["audit"]
</pre>
<p>For <a href="https://aws.amazon.com/msk/">Amazon MSK</a> broker logs:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  SensitiveCluster:
    Type: 'AWS::MSK::Cluster'
    Properties:
      ClusterName: Sensitive Cluster
      LoggingInfo:
        BrokerLogs:
          Firehose:
            DeliveryStream: DS
            Enabled: true
          S3:
            Bucket: Broker Logs
            Enabled: true
            Prefix: "logs/msk-brokers-"
</pre>
<p>For <a href="https://aws.amazon.com/documentdb/">Amazon DocDB</a>:</p>
<pre>
AWSTemplateFormatVersion: "2010-09-09"
Resources:
  DocDBWithLogs:
    Type: "AWS::DocDB::DBCluster"
    Properties:
      DBClusterIdentifier : "DB With Logs"
      EnableCloudwatchLogsExports:
         - audit
</pre>
<p>For <a href="https://aws.amazon.com/amazon-mq/">Amazon MQ</a> enable <code>Audit</code> or <code>General</code>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Broker:
    Type: AWS::AmazonMQ::Broker
    Properties:
      Logs:
        Audit: true
        General: true
</pre>
<p>For <a href="https://aws.amazon.com/redshift/">Amazon Redshift</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  CompliantCluster:
    Type: "AWS::Redshift::Cluster"
    Properties:
      DBName: "Redshift Warehouse Cluster"
      LoggingProperties:
        BucketName: "Infra Logs"
        S3KeyPrefix: "log/redshift-"
</pre>
<p>For <a href="https://aws.amazon.com/opensearch-service/">Amazon OpenSearch</a> service, or Amazon Elasticsearch service:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  OpenSearchServiceDomain:
    Type: 'AWS::OpenSearchService::Domain'
    Properties:
      LogPublishingOptions:
        AUDIT_LOGS:
          CloudWatchLogsLogGroupArn: 'arn:aws:logs:us-east-1:1234:log-group:es-audit-logs'
          Enabled: true
</pre>
<p>For <a href="https://aws.amazon.com/cloudfront/">Amazon CloudFront</a> distributions:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  cloudfrontdistribution:
    Type: AWS::CloudFront::Distribution
    Properties:
      DistributionConfig:
        DefaultRootObject: "index.html"
        Logging:
          Bucket: "mycompliantbucket"
          Prefix: "log/cloudfront-"
</pre>
<p>For <a href="https://aws.amazon.com/elasticloadbalancing/">Amazon Elastic Load Balancing</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  LoadBalancer:
      Type: AWS::ElasticLoadBalancing::LoadBalancer
      Properties:
        AccessLoggingPolicy:
          Enabled: true
          S3BucketName: mycompliantbucket
          S3BucketPrefix: "log/loadbalancer-"
</pre>
<p>For <a href="https://aws.amazon.com/elasticloadbalancing/">Amazon Load Balancing (v2)</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  ApplicationLoadBalancer:
   Type: AWS::ElasticLoadBalancingV2::LoadBalancer
   Properties:
     Name: CompliantLoadBalancer
     LoadBalancerAttributes:
       - Key: "access_logs.s3.enabled"
         Value: true
       - Key: "access_logs.s3.bucket"
         Value: "mycompliantbucket"
       - Key: "access_logs.s3.prefix"
         Value: "log/elbv2-"
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html">AWS Documentation</a> - Logging requests using server access
  logging </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/778">MITRE, CWE-778</a> - Insufficient Logging </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring">OWASP Top 10 2017 Category A10</a> -
  Insufficient Logging &amp; Monitoring </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="cloudformation:S6319"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6319">
              cloudformation:S6319
            </a>
          </td>
          <td >
            <details>
              <p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker
instances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries
physically access the storage media, they cannot decrypt encrypted data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The instance contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by
SageMaker, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-sagemaker-notebookinstance.html">AWS::SageMaker::NotebookInstance</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Notebook:  # Sensitive, encryption disabled by default
    Type: AWS::SageMaker::NotebookInstance
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-sagemaker-notebookinstance.html">AWS::SageMaker::NotebookInstance</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Notebook:
    Type: AWS::SageMaker::NotebookInstance
    Properties:
      KmsKeyId:
        Fn::GetAtt:
          - SomeKey
          - KeyId
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html">Protect Data at Rest Using Encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6333"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6333">
              cloudformation:S6333
            </a>
          </td>
          <td >
            <details>
              <p>A public API, which can be requested by any authenticated or unauthenticated identities, can lead to unauthorized actions and information
disclosures.</p>
<h2>Ask Yourself Whether</h2>
<p>The public API:</p>
<ul>
  <li> exposes sensitive data like personal information. </li>
  <li> can be used to perform sensitive operations. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict API access to authorized entities, unless the API offers a non-sensitive service designed to be public.</p>
<h2>Noncompliant Code Example</h2>
<p>A public API that doesn’t have access control implemented:</p>
<pre>
NoncompliantApiGatewayMethod:
    Type: AWS::ApiGateway::Method
    Properties:
      AuthorizationType: NONE # Sensitive
      HttpMethod: GET
</pre>
<p>A Serverless Application Model (SAM) API resource that is public by default:</p>
<pre>
OpenApiDefault: # Sensitive
    Type: AWS::Serverless::Api
    Properties:
      StageName: Prod
</pre>
<h2>Compliant Solution</h2>
<p>An API that implements AWS IAM permissions:</p>
<pre>
MyApiGatewayMethodIam:
    Type: AWS::ApiGateway::Method
    Properties:
      AuthorizationType: AWS_IAM
      HttpMethod: GET
</pre>
<p>A Serverless Application Model (SAM) API resource that has to be requested using a key:</p>
<pre>
ApiKeyApi:
    Type: AWS::Serverless::Api
    Properties:
      StageName: Prod
      Auth:
        ApiKeyRequired: true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html">AWS Documentation</a> -
  Controlling and managing access to a REST API in API Gateway </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6252"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6252">
              cloudformation:S6252
            </a>
          </td>
          <td >
            <details>
              <p>S3 buckets can be in three states related to versioning:</p>
<ul>
  <li> unversioned (default one) </li>
  <li> enabled </li>
  <li> suspended </li>
</ul>
<p>When the S3 bucket is unversioned or has versioning suspended it means that a new version of an object overwrites an existing one in the S3
bucket.</p>
<p>It can lead to unintentional or intentional information loss.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The bucket stores information that require high availability. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>
<h2>Sensitive Code Example</h2>
<p>Versioning is disabled by default:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Sensitive
    Properties:
      BucketName: "Example"
</pre>
<h2>Compliant Solution</h2>
<p>Versioning is enabled:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3Bucket:
    Type: 'AWS::S3::Bucket' # Compliant
    Properties:
      BucketName: "Example"
      VersioningConfiguration:
        Status: Enabled
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html">AWS documentation</a> - Using versioning in S3 buckets </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6275"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6275">
              cloudformation:S6275
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the
security of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access
to the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a
href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default">all new volumes and snapshots</a>. Volumes created
from snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The disk contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no
further modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption
globally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security
parameter will prevent any future unexpected security downgrade.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ebs-volume.html">AWS::EC2::Volume</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Ec2Volume:
    Type: AWS::EC2::Volume
    Properties:
      Encrypted: false  # Sensitive
</pre>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Ec2Volume:
    Type: AWS::EC2::Volume  # Sensitive as encryption is disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-ebs-volume.html">AWS::EC2::Volume</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Ec2Volume:
    Type: AWS::EC2::Volume
    Properties:
      Encrypted: true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html">Amazon EBS encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6330">
              cloudformation:S6330
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store
messages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message
from the file system, for example through a vulnerability in the service, they are not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The queue contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sqs-queues.html">AWS::SQS::Queue</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Queue:  # Sensitive, encryption disabled by default
    Type: AWS::SQS::Queue
    Properties:
      DisplayName: "unencrypted_queue"
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-sqs-queues.html">AWS::SQS::Queue</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Queue:
    Type: AWS::SQS::Queue
    Properties:
      DisplayName: "encrypted_queue"
      KmsMasterKeyId:
        Fn::GetAtt:
          - TestKey
          - KeyId
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html">AWS Documentation</a> -
  Encryption at rest </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6270"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6270">
              cloudformation:S6270
            </a>
          </td>
          <td >
            <details>
              <p>Resource-based policies granting access to all users can lead to information leakage.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The AWS resource stores or processes sensitive data. </li>
  <li> The AWS resource is designed to be private. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the
context of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>
<h2>Sensitive Code Example</h2>
<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3BucketPolicy:
    Type: 'AWS::S3::BucketPolicy' # Sensitive
    Properties:
      Bucket: !Ref S3Bucket
      PolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Principal:
              AWS: "*" # all principals / anonymous access
            Action: "s3:PutObject" # can put object
            Resource: arn:aws:s3:::mybucket/*
</pre>
<h2>Compliant Solution</h2>
<p>This policy allows only the authorized users:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  S3BucketPolicy:
    Type: 'AWS::S3::BucketPolicy' # Compliant
    Properties:
      Bucket: !Ref S3Bucket
      PolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Principal:
              AWS:
                - !Sub 'arn:aws:iam::${AWS::AccountId}:root' # only this principal
            Action: "s3:PutObject" # can put object
            Resource: arn:aws:s3:::mybucket/*
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="cloudformation:S6332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6332">
              cloudformation:S6332
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be
automatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are
not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The file system contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html">AWS::EFS::FileSystem</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Fs:  # Sensitive, encryption disabled by default
    Type: AWS::EFS::FileSystem
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-efs-filesystem.html">AWS::EFS::FileSystem</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  Fs:
    Type: AWS::EFS::FileSystem
    Properties:
      Encrypted: true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/efs/latest/ug/encryption.html">AWS Documentation</a> - Data encryption in Amazon EFS </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S2068">
              vbnet:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Dim username As String = "admin"
Dim password As String = "Password123" ' Sensitive
Dim usernamePassword As String = "user=admin&amp;password=Password123" ' Sensitive
Dim url As String = "scheme://user:Admin123@domain.com" ' Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
Dim username As String = "admin"
Dim password As String = GetEncryptedPassword()
Dim usernamePassword As String = String.Format("user={0}&amp;password={1}", GetEncryptedUsername(), GetEncryptedPassword())
Dim url As String = $"scheme://{username}:{password}@domain.com"

Dim url2 As String= "http://guest:guest@domain.com" ' Compliant
Const Password_Property As String = "custom.password" ' Compliant
</pre>
<h2>Exceptions</h2>
<ul>
  <li> Issue is not raised when URI username and password are the same. </li>
  <li> Issue is not raised when searched pattern is found in variable name and value. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S5693"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S5693">
              vbnet:S5693
            </a>
          </td>
          <td >
            <details>
              <p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in
order to prevents DoS attacks.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> size limits are not defined for the different resources of the web application. </li>
  <li> the web application is not protected by <a href="https://en.wikipedia.org/wiki/Rate_limiting">rate limiting</a> features. </li>
  <li> the web application infrastructure has limited resources. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> For most of the features of an application, it is recommended to limit the size of requests to:
    <ul>
      <li> lower or equal to 8mb for file uploads. </li>
      <li> lower or equal to 2mb for other requests. </li>
    </ul>  </li>
</ul>
<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>
<h2>Sensitive Code Example</h2>
<pre>
Imports Microsoft.AspNetCore.Mvc

Public Class MyController
    Inherits Controller

    &lt;HttpPost&gt;
    &lt;DisableRequestSizeLimit&gt; ' Sensitive: No size  limit
    &lt;RequestSizeLimit(10000000)&gt; ' Sensitive: 10MB is more than the recommended limit of 8MB
    Public Function PostRequest(Model model) As IActionResult
    ' ...
    End Function

    &lt;HttpPost&gt;
    &lt;RequestFormLimits(MultipartBodyLengthLimit = 8000000)&gt; ' Sensitive: 10MB is more than the recommended limit of 8MB
    Public Function MultipartFormRequest(Model model) As IActionResult
    ' ...
    End Function

End Class
</pre>
<h2>Compliant Solution</h2>
<pre>
Imports Microsoft.AspNetCore.Mvc

Public Class MyController
    Inherits Controller

    &lt;HttpPost&gt;
    &lt;RequestSizeLimit(8000000)&gt; ' Compliant: 8MB
    Public Function PostRequest(Model model) As IActionResult
    ' ...
    End Function

    &lt;HttpPost&gt;
    &lt;RequestFormLimits(MultipartBodyLengthLimit = 8000000)&gt; ' Compliant: 8MB
    Public Function MultipartFormRequest(Model model) AS IActionResult
    ' ...
    End Function

End Class
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html">Owasp Cheat Sheet</a> - Owasp Denial of Service
  Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/770">MITRE, CWE-770</a> - Allocation of Resources Without Limits or Throttling </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S2077"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S2077">
              vbnet:S2077
            </a>
          </td>
          <td >
            <details>
              <p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the
query. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=vbnet%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted queries.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some parts of the query come from untrusted values (like user inputs). </li>
  <li> The query is repeated/duplicated in other parts of the code. </li>
  <li> The application must support different types of relational databases. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">parameterized queries, prepared
  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>
  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Public Sub SqlCommands(ByVal connection As SqlConnection, ByVal query As String, ByVal param As String)
    Dim sensitiveQuery As String = String.Concat(query, param)
    command = New SqlCommand(sensitiveQuery) ' Sensitive

    command.CommandText = sensitiveQuery ' Sensitive

    Dim adapter As SqlDataAdapter
    adapter = New SqlDataAdapter(sensitiveQuery, connection) ' Sensitive
End Sub

Public Sub Foo(ByVal context As DbContext, ByVal query As String, ByVal param As String)
    Dim sensitiveQuery As String = String.Concat(query, param)
    context.Database.ExecuteSqlCommand(sensitiveQuery) ' Sensitive

    context.Query(Of User)().FromSql(sensitiveQuery) ' Sensitive
End Sub
</pre>
<h2>Compliant Solution</h2>
<pre>
Public Sub Foo(ByVal context As DbContext, ByVal value As String)
    context.Database.ExecuteSqlCommand("SELECT * FROM mytable WHERE mycol=@p0", value) ' Compliant, the query is parameterized
End Sub
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/89">MITRE, CWE-89</a> - Improper Neutralization of Special Elements used in an SQL Command
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rules <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA">Potential SQL/JPQL Injection
  (JPA)</a>, <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO">Potential SQL/JDOQL Injection (JDO)</a>, <a
  href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE">Potential SQL/HQL Injection (Hibernate)</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4818"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4818">
              vbnet:S4818
            </a>
          </td>
          <td >
            <details>
              <p>Using sockets is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1785">CVE-2011-178</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5645">CVE-2017-5645</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6597">CVE-2018-6597</a> </li>
</ul>
<p>Sockets are vulnerable in multiple ways:</p>
<ul>
  <li> They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive
  sensitive information or inject dangerous input. </li>
  <li> The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. </li>
</ul>
<p>This rules flags code that creates sockets. It matches only the direct use of sockets, not use through frameworks or high-level APIs such as the
use of http connections.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sockets are created without any limit every time a user performs an action. </li>
  <li> input received from sockets is used without being sanitized. </li>
  <li> sensitive data is sent via sockets without being encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols. </li>
  <li> Encrypt all data sent if it is sensitive. Usually it is better to encrypt it even if the data is not sensitive as it might change later. </li>
  <li> <a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> any input read from the socket. </li>
  <li> Limit the number of sockets a given user can create. Close the sockets as soon as possible. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Imports System.Net.Sockets

Public Class Sockets

    Public Shared Sub Run()
        ' Sensitive
        Dim socket As Socket = New Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp)

        ' TcpClient And UdpClient simply abstract the details of creating a Socket
        Dim client As TcpClient = New TcpClient("example.com", 80) ' Sensitive
        Dim listener As UdpClient = New UdpClient(80)   ' Sensitive
    End Sub

End Class
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption ('Resource Exhaustion') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4507">
              vbnet:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> the application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers.</p>
<p>The .Net Core framework offers multiple features which help during debug.
<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDeveloperExceptionPage</code> and
<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDatabaseErrorPage</code> are two of them. Make sure that those features are disabled in
production.</p>
<p>Use <code>If env.IsDevelopment()</code> to disable debug code.</p>
<h2>Sensitive Code Example</h2>
<p>This rule raises issues when the following .Net Core methods are called:
<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDeveloperExceptionPage</code>,
<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDatabaseErrorPage</code>.</p>
<pre>
Imports Microsoft.AspNetCore.Builder
Imports Microsoft.AspNetCore.Hosting

Namespace MyMvcApp
    Public Class Startup
        Public Sub Configure(ByVal app As IApplicationBuilder, ByVal env As IHostingEnvironment)
            ' Those calls are Sensitive because it seems that they will run in production
            app.UseDeveloperExceptionPage() 'Sensitive
            app.UseDatabaseErrorPage() 'Sensitive
        End Sub
    End Class
End Namespace
</pre>
<h2>Compliant Solution</h2>
<pre>
Imports Microsoft.AspNetCore.Builder
Imports Microsoft.AspNetCore.Hosting

Namespace MyMvcApp
    Public Class Startup
        Public Sub Configure(ByVal app As IApplicationBuilder, ByVal env As IHostingEnvironment)
            If env.IsDevelopment() Then ' Compliant
                ' The following calls are ok because they are disabled in production
                app.UseDeveloperExceptionPage()
                app.UseDatabaseErrorPage()
            End If
        End Sub
    End Class
End Namespace
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S5443"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S5443">
              vbnet:S5443
            </a>
          </td>
          <td >
            <details>
              <p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like
<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious
user can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,
modified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2012-2451">CVE-2012-2451</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2015-1838">CVE-2015-1838</a> </li>
</ul>
<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It
also detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code>, <code>TMPDIR</code> and
<code>TEMP</code>.</p>
<ul>
  <li> <code>/tmp</code> </li>
  <li> <code>/var/tmp</code> </li>
  <li> <code>/usr/tmp</code> </li>
  <li> <code>/dev/shm</code> </li>
  <li> <code>/dev/mqueue</code> </li>
  <li> <code>/run/lock</code> </li>
  <li> <code>/var/run/lock</code> </li>
  <li> <code>/Library/Caches</code> </li>
  <li> <code>/Users/Shared</code> </li>
  <li> <code>/private/tmp</code> </li>
  <li> <code>/private/var/tmp</code> </li>
  <li> <code>\Windows\Temp</code> </li>
  <li> <code>\Temp</code> </li>
  <li> <code>\TMP</code> </li>
  <li> <code>%USERPROFILE%\AppData\Local\Temp</code> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Files are read from or written into a publicly writable folder </li>
  <li> The application creates files with predictable names into a publicly writable folder </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Out of the box, .NET is missing secure-by-design APIs to create temporary files. To overcome this, one of the following options can be used:</p>
<ul>
  <li> Use a dedicated sub-folder with tightly controlled permissions </li>
  <li> Created temporary files in a publicly writable folder and make sure:
    <ul>
      <li> Generated filename is unpredictable </li>
      <li> File is readable and writable only by the creating user ID </li>
      <li> File descriptor is not inherited by child processes </li>
      <li> File is destroyed as soon as it is closed </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Using Writer As New StreamWriter("/tmp/f") ' Sensitive
' ...
End Using
</pre>
<pre>
Dim Tmp As String = Environment.GetEnvironmentVariable("TMP") ' Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
Dim RandomPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName())

' Creates a new file with write, non inheritable permissions which is deleted on close.
Using FileStream As New FileStream(RandomPath, FileMode.CreateNew, FileAccess.Write, FileShare.None, 4096, FileOptions.DeleteOnClose)
    Using Writer As New StreamWriter(FileStream) ' Sensitive
    ' ...
    End Using
End Using
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="vbnet:S2612"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S2612">
              vbnet:S2612
            </a>
          </td>
          <td >
            <details>
              <p>In Unix, "others" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>
<p>In Windows, "Everyone" group is similar and includes all members of the Authenticated Users group as well as the built-in Guest account, and
several other built-in security accounts.</p>
<p>Granting permissions to these groups can lead to unintended access to files.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application is designed to be run on a multi-user environment. </li>
  <li> Corresponding files and directories may contain confidential information. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
<h2>Sensitive Code Example</h2>
<p>.Net Framework:</p>
<pre>
Dim unsafeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Allow)

Dim fileSecurity = File.GetAccessControl("path")
fileSecurity.AddAccessRule(unsafeAccessRule) ' Sensitive
fileSecurity.SetAccessRule(unsafeAccessRule) ' Sensitive
File.SetAccessControl("fileName", fileSecurity)
</pre>
<p>.Net / .Net Core</p>
<pre>
Dim fileInfo = new FileInfo("path")
Dim fileSecurity = fileInfo.GetAccessControl()

fileSecurity.AddAccessRule(new FileSystemAccessRule("Everyone", FileSystemRights.Write, AccessControlType.Allow)) ' Sensitive
fileInfo.SetAccessControl(fileSecurity)
</pre>
<p>.Net / .Net Core using Mono.Posix.NETStandard</p>
<pre>
Dim fileSystemEntry = UnixFileSystemInfo.GetFileSystemEntry("path")
fileSystemEntry.FileAccessPermissions = FileAccessPermissions.OtherReadWriteExecute ' Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>.Net Framework</p>
<pre>
Dim safeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Deny)

Dim fileSecurity = File.GetAccessControl("path")
fileSecurity.AddAccessRule(safeAccessRule)
File.SetAccessControl("path", fileSecurity)
</pre>
<p>.Net / .Net Core</p>
<pre>
Dim safeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Deny)

Dim fileInfo = new FileInfo("path")
Dim fileSecurity = fileInfo.GetAccessControl()
fileSecurity.SetAccessRule(safeAccessRule)
fileInfo.SetAccessControl(fileSecurity)
</pre>
<p>.Net / .Net Core using Mono.Posix.NETStandard</p>
<pre>
Dim fs = UnixFileSystemInfo.GetFileSystemEntry("path")
fs.FileAccessPermissions = FileAccessPermissions.UserExecute
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission">OWASP File Permission</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S5042"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S5042">
              vbnet:S5042
            </a>
          </td>
          <td >
            <details>
              <p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can
lead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of
uncompressed data. To achieve this extreme <a href="https://en.wikipedia.org/wiki/Data_compression_ratio">compression ratio</a>, attackers will
compress irrelevant data (eg: a long string of repeated bytes).</p>
<h2>Ask Yourself Whether</h2>
<p>Archives to expand are untrusted and:</p>
<ul>
  <li> There is no validation of the number of entries in the archive. </li>
  <li> There is no validation of the total size of the uncompressed data. </li>
  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is
  1 to 3. </li>
  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>
  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in
  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
For Each entry As ZipArchiveEntry in archive.Entries
    ' entry.FullName could contain parent directory references ".." and the destinationPath variable could become outside of the desired path
    string destinationPath = Path.GetFullPath(Path.Combine(path, entry.FullName))
    entry.ExtractToFile(destinationPath) ' Sensitive, extracts the entry to a file

    Dim stream As Stream
    stream = entry.Open() ' Sensitive, the entry is about to be extracted
Next
</pre>
<h2>Compliant Solution</h2>
<pre>
Const ThresholdRatio As Double = 10
Const ThresholdSize As Integer = 1024 * 1024 * 1024 ' 1 GB
Const ThresholdEntries As Integer = 10000
Dim TotalSizeArchive, TotalEntryArchive, TotalEntrySize, Cnt As Integer
Dim Buffer(1023) As Byte
Using ZipToOpen As New FileStream("ZipBomb.zip", FileMode.Open), Archive As New ZipArchive(ZipToOpen, ZipArchiveMode.Read)
    For Each Entry As ZipArchiveEntry In Archive.Entries
        Using s As Stream = Entry.Open
            TotalEntryArchive += 1
            TotalEntrySize = 0
            Do
                Cnt = s.Read(Buffer, 0, Buffer.Length)
                TotalEntrySize += Cnt
                TotalSizeArchive += Cnt
                If TotalEntrySize / Entry.CompressedLength &gt; ThresholdRatio Then Exit Do    ' Ratio between compressed And uncompressed data Is highly suspicious, looks Like a Zip Bomb Attack
            Loop While Cnt &gt; 0
        End Using
        If TotalSizeArchive &gt; ThresholdSize Then Exit For       ' The uncompressed data size Is too much for the application resource capacity
        If TotalEntryArchive &gt; ThresholdEntries Then Exit For   ' Too much entries in this archive, can lead to inodes exhaustion of the system
    Next
End Using
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/409">MITRE, CWE-409</a> - Improper Handling of Highly Compressed Data (Data Amplification)
  </li>
  <li> <a href="https://www.bamsoftware.com/hacks/zipbomb/">bamsoftware.com</a> - A better Zip Bomb </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="vbnet:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S1313">
              vbnet:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
Dim ip = "192.168.12.42" ' Sensitive
Dim address = IPAddress.Parse(ip)
</pre>
<h2>Compliant Solution</h2>
<pre>
Dim ip = ConfigurationManager.AppSettings("myapplication.ip") ' Compliant
Dim address = IPAddress.Parse(ip)
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4787"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4787">
              vbnet:S4787
            </a>
          </td>
          <td >
            <details>
              <p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902">CVE-2017-7902</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378">CVE-2006-1378</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376">CVE-2003-1376</a> </li>
</ul>
<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed
regularly. However these are not the only means to defeat or weaken an encryption.</p>
<p>This rule flags function calls that initiate encryption/decryption.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>
  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>
  <li> the key exchange is made without properly authenticating the receiver. </li>
  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time
  passes. </li>
  <li> the chosen encryption library is deemed unsafe. </li>
  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>
  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.
  </li>
  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random
  algorithm, or it is reused. </li>
  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.
  </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Generate encryption keys using secure random algorithms. </li>
  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force
  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.
  </li>
  <li> Regenerate the keys regularly. </li>
  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>
  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>
  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are
  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most
  probably have flaws. </li>
  <li> When a nonce is used, generate it randomly every time. </li>
  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>
  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks
  like "Chosen-Plaintext Attacks". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption
  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>
  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be
  preferred to the following combinations which are not secured:
    <ul>
      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it
      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in
      cryptographic protocols at all. </li>
      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Imports System
Imports System.Security.Cryptography

Namespace MyNamespace

    Public Class Class1

        Public Sub Main()

            Dim data As Byte() = {1, 1, 1}

            Dim myRSA As RSA = RSA.Create()
            Dim padding As RSAEncryptionPadding = RSAEncryptionPadding.CreateOaep(HashAlgorithmName.SHA1)

            ' Review all base RSA class' Encrypt/Decrypt calls
            myRSA.Encrypt(data, padding)  ' Sensitive
            myRSA.EncryptValue(data)      ' Sensitive
            myRSA.Decrypt(data, padding)  ' Sensitive
            myRSA.DecryptValue(data)      ' Sensitive

            Dim myRSAC As RSACryptoServiceProvider = New RSACryptoServiceProvider()
            ' Review the use of any TryEncrypt/TryDecrypt And specific Encrypt/Decrypt of RSA subclasses.
            myRSAC.Encrypt(data, False)    ' Sensitive
            myRSAC.Decrypt(data, False)    ' Sensitive

            Dim written As Integer
            myRSAC.TryEncrypt(data, Span&lt;byte&gt;.Empty, padding, out written) ' Sensitive
            myRSAC.TryDecrypt(data, Span&lt;byte&gt;.Empty, padding, out written) ' Sensitive

            Dim rgbKey As Byte() = {1, 2, 3}
            Dim rgbIV As Byte() = {4, 5, 6}
            Dim rijn = SymmetricAlgorithm.Create()

            ' Review the creation of Encryptors from any SymmetricAlgorithm instance.
            rijn.CreateEncryptor()   ' Sensitive
            rijn.CreateEncryptor(rgbKey, rgbIV)  ' Sensitive
            rijn.CreateDecryptor()  ' Sensitive
            rijn.CreateDecryptor(rgbKey, rgbIV)  ' Sensitive
        End Sub

        Public Class MyCrypto
            Inherits System.Security.Cryptography.AsymmetricAlgorithm ' Sensitive
            ' ...
        End Class

        Public Class MyCrypto2
            Inherits System.Security.Cryptography.SymmetricAlgorithm ' Sensitive
            ' ...
        End Class
    End Class
End Namespace
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/321">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/322">MITRE, CWE-322</a> - Key Exchange without Entity Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/323">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/324">MITRE, CWE-324</a> - Use of a Key Past its Expiration Date </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/325">MITRE, CWE-325</a> - Missing Required Cryptographic Step </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=vbnet%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=vbnet%3AS5547'>S5547</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="vbnet:S6444"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S6444">
              vbnet:S6444
            </a>
          </td>
          <td >
            <details>
              <p>Not specifying a timeout for regular expressions can lead to a Denial-of-Service attack. Pass a timeout when using
<code>System.Text.RegularExpressions</code> to process untrusted input because a malicious user might craft a value for which the evaluation lasts
excessively long.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the input passed to the regular expression is untrusted. </li>
  <li> the regular expression contains patterns vulnerable to <a href="https://www.regular-expressions.info/catastrophic.html">catastrophic
  backtracking</a>. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> It is recommended to specify a <a
  href="https://learn.microsoft.com/dotnet/standard/base-types/best-practices#use-time-out-values"><code>matchTimeout</code></a> when executing a
  regular expression. </li>
  <li> Make sure regular expressions are not vulnerable to Denial-of-Service attacks by reviewing the patterns. </li>
  <li> Consider using a non-backtracking algorithm by specifying <a
  href="https://learn.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions?view=net-7.0"><code>RegexOptions.NonBacktracking</code></a>. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Public Sub RegexPattern(Input As String)
    Dim EmailPattern As New Regex(".+@.+", RegexOptions.None)
    Dim IsNumber as Boolean = Regex.IsMatch(Input, "[0-9]+")
    Dim IsLetterA as Boolean = Regex.IsMatch(Input, "(a+)+")
End Sub
</pre>
<h2>Compliant Solution</h2>
<pre>
Public Sub RegexPattern(Input As String)
    Dim EmailPattern As New Regex(".+@.+", RegexOptions.None, TimeSpan.FromMilliseconds(100))
    Dim IsNumber as Boolean = Regex.IsMatch(Input, "[0-9]+", RegexOptions.None, TimeSpan.FromMilliseconds(100))
    Dim IsLetterA As Boolean = Regex.IsMatch(Input, "(a+)+", RegexOptions.NonBacktracking) '.Net 7 And above
    AppDomain.CurrentDomain.SetData("REGEX_DEFAULT_MATCH_TIMEOUT", TimeSpan.FromMilliseconds(100)) 'process-wide setting
End Sub
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1333">MITRE, CWE-1333</a> - Inefficient Regular Expression Complexity </li>
  <li> <a href="https://www.regular-expressions.info/catastrophic.html">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic
  Backtracking </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">owasp.org</a> - Regular expression Denial of
  Service - ReDoS </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1333">MITRE, CWE-1333</a> - Inefficient Regular Expression Complexity </li>
  <li> <a href="https://docs.microsoft.com/dotnet/standard/base-types/best-practices">docs.microsoft.com</a> - Best practices for regular expressions
  in .NET </li>
  <li> <a href="https://docs.microsoft.com/dotnet/standard/base-types/backtracking-in-regular-expressions">docs.microsoft.com</a> - Backtracking in
  Regular Expressions </li>
  <li> <a
  href="https://devblogs.microsoft.com/dotnet/regular-expression-improvements-in-dotnet-7/#backtracking-and-regexoptions-nonbacktracking">devblogs.microsoft.com</a> - Regular Expression Improvements in .NET 7: Backtracking (and RegexOptions.NonBacktracking) </li>
  <li> <a href="https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regex.matchtimeout">docs.microsoft.com</a> - Regex.MatchTimeout
  Property </li>
  <li> <a href="https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions?view=net-7.0">docs.microsoft.com</a> - RegexOptions
  Enum (NonBacktracking option) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4784"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4784">
              vbnet:S4784
            </a>
          </td>
          <td >
            <details>
              <p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021">CVE-2017-16021</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863">CVE-2018-13863</a> </li>
</ul>
<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as
<code>(a+)+s</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with
every additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular
expression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>
<p>Evaluating such regular expressions opens the door to <a
href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">Regular expression Denial of Service (ReDoS)</a> attacks.
In the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making
the service inaccessible to genuine users.</p>
<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and at least two instances of any of the following
characters: <code>*+{</code>.</p>
<p>Example: <code>(a+)*</code></p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>
  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for
vulnerability reports mentioning the one engine you’re are using.</p>
<p>If the regular expression is vulnerable to ReDos attacks, mitigate the risk by using a "match timeout" to limit the time spent running the regular
expression.</p>
<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>
<h2>Sensitive Code Example</h2>
<pre>
Imports System
Imports System.Collections.Generic
Imports System.Linq
Imports System.Runtime.Serialization
Imports System.Text.RegularExpressions
Imports System.Web

Namespace N
    Public Class RegularExpression
        Private Sub Foo(ByVal pattern As String, ByVal options As RegexOptions, ByVal matchTimeout As TimeSpan,
                        ByVal input As String, ByVal replacement As String, ByVal evaluator As MatchEvaluator)
            ' All the following instantiations are Sensitive. Validate the regular expression and matched input.
            Dim r As Regex = New System.Text.RegularExpressions.Regex("(a+)+b")
            r = New System.Text.RegularExpressions.Regex("(a+)+b", options)
            r = New System.Text.RegularExpressions.Regex("(a+)+b", options, matchTimeout)

            ' All the following static methods are Sensitive.
            System.Text.RegularExpressions.Regex.IsMatch(input, "(a+)+b")
            System.Text.RegularExpressions.Regex.IsMatch(input, "(a+)+b", options)
            System.Text.RegularExpressions.Regex.IsMatch(input, "(a+)+b", options, matchTimeout)

            System.Text.RegularExpressions.Regex.Match(input, "(a+)+b")
            System.Text.RegularExpressions.Regex.Match(input, "(a+)+b", options)
            System.Text.RegularExpressions.Regex.Match(input, "(a+)+b", options, matchTimeout)

            System.Text.RegularExpressions.Regex.Matches(input, "(a+)+b")
            System.Text.RegularExpressions.Regex.Matches(input, "(a+)+b", options)
            System.Text.RegularExpressions.Regex.Matches(input, "(a+)+b", options, matchTimeout)

            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+b", evaluator)
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+b", evaluator, options)
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+b", evaluator, options, matchTimeout)
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+b", replacement)
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+b", replacement, options)
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+b", replacement, options, matchTimeout)

            System.Text.RegularExpressions.Regex.Split(input, "(a+)+b")
            System.Text.RegularExpressions.Regex.Split(input, "(a+)+b", options)
            System.Text.RegularExpressions.Regex.Split(input, "(a+)+b", options, matchTimeout)
        End Sub
    End Class
End Namespace
</pre>
<h2>Exceptions</h2>
<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,
<code>(a|a?)+</code>.</p>
<p>It is a good idea to test your regular expression if it has the same pattern on both side of a "<code>|</code>".</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">MITRE, CWE-624</a> - Executable Regular
  Expression Error </li>
  <li> OWASP Regular expression Denial of Service - ReDoS </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4829"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4829">
              vbnet:S4829
            </a>
          </td>
          <td >
            <details>
              <p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337">CVE-2005-2337</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449">CVE-2017-11449</a> </li>
</ul>
<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)
can be dangerous and should be validated.</p>
<p>This rule flags code that reads from the standard input.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> data read from the standard input is not sanitized before being used. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all data read from the standard input before using it.</p>
<h2>Sensitive Code Example</h2>
<pre>
Imports System
Public Class C
    Public Sub Main()
        Dim x = Console.[In] ' Sensitive
        Console.Read() ' Sensitive
        Console.ReadKey() ' Sensitive
        Console.ReadLine() ' Sensitive
        Console.OpenStandardInput() ' Sensitive
    End Sub
End Class
</pre>
<h2>Exceptions</h2>
<p>This rule does not raise issues when the return value of the <code>Console.Read</code> <code>Console.ReadKey</code> or
<code>Console.ReadLine</code> methods is ignored.</p>
<pre>
Imports System

Public Class C
    Public Sub Main()
        Console.ReadKey() ' Return value is ignored
        Console.ReadLine() ' Return value is ignored
    End Sub
End Class
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S5753"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S5753">
              vbnet:S5753
            </a>
          </td>
          <td >
            <details>
              <p>ASP.NET 1.1+ comes with a feature called <em>Request Validation</em>, preventing the server to accept content containing un-encoded HTML. This
feature comes as a first protection layer against Cross-Site Scripting (XSS) attacks and act as a simple Web Application Firewall (WAF) rejecting
requests potentially containing malicious content.</p>
<p>While this feature is not a silver bullet to prevent all XSS attacks, it helps to catch basic ones. It will for example prevent <code>&lt;script
type="text/javascript" src="https://malicious.domain/payload.js"&gt;</code> to reach your Controller.</p>
<p>Note: <em>Request Validation</em> feature being only available for ASP.NET, no Security Hotspot is raised on ASP.NET Core applications.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the developer doesn’t know the impact to deactivate the Request Validation feature </li>
  <li> the web application accepts user-supplied data </li>
  <li> all user-supplied data are not validated </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Activate the Request Validation feature for all HTTP requests </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>At Controller level:</p>
<pre>
&lt;ValidateInput(False)&gt;
Public Function Welcome(Name As String) As ActionResult
  ...
End Function
</pre>
<p>At application level, configured in the Web.config file:</p>
<pre>
&lt;configuration&gt;
   &lt;system.web&gt;
      &lt;pages validateRequest="false" /&gt;
      ...
      &lt;httpRuntime requestValidationMode="0.0" /&gt;
   &lt;/system.web&gt;
&lt;/configuration&gt;
</pre>
<h2>Compliant Solution</h2>
<p>At Controller level:</p>
<pre>
&lt;ValidateInput(True)&gt;
Public Function Welcome(Name As String) As ActionResult
  ...
End Function
</pre>
<p>or</p>
<pre>
Public Function Welcome(Name As String) As ActionResult
  ...
End Function
</pre>
<p>At application level, configured in the Web.config file:</p>
<pre>
&lt;configuration&gt;
   &lt;system.web&gt;
      &lt;pages validateRequest="true" /&gt;
      ...
      &lt;httpRuntime requestValidationMode="4.5" /&gt;
   &lt;/system.web&gt;
&lt;/configuration&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a
  href="https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.httpruntimesection.requestvalidationmode?view=netframework-4.8">HttpRuntimeSection.RequestValidationMode Property</a> </li>
  <li> <a href="https://owasp.org/www-community/ASP-NET_Request_Validation">OWASP ASP.NET Request Validation</a> </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet</a> - XSS
  Prevention Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4823"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4823">
              vbnet:S4823
            </a>
          </td>
          <td >
            <details>
              <p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281">CVE-2018-7281</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326">CVE-2018-12326</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198">CVE-2011-3198</a> </li>
</ul>
<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>
<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus
passing sensitive information via command line arguments should be considered as insecure.</p>
<p>This rule raises an issue when on every program entry points (<code>main</code> methods) when command line arguments are used. The goal is to guide
security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> any of the command line arguments are used without being sanitized first. </li>
  <li> your application accepts sensitive information via command line arguments. </li>
</ul>
<p>If you answered yes to any of these questions you are at risk.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all command line arguments before using them.</p>
<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing
sensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the
path to a file containing the information.</p>
<h2>Sensitive Code Example</h2>
<pre>
Module Program
    Sub Main(args As String()) ' Sensitive as there is a reference to "args" in the procedure.
        Console.WriteLine(args(0))
    End Sub
End Module
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/88">MITRE, CWE-88</a> - Argument Injection or Modification </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/214">MITRE, CWE-214</a> - Information Exposure Through Process Environment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="vbnet:S2257"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S2257">
              vbnet:S2257
            </a>
          </td>
          <td >
            <details>
              <p>The use of a non-standard algorithm is dangerous because a determined attacker may be able to break the algorithm and compromise whatever data has
been protected. Standard algorithms like <code>AES</code>, <code>RSA</code>, <code>SHA</code>, …​ should be used instead.</p>
<p>This rule tracks custom implementation of these types from <code>System.Security.Cryptography</code> namespace:</p>
<ul>
  <li> <code>AsymmetricAlgorithm</code> </li>
  <li> <code>AsymmetricKeyExchangeDeformatter</code> </li>
  <li> <code>AsymmetricKeyExchangeFormatter</code> </li>
  <li> <code>AsymmetricSignatureDeformatter</code> </li>
  <li> <code>AsymmetricSignatureFormatter</code> </li>
  <li> <code>DeriveBytes</code> </li>
  <li> <code>HashAlgorithm</code> </li>
  <li> <code>ICryptoTransform</code> </li>
  <li> <code>SymmetricAlgorithm</code> </li>
</ul>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a standard algorithm instead of creating a custom one. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Public Class CustomHash     ' Noncompliant
    Inherits HashAlgorithm

    Private fResult() As Byte

    Public Overrides Sub Initialize()
        fResult = Nothing
    End Sub

    Protected Overrides Function HashFinal() As Byte()
        Return fResult
    End Function

    Protected Overrides Sub HashCore(array() As Byte, ibStart As Integer, cbSize As Integer)
        fResult = If(fResult, array.Take(8).ToArray)
    End Sub

End Class
</pre>
<h2>Compliant Solution</h2>
<pre>
Dim mySHA256 As SHA256 = SHA256.Create()
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#CUSTOM_MESSAGE_DIGEST">MessageDigest is Custom</a>
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4036"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4036">
              vbnet:S4036
            </a>
          </td>
          <td >
            <details>
              <p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>
environment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in
<code>PATH</code> is a directory under his control.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>
<h2>Sensitive Code Example</h2>
<pre>
Dim p As New Process()
p.StartInfo.FileName = "binary" ' Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
Dim p As New Process()
p.StartInfo.FileName = "C:\Apps\binary.exe" ' Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/426">MITRE, CWE-426</a> - Untrusted Search Path </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/427">MITRE, CWE-427</a> - Uncontrolled Search Path Element </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S2255"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S2255">
              vbnet:S2255
            </a>
          </td>
          <td >
            <details>
              <p>Using cookies is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11639">CVE-2018-11639</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6537">CVE-2016-6537</a> </li>
</ul>
<p>Attackers can use widely-available tools to read cookies. Any sensitive information they may contain will be exposed.</p>
<p>This rule flags code that writes cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sensitive information is stored inside the cookie. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Cookies should only be used to manage the user session. The best practice is to keep all user-related information server-side and link them to the
user session, never sending them to the client. In a very few corner cases, cookies can be used for non-sensitive information that need to live longer
than the user session.</p>
<p>Do not try to encode sensitive information in a non human-readable format before writing them in a cookie. The encoding can be reverted and the
original information will be exposed.</p>
<p>Using cookies only for session IDs doesn’t make them secure. Follow <a
href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies">OWASP best practices</a> when you configure your
cookies.</p>
<p>As a side note, every information read from a cookie should be <a
href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitized</a>.</p>
<h2>Sensitive Code Example</h2>
<pre>
' === .NET Framework ===

Dim myCookie As HttpCookie = New HttpCookie("UserSettings")
myCookie("CreditCardNumber") = "1234 1234 1234 1234" ' Sensitive; sensitive data stored
myCookie.Values("password") = "5678" ' Sensitive
myCookie.Value = "mysecret" ' Sensitive
...
Response.Cookies.Add(myCookie)


' === .NET Core ===

Response.Headers.Add("Set-Cookie", ...) ' Sensitive
Response.Cookies.Append("mykey", "myValue") ' Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/312">MITRE, CWE-312</a> - Cleartext Storage of Sensitive Information </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#COOKIE_USAGE">COOKIE_USAGE</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4834"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4834">
              vbnet:S4834
            </a>
          </td>
          <td >
            <details>
              <p>The access control of an application must be properly implemented in order to restrict access to resources to authorized entities otherwise this
could lead to vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12999">CVE-2018-12999</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10285">CVE-2018-10285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7455">CVE-2017-7455</a> </li>
</ul>
<p>Granting correct permissions to users, applications, groups or roles and defining required permissions that allow access to a resource is
sensitive, must therefore be done with care. For instance, it is obvious that only users with administrator privilege should be authorized to
add/remove the administrator permission of another user.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Granted permission to an entity (user, application) allow access to information or functionalities not needed by this entity. </li>
  <li> Privileges are easily acquired (eg: based on the location of the user, type of device used, defined by third parties, does not require approval
  …​). </li>
  <li> Inherited permission, default permission, no privileges (eg: anonymous user) is authorized to access to a protected resource. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>At minimum, an access control system should:</p>
<ul>
  <li> Use a well-defined access control model like <a href="https://en.wikipedia.org/wiki/Role-based_access_control">RBAC</a> or <a
  href="https://en.wikipedia.org/wiki/Access-control_list">ACL</a>. </li>
  <li> Entities' permissions should be reviewed regularly to remove permissions that are no longer needed. </li>
  <li> Respect <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a> ("<em>an entity has access
  only the information and resources that are necessary for its legitimate purpose</em>"). </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Imports System.Threading
Imports System.Security.Permissions
Imports System.Security.Principal
Imports System.IdentityModel.Tokens

Class SecurityPrincipalDemo
    Class MyIdentity
        Implements IIdentity ' Sensitive, custom IIdentity implementations should be reviewed
    End Class

    Class MyPrincipal
        Implements IPrincipal ' Sensitive, custom IPrincipal implementations should be reviewed
    End Class

    &lt;System.Security.Permissions.PrincipalPermission(SecurityAction.Demand, Role:="Administrators")&gt; ' Sensitive. The access restrictions enforced by this attribute should be reviewed.
    Private Shared Sub CheckAdministrator()
        Dim MyIdentity As WindowsIdentity = WindowsIdentity.GetCurrent() ' Sensitive

        HttpContext.User = ... ' Sensitive: review all reference (set and get) to System.Web HttpContext.User

        Dim domain As AppDomain = AppDomain.CurrentDomain
        domain.SetPrincipalPolicy(PrincipalPolicy.WindowsPrincipal) ' Sensitive

        Dim identity As MyIdentity = New MyIdentity() ' Sensitive
        Dim MyPrincipal As MyPrincipal = New MyPrincipal(MyIdentity) ' Sensitive
        Thread.CurrentPrincipal = MyPrincipal ' Sensitive
        domain.SetThreadPrincipal(MyPrincipal) ' Sensitive

        Dim principalPerm As PrincipalPermission = New PrincipalPermission(Nothing, "Administrators")  ' Sensitive
        principalPerm.Demand()

        Dim handler As SecurityTokenHandler = ...
        Dim identities As ReadOnlyCollection(Of ClaimsIdentity) = handler.ValidateToken()  ' Sensitive, this creates identity
    End Sub

    ' Sensitive: review how this function uses the identity and principal.
    Private Sub modifyPrincipal(ByVal identity As MyIdentity, ByVal principal As MyPrincipal)
    End Sub
End Class
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/276">MITRE, CWE-276</a> - Incorrect Default Permissions </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/277">MITRE, CWE-277</a> - Insecure Inherited Permissions </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4790"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4790">
              vbnet:S4790
            </a>
          </td>
          <td >
            <details>
              <p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,
<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,
<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little
computational effort is enough to find two or more different inputs that produce the same hash).</p>
<h2>Ask Yourself Whether</h2>
<p>The hashed value is used in a security context like:</p>
<ul>
  <li> User-password storage. </li>
  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>
  <li> To compute some message integrity. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even
better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>
because it slows down <code>brute force attacks</code>.</p>
<h2>Sensitive Code Example</h2>
<pre>
Imports System.Security.Cryptography

Sub ComputeHash()

    ' Review all instantiations of classes that inherit from HashAlgorithm, for example:
    Dim hashAlgo As HashAlgorithm = HashAlgorithm.Create() ' Sensitive
    Dim hashAlgo2 As HashAlgorithm = HashAlgorithm.Create("SHA1") ' Sensitive
    Dim sha As SHA1 = New SHA1CryptoServiceProvider() ' Sensitive
    Dim md5 As MD5 = New MD5CryptoServiceProvider() ' Sensitive

    ' ...
End Sub

Class MyHashAlgorithm
    Inherits HashAlgorithm ' Sensitive

    ' ...
End Class
</pre>
<h2>Compliant Solution</h2>
<pre>
Imports System.Security.Cryptography

Sub ComputeHash()
    Dim sha256 = New SHA256CryptoServiceProvider() ' Compliant
    Dim sha384 = New SHA384CryptoServiceProvider() ' Compliant
    Dim sha512 = New SHA512CryptoServiceProvider() ' Compliant

    ' ...
End Sub
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1240">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S4792"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4792">
              vbnet:S4792
            </a>
          </td>
          <td >
            <details>
              <p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285">CVE-2018-0285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127">CVE-2000-1127</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113">CVE-2017-15113</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742">CVE-2015-5742</a> </li>
</ul>
<p>Logs are useful before, during and after a security incident.</p>
<ul>
  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it
  is the first step to prevent an attack from ever happening. </li>
  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>
</ul>
<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information
logged and how they are logged.</p>
<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives
  access to them. </li>
  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>
  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the
  user can perform the action as many times as he/she wants. </li>
  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)
  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>
  <li> the logs are only stored locally instead of being backuped or replicated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Check that your production deployment doesn’t have its loggers in "debug" mode as it might write sensitive information in logs. </li>
  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>
  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the
  hostname. </li>
  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the
  impact is known and limited. </li>
  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the
  service are secure too. </li>
  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control
  the logged information. An attacker could just repeat a logged action many times. </li>
</ul>
<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your
logs:</p>
<ul>
  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user
  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>
  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user
  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example
  use all your storage space or compromise your log indexing service. </li>
  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as
  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>
  <li> Monitor the logs for any suspicious activity. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><strong>.Net Core</strong>: configure programmatically</p>
<pre>
Imports System
Imports System.Collections
Imports System.Collections.Generic
Imports Microsoft.AspNetCore
Imports Microsoft.AspNetCore.Builder
Imports Microsoft.AspNetCore.Hosting
Imports Microsoft.Extensions.Configuration
Imports Microsoft.Extensions.DependencyInjection
Imports Microsoft.Extensions.Logging
Imports Microsoft.Extensions.Options

Namespace MvcApp

    Public Class ProgramLogging

        Public Shared Function CreateWebHostBuilder(args As String()) As IWebHostBuilder

            WebHost.CreateDefaultBuilder(args) _
                .ConfigureLogging(Function(hostingContext, Logging) ' Sensitive
                                      ' ...
                                  End Function) _
            .UseStartup(Of StartupLogging)()

            '...
        End Function
    End Class


    Public Class StartupLogging

        Public Sub ConfigureServices(services As IServiceCollection)

            services.AddLogging(Function(logging) ' Sensitive
                                    '...
                                End Function)
        End Sub

        Public Sub Configure(app As IApplicationBuilder, env As IHostingEnvironment, loggerFactory As ILoggerFactory)

            Dim config As IConfiguration = Nothing
            Dim level As LogLevel = LogLevel.Critical
            Dim includeScopes As Boolean = False
            Dim filter As Func(Of String, Microsoft.Extensions.Logging.LogLevel, Boolean) = Nothing
            Dim consoleSettings As Microsoft.Extensions.Logging.Console.IConsoleLoggerSettings = Nothing
            Dim azureSettings As Microsoft.Extensions.Logging.AzureAppServices.AzureAppServicesDiagnosticsSettings = Nothing
            Dim eventLogSettings As Microsoft.Extensions.Logging.EventLog.EventLogSettings = Nothing

            ' An issue will be raised for each call to an ILoggerFactory extension methods adding loggers.
            loggerFactory.AddAzureWebAppDiagnostics() ' Sensitive
            loggerFactory.AddAzureWebAppDiagnostics(azureSettings) ' Sensitive
            loggerFactory.AddConsole() ' Sensitive
            loggerFactory.AddConsole(level) ' Sensitive
            loggerFactory.AddConsole(level, includeScopes) ' Sensitive
            loggerFactory.AddConsole(filter) ' Sensitive
            loggerFactory.AddConsole(filter, includeScopes) ' Sensitive
            loggerFactory.AddConsole(config) ' Sensitive
            loggerFactory.AddConsole(consoleSettings) ' Sensitive
            loggerFactory.AddDebug() ' Sensitive
            loggerFactory.AddDebug(level) ' Sensitive
            loggerFactory.AddDebug(filter) ' Sensitive
            loggerFactory.AddEventLog() ' Sensitive
            loggerFactory.AddEventLog(eventLogSettings) ' Sensitive
            loggerFactory.AddEventLog(level) ' Sensitive
            ' Only available for NET Standard 2.0 and above
            'loggerFactory.AddEventSourceLogger() ' Sensitive

            Dim providers As IEnumerable(Of ILoggerProvider) = Nothing
            Dim filterOptions1 As LoggerFilterOptions = Nothing
            Dim filterOptions2 As IOptionsMonitor(Of LoggerFilterOptions) = Nothing

            Dim factory As LoggerFactory = New LoggerFactory() ' Sensitive
            factory = New LoggerFactory(providers) ' Sensitive
            factory = New LoggerFactory(providers, filterOptions1) ' Sensitive
            factory = New LoggerFactory(providers, filterOptions2) ' Sensitive
        End Sub
    End Class
End Namespace
</pre>
<p><strong>Log4Net</strong></p>
<pre>
Imports System
Imports System.IO
Imports System.Xml
Imports log4net.Appender
Imports log4net.Config
Imports log4net.Repository

Namespace Logging
    Class Log4netLogging
        Private Sub Foo(ByVal repository As ILoggerRepository, ByVal element As XmlElement, ByVal configFile As FileInfo, ByVal configUri As Uri, ByVal configStream As Stream, ByVal appender As IAppender, ParamArray appenders As IAppender())
            log4net.Config.XmlConfigurator.Configure(repository) ' Sensitive
            log4net.Config.XmlConfigurator.Configure(repository, element) ' Sensitive
            log4net.Config.XmlConfigurator.Configure(repository, configFile) ' Sensitive
            log4net.Config.XmlConfigurator.Configure(repository, configUri) ' Sensitive
            log4net.Config.XmlConfigurator.Configure(repository, configStream) ' Sensitive
            log4net.Config.XmlConfigurator.ConfigureAndWatch(repository, configFile) ' Sensitive

            log4net.Config.DOMConfigurator.Configure() ' Sensitive
            log4net.Config.DOMConfigurator.Configure(repository) ' Sensitive
            log4net.Config.DOMConfigurator.Configure(element) ' Sensitive
            log4net.Config.DOMConfigurator.Configure(repository, element) ' Sensitive
            log4net.Config.DOMConfigurator.Configure(configFile) ' Sensitive
            log4net.Config.DOMConfigurator.Configure(repository, configFile) ' Sensitive
            log4net.Config.DOMConfigurator.Configure(configStream) ' Sensitive
            log4net.Config.DOMConfigurator.Configure(repository, configStream) ' Sensitive
            log4net.Config.DOMConfigurator.ConfigureAndWatch(configFile) ' Sensitive
            log4net.Config.DOMConfigurator.ConfigureAndWatch(repository, configFile) ' Sensitive

            log4net.Config.BasicConfigurator.Configure() ' Sensitive
            log4net.Config.BasicConfigurator.Configure(appender) ' Sensitive
            log4net.Config.BasicConfigurator.Configure(appenders) ' Sensitive
            log4net.Config.BasicConfigurator.Configure(repository) ' Sensitive
            log4net.Config.BasicConfigurator.Configure(repository, appender) ' Sensitive
            log4net.Config.BasicConfigurator.Configure(repository, appenders) ' Sensitive
        End Sub
    End Class
End Namespace
</pre>
<p><strong>NLog</strong>: configure programmatically</p>
<pre>
Namespace Logging
    Class NLogLogging
        Private Sub Foo(ByVal config As NLog.Config.LoggingConfiguration)
            NLog.LogManager.Configuration = config ' Sensitive
        End Sub
    End Class
End Namespace
</pre>
<p><strong>Serilog</strong></p>
<pre>
Namespace Logging
    Class SerilogLogging
        Private Sub Foo()
            Dim config As Serilog.LoggerConfiguration = New Serilog.LoggerConfiguration() ' Sensitive
        End Sub
    End Class
End Namespace
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring">OWASP Top 10 2017 Category A10</a> -
  Insufficient Logging &amp; Monitoring </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/117">MITRE, CWE-117</a> - Improper Output Neutralization for Logs </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/532">MITRE, CWE-532</a> - Information Exposure Through Log Files </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5732"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5732">
              typescript:S5732
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Clickjacking">Clickjacking</a> attacks occur when an attacker try to trick an user to click on certain
buttons/links of a legit website. This attack can take place with malicious HTML frames well hidden in an attacker website.</p>
<p>For instance, suppose a safe and authentic page of a social network (https://socialnetworkexample.com/makemyprofilpublic) which allows an user to
change the visibility of his profile by clicking on a button. This is a critical feature with high privacy concerns. Users are generally well informed
on the social network of the consequences of this action. An attacker can trick users, without their consent, to do this action with the below
embedded code added on a malicious website:</p>
<pre>
&lt;html&gt;
&lt;b&gt;Click on the button below to win 5000$&lt;/b&gt;
&lt;br&gt;
&lt;iframe src="https://socialnetworkexample.com/makemyprofilpublic" width="200" height="200"&gt;&lt;/iframe&gt;
&lt;/html&gt;
</pre>
<p>Playing with the size of the iframe it’s sometimes possible to display only the critical parts of a page, in this case the button of the
<em>makemyprofilpublic</em> page.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> <a href="https://en.wikipedia.org/wiki/Clickjacking#Clickjacking_categories">Critical actions</a> of the application are prone to clickjacking
  attacks because a simple click on a link or a button can trigger them. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement content security policy <em>frame-ancestors</em> directive which is supported by all modern browsers and will specify the origins of
frame allowed to be loaded by the browser (this directive deprecates <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">X-Frame-Options</a>).</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/helmet-csp">helmet-csp</a> or <a
href="https://www.npmjs.com/package/helmet">helmet</a> middleware is used without the <code>frameAncestors</code> directive (or if
<code>frameAncestors</code> is set to <code>'none'</code>):</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.contentSecurityPolicy({
    directives: {
      // other directives
      frameAncestors: ["'none'"] // Sensitive: frameAncestors  is set to none
    }
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application a standard way to implement CSP frame-ancestors directive is the <a
href="https://www.npmjs.com/package/helmet-csp">helmet-csp</a> or <a href="https://www.npmjs.com/package/helmet">helmet</a> middleware:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.contentSecurityPolicy({
    directives: {
      // other directives
      frameAncestors: ["'example.com'"] // Compliant
    }
  })
);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html">OWASP Cheat Sheets</a> - Clickjacking Defense
  Cheat Sheet </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors">developer.mozilla.org</a> -
  Frame-ancestors </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">developer.mozilla.org</a> - Content Security Policy (CSP) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/451">MITRE, CWE-451</a> - User Interface (UI) Misrepresentation of Critical Information </li>
  <li> <a href="https://www.w3.org/TR/CSP3/">w3.org</a> - Content Security Policy Level 3 </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5734"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5734">
              typescript:S5734
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://blog.mozilla.org/security/2016/08/26/mitigating-mime-confusion-attacks-in-firefox/">MIME confusion</a> attacks occur when an
attacker successfully tricks a web-browser to interpret a resource as a different type than the one expected. To correctly interpret a resource
(script, image, stylesheet …​) web browsers look for the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type">Content-Type
header</a> defined in the HTTP response received from the server, but often this header is not set or is set with an incorrect value. To avoid
content-type mismatch and to provide the best user experience, web browsers try to deduce the right content-type, generally by inspecting the content
of the resources (the first bytes). This "guess mechanism" is called <a href="https://en.wikipedia.org/wiki/Content_sniffing">MIME type
sniffing</a>.</p>
<p>Attackers can take advantage of this feature when a website ("example.com" here) allows to upload arbitrary files. In that case, an attacker can
upload a malicious image <em>fakeimage.png</em> (containing malicious JavaScript code or <a
href="https://docs.microsoft.com/fr-fr/archive/blogs/ieinternals/script-polyglots">a polyglot content</a> file) such as:</p>
<pre>
&lt;script&gt;alert(document.cookie)&lt;/script&gt;
</pre>
<p>When the victim will visit the website showing the uploaded image, the malicious script embedded into the image will be executed by web browsers
performing MIME type sniffing.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type">Content-Type</a> header is not systematically set for all
  resources. </li>
  <li> Content of resources can be controlled by users. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options">X-Content-Type-Options</a> header with
<em>nosniff</em> value (the only existing value for this header) which is supported by all modern browsers and will prevent browsers from performing
MIME type sniffing, so that in case of Content-Type header mismatch, the resource is not interpreted. For example within a &lt;script&gt; object
context, JavaScript MIME types are expected (like <em>application/javascript</em>) in the Content-Type header.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if, when using <a href="https://www.npmjs.com/package/helmet">helmet</a>, the <code>noSniff</code>
middleware is disabled:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet({
    noSniff: false, // Sensitive
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>When using <code>helmet</code> in an Express.js application, the <code>noSniff</code> middleware should be enabled (it is also done by
default):</p>
<pre>
const express = require('express');
const helmet= require('helmet');

let app = express();

app.use(helmet.noSniff());
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options">developer.mozilla.org</a> - X-Content-Type-Options
  </li>
  <li> <a href="https://blog.mozilla.org/security/2016/08/26/mitigating-mime-confusion-attacks-in-firefox/">blog.mozilla.org</a> - Mitigating MIME
  Confusion Attacks in Firefox </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6268"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6268">
              typescript:S6268
            </a>
          </td>
          <td >
            <details>
              <p>Angular prevents XSS vulnerabilities by treating all values as untrusted by default. Untrusted values are systematically sanitized by the framework
before they are inserted into the DOM.</p>
<p>Still, developers have the ability to manually mark a value as trusted if they are sure that the value is already sanitized. Accidentally trusting
malicious data will introduce an XSS vulnerability in the application and enable a wide range of serious attacks like accessing/modifying sensitive
information or impersonating other users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The value for which sanitization has been disabled is user-controlled. </li>
  <li> It’s difficult to understand how this value is constructed. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Avoid including dynamic executable code and thus disabling Angular’s built-in sanitization unless it’s absolutely necessary. Try instead to
  rely as much as possible on static templates and Angular built-in sanitization to define web page content. </li>
  <li> Make sure to understand how the value to consider as trusted is constructed and never concatenate it with user-controlled data. </li>
  <li> Make sure to choose the correct <a href="https://angular.io/api/platform-browser/DomSanitizer">DomSanitizer</a> "bypass" method based on the
  context. For instance, only use <code>bypassSecurityTrustUrl</code> to trust urls in an <code>href</code> attribute context. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
import { Component, OnInit } from '@angular/core';
import { DomSanitizer, SafeHtml } from "@angular/platform-browser";
import { ActivatedRoute } from '@angular/router';

@Component({
  template: '&lt;div id="hello" [innerHTML]="hello"&gt;&lt;/div&gt;'
})
export class HelloComponent implements OnInit {
  hello: SafeHtml;

  constructor(private sanitizer: DomSanitizer, private route: ActivatedRoute) { }

  ngOnInit(): void {
    let name = this.route.snapshot.queryParams.name;
    let html = "&lt;h1&gt;Hello " + name + "&lt;/h1&gt;";
    this.hello = this.sanitizer.bypassSecurityTrustHtml(html); // Sensitive
  }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import { Component, OnInit } from '@angular/core';
import { DomSanitizer } from "@angular/platform-browser";
import { ActivatedRoute } from '@angular/router';

@Component({
  template: '&lt;div id="hello"&gt;&lt;h1&gt;Hello {{name}}&lt;/h1&gt;&lt;/div&gt;',
})
export class HelloComponent implements OnInit {
  name: string;

  constructor(private sanitizer: DomSanitizer, private route: ActivatedRoute) { }

  ngOnInit(): void {
    this.name = this.route.snapshot.queryParams.name;
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
  <li> <a href="https://angular.io/guide/security">Angular - Best Practices - Security</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5730"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5730">
              typescript:S5730
            </a>
          </td>
          <td >
            <details>
              <p>A mixed-content is when a resource is loaded with the HTTP protocol, from a website accessed with the HTTPs protocol, thus mixed-content are not
encrypted and exposed to <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">MITM attacks</a> and could break the entire level of
protection that was desired by implementing encryption with the HTTPs protocol.</p>
<p>The main threat with mixed-content is not only the confidentiality of resources but the whole website integrity:</p>
<ul>
  <li> A passive mixed-content (eg: <em>&lt;img src="http://example.com/picture.png"&gt;</em>) allows an attacker to access and replace only these
  resources, like images, with malicious ones that could lead to successful phishing attacks. </li>
  <li> With active mixed-content (eg: <em>&lt;script src="http://example.com/library.js"&gt;</em>) an attacker can compromise the entire website by
  injecting malicious javascript code for example (accessing and modifying the DOM, steal cookies, etc). </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The HTTPS protocol is in place and external resources are fetched from the website pages. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement content security policy <em>block-all-mixed-content</em> directive which is supported by all modern browsers and will block loading of
mixed-contents.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/helmet-csp">helmet-csp</a> or <a
href="https://www.npmjs.com/package/helmet">helmet</a> middleware is used without the <code>blockAllMixedContent</code> directive:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.contentSecurityPolicy({
    directives: {
      "default-src": ["'self'", 'example.com', 'code.jquery.com']
    } // Sensitive: blockAllMixedContent directive is missing
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application a standard way to block mixed-content is to put in place the <a
href="https://www.npmjs.com/package/helmet-csp">helmet-csp</a> or <a href="https://www.npmjs.com/package/helmet">helmet</a> middleware with the
<code>blockAllMixedContent</code> directive:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.contentSecurityPolicy({
    directives: {
      "default-src": ["'self'", 'example.com', 'code.jquery.com'],
      blockAllMixedContent: [] // Compliant
    }
  })
);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> -
  Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">developer.mozilla.org</a> - Mixed-content </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">developer.mozilla.org</a> - Content Security Policy (CSP) </li>
  <li> <a href="https://www.w3.org/TR/CSP3/">w3.org</a> - Content Security Policy Level 3 </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5852"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5852">
              typescript:S5852
            </a>
          </td>
          <td >
            <details>
              <p>Most of the regular expression engines use backtracking to try all possible execution paths of the regular expression when evaluating an input, in
some cases it can cause performance issues, called <strong>catastrophic backtracking</strong> situations. In the worst case, the complexity of the
regular expression is exponential in the size of the input, this means that a small carefully-crafted input (like 20 chars) can trigger catastrophic
backtracking and cause a denial of service of the application. Super-linear regex complexity can lead to the same impact too with, in this case, a
large carefully-crafted input (thousands chars).</p>
<p>This rule determines the runtime complexity of a regular expression and informs you if it is not linear.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The input is user-controlled. </li>
  <li> The input size is not restricted to a small number of characters. </li>
  <li> There is no timeout in place to limit the regex evaluation time. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>To avoid catastrophic backtracking situations, make sure that none of the following conditions apply to your regular expression.</p>
<p>In all of the following cases, catastrophic backtracking can only happen if the problematic part of the regex is followed by a pattern that can
fail, causing the backtracking to actually happen.</p>
<ul>
  <li> If you have a repetition <code>r*</code> or <code>r*?</code>, such that the regex <code>r</code> could produce different possible matches (of
  possibly different lengths) on the same input, the worst case matching time can be exponential. This can be the case if <code>r</code> contains
  optional parts, alternations or additional repetitions (but not if the repetition is written in such a way that there’s only one way to match it).
  </li>
  <li> If you have multiple repetitions that can match the same contents and are consecutive or are only separated by an optional separator or a
  separator that can be matched by both of the repetitions, the worst case matching time can be polynomial (O(n^c) where c is the number of
  problematic repetitions). For example <code>a*b*</code> is not a problem because <code>a*</code> and <code>b*</code> match different things and
  <code>a*_a*</code> is not a problem because the repetitions are separated by a <code>'_'</code> and can’t match that <code>'_'</code>. However,
  <code>a*a*</code> and <code>.*_.*</code> have quadratic runtime. </li>
  <li> If the regex is not anchored to the beginning of the string, quadratic runtime is especially hard to avoid because whenever a match fails, the
  regex engine will try again starting at the next index. This means that any unbounded repetition, if it’s followed by a pattern that can fail, can
  cause quadratic runtime on some inputs. For example <code>str.split(/\s*,/)</code> will run in quadratic time on strings that consist entirely of
  spaces (or at least contain large sequences of spaces, not followed by a comma). </li>
</ul>
<p>In order to rewrite your regular expression without these patterns, consider the following strategies:</p>
<ul>
  <li> If applicable, define a maximum number of expected repetitions using the bounded quantifiers, like <code>{1,5}</code> instead of <code>+</code>
  for instance. </li>
  <li> Refactor nested quantifiers to limit the number of way the inner group can be matched by the outer quantifier, for instance this nested
  quantifier situation <code>(ba+)+</code> doesn’t cause performance issues, indeed, the inner group can be matched only if there exists exactly one
  <code>b</code> char per repetition of the group. </li>
  <li> Optimize regular expressions by emulating <em>possessive quantifiers</em> and <em>atomic grouping</em>. </li>
  <li> Use negated character classes instead of <code>.</code> to exclude separators where applicable. For example the quadratic regex
  <code>.*_.*</code> can be made linear by changing it to <code>[^_]*_.*</code> </li>
</ul>
<p>Sometimes it’s not possible to rewrite the regex to be linear while still matching what you want it to match. Especially when the regex is not
anchored to the beginning of the string, for which it is quite hard to avoid quadratic runtimes. In those cases consider the following approaches:</p>
<ul>
  <li> Solve the problem without regular expressions </li>
  <li> Use an alternative non-backtracking regex implementations such as Google’s <a href="https://github.com/google/re2">RE2</a> or <a
  href="https://github.com/uhop/node-re2/">node-re2</a>. </li>
  <li> Use multiple passes. This could mean pre- and/or post-processing the string manually before/after applying the regular expression to it or
  using multiple regular expressions. One example of this would be to replace <code>str.split(/\s*,\s*/)</code> with <code>str.split(",")</code> and
  then trimming the spaces from the strings as a second step. </li>
  <li> It is often possible to make the regex infallible by making all the parts that could fail optional, which will prevent backtracking. Of course
  this means that you’ll accept more strings than intended, but this can be handled by using capturing groups to check whether the optional parts were
  matched or not and then ignoring the match if they weren’t. For example the regex <code>x*y</code> could be replaced with <code>x*(y)?</code> and
  then the call to <code>str.match(regex)</code> could be replaced with <code>matched = str.match(regex)</code> and <code>matched[1] !==
  undefined</code>. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>The regex evaluation will never end:</p>
<pre>
/(a+)+$/.test(
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaa!"
); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Possessive quantifiers do not keep backtracking positions, thus can be used, if possible, to avoid performance issues. Unfortunately, they are not
supported in JavaScript, but one can still mimick them using lookahead assertions and backreferences:</p>
<pre>
/((?=(a+))\2)+$/.test(
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaa!"
); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1333">MITRE, CWE-1333</a> - Inefficient Regular Expression Complexity </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">owasp.org</a> - OWASP Regular expression Denial
  of Service - ReDoS </li>
  <li> <a
  href="https://web.archive.org/web/20220506215733/https://stackstatus.net/post/147710624694/outage-postmortem-july-20-2016">stackstatus.net(archived)</a> - Outage Postmortem - July 20, 2016 </li>
  <li> <a href="https://www.regular-expressions.info/catastrophic.html">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic
  Backtracking </li>
  <li> <a
  href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions#backtracking-with-nested-optional-quantifiers">docs.microsoft.com</a> - Backtracking with Nested Optional Quantifiers </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5736"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5736">
              typescript:S5736
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://en.wikipedia.org/wiki/HTTP_referer">HTTP header referer</a> contains a URL set by web browsers and used by applications to track
from where the user came from, it’s for instance a relevant value for web analytic services, but it can cause <a
href="https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns">serious privacy and security problems</a>
if the URL contains confidential information. Note that Firefox for instance, to prevent data leaks, <a
href="https://blog.mozilla.org/security/2018/01/31/preventing-data-leaks-by-stripping-path-information-in-http-referrers/">removes path
information</a> in the Referer header while browsing privately.</p>
<p>Suppose an e-commerce website asks the user his credit card number to purchase a product:</p>
<pre>
&lt;html&gt;
&lt;body&gt;
&lt;form action="/valid_order" method="GET"&gt;
Type your credit card number to purchase products:
&lt;input type=text id="cc" value="1111-2222-3333-4444"&gt;
&lt;input type=submit&gt;
&lt;/form&gt;
&lt;/body&gt;
</pre>
<p>When submitting the above HTML form, a HTTP GET request will be performed, the URL requested will be
https://example.com/valid_order?cc=1111-2222-3333-4444 with credit card number inside and it’s obviously not secure for these reasons:</p>
<ul>
  <li> URLs are stored in the history of browsers. </li>
  <li> URLs could be accidentally shared when doing copy/paste actions. </li>
  <li> URLs can be stolen if a malicious person looks at the computer screen of an user. </li>
</ul>
<p>In addition to these threats, when further requests will be performed from the "valid_order" page with a simple legitimate embedded script like
that:</p>
<pre>
&lt;script src="https://webanalyticservices_example.com/track"&gt;
</pre>
<p>The referer header which contains confidential information will be send to a third party web analytic service and cause privacy issue:</p>
<pre>
GET /track HTTP/2.0
Host: webanalyticservices_example.com
Referer: https://example.com/valid_order?cc=1111-2222-3333-4444
</pre>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Confidential information exists in URLs. </li>
  <li> Semantic of HTTP methods is not respected (eg: use of a GET method instead of POST when the state of the application is changed). </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Confidential information should not be set inside URLs (GET requests) of the application and a safe (ie: different from <code>unsafe-url</code> or
<code>no-referrer-when-downgrade</code>) <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">referrer-Policy</a>
header, to control how much information is included in the referer header, should be used.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/helmet">helmet</a> <code>referrerPolicy</code>
middleware is disabled or used with <code>no-referrer-when-downgrade</code> or <code>unsafe-url</code>:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

app.use(
  helmet.referrerPolicy({
    policy: 'no-referrer-when-downgrade' // Sensitive: no-referrer-when-downgrade is used
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application a secure solution is to user the <a href="https://www.npmjs.com/package/helmet">helmet</a> referrer policy middleware set
to <code>no-referrer</code>:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.referrerPolicy({
    policy: 'no-referrer' // Compliant
  })
);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> -
  Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">developer.mozilla.org</a> - Referrer-Policy </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns">developer.mozilla.org</a> -
  Referer header: privacy and security concerns </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5739"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5739">
              typescript:S5739
            </a>
          </td>
          <td >
            <details>
              <p>When implementing the HTTPS protocol, the website mostly continue to support the HTTP protocol to redirect users to HTTPS when they request a HTTP
version of the website. These redirects are not encrypted and are therefore vulnerable to man in the middle attacks. The <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">Strict-Transport-Security policy header</a> (HSTS) set by
an application instructs the web browser to convert any HTTP request to HTTPS.</p>
<p>Web browsers that see the Strict-Transport-Security policy header for the first time record information specified in the header:</p>
<ul>
  <li> the <code>max-age</code> directive which specify how long the policy should be kept on the web browser. </li>
  <li> the <code>includeSubDomains</code> optional directive which specify if the policy should apply on all sub-domains or not. </li>
  <li> the <code>preload</code> optional directive which is not part of the HSTS specification but supported on all modern web browsers. </li>
</ul>
<p>With the <code>preload</code> directive the web browser never connects in HTTP to the website and to use this directive, it is required <a
href="https://hstspreload.org/">to submit</a> the concerned application to a preload service maintained by Google.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The website is accessible with the unencrypted HTTP protocol. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement Strict-Transport-Security policy header, it is recommended to apply this policy to all subdomains (<code>includeSubDomains</code>) and
for at least 6 months (<code>max-age=15552000</code>) or even better for 1 year (<code>max-age=31536000</code>).</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/helmet">helmet</a> or <a
href="https://www.npmjs.com/package/hsts">hsts</a> middleware are disabled or used without recommended values:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(helmet.hsts({
  maxAge: 3153600, // Sensitive, recommended &gt;= 15552000
  includeSubDomains: false // Sensitive, recommended 'true'
}));
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application a standard way to implement HSTS is with the <a href="https://www.npmjs.com/package/helmet">helmet</a> or <a
href="https://www.npmjs.com/package/hsts">hsts</a> middleware:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(helmet.hsts({
  maxAge: 31536000,
  includeSubDomains: true
})); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> -
  Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">developer.mozilla.org</a> - Strict Transport
  Security </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5743"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5743">
              typescript:S5743
            </a>
          </td>
          <td >
            <details>
              <p>By default, web browsers perform <a href="https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch/">DNS prefetching</a> to reduce
latency due to DNS resolutions required when an user clicks links from a website page.</p>
<p>For instance on example.com the hyperlink below contains a cross-origin domain name that must be resolved to an IP address by the web browser:</p>
<pre>
&lt;a href="https://otherexample.com"&gt;go on our partner website&lt;/a&gt;
</pre>
<p>It can add significant latency during requests, especially if the page contains many links to cross-origin domains. DNS prefetch allows web
browsers to perform DNS resolving in the background before the user clicks a link. This feature can cause privacy issues because DNS resolving from
the user’s computer is performed without his consent if he doesn’t intent to go to the linked website.</p>
<p>On a complex private webpage, a combination "of unique links/DNS resolutions" can indicate, to a eavesdropper for instance, that the user is
visiting the private page.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Links to cross-origin domains could result in leakage of confidential information about the user’s navigation/behavior of the website. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control">X-DNS-Prefetch-Control</a> header with an
<em>off</em> value but this could significantly degrade website performances.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/dns-prefetch-control">dns-prefetch-control</a>
middleware is disabled or used without the recommended value:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.dnsPrefetchControl({
    allow: true // Sensitive: allowing DNS prefetching is security-sensitive
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application the <a href="https://www.npmjs.com/package/dns-prefetch-control">dns-prefetch-control</a> or <a
href="https://www.npmjs.com/package/helmet">helmet</a> middleware is the standard way to implement <code>X-DNS-Prefetch-Control</code> header:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.dnsPrefetchControl({
    allow: false // Compliant
  })
);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html">OWASP Top 10 2017 Category
  A3</a> - Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control">developer.mozilla.org</a> - X-DNS-Prefetch-Control
  </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch">developer.mozilla.org</a> - Using dns-prefetch </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6265"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6265">
              typescript:S6265
            </a>
          </td>
          <td >
            <details>
              <p>Predefined permissions, also known as <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">canned ACLs</a>,
are an easy way to grant large privileges to predefined groups or users.</p>
<p>The following canned ACLs are security-sensitive:</p>
<ul>
  <li> <code>PUBLIC_READ</code>, <code>PUBLIC_READ_WRITE</code> grant respectively "read" and "read and write" privileges to anyone, either
  authenticated or anonymous (<code>AllUsers</code> group). </li>
  <li> <code>AUTHENTICATED_READ</code> grants "read" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege policy, i.e., to only grant users the necessary permissions for their required tasks. In the
context of canned ACL, set it to <code>PRIVATE</code> (the default one), and if needed more granularity then use an appropriate S3 policy.</p>
<h2>Sensitive Code Example</h2>
<p>All users, either authenticated or anonymous, have read and write permissions with the <code>PUBLIC_READ_WRITE</code> access control:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'bucket', {
    accessControl: s3.BucketAccessControl.PUBLIC_READ_WRITE // Sensitive
});

new s3deploy.BucketDeployment(this, 'DeployWebsite', {
    accessControl: s3.BucketAccessControl.PUBLIC_READ_WRITE // Sensitive
});
</pre>
<h2>Compliant Solution</h2>
<p>With the <code>PRIVATE</code> access control (default), only the bucket owner has the read/write permissions on the bucket and its ACL.</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'bucket', {
    accessControl: s3.BucketAccessControl.PRIVATE
});

new s3deploy.BucketDeployment(this, 'DeployWebsite', {
    accessControl: s3.BucketAccessControl.PRIVATE
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">AWS Documentation</a> - Access control list (ACL)
  overview (canned ACLs) </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html">AWS Documentation</a> - Controlling access to a bucket with
  user policies </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html">AWS CDK version 2</a> - Class Bucket (construct) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="typescript:S5742"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5742">
              typescript:S5742
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency">Certificate Transparency</a> (CT) is an open-framework to
protect against identity theft when certificates are issued. <a href="https://en.wikipedia.org/wiki/Certificate_authority">Certificate Authorities</a>
(CA) electronically sign certificate after verifying the identify of the certificate owner. Attackers use, among other things, social engineering
attacks to trick a CA to correctly verifying a spoofed identity/forged certificate.</p>
<p>CAs implement Certificate Transparency framework to publicly log the records of newly issued certificates, allowing the public and in particular
the identity owner to monitor these logs to verify that his identify was not usurped.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The website identity is valuable and well-known, therefore prone to theft. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT">Expect-CT</a> HTTP header which instructs the web browser
to check <a href="https://www.certificate-transparency.org/known-logs">public CT logs</a> in order to verify if the website appears inside and if it
is not, the browser will block the request and display a warning to the user.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/expect-ct">expect-ct</a> middleware is disabled:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
    helmet({
      expectCt: false // Sensitive
    })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application the <a href="https://www.npmjs.com/package/expect-ct">expect-ct</a> middleware is the standard way to implement
expect-ct. Usually, the deployment of this policy starts with the report only mode (<code>enforce: false</code>) and with a low <code>maxAge</code>
(the number of seconds the policy will apply) value and next if everything works well it is recommended to block future connections that violate
Expect-CT policy (<code>enforce: true</code>) and greater value for maxAge directive:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(helmet.expectCt({
  enforce: true,
  maxAge: 86400
})); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> -
  Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency">developer.mozilla.org</a> - Certificate Transparency
  </li>
  <li> <a href="https://en.wikipedia.org/wiki/Certificate_authority">wikipedia.org</a> - Certificate Authority </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6270"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6270">
              typescript:S6270
            </a>
          </td>
          <td >
            <details>
              <p>Resource-based policies granting access to all users can lead to information leakage.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The AWS resource stores or processes sensitive data. </li>
  <li> The AWS resource is designed to be private. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the
context of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>
<h2>Sensitive Code Example</h2>
<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'
import { aws_s3 as s3 } from 'aws-cdk-lib'

const bucket = new s3.Bucket(this, "ExampleBucket")

bucket.addToResourcePolicy(new iam.PolicyStatement({
    effect: iam.Effect.ALLOW,
    actions: ["s3:*"],
    resources: [bucket.arnForObjects("*")],
    principals: [new iam.AnyPrincipal()] // Sensitive
}))
</pre>
<h2>Compliant Solution</h2>
<p>This policy allows only the authorized users:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'
import { aws_s3 as s3 } from 'aws-cdk-lib'

const bucket = new s3.Bucket(this, "ExampleBucket")

bucket.addToResourcePolicy(new iam.PolicyStatement({
    effect: iam.Effect.ALLOW,
    actions: ["s3:*"],
    resources: [bucket.arnForObjects("*")],
    principals: [new iam.AccountRootPrincipal()]
}))
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6275"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6275">
              typescript:S6275
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the
security of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access
to the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a
href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default">all new volumes and snapshots</a>. Volumes created
from snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The disk contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no
further modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption
globally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security
parameter will prevent any future unexpected security downgrade.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html">aws_cdk.aws_ec2.Volume</a>:</p>
<pre>
import { Size } from 'aws-cdk-lib';
import { Volume } from 'aws-cdk-lib/aws-ec2';

new Volume(this, 'unencrypted-explicit', {
      availabilityZone: 'us-west-2a',
      size: Size.gibibytes(1),
      encrypted: false // Sensitive
    });
</pre>
<pre>
import { Size } from 'aws-cdk-lib';
import { Volume } from 'aws-cdk-lib/aws-ec2';

new Volume(this, 'unencrypted-implicit', {
      availabilityZone: 'eu-west-1a',
      size: Size.gibibytes(1),
    }); // Sensitive as encryption is disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html">aws_cdk.aws_ec2.Volume</a>:</p>
<pre>
import { Size } from 'aws-cdk-lib';
import { Volume } from 'aws-cdk-lib/aws-ec2';

new Volume(this, 'encrypted-explicit', {
      availabilityZone: 'eu-west-1a',
      size: Size.gibibytes(1),
      encrypted: true
    });
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html">Amazon EBS encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6249"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6249">
              typescript:S6249
            </a>
          </td>
          <td >
            <details>
              <p>By default, S3 buckets can be accessed through HTTP and HTTPs protocols.</p>
<p>As HTTP is a clear-text protocol, it lack the encryption of transported data, as well as the capability to build an authenticated connection. It
means that a malicious actor who is able to intersept traffic from the network can read, modify or corrupt the transported content.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure has to comply with AWS Foundational Security Best Practices standard. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enforce HTTPS only access by setting <code>enforceSSL</code> property to <code>true</code></p>
<h2>Sensitive Code Example</h2>
<p>S3 bucket objects access through TLS is not enforced by default:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

const bucket = new s3.Bucket(this, 'example'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

const bucket = new s3.Bucket(this, 'example', {
    bucketName: 'example',
    versioned: true,
    publicReadAccess: false,
    enforceSSL: true
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit">AWS documentation</a> - Enforce encryption
  of data in transit </li>
  <li> <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5">AWS Foundational Security
  Best Practices controls</a> - S3 buckets should require requests to use Secure Socket Layer </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html">AWS CDK version 2</a> - Bucket </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4502"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4502">
              typescript:S4502
            </a>
          </td>
          <td >
            <details>
              <p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive
actions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the
application.</p>
<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a
hidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The web application uses cookies to authenticate users. </li>
  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>
  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Protection against CSRF attacks is strongly recommended:
    <ul>
      <li> to be activated by default for all <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">unsafe HTTP
      methods</a>. </li>
      <li> implemented, for example, with an unguessable CSRF token </li>
    </ul>  </li>
  <li> Of course all sensitive operations should not be performed with <a
  href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">safe HTTP</a> methods like <code>GET</code> which are designed to be
  used only for information retrieval. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/csurf">Express.js CSURF middleware</a> protection is not found on an unsafe HTTP method like POST
method:</p>
<pre>
let csrf = require('csurf');
let express = require('express');

let csrfProtection = csrf({ cookie: true });

let app = express();

// Sensitive: this operation doesn't look like protected by CSURF middleware (csrfProtection is not used)
app.post('/money_transfer', parseForm, function (req, res) {
  res.send('Money transferred');
});
</pre>
<p>Protection provided by <a href="https://www.npmjs.com/package/csurf">Express.js CSURF middleware</a> is globally disabled on unsafe methods:</p>
<pre>
let csrf = require('csurf');
let express = require('express');

app.use(csrf({ cookie: true, ignoreMethods: ["POST", "GET"] })); // Sensitive as POST is unsafe method
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/csurf">Express.js CSURF middleware</a> protection is used on unsafe methods:</p>
<pre>
let csrf = require('csurf');
let express = require('express');

let csrfProtection = csrf({ cookie:  true });

let app = express();

app.post('/money_transfer', parseForm, csrfProtection, function (req, res) { // Compliant
  res.send('Money transferred')
});
</pre>
<p>Protection provided by <a href="https://www.npmjs.com/package/csurf">Express.js CSURF middleware</a> is enabled on unsafe methods:</p>
<pre>
let csrf = require('csurf');
let express = require('express');

app.use(csrf({ cookie: true, ignoreMethods: ["GET"] })); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/352">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF) </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/csrf">OWASP: Cross-Site Request Forgery</a> </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6245">
              typescript:S6245
            </a>
          </td>
          <td >
            <details>
              <p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is
read from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if
they were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure
itself.</p>
<p>There are three SSE options:</p>
<ul>
  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)
    <ul>
      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)
    <ul>
      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)
    <ul>
      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s
      encryption keys. </li>
    </ul>  </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>
<h2>Sensitive Code Example</h2>
<p>Server-side encryption is not used:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'default'
}); // Sensitive
</pre>
<p>Bucket encryption is disabled by default.</p>
<h2>Compliant Solution</h2>
<p>Server-side encryption with Amazon S3-Managed Keys is used:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    encryption: s3.BucketEncryption.KMS_MANAGED
});

# Alternatively with a KMS key managed by the user.

new s3.Bucket(this, 'id', {
    encryption: s3.BucketEncryption.KMS_MANAGED,
    encryptionKey: access_key
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html">AWS documentation</a> - Protecting data using
  server-side encryption </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BucketEncryption.html">AWS CDK version 2</a> - BucketEncryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4507">
              typescript:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> The application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers or applications distributed to end users.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/errorhandler">errorhandler Express.js middleware</a> should not be used in production:</p>
<pre>
const express = require('express');
const errorhandler = require('errorhandler');

let app = express();
app.use(errorhandler()); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/errorhandler">errorhandler Express.js middleware</a> used only in development mode:</p>
<pre>
const express = require('express');
const errorhandler = require('errorhandler');

let app = express();

if (process.env.NODE_ENV === 'development') {
  app.use(errorhandler());
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5604"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5604">
              typescript:S5604
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://www.w3.org/TR/permissions/#powerful-feature">Powerful features</a> are browser features (geolocation, camera, microphone …​) that
can be accessed with JavaScript API and may require a permission granted by the user. These features can have a high impact on privacy and user
security thus they should only be used if they are really necessary to implement the critical parts of an application.</p>
<p>This rule highlights intrusive permissions when requested with <a href="https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query">the
future standard (but currently experimental) web browser query API</a> and specific APIs related to the permission. It is highly recommended to
customize this rule with the permissions considered as intrusive in the context of the web application.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some powerful features used by the application are not really necessary. </li>
  <li> Users are not clearly informed why and when powerful features are used by the application. </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> In order to respect user privacy it is recommended to avoid using intrusive powerful features. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>When using <a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API">geolocation API</a>, Firefox for example retrieves personal
information like nearby wireless access points and IP address and sends it to the default geolocation service provider, <a
href="https://www.google.com/privacy/lsf.html">Google Location Services</a>:</p>
<pre>
navigator.permissions.query({name:"geolocation"}).then(function(result) {
});  // Sensitive: geolocation is a powerful feature with high privacy concerns

navigator.geolocation.getCurrentPosition(function(position) {
  console.log("coordinates x="+position.coords.latitude+" and y="+position.coords.longitude);
}); // Sensitive: geolocation is a powerful feature with high privacy concerns
</pre>
<h2>Compliant Solution</h2>
<p>If geolocation is required, always explain to the user why the application needs it and prefer requesting an approximate location when
possible:</p>
<pre>
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;
        Retailer website example
    &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    Type a city, street or zip code where you want to retrieve the closest retail locations of our products:
    &lt;form method=post&gt;
        &lt;input type=text value="New York"&gt; &lt;!-- Compliant --&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Web Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/250">MITRE, CWE-250</a> - Execution with Unnecessary Privileges </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/359">MITRE, CWE-359</a> - Exposure of Private Information </li>
  <li> <a href="https://www.w3.org/TR/permissions/">W3C</a> - Permissions </li>
  <li> <a href="https://support.mozilla.org/en-US/kb/does-firefox-share-my-location-websites">Mozilla</a> - Does Firefox share my location with
  websites? </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5725"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5725">
              typescript:S5725
            </a>
          </td>
          <td >
            <details>
              <p>Using remote artifacts without integrity checks can lead to the unexpected execution of malicious code in the application.</p>
<p>On the client side, where front-end code is executed, malicious code could:</p>
<ul>
  <li> impersonate users' identities and take advantage of their privileges on the application. </li>
  <li> add quiet malware that monitors users' session and capture sensitive secrets. </li>
  <li> gain access to sensitive clients' personal data. </li>
  <li> deface, or otherwise affect the general availability of the application. </li>
  <li> mine cryptocurrencies in the background. </li>
</ul>
<p>Likewise, a compromised software piece that would be deployed on a server-side application could badly affect the application’s security. For
example, server-side malware could:</p>
<ul>
  <li> access and modify sensitive technical and business data. </li>
  <li> elevate its privileges on the underlying operating system. </li>
  <li> Use the compromised application as a pivot to attack the local network. </li>
</ul>
<p>By ensuring that a remote artifact is exactly what it is supposed to be before using it, the application is protected from unexpected changes
applied to it before it is downloaded.<br> Especially, integrity checks will allow for identifying an artifact replaced by malware on the publication
website or that was legitimately changed by its author, in a more benign scenario.</p>
<p>Important note: downloading an artifact over HTTPS only protects it while in transit from one host to another. It provides authenticity and
integrity checks <strong>for the network stream</strong> only. It does not ensure the authenticity or security of the artifact itself.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The artifact is a file intended to execute code. </li>
  <li> The artifact is a file that is intended to configure or affect running code in some way. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>To check the integrity of a remote artifact, hash verification is the most reliable solution. It does ensure that the file has not been modified
since the fingerprint was computed.</p>
<p>In this case, the artifact’s hash must:</p>
<ul>
  <li> Be computed with a secure hash algorithm such as <code>SHA512</code>, <code>SHA384</code> or <code>SHA256</code>. </li>
  <li> Be compared with a secure hash that was <strong>not</strong> downloaded from the same source. </li>
</ul>
<p>To do so, the best option is to add the hash in the code explicitly, by following <a
href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity#tools_for_generating_sri_hashes">Mozilla’s official documentation on
how to generate integrity strings</a>.</p>
<p><strong>Note: Use this fix together with version binding on the remote file. Avoid downloading files named "latest" or similar, so that the
front-end pages do not break when the code of the latest remote artifact changes.</strong></p>
<h2>Sensitive Code Example</h2>
<p>The following code sample uses neither integrity checks nor version pinning:</p>
<pre>
let script = document.createElement("script");
script.src = "https://cdn.example.com/latest/script.js"; // Sensitive
script.crossOrigin = "anonymous";
document.head.appendChild(script);
</pre>
<h2>Compliant Solution</h2>
<pre>
let script = document.createElement("script");
script.src = "https://cdn.example.com/v5.3.6/script.js";
script.integrity = "sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC";
script.crossOrigin = "anonymous";
document.head.appendChild(script);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/353">MITRE, CWE-353</a> - Missing Support for Integrity Check </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration.html">OWASP Top 10 2017 Category
  A6</a> - Security Misconfiguration </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">developer.mozilla.org</a> - Subresource Integrity </li>
  <li> <a href="https://en.wikipedia.org/wiki/Watering_hole_attack">Wikipedia, Watering Hole Attacks</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5728"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5728">
              typescript:S5728
            </a>
          </td>
          <td >
            <details>
              <p>Content security policy (CSP) (fetch directives) is a <a href="https://www.w3.org/TR/CSP3/">W3C standard </a> which is used by a server to specify,
via a http header, the origins from where the browser is allowed to load resources. It can help to mitigate the risk of cross site scripting (XSS)
attacks and reduce privileges used by an application. If the website doesn’t define CSP header the browser will apply <a
href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">same-origin policy</a> by default.</p>
<pre>
Content-Security-Policy: default-src 'self'; script-src ‘self ‘ http://www.example.com
</pre>
<p>In the above example, all resources are allowed from the website where this header is set and script resources fetched from example.com are also
authorized:</p>
<pre>
&lt;img src="selfhostedimage.png&gt;&lt;/script&gt; &lt;!-- will be loaded because default-src 'self'; directive is applied  --&gt;
&lt;img src="http://www.example.com/image.png&gt;&lt;/script&gt;  &lt;!-- will NOT be loaded because default-src 'self'; directive is applied  --&gt;
&lt;script src="http://www.example.com/library.js&gt;&lt;/script&gt; &lt;!-- will be loaded because script-src ‘self ‘ http://www.example.comdirective is applied  --&gt;
&lt;script src="selfhostedscript.js&gt;&lt;/script&gt; &lt;!-- will be loaded because script-src ‘self ‘ http://www.example.com directive is applied  --&gt;
&lt;script src="http://www.otherexample.com/library.js&gt;&lt;/script&gt; &lt;!-- will NOT be loaded because script-src ‘self ‘ http://www.example.comdirective is applied  --&gt;
</pre>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The resources of the application are fetched from various untrusted locations. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement content security policy fetch directives, in particular <em>default-src</em> directive and continue to properly sanitize and validate all
inputs of the application, indeed CSP fetch directives is only a tool to reduce the impact of cross site scripting attacks.</p>
<h2>Sensitive Code Example</h2>
<p>In a Express.js application, the code is sensitive if the <a href="https://www.npmjs.com/package/helmet">helmet</a> contentSecurityPolicy
middleware is disabled:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();
app.use(
    helmet({
      contentSecurityPolicy: false, // sensitive
    })
);
</pre>
<h2>Compliant Solution</h2>
<p>In a Express.js application, a standard way to implement CSP is the <a href="https://www.npmjs.com/package/helmet">helmet contentSecurityPolicy
middleware</a>:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();
app.use(helmet.contentSecurityPolicy()); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.w3.org/TR/CSP3/">w3.org</a> - Content Security Policy Level 3 </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration.html">OWASP Top 10 2017 Category
  A6</a> - Security Misconfiguration </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">developer.mozilla.org</a> - Content Security Policy (CSP) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5042"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5042">
              typescript:S5042
            </a>
          </td>
          <td >
            <details>
              <p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can
lead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of
uncompressed data. To achieve this extreme <a href="https://en.wikipedia.org/wiki/Data_compression_ratio">compression ratio</a>, attackers will
compress irrelevant data (eg: a long string of repeated bytes).</p>
<h2>Ask Yourself Whether</h2>
<p>Archives to expand are untrusted and:</p>
<ul>
  <li> There is no validation of the number of entries in the archive. </li>
  <li> There is no validation of the total size of the uncompressed data. </li>
  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is
  1 to 3. </li>
  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>
  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in
  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://github.com/npm/node-tar">tar</a> module:</p>
<pre>
const tar = require('tar');

tar.x({ // Sensitive
  file: 'foo.tar.gz'
});
</pre>
<p>For <a href="https://github.com/cthackers/adm-zip">adm-zip</a> module:</p>
<pre>
const AdmZip = require('adm-zip');

let zip = new AdmZip("./foo.zip");
zip.extractAllTo("."); // Sensitive
</pre>
<p>For <a href="https://stuk.github.io/jszip/">jszip</a> module:</p>
<pre>
const fs = require("fs");
const JSZip = require("jszip");

fs.readFile("foo.zip", function(err, data) {
  if (err) throw err;
  JSZip.loadAsync(data).then(function (zip) { // Sensitive
    zip.forEach(function (relativePath, zipEntry) {
      if (!zip.file(zipEntry.name)) {
        fs.mkdirSync(zipEntry.name);
      } else {
        zip.file(zipEntry.name).async('nodebuffer').then(function (content) {
          fs.writeFileSync(zipEntry.name, content);
        });
      }
    });
  });
});
</pre>
<p>For <a href="https://github.com/thejoshwolfe/yauzl">yauzl</a> module</p>
<pre>
const yauzl = require('yauzl');

yauzl.open('foo.zip', function (err, zipfile) {
  if (err) throw err;

  zipfile.on("entry", function(entry) {
    zipfile.openReadStream(entry, function(err, readStream) {
      if (err) throw err;
      // TODO: extract
    });
  });
});
</pre>
<p>For <a href="https://github.com/maxogden/extract-zip">extract-zip</a> module:</p>
<pre>
const extract = require('extract-zip')

async function main() {
  let target = __dirname + '/test';
  await extract('test.zip', { dir: target }); // Sensitive
}
main();
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://github.com/npm/node-tar">tar</a> module:</p>
<pre>
const tar = require('tar');
const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB

let fileCount = 0;
let totalSize = 0;

tar.x({
  file: 'foo.tar.gz',
  filter: (path, entry) =&gt; {
    fileCount++;
    if (fileCount &gt; MAX_FILES) {
      throw 'Reached max. number of files';
    }

    totalSize += entry.size;
    if (totalSize &gt; MAX_SIZE) {
      throw 'Reached max. size';
    }

    return true;
  }
});
</pre>
<p>For <a href="https://github.com/cthackers/adm-zip">adm-zip</a> module:</p>
<pre>
const AdmZip = require('adm-zip');
const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB
const THRESHOLD_RATIO = 10;

let fileCount = 0;
let totalSize = 0;
let zip = new AdmZip("./foo.zip");
let zipEntries = zip.getEntries();
zipEntries.forEach(function(zipEntry) {
    fileCount++;
    if (fileCount &gt; MAX_FILES) {
        throw 'Reached max. number of files';
    }

    let entrySize = zipEntry.getData().length;
    totalSize += entrySize;
    if (totalSize &gt; MAX_SIZE) {
        throw 'Reached max. size';
    }

    let compressionRatio = entrySize / zipEntry.header.compressedSize;
    if (compressionRatio &gt; THRESHOLD_RATIO) {
        throw 'Reached max. compression ratio';
    }

    if (!zipEntry.isDirectory) {
        zip.extractEntryTo(zipEntry.entryName, ".");
    }
});
</pre>
<p>For <a href="https://stuk.github.io/jszip/">jszip</a> module:</p>
<pre>
const fs = require("fs");
const pathmodule = require("path");
const JSZip = require("jszip");

const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB

let fileCount = 0;
let totalSize = 0;
let targetDirectory = __dirname + '/archive_tmp';

fs.readFile("foo.zip", function(err, data) {
  if (err) throw err;
  JSZip.loadAsync(data).then(function (zip) {
    zip.forEach(function (relativePath, zipEntry) {
      fileCount++;
      if (fileCount &gt; MAX_FILES) {
        throw 'Reached max. number of files';
      }

      // Prevent ZipSlip path traversal (S6096)
      const resolvedPath = pathmodule.join(targetDirectory, zipEntry.name);
      if (!resolvedPath.startsWith(targetDirectory)) {
        throw 'Path traversal detected';
      }

      if (!zip.file(zipEntry.name)) {
        fs.mkdirSync(resolvedPath);
      } else {
        zip.file(zipEntry.name).async('nodebuffer').then(function (content) {
          totalSize += content.length;
          if (totalSize &gt; MAX_SIZE) {
            throw 'Reached max. size';
          }

          fs.writeFileSync(resolvedPath, content);
        });
      }
    });
  });
});
</pre>
<p>Be aware that due to the similar structure of sensitive and compliant code the issue will be raised in both cases. It is up to the developer to
decide if the implementation is secure.</p>
<p>For <a href="https://github.com/thejoshwolfe/yauzl">yauzl</a> module</p>
<pre>
const yauzl = require('yauzl');

const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB
const THRESHOLD_RATIO = 10;

yauzl.open('foo.zip', function (err, zipfile) {
  if (err) throw err;

  let fileCount = 0;
  let totalSize = 0;

  zipfile.on("entry", function(entry) {
    fileCount++;
    if (fileCount &gt; MAX_FILES) {
      throw 'Reached max. number of files';
    }

    // The uncompressedSize comes from the zip headers, so it might not be trustworthy.
    // Alternatively, calculate the size from the readStream.
    let entrySize = entry.uncompressedSize;
    totalSize += entrySize;
    if (totalSize &gt; MAX_SIZE) {
      throw 'Reached max. size';
    }

    if (entry.compressedSize &gt; 0) {
      let compressionRatio = entrySize / entry.compressedSize;
      if (compressionRatio &gt; THRESHOLD_RATIO) {
        throw 'Reached max. compression ratio';
      }
    }

    zipfile.openReadStream(entry, function(err, readStream) {
      if (err) throw err;
      // TODO: extract
    });
  });
});
</pre>
<p>Be aware that due to the similar structure of sensitive and compliant code the issue will be raised in both cases. It is up to the developer to
decide if the implementation is secure.</p>
<p>For <a href="https://github.com/maxogden/extract-zip">extract-zip</a> module:</p>
<pre>
const extract = require('extract-zip')

const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB
const THRESHOLD_RATIO = 10;

async function main() {
  let fileCount = 0;
  let totalSize = 0;

  let target = __dirname + '/foo';
  await extract('foo.zip', {
    dir: target,
    onEntry: function(entry, zipfile) {
      fileCount++;
      if (fileCount &gt; MAX_FILES) {
        throw 'Reached max. number of files';
      }

      // The uncompressedSize comes from the zip headers, so it might not be trustworthy.
      // Alternatively, calculate the size from the readStream.
      let entrySize = entry.uncompressedSize;
      totalSize += entrySize;
      if (totalSize &gt; MAX_SIZE) {
        throw 'Reached max. size';
      }

      if (entry.compressedSize &gt; 0) {
        let compressionRatio = entrySize / entry.compressedSize;
        if (compressionRatio &gt; THRESHOLD_RATIO) {
          throw 'Reached max. compression ratio';
        }
      }
    }
  });
}
main();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/409">MITRE, CWE-409</a> - Improper Handling of Highly Compressed Data (Data Amplification)
  </li>
  <li> <a href="https://www.bamsoftware.com/hacks/zipbomb/">bamsoftware.com</a> - A better Zip Bomb </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6252"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6252">
              typescript:S6252
            </a>
          </td>
          <td >
            <details>
              <p>S3 buckets can be versioned. When the S3 bucket is unversioned it means that a new version of an object overwrites an existing one in the S3
bucket.</p>
<p>It can lead to unintentional or intentional information loss.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The bucket stores information that require high availability. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>
<h2>Sensitive Code Example</h2>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    versioned: false // Sensitive
});
</pre>
<p>The default value of <code>versioned</code> is <code>false</code> so the absence of this parameter is also sensitive.</p>
<h2>Compliant Solution</h2>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    versioned: true
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html">AWS documentation</a> - Using versioning in S3 buckets </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html#versioned">AWS CDK version 2</a> - Using versioning in S3
  buckets </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="typescript:S4787"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4787">
              typescript:S4787
            </a>
          </td>
          <td >
            <details>
              <p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902">CVE-2017-7902</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378">CVE-2006-1378</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376">CVE-2003-1376</a> </li>
</ul>
<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed
regularly. However these are not the only means to defeat or weaken an encryption.</p>
<p>This rule flags function calls that initiate encryption/decryption.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>
  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>
  <li> the key exchange is made without properly authenticating the receiver. </li>
  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time
  passes. </li>
  <li> the chosen encryption library is deemed unsafe. </li>
  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>
  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.
  </li>
  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random
  algorithm, or it is reused. </li>
  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.
  </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Generate encryption keys using secure random algorithms. </li>
  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force
  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.
  </li>
  <li> Regenerate the keys regularly. </li>
  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>
  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>
  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are
  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most
  probably have flaws. </li>
  <li> When a nonce is used, generate it randomly every time. </li>
  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>
  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks
  like "Chosen-Plaintext Attacks". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption
  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>
  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be
  preferred to the following combinations which are not secured:
    <ul>
      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it
      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in
      cryptographic protocols at all. </li>
      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
// === Client side ===
crypto.subtle.encrypt(algo, key, plainData); // Sensitive
crypto.subtle.decrypt(algo, key, encData); // Sensitive
</pre>
<pre>
// === Server side ===
const crypto = require("crypto");
const cipher = crypto.createCipher(algo, key); // Sensitive
const cipheriv = crypto.createCipheriv(algo, key, iv); // Sensitive
const decipher = crypto.createDecipher(algo, key); // Sensitive
const decipheriv = crypto.createDecipheriv(algo, key, iv); // Sensitive
const pubEnc = crypto.publicEncrypt(key, buf); // Sensitive
const privDec = crypto.privateDecrypt({ key: key, passphrase: secret }, pubEnc); // Sensitive
const privEnc = crypto.privateEncrypt({ key: key, passphrase: secret }, buf); // Sensitive
const pubDec = crypto.publicDecrypt(key, privEnc); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/321">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/322">MITRE, CWE-322</a> - Key Exchange without Entity Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/323">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/324">MITRE, CWE-324</a> - Use of a Key Past its Expiration Date </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/325">MITRE, CWE-325</a> - Missing Required Cryptographic Step </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=javascript%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=javascript%3AS5547'>S5547</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S2245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2245">
              typescript:S2245
            </a>
          </td>
          <td >
            <details>
              <p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386">CVE-2013-6386</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419">CVE-2006-3419</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102">CVE-2008-4102</a> </li>
</ul>
<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that
will be generated, and use this guess to impersonate another user or access sensitive information.</p>
<p>As the <code>Math.random()</code> function relies on a weak pseudorandom number generator, this function should not be used for security-critical
applications or for protecting sensitive data. In such context, a cryptographically strong pseudorandom number generator (CSPRNG) should be used
instead.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such
  as a password, is hashed. </li>
  <li> the function you use generates a value which can be predicted (pseudo-random). </li>
  <li> the generated value is used multiple times. </li>
  <li> an attacker can access the generated value. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a cryptographically strong pseudorandom number generator (CSPRNG) like <code>crypto.getRandomValues()</code>. </li>
  <li> Use the generated random values only once. </li>
  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
const val = Math.random(); // Sensitive
// Check if val is used in a security context.
</pre>
<h2>Compliant Solution</h2>
<pre>
// === Client side ===
const crypto = window.crypto || window.msCrypto;
var array = new Uint32Array(1);
crypto.getRandomValues(array); // Compliant for security-sensitive use cases

// === Server side ===
const crypto = require('crypto');
const buf = crypto.randomBytes(1); // Compliant for security-sensitive use cases
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/338">MITRE, CWE-338</a> - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1241">MITRE, CWE-1241</a> - Use of Predictable Algorithm in Random Number Generator </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM">Predictable Pseudo Random Number
  Generator</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="typescript:S5757"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5757">
              typescript:S5757
            </a>
          </td>
          <td >
            <details>
              <p>Log management is an important topic, especially for the security of a web application, to ensure user activity, including potential attackers, is
recorded and available for an analyst to understand what’s happened on the web application in case of malicious activities.</p>
<p>Retention of specific logs for a defined period of time is often necessary to comply with regulations such as GDPR, <a
href="https://www.pcisecuritystandards.org/documents/Effective-Daily-Log-Monitoring-Guidance.pdf">PCI DSS</a> and others. However, to protect user’s
privacy, certain informations are forbidden or strongly discouraged from being logged, such as user passwords or credit card numbers, which obviously
should not be stored or at least not in clear text.</p>
<h2>Ask Yourself Whether</h2>
<p>In a production environment:</p>
<ul>
  <li> The web application uses confidential information and logs a significant amount of data. </li>
  <li> Logs are externalized to SIEM or Big Data repositories. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Loggers should be configured with a list of confidential, personal information that will be hidden/masked or removed from logs.</p>
<h2>Sensitive Code Example</h2>
<p>With <a href="https://www.npmjs.com/package/signale">Signale log management framework</a> the code is sensitive when an empty list of secrets is
defined:</p>
<pre>
const { Signale } = require('signale');

const CREDIT_CARD_NUMBERS = fetchFromWebForm()
// here we suppose the credit card numbers are retrieved somewhere and CREDIT_CARD_NUMBERS looks like ["1234-5678-0000-9999", "1234-5678-0000-8888"]; for instance

const options = {
  secrets: []         // empty list of secrets
};

const logger = new Signale(options); // Sensitive

CREDIT_CARD_NUMBERS.forEach(function(CREDIT_CARD_NUMBER) {
  logger.log('The customer ordered products with the credit card number = %s', CREDIT_CARD_NUMBER);
});
</pre>
<h2>Compliant Solution</h2>
<p>With <a href="https://www.npmjs.com/package/signale">Signale log management framework</a> it is possible to define a list of secrets that will be
hidden in logs:</p>
<pre>
const { Signale } = require('signale');

const CREDIT_CARD_NUMBERS = fetchFromWebForm()
// here we suppose the credit card numbers are retrieved somewhere and CREDIT_CARD_NUMBERS looks like ["1234-5678-0000-9999", "1234-5678-0000-8888"]; for instance

const options = {
  secrets: ["([0-9]{4}-?)+"]
};

const logger = new Signale(options); // Compliant

CREDIT_CARD_NUMBERS.forEach(function(CREDIT_CARD_NUMBER) {
  logger.log('The customer ordered products with the credit card number = %s', CREDIT_CARD_NUMBER);
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/532">MITRE, CWE-532</a> - Insertion of Sensitive Information into Log File </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html">OWASP Top 10 2017 Category
  A3</a> - Sensitive Data Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S3330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S3330">
              typescript:S3330
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will
be able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer
to decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target
the theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS
vulnerability to steal session-cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>
  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)
  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /
  sensitive-security cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> module:</p>
<pre>
let session = cookieSession({
  httpOnly: false,// Sensitive
});  // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/express-session">express-session</a> module:</p>
<pre>
const express = require('express'),
const session = require('express-session'),

let app = express()
app.use(session({
  cookie:
  {
    httpOnly: false // Sensitive
  }
})),
</pre>
<p><a href="https://www.npmjs.com/package/cookies">cookies</a> module:</p>
<pre>
let cookies = new Cookies(req, res, { keys: keys });

cookies.set('LastVisit', new Date().toISOString(), {
  httpOnly: false // Sensitive
}); // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/csurf">csurf</a> module:</p>
<pre>
const cookieParser = require('cookie-parser');
const csrf = require('csurf');
const express = require('express');

let csrfProtection = csrf({ cookie: { httpOnly: false }}); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> module:</p>
<pre>
let session = cookieSession({
  httpOnly: true,// Compliant
});  // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/express-session">express-session</a> module:</p>
<pre>
const express = require('express');
const session = require('express-session');

let app = express();
app.use(session({
  cookie:
  {
    httpOnly: true // Compliant
  }
}));
</pre>
<p><a href="https://www.npmjs.com/package/cookies">cookies</a> module:</p>
<pre>
let cookies = new Cookies(req, res, { keys: keys });

cookies.set('LastVisit', new Date().toISOString(), {
  httpOnly: true // Compliant
}); // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/csurf">csurf</a> module:</p>
<pre>
const cookieParser = require('cookie-parser');
const csrf = require('csurf');
const express = require('express');

let csrfProtection = csrf({ cookie: { httpOnly: true }}); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/HttpOnly">OWASP HttpOnly</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1004">MITRE, CWE-1004</a> - Sensitive Cookie Without 'HttpOnly' Flag </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE">HTTPONLY_COOKIE</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4784"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4784">
              typescript:S4784
            </a>
          </td>
          <td >
            <details>
              <p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021">CVE-2017-16021</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863">CVE-2018-13863</a> </li>
</ul>
<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as
<code>(a+)+s</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with
every additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular
expression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>
<p>Evaluating such regular expressions opens the door to <a
href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">Regular expression Denial of Service (ReDoS)</a> attacks.
In the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making
the service inaccessible to genuine users.</p>
<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and at least two instances of any of the following
characters: <code>*+{</code>.</p>
<p>Example: <code>(a+)*</code></p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>
  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for
vulnerability reports mentioning the one engine you’re are using.</p>
<p>Use if possible a library which is not vulnerable to Redos Attacks such as <a href="https://github.com/google/re2">Google Re2</a>.</p>
<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>
<h2>Sensitive Code Example</h2>
<pre>
const regex = /(a+)+b/; // Sensitive
const regex2 = new RegExp("(a+)+b"); // Sensitive

str.search("(a+)+b"); // Sensitive
str.match("(a+)+b"); // Sensitive
str.split("(a+)+b"); // Sensitive
</pre>
<p>Note: String.matchAll does not raise any issue as it is not supported by NodeJS.</p>
<h2>Exceptions</h2>
<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,
<code>(a|a?)+</code>.</p>
<p>It is a good idea to test your regular expression if it has the same pattern on both side of a "<code>|</code>".</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">MITRE, CWE-624</a> - Executable Regular
  Expression Error </li>
  <li> OWASP Regular expression Denial of Service - ReDoS </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS5852'>S5852</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5759"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5759">
              typescript:S5759
            </a>
          </td>
          <td >
            <details>
              <p>Users often connect to web servers through HTTP proxies.</p>
<p>Proxy can be configured to forward the client IP address via the <code>X-Forwarded-For</code> or <code>Forwarded</code> HTTP headers.</p>
<p>IP address is a personal information which can identify a single user and thus impact his privacy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The web application uses reverse proxies or similar but doesn’t need to know the IP address of the user. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>User IP address should not be forwarded unless the application needs it, as part of an authentication, authorization scheme or log management for
examples.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://github.com/http-party/node-http-proxy">node-http-proxy</a></p>
<pre>
var httpProxy = require('http-proxy');

httpProxy.createProxyServer({target:'http://localhost:9000', xfwd:true}) // Noncompliant
  .listen(8000);
</pre>
<p><a href="https://github.com/chimurai/http-proxy-middleware">http-proxy-middleware</a></p>
<pre>
var express = require('express');

const { createProxyMiddleware } = require('http-proxy-middleware');

const app = express();

app.use('/proxy', createProxyMiddleware({ target: 'http://localhost:9000', changeOrigin: true, xfwd: true })); // Noncompliant
app.listen(3000);
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://github.com/http-party/node-http-proxy">node-http-proxy</a></p>
<pre>
var httpProxy = require('http-proxy');

// By default xfwd option is false
httpProxy.createProxyServer({target:'http://localhost:9000'}) // Compliant
  .listen(8000);
</pre>
<p><a href="https://github.com/chimurai/http-proxy-middleware">http-proxy-middleware</a></p>
<pre>
var express = require('express');

const { createProxyMiddleware } = require('http-proxy-middleware');

const app = express();

// By default xfwd option is false
app.use('/proxy', createProxyMiddleware({ target: 'http://localhost:9000', changeOrigin: true})); // Compliant
app.listen(3000);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html">OWASP Top 10 2017 Category
  A3</a> - Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For">developer.mozilla.org</a> - X-Forwarded-For </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6281"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6281">
              typescript:S6281
            </a>
          </td>
          <td >
            <details>
              <p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>
<p>This access control can be relaxed with ACLs or policies.</p>
<p>To prevent permissive policies or ACLs to be set on a S3 bucket the following booleans settings can be enabled:</p>
<ul>
  <li> <code>blockPublicAcls</code>: to block or not public ACLs to be set to the S3 bucket. </li>
  <li> <code>ignorePublicAcls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>
  <li> <code>blockPublicPolicy</code>: to block or not public policies to be set to the S3 bucket. </li>
  <li> <code>restrictPublicBuckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket
  owner account. </li>
</ul>
<p>The other attribute <code>BlockPublicAccess.BLOCK_ACLS</code> only turns on <code>blockPublicAcls</code> and <code>ignorePublicAcls</code>. The
public policies can still affect the S3 bucket.</p>
<p>However, all of those options can be enabled by setting the <code>blockPublicAccess</code> property of the S3 bucket to
<code>BlockPublicAccess.BLOCK_ALL</code>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>
  <li> These settings are not already enforced to true at the account level. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to configure:</p>
<ul>
  <li> <code>blockPublicAcls</code> to <code>True</code> to block new attempts to set public ACLs. </li>
  <li> <code>ignorePublicAcls</code> to <code>True</code> to block existing public ACLs. </li>
  <li> <code>blockPublicPolicy</code> to <code>True</code> to block new attempts to set public policies. </li>
  <li> <code>restrictPublicBuckets</code> to <code>True</code> to restrict existing public policies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>By default, when not set, the <code>blockPublicAccess</code> is fully deactivated (nothing is blocked):</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket'
}); // Sensitive
</pre>
<p>This <code>block_public_access</code> allows public ACL to be set:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    blockPublicAccess: new s3.BlockPublicAccess({
        blockPublicAcls         : false, // Sensitive
        blockPublicPolicy       : true,
        ignorePublicAcls        : true,
        restrictPublicBuckets   : true
    })
});
</pre>
<p>The attribute <code>BLOCK_ACLS</code> only blocks and ignores public ACLs:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ACLS // Sensitive
});
</pre>
<h2>Compliant Solution</h2>
<p>This <code>blockPublicAccess</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public policies:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL
});
</pre>
<p>A similar configuration to the one above can be obtained by setting all parameters of the <code>blockPublicAccess</code></p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    blockPublicAccess: new s3.BlockPublicAccess({
        blockPublicAcls         : true,
        blockPublicPolicy       : true,
        ignorePublicAcls        : true,
        restrictPublicBuckets   : true
    })
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html">AWS Documentation</a> - Blocking public
  access to your Amazon S3 storage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BlockPublicAccess.html">AWS CDK version 2</a> - BlockPublicAccess </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S2255"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2255">
              typescript:S2255
            </a>
          </td>
          <td >
            <details>
              <p>Using cookies is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11639">CVE-2018-11639</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6537">CVE-2016-6537</a> </li>
</ul>
<p>Attackers can use widely-available tools to read cookies. Any sensitive information they may contain will be exposed.</p>
<p>This rule flags code that writes cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sensitive information is stored inside the cookie. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Cookies should only be used to manage the user session. The best practice is to keep all user-related information server-side and link them to the
user session, never sending them to the client. In a very few corner cases, cookies can be used for non-sensitive information that need to live longer
than the user session.</p>
<p>Do not try to encode sensitive information in a non human-readable format before writing them in a cookie. The encoding can be reverted and the
original information will be exposed.</p>
<p>Using cookies only for session IDs doesn’t make them secure. Follow <a
href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies">OWASP best practices</a> when you configure your
cookies.</p>
<p>As a side note, every information read from a cookie should be <a
href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitized</a>.</p>
<h2>Sensitive Code Example</h2>
<pre>
// === Built-in NodeJS modules ===
const http = require('http');
const https = require('https');

http.createServer(function(req, res) {
  res.setHeader('Set-Cookie', ['type=ninja', 'lang=js']); // Sensitive
});
https.createServer(function(req, res) {
  res.setHeader('Set-Cookie', ['type=ninja', 'lang=js']); // Sensitive
});
</pre>
<pre>
// === ExpressJS ===
const express = require('express');
const app = express();
app.use(function(req, res, next) {
  res.cookie('name', 'John'); // Sensitive
});
</pre>
<pre>
// === In browser ===
// Set cookie
document.cookie = "name=John"; // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/312">MITRE, CWE-312</a> - Cleartext Storage of Sensitive Information </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#COOKIE_USAGE">COOKIE_USAGE</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="typescript:S4790"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4790">
              typescript:S4790
            </a>
          </td>
          <td >
            <details>
              <p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,
<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,
<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little
computational effort is enough to find two or more different inputs that produce the same hash).</p>
<h2>Ask Yourself Whether</h2>
<p>The hashed value is used in a security context like:</p>
<ul>
  <li> User-password storage. </li>
  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>
  <li> To compute some message integrity. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even
better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>
because it slows down <code>brute force attacks</code>.</p>
<h2>Sensitive Code Example</h2>
<pre>
const crypto = require("crypto");

const hash = crypto.createHash('sha1'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
const crypto = require("crypto");

const hash = crypto.createHash('sha512'); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1240">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="typescript:S6299"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6299">
              typescript:S6299
            </a>
          </td>
          <td >
            <details>
              <p>Vue.js framework prevents XSS vulnerabilities by automatically escaping HTML contents with the use of native API browsers like
<code>innerText</code> instead of <code>innerHtml</code>.</p>
<p>It’s still possible to explicity use <code>innerHtml</code> and similar APIs to render HTML. Accidentally rendering malicious HTML data will
introduce an XSS vulnerability in the application and enable a wide range of serious attacks like accessing/modifying sensitive information or
impersonating other users.</p>
<h2>Ask Yourself Whether</h2>
<p>The application needs to render HTML content which:</p>
<ul>
  <li> could be user-controlled and not previously sanitized. </li>
  <li> is difficult to understand how it was constructed. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Avoid injecting HTML content with <code>v-html</code> directive unless the content can be considered 100% safe, instead try to rely as much as
  possible on built-in auto-escaping Vue.js features. </li>
  <li> Take care when using the <code>v-bind:href</code> directive to set URLs which can contain malicious Javascript
  (<code>javascript:onClick(...)</code>). </li>
  <li> Event directives like <code>:onmouseover</code> are also prone to Javascript injection and should not be used with unsafe values. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>When using Vue.js templates, the <code>v-html</code> directive enables HTML rendering without any sanitization:</p>
<pre>
&lt;div v-html="htmlContent"&gt;&lt;/div&gt; &lt;!-- Noncompliant --&gt;
</pre>
<p>When using a rendering function, the <code>innerHTML</code> attribute enables HTML rendering without any sanitization:</p>
<pre>
Vue.component('element', {
  render: function (createElement) {
    return createElement(
      'div',
      {
        domProps: {
          innerHTML: this.htmlContent, // Noncompliant
        }
      }
    );
  },
});
</pre>
<p>When using JSX, the <code>domPropsInnerHTML</code> attribute enables HTML rendering without any sanitization:</p>
<pre>
&lt;div domPropsInnerHTML={this.htmlContent}&gt;&lt;/div&gt; &lt;!-- Noncompliant --&gt;
</pre>
<h2>Compliant Solution</h2>
<p>When using Vue.js templates, putting the content as a child node of the element is safe:</p>
<pre>
&lt;div&gt;{{ htmlContent }}&lt;/div&gt;
</pre>
<p>When using a rendering function, using the <code>innerText</code> attribute or putting the content as a child node of the element is safe:</p>
<pre>
Vue.component('element', {
  render: function (createElement) {
    return createElement(
      'div',
      {
        domProps: {
          innerText: this.htmlContent,
        }
      },
      this.htmlContent // Child node
    );
  },
});
</pre>
<p>When using JSX, putting the content as a child node of the element is safe:</p>
<pre>
&lt;div&gt;{this.htmlContent}&lt;/div&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
  <li> <a href="https://vuejs.org/v2/guide/security.html#Injecting-HTML">Vue.js - Security - Injecting HTML</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6304"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6304">
              typescript:S6304
            </a>
          </td>
          <td >
            <details>
              <p>A policy that allows identities to access all resources in an AWS account may violate <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity has permission to access
all resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive
information will occur.</p>
<h2>Ask Yourself Whether</h2>
<p>The AWS account has more than one resource with different levels of sensitivity.</p>
<p>A risk exists if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is
to organize or <a
href="https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/">tag</a>
resources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>
<h2>Noncompliant Code Example</h2>
<p>The wildcard <code>"*"</code> is specified as the resource for this <code>PolicyStatement</code>. This grants the update permission for all
policies of the account:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'

new iam.PolicyDocument({
    statements: [
        new iam.PolicyStatement({
            effect: iam.Effect.ALLOW,
            actions: ["iam:CreatePolicyVersion"],
            resources: ["*"] // Sensitive
        })
    ]
})
</pre>
<h2>Compliant Solution</h2>
<p>Restrict the update permission to the appropriate subset of policies:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'

new iam.PolicyDocument({
    statements: [
        new iam.PolicyStatement({
            effect: iam.Effect.ALLOW,
            actions: ["iam:CreatePolicyVersion"],
            resources: ["arn:aws:iam:::policy/team1/*"]
        })
    ]
})
</pre>
<h2>Exceptions</h2>
<ul>
  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>
  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2068">
              typescript:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
var mysql = require('mysql');

var connection = mysql.createConnection(
{
  host:'localhost',
  user: "admin",
  database: "project",
  password: "mypassword", // sensitive
  multipleStatements: true
});

connection.connect();
</pre>
<h2>Compliant Solution</h2>
<pre>
var mysql = require('mysql');

var connection = mysql.createConnection({
  host: process.env.MYSQL_URL,
  user: process.env.MYSQL_USERNAME,
  password: process.env.MYSQL_PASSWORD,
  database: process.env.MYSQL_DATABASE
});
connection.connect();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5332">
              typescript:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<pre>
url = "http://example.com"; // Sensitive
url = "ftp://anonymous@example.com"; // Sensitive
url = "telnet://anonymous@example.com"; // Sensitive
</pre>
<p>For <a href="https://nodemailer.com">nodemailer</a>:</p>
<pre>
const nodemailer = require("nodemailer");
let transporter = nodemailer.createTransport({
  secure: false, // Sensitive
  requireTLS: false // Sensitive
});
</pre>
<pre>
const nodemailer = require("nodemailer");
let transporter = nodemailer.createTransport({}); // Sensitive
</pre>
<p>For <a href="https://github.com/mscdex/node-ftp">ftp</a>:</p>
<pre>
var Client = require('ftp');
var c = new Client();
c.connect({
  'secure': false // Sensitive
});
</pre>
<p>For <a href="https://github.com/mkozjak/node-telnet-client">telnet-client</a>:</p>
<pre>
const Telnet = require('telnet-client'); // Sensitive
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>
<pre>
import { ApplicationLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

const alb = new ApplicationLoadBalancer(this, 'ALB', {
  vpc: vpc,
  internetFacing: true
});

alb.addListener('listener-http-default', {
  port: 8080,
  open: true
}); // Sensitive

alb.addListener('listener-http-explicit', {
  protocol: ApplicationProtocol.HTTP, // Sensitive
  port: 8080,
  open: true
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationListener</a>:</p>
<pre>
import { ApplicationListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new ApplicationListener(this, 'listener-http-explicit-constructor', {
  loadBalancer: alb,
  protocol: ApplicationProtocol.HTTP, // Sensitive
  port: 8080,
  open: true
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>
<pre>
import { NetworkLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

const nlb = new NetworkLoadBalancer(this, 'nlb', {
  vpc: vpc,
  internetFacing: true
});

var listenerNLB = nlb.addListener('listener-tcp-default', {
  port: 1234
}); // Sensitive

listenerNLB = nlb.addListener('listener-tcp-explicit', {
  protocol: Protocol.TCP, // Sensitive
  port: 1234
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkListener</a>:</p>
<pre>
import { NetworkListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new NetworkListener(this, 'listener-tcp-explicit-constructor', {
  loadBalancer: nlb,
  protocol: Protocol.TCP, // Sensitive
  port: 8080
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.CfnListener</a>:</p>
<pre>
import { CfnListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new CfnListener(this, 'listener-http', {
  defaultActions: defaultActions,
  loadBalancerArn: alb.loadBalancerArn,
  protocol: "HTTP", // Sensitive
  port: 80
});

new CfnListener(this, 'listener-tcp', {
  defaultActions: defaultActions,
  loadBalancerArn: alb.loadBalancerArn,
  protocol: "TCP", // Sensitive
  port: 80
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.CfnLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancing.CfnLoadBalancer</a>:</p>
<pre>
import { CfnLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';

new CfnLoadBalancer(this, 'elb-tcp', {
  listeners: [{
    instancePort: '1000',
    loadBalancerPort: '1000',
    protocol: 'tcp' // Sensitive
  }]
});

new CfnLoadBalancer(this, 'elb-http', {
  listeners: [{
    instancePort: '1000',
    loadBalancerPort: '1000',
    protocol: 'http' // Sensitive
  }]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.LoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancing.LoadBalancer</a>:</p>
<pre>
import { LoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';

const loadBalancer = new LoadBalancer(this, 'elb-tcp-dict', {
    vpc,
    internetFacing: true,
    healthCheck: {
    port: 80,
    },
    listeners: [
    {
        externalPort:10000,
        externalProtocol: LoadBalancingProtocol.TCP, // Sensitive
        internalPort:10000
    }]
});

loadBalancer.addListener({
  externalPort:10001,
  externalProtocol:LoadBalancingProtocol.TCP, // Sensitive
  internalPort:10001
});
loadBalancer.addListener({
  externalPort:10002,
  externalProtocol:LoadBalancingProtocol.HTTP, // Sensitive
  internalPort:10002
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticache.CfnReplicationGroup.html">aws-cdk-lib.aws-elasticache.CfnReplicationGroup</a>:</p>
<pre>
import { CfnReplicationGroup } from 'aws-cdk-lib/aws-elasticache';

new CfnReplicationGroup(this, 'unencrypted-implicit', {
  replicationGroupDescription: 'exampleDescription'
}); // Sensitive

new CfnReplicationGroup(this, 'unencrypted-explicit', {
  replicationGroupDescription: 'exampleDescription',
  transitEncryptionEnabled: false // Sensitive
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.CfnStream.html">aws-cdk-lib.aws-kinesis.CfnStream</a>:</p>
<pre>
import { CfnStream } from 'aws-cdk-lib/aws-kinesis';

new CfnStream(this, 'cfnstream-implicit-unencrytped', undefined); // Sensitive

new CfnStream(this, 'cfnstream-explicit-unencrytped', {
  streamEncryption: undefined // Sensitive
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.Stream.html">aws-cdk-lib.aws-kinesis.Stream</a>:</p>
<pre>
import { Stream } from 'aws-cdk-lib/aws-kinesis';

new Stream(this, 'stream-explicit-unencrypted', {
  encryption: StreamEncryption.UNENCRYPTED // Sensitive
});
</pre>
<h2>Compliant Solution</h2>
<pre>
url = "https://example.com";
url = "sftp://anonymous@example.com";
url = "ssh://anonymous@example.com";
</pre>
<p>For <a href="https://nodemailer.com">nodemailer</a> one of the following options must be set:</p>
<pre>
const nodemailer = require("nodemailer");
let transporter = nodemailer.createTransport({
  secure: true,
  requireTLS: true,
  port: 465,
  secured: true
});
</pre>
<p>For <a href="https://github.com/mscdex/node-ftp">ftp</a>:</p>
<pre>
var Client = require('ftp');
var c = new Client();
c.connect({
  'secure': true
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>
<pre>
import { ApplicationLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

const alb = new ApplicationLoadBalancer(this, 'ALB', {
  vpc: vpc,
  internetFacing: true
});

alb.addListener('listener-https-explicit', {
  protocol: ApplicationProtocol.HTTPS,
  port: 8080,
  open: true,
  certificates: [certificate]
});

alb.addListener('listener-https-implicit', {
  port: 8080,
  open: true,
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationListener</a>:</p>
<pre>
import { ApplicationListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new ApplicationListener(this, 'listener-https-explicit', {
  loadBalancer: loadBalancer,
  protocol: ApplicationProtocol.HTTPS,
  port: 8080,
  open: true,
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>
<pre>
import { NetworkLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

const nlb = new NetworkLoadBalancer(this, 'nlb', {
  vpc: vpc,
  internetFacing: true
});

nlb.addListener('listener-tls-explicit', {
  protocol: Protocol.TLS,
  port: 1234,
  certificates: [certificate]
});

nlb.addListener('listener-tls-implicit', {
  port: 1234,
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkListener</a>:</p>
<pre>
import { NetworkListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new NetworkListener(this, 'listener-tls-explicit', {
  loadBalancer: loadBalancer,
  protocol: Protocol.TLS,
  port: 8080,
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.CfnListener</a>:</p>
<pre>
import { CfnListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new CfnListener(this, 'listener-https', {
  defaultActions: defaultActions,
  loadBalancerArn: loadBalancerArn,
  protocol: "HTTPS",
  port: 80
  certificates: [certificate]
});

new CfnListener(this, 'listener-tls', {
  defaultActions: defaultActions,
  loadBalancerArn: loadBalancerArn,
  protocol: "TLS",
  port: 80
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.CfnLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancing.CfnLoadBalancer</a>:</p>
<pre>
import { CfnLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';

new CfnLoadBalancer(this, 'elb-ssl', {
  listeners: [{
    instancePort: '1000',
    loadBalancerPort: '1000',
    protocol: 'ssl',
    sslCertificateId: sslCertificateId
  }]
});

new CfnLoadBalancer(this, 'elb-https', {
  listeners: [{
    instancePort: '1000',
    loadBalancerPort: '1000',
    protocol: 'https',
    sslCertificateId: sslCertificateId
  }]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.LoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancing.LoadBalancer</a>:</p>
<pre>
import { LoadBalancer, LoadBalancingProtocol } from 'aws-cdk-lib/aws-elasticloadbalancing';

const lb = new LoadBalancer(this, 'elb-ssl', {
  vpc,
  internetFacing: true,
  healthCheck: {
    port: 80,
  },
  listeners: [
    {
      externalPort:10000,
      externalProtocol:LoadBalancingProtocol.SSL,
      internalPort:10000
    }]
});

lb.addListener({
  externalPort:10001,
  externalProtocol:LoadBalancingProtocol.SSL,
  internalPort:10001
});
lb.addListener({
  externalPort:10002,
  externalProtocol:LoadBalancingProtocol.HTTPS,
  internalPort:10002
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticache.CfnReplicationGroup.html">aws-cdk-lib.aws-elasticache.CfnReplicationGroup</a>:</p>
<pre>
import { CfnReplicationGroup } from 'aws-cdk-lib/aws-elasticache';

new CfnReplicationGroup(this, 'encrypted-explicit', {
  replicationGroupDescription: 'example',
  transitEncryptionEnabled: true
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.Stream.html">aws-cdk-lib.aws-kinesis.Stream</a>:</p>
<pre>
import { Stream } from 'aws-cdk-lib/aws-kinesis';

new Stream(this, 'stream-implicit-encrypted');

new Stream(this, 'stream-explicit-encrypted-selfmanaged', {
  encryption: StreamEncryption.KMS,
  encryptionKey: encryptionKey,
});

new Stream(this, 'stream-explicit-encrypted-managed', {
  encryption: StreamEncryption.MANAGED
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.CfnStream.html">aws-cdk-lib.aws-kinesis.CfnStream</a>:</p>
<pre>
import { CfnStream } from 'aws-cdk-lib/aws-kinesis';

new CfnStream(this, 'cfnstream-explicit-encrypted', {
  streamEncryption: {
    encryptionType: encryptionType,
    keyId: encryptionKey.keyId,
  }
});
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6303"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6303">
              typescript:S6303
            </a>
          </td>
          <td >
            <details>
              <p>Using unencrypted RDS DB resources exposes data to unauthorized access to the underlying storage.<br> This includes database data, logs, automatic
backups, read replicas, snapshots, and cluster metadata.</p>
<p>This situation can occur in a variety of scenarios, such as:</p>
<ul>
  <li> a malicious insider working at the cloud provider gains physical access to the storage device and exfiltrates data. </li>
  <li> unknown attackers penetrate the cloud provider’s logical infrastructure and systems for extortion. </li>
</ul>
<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is
required as encryption at rest is fully managed by AWS.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html"><code>aws-cdk-lib.aws_rds.CfnDBCluster</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

new rds.CfnDBCluster(this, 'example', {
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html"><code>aws-cdk-lib.aws_rds.CfnDBInstance</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

new rds.CfnDBInstance(this, 'example', {
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html"><code>aws-cdk-lib.aws_rds.DatabaseCluster</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';
import { aws_ec2 as ec2 } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

const cluster = new rds.DatabaseCluster(this, 'example', {
  engine: rds.DatabaseClusterEngine.auroraMysql({ version: rds.AuroraMysqlEngineVersion.VER_2_08_1 }),
  instanceProps: {
    vpcSubnets: {
      subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,
    },
    vpc,
  },
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot.html"><code>aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

new rds.DatabaseClusterFromSnapshot(this, 'example', {
  engine: rds.DatabaseClusterEngine.aurora({ version: rds.AuroraEngineVersion.VER_1_22_2 }),
  instanceProps: {
    vpc,
  },
  snapshotIdentifier: 'exampleSnapshot',
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html"><code>aws-cdk-lib.aws_rds.DatabaseInstance</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

new rds.DatabaseInstance(this, 'example', {
  engine: rds.DatabaseInstanceEngine.POSTGRES,
  vpc,
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica.html"><code>aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const sourceInstance: rds.DatabaseInstance;

new rds.DatabaseInstanceReadReplica(this, 'example', {
  sourceDatabaseInstance: sourceInstance,
  instanceType: ec2.InstanceType.of(ec2.InstanceClass.BURSTABLE2, ec2.InstanceSize.LARGE),
  vpc,
  storageEncrypted: false, // Sensitive
});
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html"><code>aws-cdk-lib.aws_rds.CfnDBCluster</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

new rds.CfnDBCluster(this, 'example', {
  storageEncrypted: true,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html"><code>aws-cdk-lib.aws_rds.CfnDBInstance</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

new rds.CfnDBInstance(this, 'example', {
  storageEncrypted: true,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html"><code>aws-cdk-lib.aws_rds.DatabaseCluster</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

const cluster = new rds.DatabaseCluster(this, 'example', {
  engine: rds.DatabaseClusterEngine.auroraMysql({ version: rds.AuroraMysqlEngineVersion.VER_2_08_1 }),
  instanceProps: {
    vpcSubnets: {
      subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,
    },
    vpc,
  },
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot.html"><code>aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

new rds.DatabaseClusterFromSnapshot(this, 'example', {
  engine: rds.DatabaseClusterEngine.aurora({ version: rds.AuroraEngineVersion.VER_1_22_2 }),
  instanceProps: {
    vpc,
  },
  snapshotIdentifier: 'exampleSnapshot',
  storageEncrypted: true,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html"><code>aws-cdk-lib.aws_rds.DatabaseInstance</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

new rds.DatabaseInstance(this, 'example', {
  engine: rds.DatabaseInstanceEngine.POSTGRES,
  vpc,
  storageEncrypted: true,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica.html"><code>aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const sourceInstance: rds.DatabaseInstance;

new rds.DatabaseInstanceReadReplica(this, 'example', {
  sourceDatabaseInstance: sourceInstance,
  instanceType: ec2.InstanceType.of(ec2.InstanceClass.BURSTABLE2, ec2.InstanceSize.LARGE),
  vpc,
  storageEncrypted: true,
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html">AWS Documentation</a> - Encrypting Amazon RDS
  resources </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6302"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6302">
              typescript:S6302
            </a>
          </td>
          <td >
            <details>
              <p>A policy that grants all permissions may indicate an improper access control, which violates <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity is granted full
permissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources
may occur and therefore result in loss of information.</p>
<h2>Ask Yourself Whether</h2>
<p>Identities obtaining all the permissions:</p>
<ul>
  <li> only require a subset of these permissions to perform the intended function. </li>
  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start
with the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in
production, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>
<h2>Sensitive Code Example</h2>
<p>A customer-managed policy that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'

new iam.PolicyStatement({
    effect: iam.Effect.ALLOW,
    actions: ["*"], // Sensitive
    resources: ["arn:aws:iam:::user/*"],
})
</pre>
<h2>Compliant Solution</h2>
<p>A customer-managed policy that grants only the required permissions:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'

new iam.PolicyStatement({
    effect: iam.Effect.ALLOW,
    actions: ["iam:GetAccountSummary"],
    resources: ["arn:aws:iam:::user/*"],
})
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cloud.google.com/iam/docs/understanding-roles">Google Cloud Documentation</a> - Understanding roles </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6308"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6308">
              typescript:S6308
            </a>
          </td>
          <td >
            <details>
              <p>Amazon OpenSearch Service is a managed service to host OpenSearch instances. It replaces Elasticsearch Service, which has been deprecated.</p>
<p>To harden domain (cluster) data in case of unauthorized access, OpenSearch provides data-at-rest encryption if the engine is OpenSearch (any
version), or Elasticsearch with a version of 5.1 or above. Enabling encryption at rest will help protect:</p>
<ul>
  <li> indices </li>
  <li> logs </li>
  <li> swap files </li>
  <li> data in the application directory </li>
  <li> automated snapshots </li>
</ul>
<p>Thus, adversaries cannot access the data if they gain physical access to the storage medium.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to encrypt OpenSearch domains that contain sensitive information.</p>
<p>OpenSearch handles encryption and decryption transparently, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>
<pre>
import { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';

const exampleDomain = new opensearchservice.Domain(this, 'ExampleDomain', {
  version: EngineVersion.OPENSEARCH_1_3,
}); // Sensitive, encryption must be explicitly enabled
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.CfnDomain.html">aws-cdk-lib.aws_opensearchservice.CfnDomain</a>:</p>
<pre>
import { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';

const exampleCfnDomain = new opensearchservice.CfnDomain(this, 'ExampleCfnDomain', {
  engineVersion: 'OpenSearch_1.3',
}); // Sensitive, encryption must be explicitly enabled
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>
<pre>
import { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';

const exampleDomain = new opensearchservice.Domain(this, 'ExampleDomain', {
  version: EngineVersion.OPENSEARCH_1_3,
  encryptionAtRest: {
    enabled: true,
  },
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.CfnDomain.html">aws-cdk-lib.aws_opensearchservice.CfnDomain</a>:</p>
<pre>
import { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';

const exampleCfnDomain = new opensearchservice.CfnDomain(this, 'ExampleCfnDomain', {
  engineVersion: 'OpenSearch_1.3',
  encryptionAtRestOptions: {
    enabled: true,
  },
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/opensearch-service/latest/developerguide/encryption-at-rest.html">AWS Documentation</a> - Encryption of
  data at rest for Amazon OpenSearch Service </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5691"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5691">
              typescript:S5691
            </a>
          </td>
          <td >
            <details>
              <p>Hidden files are created automatically by many tools to save user-preferences, well-known examples are <code>.profile</code>, <code>.bashrc</code>,
<code>.bash_history</code> or .<code>git</code>. To simplify the view these files are not displayed by default using operating system commands like
<code>ls</code>.</p>
<p>Outside of the user environment, hidden files are sensitive because they are used to store privacy-related information or even hard-coded
secrets.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Hidden files may have been inadvertently uploaded to the static server’s public directory and it accepts requests to hidden files. </li>
  <li> There is no business use cases linked to serve files in <code>.name</code> format but the server is not configured to reject requests to this
  type of files. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Disable the serving of hidden files. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/serve-static">Express.js serve-static</a> middleware:</p>
<pre>
let serveStatic = require("serve-static");
let app = express();
let serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'allow'});   // Sensitive
app.use(serveStaticMiddleware);
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/serve-static">Express.js serve-static</a> middleware:</p>
<pre>
let serveStatic = require("serve-static");
let app = express();
let serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'ignore'});   // Compliant: ignore or deny are recommended values
let serveStaticDefault = serveStatic('public', { 'index': false});   // Compliant: by default, "dotfiles" (file or directory that begins with a dot) are not served (with the exception that files within a directory that begins with a dot are not ignored), see serve-static module documentation
app.use(serveStaticMiddleware);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://github.com/mtojek/go-url-fuzzer">github.com/mtojek/go-url-fuzzer</a> - Discover hidden files and directories on a web server.
  </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Web Top 10 2017 Category A6</a> - Security
  Misconfiguration. </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/538">MITRE, CWE-538</a> - File and Directory Information Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5693"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5693">
              typescript:S5693
            </a>
          </td>
          <td >
            <details>
              <p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in
order to prevents DoS attacks.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> size limits are not defined for the different resources of the web application. </li>
  <li> the web application is not protected by <a href="https://en.wikipedia.org/wiki/Rate_limiting">rate limiting</a> features. </li>
  <li> the web application infrastructure has limited resources. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> For most of the features of an application, it is recommended to limit the size of requests to:
    <ul>
      <li> lower or equal to 8mb for file uploads. </li>
      <li> lower or equal to 2mb for other requests. </li>
    </ul>  </li>
</ul>
<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/formidable">formidable</a> file upload module:</p>
<pre>
const form = new Formidable();
form.maxFileSize = 10000000; // Sensitive: 10MB is more than the recommended limit of 8MB

const formDefault = new Formidable(); // Sensitive, the default value is 200MB
</pre>
<p><a href="https://www.npmjs.com/package/multer">multer</a> (Express.js middleware) file upload module:</p>
<pre>
let diskUpload = multer({
  storage: diskStorage,
  limits: {
    fileSize: 10000000; // Sensitive: 10MB is more than the recommended limit of 8MB
  }
});

let diskUploadUnlimited = multer({ // Sensitive: the default value is no limit
  storage: diskStorage,
});
</pre>
<p><a href="https://www.npmjs.com/package/body-parser">body-parser</a> module:</p>
<pre>
// 4MB is more than the recommended limit of 2MB for non-file-upload requests
let jsonParser = bodyParser.json({ limit: "4mb" }); // Sensitive
let urlencodedParser = bodyParser.urlencoded({ extended: false, limit: "4mb" }); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/formidable">formidable</a> file upload module:</p>
<pre>
const form = new Formidable();
form.maxFileSize = 8000000; // Compliant: 8MB
</pre>
<p><a href="https://www.npmjs.com/package/multer">multer</a> (Express.js middleware) file upload module:</p>
<pre>
let diskUpload = multer({
  storage: diskStorage,
  limits: {
     fileSize: 8000000 // Compliant: 8MB
  }
});
</pre>
<p><a href="https://www.npmjs.com/package/body-parser">body-parser</a> module:</p>
<pre>
let jsonParser = bodyParser.json(); // Compliant, when the limit is not defined, the default value is set to 100kb
let urlencodedParser = bodyParser.urlencoded({ extended: false, limit: "2mb" }); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html">Owasp Cheat Sheet</a> - Owasp Denial of Service
  Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/770">MITRE, CWE-770</a> - Allocation of Resources Without Limits or Throttling </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="typescript:S2077"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2077">
              typescript:S2077
            </a>
          </td>
          <td >
            <details>
              <p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the
query. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=javascript%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted
queries.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some parts of the query come from untrusted values (like user inputs). </li>
  <li> The query is repeated/duplicated in other parts of the code. </li>
  <li> The application must support different types of relational databases. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">parameterized queries, prepared
  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>
  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
// === MySQL ===
const mysql = require('mysql');
const mycon = mysql.createConnection({ host: host, user: user, password: pass, database: db });
mycon.connect(function(err) {
  mycon.query('SELECT * FROM users WHERE id = ' + userinput, (err, res) =&gt; {}); // Sensitive
});

// === PostgreSQL ===
const pg = require('pg');
const pgcon = new pg.Client({ host: host, user: user, password: pass, database: db });
pgcon.connect();
pgcon.query('SELECT * FROM users WHERE id = ' + userinput, (err, res) =&gt; {}); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
// === MySQL ===
const mysql = require('mysql');
const mycon = mysql.createConnection({ host: host, user: user, password: pass, database: db });
mycon.connect(function(err) {
  mycon.query('SELECT name FROM users WHERE id = ?', [userinput], (err, res) =&gt; {});
});

// === PostgreSQL ===
const pg = require('pg');
const pgcon = new pg.Client({ host: host, user: user, password: pass, database: db });
pgcon.connect();
pgcon.query('SELECT name FROM users WHERE id = $1', [userinput], (err, res) =&gt; {});
</pre>
<h2>Exceptions</h2>
<p>This rule’s current implementation does not follow variables. It will only detect SQL queries which are formatted directly in the function
call.</p>
<pre>
const sql = 'SELECT * FROM users WHERE id = ' + userinput;
mycon.query(sql, (err, res) =&gt; {}); // Sensitive but no issue is raised.
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/89">MITRE, CWE-89</a> - Improper Neutralization of Special Elements used in an SQL Command
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rules <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA">Potential SQL/JPQL Injection
  (JPA)</a>, <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO">Potential SQL/JDOQL Injection (JDO)</a>, <a
  href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE">Potential SQL/HQL Injection (Hibernate)</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4817"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4817">
              typescript:S4817
            </a>
          </td>
          <td >
            <details>
              <p>Executing XPATH expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6272">CVE-2016-6272</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9149">CVE-2016-9149</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4837">CVE-2012-4837</a> </li>
</ul>
<p>User-provided data such as URL parameters should always be considered as untrusted and tainted. Constructing XPath expressions directly from
tainted data enables attackers to inject specially crafted values that changes the initial meaning of the expression itself. Successful XPath
injections attacks can read sensitive information from the XML document.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the XPATH expression might contain some unsafe input coming from a user. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Sanitize any user input before using it in an XPATH expression.</p>
<h2>Sensitive Code Example</h2>
<pre>
// === Server side ===

var xpath = require('xpath');
var xmldom = require('xmldom');

var doc = new xmldom.DOMParser().parseFromString(xml);
var nodes = xpath.select(userinput, doc); // Sensitive
var node = xpath.select1(userinput, doc); // Sensitive
</pre>
<pre>
// === Client side ===

// Chrome, Firefox, Edge, Opera, and Safari use the evaluate() method to select nodes:
var nodes = document.evaluate(userinput, xmlDoc, null, XPathResult.ANY_TYPE, null); // Sensitive

// Internet Explorer uses its own methods to select nodes:
var nodes = xmlDoc.selectNodes(userinput); // Sensitive
var node = xmlDoc.SelectSingleNode(userinput); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/643">MITRE, CWE-643</a> - Improper Neutralization of Data within XPath Expressions </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4818"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4818">
              typescript:S4818
            </a>
          </td>
          <td >
            <details>
              <p>Using sockets is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1785">CVE-2011-178</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5645">CVE-2017-5645</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6597">CVE-2018-6597</a> </li>
</ul>
<p>Sockets are vulnerable in multiple ways:</p>
<ul>
  <li> They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive
  sensitive information or inject dangerous input. </li>
  <li> The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. </li>
</ul>
<p>This rules flags code that creates sockets. It matches only the direct use of sockets, not use through frameworks or high-level APIs such as the
use of http connections.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sockets are created without any limit every time a user performs an action. </li>
  <li> input received from sockets is used without being sanitized. </li>
  <li> sensitive data is sent via sockets without being encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols. </li>
  <li> Encrypt all data sent if it is sensitive. Usually it is better to encrypt it even if the data is not sensitive as it might change later. </li>
  <li> <a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> any input read from the socket. </li>
  <li> Limit the number of sockets a given user can create. Close the sockets as soon as possible. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
const net = require('net');

var socket = new net.Socket(); // Sensitive
socket.connect(80, 'google.com');

// net.createConnection creates a new net.Socket, initiates connection with socket.connect(), then returns the net.Socket that starts the connection
net.createConnection({ port: port }, () =&gt; {}); // Sensitive

// net.connect is an alias to net.createConnection
net.connect({ port: port }, () =&gt; {}); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption ('Resource Exhaustion') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="typescript:S6319"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6319">
              typescript:S6319
            </a>
          </td>
          <td >
            <details>
              <p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker
instances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries
physically access the storage media, they cannot decrypt encrypted data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The instance contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by
SageMaker, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sagemaker.CfnNotebookInstance.html"><code>aws-cdk-lib.aws-sagemaker.CfnNotebookInstance</code></a></p>
<pre>
import { CfnNotebookInstance } from 'aws-cdk-lib/aws-sagemaker';

new CfnNotebookInstance(this, 'example', {
      instanceType: 'instanceType',
      roleArn: 'roleArn'
}); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sagemaker.CfnNotebookInstance.html"><code>aws-cdk-lib.aws-sagemaker.CfnNotebookInstance</code></a></p>
<pre>
import { CfnNotebookInstance } from 'aws-cdk-lib/aws-sagemaker';

const encryptionKey = new Key(this, 'example', {
    enableKeyRotation: true,
});
new CfnNotebookInstance(this, 'example', {
    instanceType: 'instanceType',
    roleArn: 'roleArn',
    kmsKeyId: encryptionKey.keyId
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html">Protect Data at Rest Using Encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5689"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5689">
              typescript:S5689
            </a>
          </td>
          <td >
            <details>
              <p>Disclosing technology fingerprints allows an attacker to gather information about the technologies used to develop the web application and to
perform relevant security assessments more quickly (like the identification of known vulnerable components).</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The <code>x-powered-by</code> HTTP header or similar is used by the application. </li>
  <li> Technologies used by the application are confidential and should not be easily guessed. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to not disclose technologies used on a website, with <code>x-powered-by</code> HTTP header for example.</p>
<p>In addition, it’s better to completely disable this HTTP header rather than setting it a random value.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/express">Express.js</a> name is disclosed by default into the <code>x-powered-by</code> HTTP header:</p>
<pre>
let express = require('express');
let app = express(); // Sensitive

app.get('/', function (req, res) {
  res.send('hello')
});
</pre>
<h2>Compliant Solution</h2>
<p><code>x-powered-by</code> HTTP header should be disabled in <a href="https://www.npmjs.com/package/express">Express.js</a> with
<code>app.disable</code> or with helmet <a href="https://www.npmjs.com/package/helmet">hidePoweredBy</a> middleware:</p>
<pre>
let express = require('express');

let app1 = express();  // Compliant
app1.disable("x-powered-by");

let helmet = require("helmet");
let app2 = express(); // Compliant
app2.use(helmet.hidePoweredBy());
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework.html">OWASP Testing Guide - OTG-INFO-008</a> - Fingerprint Web Application Framework </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Information Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5443"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5443">
              typescript:S5443
            </a>
          </td>
          <td >
            <details>
              <p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like
<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious
user can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,
modified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2012-2451">CVE-2012-2451</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2015-1838">CVE-2015-1838</a> </li>
</ul>
<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It
also detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>
<ul>
  <li> <code>/tmp</code> </li>
  <li> <code>/var/tmp</code> </li>
  <li> <code>/usr/tmp</code> </li>
  <li> <code>/dev/shm</code> </li>
  <li> <code>/dev/mqueue</code> </li>
  <li> <code>/run/lock</code> </li>
  <li> <code>/var/run/lock</code> </li>
  <li> <code>/Library/Caches</code> </li>
  <li> <code>/Users/Shared</code> </li>
  <li> <code>/private/tmp</code> </li>
  <li> <code>/private/var/tmp</code> </li>
  <li> <code>\Windows\Temp</code> </li>
  <li> <code>\Temp</code> </li>
  <li> <code>\TMP</code> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Files are read from or written into a publicly writable folder </li>
  <li> The application creates files with predictable names into a publicly writable folder </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a dedicated sub-folder with tightly controlled permissions </li>
  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:
    <ul>
      <li> The generated filename is unpredictable </li>
      <li> The file is readable and writable only by the creating user ID </li>
      <li> The file descriptor is not inherited by child processes </li>
      <li> The file will be destroyed as soon as it is closed </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
const fs = require('fs');

let tmp_file = "/tmp/temporary_file"; // Sensitive
fs.readFile(tmp_file, 'utf8', function (err, data) {
  // ...
});
</pre>
<pre>
const fs = require('fs');

let tmp_dir = process.env.TMPDIR; // Sensitive
fs.readFile(tmp_dir + "/temporary_file", 'utf8', function (err, data) {
  // ...
});
</pre>
<h2>Compliant Solution</h2>
<pre>
const tmp = require('tmp');

const tmpobj = tmp.fileSync(); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="typescript:S1523"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S1523">
              typescript:S1523
            </a>
          </td>
          <td >
            <details>
              <p>Executing code dynamically is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807">CVE-2017-9807</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802">CVE-2017-9802</a> </li>
</ul>
<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific
meta-programming use-cases. However most of the time their use is frowned upon as they also increase the risk of <a
href="https://owasp.org/www-community/attacks/Code_Injection">Injected Code</a>. Such attacks can either run on the server or in the client (exemple:
XSS attack) and have a huge impact on an application’s security.</p>
<p>This rule raises issues on calls to <code>eval</code> and <code>Function</code> constructor. This rule does not detect code injections. It only
highlights the use of APIs which should be used sparingly and very carefully. The goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>
  <li> you really need to run code dynamically. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Regarding the execution of unknown code, the best solution is to not run code provided by an untrusted source. If you really need to do it, run the
code in a <a href="https://en.wikipedia.org/wiki/Sandbox_(computer_security)">sandboxed</a> environment. Use jails, firewalls and whatever means your
operating system and programming language provide (example: <a
href="https://wiki.sei.cmu.edu/confluence/display/java/SEC54-J.+Create+a+secure+sandbox+using+a+security+manager">Security Managers</a> in java, <a
href="https://www.w3schools.com/tags/att_iframe_sandbox.asp">iframes</a> and <a href="https://en.wikipedia.org/wiki/Same-origin_policy">same-origin
policy</a> for javascript in a web browser).</p>
<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>
<p>Avoid using dynamic code APIs whenever possible. Hard-coded code is always safer.</p>
<h2>Sensitive Code Example</h2>
<pre>
let value = eval('obj.' + propName); // Sensitive
let func = Function('obj' + propName); // Sensitive
</pre>
<h2>Exceptions</h2>
<p>This rule will not raise an issue when the argument of the <code>eval</code> or <code>Function</code> is a literal string as it is reasonably
safe.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/95">MITRE, CWE-95</a> - Improper Neutralization of Directives in Dynamically Evaluated Code
  ('Eval Injection') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S2612"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2612">
              typescript:S2612
            </a>
          </td>
          <td >
            <details>
              <p>In Unix, "<code>others</code>" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>
<p>Granting permissions to this group can lead to unintended access to files.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application is designed to be run on a multi-user environment. </li>
  <li> Corresponding files and directories may contain confidential information. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
<h2>Sensitive Code Example</h2>
<p>Node.js <a href="https://nodejs.org/api/fs.html"><code>fs</code></a></p>
<pre>
const fs = require('fs');

fs.chmodSync("/tmp/fs", 0o777); // Sensitive
</pre>
<pre>
const fs = require('fs');
const fsPromises = fs.promises;

fsPromises.chmod("/tmp/fsPromises", 0o777); // Sensitive
</pre>
<pre>
const fs = require('fs');
const fsPromises = fs.promises

async function fileHandler() {
  let filehandle;
  try {
    filehandle = fsPromises.open('/tmp/fsPromises', 'r');
    filehandle.chmod(0o777); // Sensitive
  } finally {
    if (filehandle !== undefined)
      filehandle.close();
  }
}
</pre>
<p>Node.js <a href="https://nodejs.org/api/process.html#process_process_umask_mask"><code>process.umask</code></a></p>
<pre>
const process = require('process');

process.umask(0o000); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Node.js <a href="https://nodejs.org/api/fs.html"><code>fs</code></a></p>
<pre>
const fs = require('fs');

fs.chmodSync("/tmp/fs", 0o770); // Compliant
</pre>
<pre>
const fs = require('fs');
const fsPromises = fs.promises;

fsPromises.chmod("/tmp/fsPromises", 0o770); // Compliant
</pre>
<pre>
const fs = require('fs');
const fsPromises = fs.promises

async function fileHandler() {
  let filehandle;
  try {
    filehandle = fsPromises.open('/tmp/fsPromises', 'r');
    filehandle.chmod(0o770); // Compliant
  } finally {
    if (filehandle !== undefined)
      filehandle.close();
  }
}
</pre>
<p>Node.js <a href="https://nodejs.org/api/process.html#process_process_umask_mask"><code>process.umask</code></a></p>
<pre>
const process = require('process');

process.umask(0o007); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission">OWASP File Permission</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4721"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4721">
              typescript:S4721
            </a>
          </td>
          <td >
            <details>
              <p>Arbitrary OS command injection vulnerabilities are more likely when a shell is spawned rather than a new process, indeed shell meta-chars can be
used (when parameters are user-controlled for instance) to inject OS commands.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> OS command name or parameters are user-controlled. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Use functions that don’t spawn a shell.</p>
<h2>Sensitive Code Example</h2>
<pre>
const cp = require('child_process');

// A shell will be spawn in these following cases:
cp.exec(cmd); // Sensitive
cp.execSync(cmd); // Sensitive

cp.spawn(cmd, { shell: true }); // Sensitive
cp.spawnSync(cmd, { shell: true }); // Sensitive
cp.execFile(cmd, { shell: true }); // Sensitive
cp.execFileSync(cmd, { shell: true }); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
const cp = require('child_process');

cp.spawnSync("/usr/bin/file.exe", { shell: false }); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/78">MITRE, CWE-78</a> - Improper Neutralization of Special Elements used in an OS Command </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5148"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5148">
              typescript:S5148
            </a>
          </td>
          <td >
            <details>
              <p>A newly opened window having access back to the originating window could allow basic phishing attacks (the <code>window.opener</code> object is not
<code>null</code> and thus <code>window.opener.location</code> can be set to a malicious website by the opened page).</p>
<p>For instance, an attacker can put a link (say: "http://example.com/mylink") on a popular website that changes, when opened, the original page to
"http://example.com/fake_login". On "http://example.com/fake_login" there is a fake login page which could trick real users to enter their
credentials.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application opens untrusted external URL. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Use <code>noopener</code> to prevent untrusted pages from abusing <code>window.opener</code>.</p>
<p>Note: In Chrome 88+, Firefox 79+ or Safari 12.1+ <code>target=_blank</code> on anchors implies <code>rel=noopener</code> which make the protection
enabled by default.</p>
<h2>Sensitive Code Example</h2>
<pre>
window.open("https://example.com/dangerous");
</pre>
<h2>Compliant Solution</h2>
<pre>
window.open("https://example.com/dangerous", "WindowName", "noopener");
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/Reverse_Tabnabbing">Reverse Tabnabbing</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1022">MITRE, CWE-1022</a> - Use of Web Link to Untrusted Target with window.opener Access </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mathiasbynens.github.io/rel-noopener/">https://mathiasbynens.github.io/rel-noopener/</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S1313">
              typescript:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
ip = "192.168.12.42"; // Sensitive

const net = require('net');
var client = new net.Socket();
client.connect(80, ip, function() {
  // ...
});
</pre>
<h2>Compliant Solution</h2>
<pre>
ip = process.env.IP_ADDRESS; // Compliant

const net = require('net');
var client = new net.Socket();
client.connect(80, ip, function() {
  // ...
});
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID). </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the 2001:db8::/32 range, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6327"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6327">
              typescript:S6327
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)
communication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages
when they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to
access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The topic contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html"><code>aws_cdk.aws_sns.Topic</code></a></p>
<pre>
import { Topic } from 'aws-cdk-lib/aws-sns';

new Topic(this, 'exampleTopic'); // Sensitive
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html"><code>aws_cdk.aws_sns.CfnTopic</code></a></p>
<pre>
import { Topic, CfnTopic } from 'aws-cdk-lib/aws-sns';

new CfnTopic(this, 'exampleCfnTopic'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html"><code>aws_cdk.aws_sns.Topic</code></a></p>
<pre>
import { Topic } from 'aws-cdk-lib/aws-sns';

const encryptionKey = new Key(this, 'exampleKey', {
    enableKeyRotation: true,
});

new Topic(this, 'exampleTopic', {
    masterKey: encryptionKey
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html"><code>aws_cdk.aws_sns.CfnTopic</code></a></p>
<pre>
import { CfnTopic } from 'aws-cdk-lib/aws-sns';

const encryptionKey = new Key(this, 'exampleKey', {
    enableKeyRotation: true,
});

cfnTopic = new CfnTopic(this, 'exampleCfnTopic', {
    kmsMasterKeyId: encryptionKey.keyId
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html">AWS Documentation</a> - Encryption at rest </li>
  <li> <a href="https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/">Encrypting messages published to
  Amazon SNS with AWS KMS</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6329"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6329">
              typescript:S6329
            </a>
          </td>
          <td >
            <details>
              <p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft
or disruption.</p>
<p>Depending on the component, inbound access from the Internet can be enabled via:</p>
<ul>
  <li> a boolean value that explicitly allows access to the public network. </li>
  <li> the assignment of a public IP address. </li>
  <li> database firewall rules that allow public IP ranges. </li>
</ul>
<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>
<p>This decision increases the likelihood of attacks on the organization, such as:</p>
<ul>
  <li> data breaches. </li>
  <li> intrusions into the infrastructure to permanently steal from it. </li>
  <li> and various malicious traffic, such as DDoS attacks. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<p>This cloud resource:</p>
<ul>
  <li> should be publicly accessible to any Internet user. </li>
  <li> requires inbound traffic from the Internet to function properly. </li>
</ul>
<p>There is a risk if you answered no to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce
sites.</p>
<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud
components.</p>
<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the
absence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html">aws-cdk-lib.aws_ec2.Instance</a> and similar
constructs:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.Instance(this, "example", {
    instanceType: nanoT2,
    machineImage: ec2.MachineImage.latestAmazonLinux(),
    vpc: vpc,
    vpcSubnets: {subnetType: ec2.SubnetType.PUBLIC} // Sensitive
})
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnInstance.html">aws-cdk-lib.aws_ec2.CfnInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnInstance(this, "example", {
    instanceType: "t2.micro",
    imageId: "ami-0ea0f26a6d50850c5",
    networkInterfaces: [
        {
            deviceIndex: "0",
            associatePublicIpAddress: true, // Sensitive
            deleteOnTermination: true,
            subnetId: vpc.selectSubnets({subnetType: ec2.SubnetType.PUBLIC}).subnetIds[0]
        }
    ]
})
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_dms.CfnReplicationInstance.html">aws-cdk-lib.aws_dms.CfnReplicationInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new dms.CfnReplicationInstance(
    this, "example", {
    replicationInstanceClass: "dms.t2.micro",
    allocatedStorage: 5,
    publiclyAccessible: true, // Sensitive
    replicationSubnetGroupIdentifier: subnetGroup.replicationSubnetGroupIdentifier,
    vpcSecurityGroupIds: [vpc.vpcDefaultSecurityGroup]
})
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html">aws-cdk-lib.aws_rds.CfnDBInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const rdsSubnetGroupPublic = new rds.CfnDBSubnetGroup(this, "publicSubnet", {
    dbSubnetGroupDescription: "Subnets",
    dbSubnetGroupName: "publicSn",
    subnetIds: vpc.selectSubnets({
        subnetType: ec2.SubnetType.PUBLIC
    }).subnetIds
})

new rds.CfnDBInstance(this, "example", {
    engine: "postgres",
    masterUsername: "foobar",
    masterUserPassword: "12345678",
    dbInstanceClass: "db.r5.large",
    allocatedStorage: "200",
    iops: 1000,
    dbSubnetGroupName: rdsSubnetGroupPublic.ref,
    publiclyAccessible: true, // Sensitive
    vpcSecurityGroups: [sg.securityGroupId]
})
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html">aws-cdk-lib.aws_ec2.Instance</a> and similar
constructs:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.Instance(
    this,
    "example", {
    instanceType: nanoT2,
    machineImage: ec2.MachineImage.latestAmazonLinux(),
    vpc: vpc,
    vpcSubnets: {subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS}
})
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnInstance.html">aws-cdk-lib.aws_ec2.CfnInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnInstance(this, "example", {
    instanceType: "t2.micro",
    imageId: "ami-0ea0f26a6d50850c5",
    networkInterfaces: [
        {
            deviceIndex: "0",
            associatePublicIpAddress: false,
            deleteOnTermination: true,
            subnetId: vpc.selectSubnets({subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS}).subnetIds[0]
        }
    ]
})
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_dms.CfnReplicationInstance.html">aws-cdk-lib.aws_dms.CfnReplicationInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new dms.CfnReplicationInstance(
    this, "example", {
    replicationInstanceClass: "dms.t2.micro",
    allocatedStorage: 5,
    publiclyAccessible: false,
    replicationSubnetGroupIdentifier: subnetGroup.replicationSubnetGroupIdentifier,
    vpcSecurityGroupIds: [vpc.vpcDefaultSecurityGroup]
})
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html">aws-cdk-lib.aws_rds.CfnDBInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const rdsSubnetGroupPrivate = new rds.CfnDBSubnetGroup(this, "example",{
    dbSubnetGroupDescription: "Subnets",
    dbSubnetGroupName: "privateSn",
    subnetIds: vpc.selectSubnets({
        subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS
    }).subnetIds
})

new rds.CfnDBInstance(this, "example", {
    engine: "postgres",
    masterUsername: "foobar",
    masterUserPassword: "12345678",
    dbInstanceClass: "db.r5.large",
    allocatedStorage: "200",
    iops: 1000,
    dbSubnetGroupName: rdsSubnetGroupPrivate.ref,
    publiclyAccessible: false,
    vpcSecurityGroups: [sg.securityGroupId]
})
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html">AWS Documentation</a> - Amazon EC2 instance IP
  addressing </li>
  <li> <a href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html">AWS Documentation</a> - Public and
  private replication instances </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html">AWS Documentation</a> - VPC Peering </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4829"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4829">
              typescript:S4829
            </a>
          </td>
          <td >
            <details>
              <p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337">CVE-2005-2337</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449">CVE-2017-11449</a> </li>
</ul>
<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)
can be dangerous and should be validated.</p>
<p>This rule flags code that reads from the standard input.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> data read from the standard input is not sanitized before being used. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all data read from the standard input before using it.</p>
<h2>Sensitive Code Example</h2>
<pre>
// The process object is a global that provides information about, and control over, the current Node.js process
// All uses of process.stdin are security-sensitive and should be reviewed

process.stdin.on('readable', () =&gt; {
	const chunk = process.stdin.read(); // Sensitive
	if (chunk !== null) {
		dosomething(chunk);
	}
});

const readline = require('readline');
readline.createInterface({
	input: process.stdin // Sensitive
}).on('line', (input) =&gt; {
	dosomething(input);
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4823"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4823">
              typescript:S4823
            </a>
          </td>
          <td >
            <details>
              <p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281">CVE-2018-7281</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326">CVE-2018-12326</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198">CVE-2011-3198</a> </li>
</ul>
<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>
<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus
passing sensitive information via command line arguments should be considered as insecure.</p>
<p>This rule raises an issue when on every program entry points (<code>main</code> methods) when command line arguments are used. The goal is to guide
security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> any of the command line arguments are used without being sanitized first. </li>
  <li> your application accepts sensitive information via command line arguments. </li>
</ul>
<p>If you answered yes to any of these questions you are at risk.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all command line arguments before using them.</p>
<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing
sensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the
path to a file containing the information.</p>
<h2>Sensitive Code Example</h2>
<pre>
// The process object is a global that provides information about, and control over, the current Node.js process
var param = process.argv[2]; // Sensitive: check how the argument is used
console.log('Param: ' + param);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/88">MITRE, CWE-88</a> - Argument Injection or Modification </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/214">MITRE, CWE-214</a> - Information Exposure Through Process Environment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="typescript:S4036"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4036">
              typescript:S4036
            </a>
          </td>
          <td >
            <details>
              <p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>
environment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in
<code>PATH</code> is a directory under his control.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>
<h2>Sensitive Code Example</h2>
<pre>
const cp = require('child_process');
cp.exec('file.exe'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
const cp = require('child_process');
cp.exec('/usr/bin/file.exe'); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/426">MITRE, CWE-426</a> - Untrusted Search Path </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/427">MITRE, CWE-427</a> - Uncontrolled Search Path Element </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6333"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6333">
              typescript:S6333
            </a>
          </td>
          <td >
            <details>
              <p>A public API, which can be requested by any authenticated or unauthenticated identities, can lead to unauthorized actions and information
disclosures.</p>
<h2>Ask Yourself Whether</h2>
<p>The public API:</p>
<ul>
  <li> exposes sensitive data like personal information. </li>
  <li> can be used to perform sensitive operations. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict API access to authorized entities, unless the API offers a non-sensitive service designed to be public.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.Resource.html">aws-cdk-lib.aws_apigateway.Resource</a>:</p>
<pre>
import {aws_apigateway as apigateway} from "aws-cdk-lib"

const resource = api.root.addResource("example")
resource.addMethod(
    "GET",
    new apigateway.HttpIntegration("https://example.org"),
    {
        authorizationType: apigateway.AuthorizationType.NONE // Sensitive
    }
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html">aws-cdk-lib.aws_apigatewayv2.CfnRoute</a>:</p>
<pre>
import {aws_apigatewayv2 as apigateway} from "aws-cdk-lib"

new apigateway.CfnRoute(this, "no-auth", {
    apiId: api.ref,
    routeKey: "GET /no-auth",
    authorizationType: "NONE", // Sensitive
    target: exampleIntegration
})
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.Resource.html">aws-cdk-lib.aws_apigateway.Resource</a>:</p>
<pre>
import {aws_apigateway as apigateway} from "aws-cdk-lib"

const resource = api.root.addResource("example",{
    defaultMethodOptions:{
        authorizationType: apigateway.AuthorizationType.IAM
    }
})
resource.addMethod(
    "POST",
    new apigateway.HttpIntegration("https://example.org"),
    {
        authorizationType: apigateway.AuthorizationType.IAM
    }
)
resource.addMethod(  // authorizationType is inherited from the Resource's configured defaultMethodOptions
    "GET"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html">aws-cdk-lib.aws_apigatewayv2.CfnRoute</a>:</p>
<pre>
import {aws_apigatewayv2 as apigateway} from "aws-cdk-lib"

new apigateway.CfnRoute(this, "auth", {
    apiId: api.ref,
    routeKey: "POST /auth",
    authorizationType: "AWS_IAM",
    target: exampleIntegration
})
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html">AWS Documentation</a> -
  Controlling and managing access to a REST API in API Gateway </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5247"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5247">
              typescript:S5247
            </a>
          </td>
          <td >
            <details>
              <p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,
<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters
that make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>
<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a
href="https://twig.symfony.com/doc/3.x/filters/escape.html">the strategy applied</a> and the context, for example a "html auto-escaping" strategy
(which only transforms html characters into <a href="https://developer.mozilla.org/en-US/docs/Glossary/Entity">html entities</a>) will not be relevant
when variables are used in a <a href="https://en.wikipedia.org/wiki/HTML_attribute">html attribute</a> because '<code>:</code>' character is not
escaped and thus an attack as below is possible:</p>
<pre>
&lt;a href="{{ myLink }}"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)
&lt;a href="javascript:alert(document.cookie)"&gt;link&lt;/a&gt; // JS injection (XSS attack)
</pre>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Templates are used to render web content and
    <ul>
      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>
      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>
    </ul>  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right
one.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/mustache">mustache.js</a> template engine:</p>
<pre>
let Mustache = require("mustache");

Mustache.escape = function(text) {return text;}; // Sensitive

let rendered = Mustache.render(template, { name: inputName });
</pre>
<p><a href="https://www.npmjs.com/package/handlebars">handlebars.js</a> template engine:</p>
<pre>
const Handlebars = require('handlebars');

let source = "&lt;p&gt;attack {{name}}&lt;/p&gt;";

let template = Handlebars.compile(source, { noEscape: true }); // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/markdown-it">markdown-it</a> markup language parser:</p>
<pre>
const markdownIt = require('markdown-it');
let md = markdownIt({
  html: true // Sensitive
});

let result = md.render('# &lt;b&gt;attack&lt;/b&gt;');
</pre>
<p><a href="https://www.npmjs.com/package/marked">marked</a> markup language parser:</p>
<pre>
const marked = require('marked');

marked.setOptions({
  renderer: new marked.Renderer(),
  sanitize: false // Sensitive
});

console.log(marked("# test &lt;b&gt;attack/b&gt;"));
</pre>
<p><a href="https://www.npmjs.com/package/kramed">kramed</a> markup language parser:</p>
<pre>
let kramed = require('kramed');

var options = {
  renderer: new kramed.Renderer({
    sanitize: false // Sensitive
  })
};
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/mustache">mustache.js</a> template engine:</p>
<pre>
let Mustache = require("mustache");

let rendered = Mustache.render(template, { name: inputName }); // Compliant autoescaping is on by default
</pre>
<p><a href="https://www.npmjs.com/package/handlebars">handlebars.js</a> template engine:</p>
<pre>
const Handlebars = require('handlebars');

let source = "&lt;p&gt;attack {{name}}&lt;/p&gt;";
let data = { "name": "&lt;b&gt;Alan&lt;/b&gt;" };

let template = Handlebars.compile(source); // Compliant by default noEscape is set to false
</pre>
<p><a href="https://www.npmjs.com/package/markdown-it">markdown-it</a> markup language parser:</p>
<pre>
let md = require('markdown-it')(); // Compliant by default html is set to false

let result = md.render('# &lt;b&gt;attack&lt;/b&gt;');
</pre>
<p><a href="https://www.npmjs.com/package/marked">marked</a> markup language parser:</p>
<pre>
const marked = require('marked');

marked.setOptions({
  renderer: new marked.Renderer()
}); // Compliant by default sanitize is set to true

console.log(marked("# test &lt;b&gt;attack/b&gt;"));
</pre>
<p><a href="https://www.npmjs.com/package/kramed">kramed</a> markup language parser:</p>
<pre>
let kramed = require('kramed');

let options = {
  renderer: new kramed.Renderer({
    sanitize: true // Compliant
  })
};

console.log(kramed('Attack [xss?](javascript:alert("xss")).', options));
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md">OWASP Cheat
  Sheet</a> - XSS Prevention Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6330">
              typescript:S6330
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store
messages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message
from the file system, for example through a vulnerability in the service, they are not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The queue contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html"><code>aws-cdk-lib.aws-sqs.Queue</code></a></p>
<pre>
import { Queue } from 'aws-cdk-lib/aws-sqs';

new Queue(this, 'example'); // Sensitive
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html"><code>aws-cdk-lib.aws-sqs.CfnQueue</code></a></p>
<pre>
import { CfnQueue } from 'aws-cdk-lib/aws-sqs';

new CfnQueue(this, 'example'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html"><code>aws-cdk-lib.aws-sqs.Queue</code></a></p>
<pre>
import { Queue } from 'aws-cdk-lib/aws-sqs';

new Queue(this, 'example', {
    encryption: QueueEncryption.KMS_MANAGED
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html"><code>aws-cdk-lib.aws-sqs.CfnQueue</code></a></p>
<pre>
import { CfnQueue } from 'aws-cdk-lib/aws-sqs';

const encryptionKey = new Key(this, 'example', {
    enableKeyRotation: true,
});

new CfnQueue(this, 'example', {
    kmsMasterKeyId: encryptionKey.keyId
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html">AWS Documentation</a> -
  Encryption at rest </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5122"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5122">
              typescript:S5122
            </a>
          </td>
          <td >
            <details>
              <p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269">CVE-2018-0269</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460">CVE-2017-14460</a> </li>
</ul>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same origin policy</a> in browsers prevents, by default and for
security-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)
from its own. The requested target can append additional HTTP headers in response, called <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>, that act like directives for the browser and change the access control policy
/ relax the same origin policy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>
  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>
  <li> Your access control policy is dynamically defined by a user-controlled input like <a
  href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin"><code>origin</code></a> header. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>
  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or
  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://nodejs.org/api/http.html">nodejs http</a> built-in module:</p>
<pre>
const http = require('http');
const srv = http.createServer((req, res) =&gt; {
  res.writeHead(200, { 'Access-Control-Allow-Origin': '*' }); // Sensitive
  res.end('ok');
});
srv.listen(3000);
</pre>
<p><a href="https://www.npmjs.com/package/express">Express.js</a> framework with <a href="https://www.npmjs.com/package/cors">cors middleware</a>:</p>
<pre>
const cors = require('cors');

let app1 = express();
app1.use(cors()); // Sensitive: by default origin is set to *

let corsOptions = {
  origin: '*' // Sensitive
};

let app2 = express();
app2.use(cors(corsOptions));
</pre>
<p>User-controlled origin:</p>
<pre>
function (req, res) {
  const origin = req.header('Origin');
  res.setHeader('Access-Control-Allow-Origin', origin); // Sensitive
};
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/http.html">nodejs http</a> built-in module:</p>
<pre>
const http = require('http');
const srv = http.createServer((req, res) =&gt; {
  res.writeHead(200, { 'Access-Control-Allow-Origin': 'trustedwebsite.com' }); // Compliant
  res.end('ok');
});
srv.listen(3000);
</pre>
<p><a href="https://www.npmjs.com/package/express">Express.js</a> framework with <a href="https://www.npmjs.com/package/cors">cors middleware</a>:</p>
<pre>
const cors = require('cors');

let corsOptions = {
  origin: 'trustedwebsite.com' // Compliant
};

let app = express();
app.use(cors(corsOptions));
</pre>
<p>User-controlled origin validated with an allow-list:</p>
<pre>
function (req, res) {
  const origin = req.header('Origin');

  if (trustedOrigins.indexOf(origin) &gt;= 0) {
    res.setHeader('Access-Control-Allow-Origin', origin);
  }
};
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">developer.mozilla.org</a> - CORS </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">developer.mozilla.org</a> - Same origin policy </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing">OWASP HTML5 Security
  Cheat Sheet</a> - Cross Origin Resource Sharing </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/346">MITRE, CWE-346</a> - Origin Validation Error </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/942">MITRE, CWE-942</a> - Overly Permissive Cross-domain Whitelist </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S6332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6332">
              typescript:S6332
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be
automatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are
not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The file system contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html"><code>aws_cdk.aws_efs.FileSystem</code></a></p>
<pre>
import { FileSystem } from 'aws-cdk-lib/aws-efs';

new FileSystem(this, 'unencrypted-explicit', {
    vpc: new Vpc(this, 'VPC'),
    encrypted: false // Sensitive
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html"><code>aws_cdk.aws_efs.CfnFileSystem</code></a></p>
<pre>
import { CfnFileSystem } from 'aws-cdk-lib/aws-efs';

new CfnFileSystem(this, 'unencrypted-implicit-cfn', {
}); // Sensitive as encryption is disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html"><code>aws_cdk.aws_efs.FileSystem</code></a></p>
<pre>
import { FileSystem } from 'aws-cdk-lib/aws-efs';

new FileSystem(this, 'encrypted-explicit', {
    vpc: new Vpc(this, 'VPC'),
    encrypted: true
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html"><code>aws_cdk.aws_efs.CfnFileSystem</code></a></p>
<pre>
import { CfnFileSystem } from 'aws-cdk-lib/aws-efs';

new CfnFileSystem(this, 'encrypted-explicit-cfn', {
    encrypted: true
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/efs/latest/ug/encryption.html">AWS Documentation</a> - Data encryption in Amazon EFS </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S2092"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2092">
              typescript:S2092
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP
request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>
  <li> it’s not sure that the website contains <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">mixed content</a> or not
  (ie HTTPS everywhere or not) </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour
  when creating cookies. </li>
  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> module:</p>
<pre>
let session = cookieSession({
  secure: false,// Sensitive
});  // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/express-session">express-session</a> module:</p>
<pre>
const express = require('express');
const session = require('express-session');

let app = express();
app.use(session({
  cookie:
  {
    secure: false // Sensitive
  }
}));
</pre>
<p><a href="https://www.npmjs.com/package/cookies">cookies</a> module:</p>
<pre>
let cookies = new Cookies(req, res, { keys: keys });

cookies.set('LastVisit', new Date().toISOString(), {
  secure: false // Sensitive
}); // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/csurf">csurf</a> module:</p>
<pre>
const cookieParser = require('cookie-parser');
const csrf = require('csurf');
const express = require('express');

let csrfProtection = csrf({ cookie: { secure: false }}); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> module:</p>
<pre>
let session = cookieSession({
  secure: true,// Compliant
});  // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/express-session">express-session</a> module:</p>
<pre>
const express = require('express');
const session = require('express-session');

let app = express();
app.use(session({
  cookie:
  {
    secure: true // Compliant
  }
}));
</pre>
<p><a href="https://www.npmjs.com/package/cookies">cookies</a> module:</p>
<pre>
let cookies = new Cookies(req, res, { keys: keys });

cookies.set('LastVisit', new Date().toISOString(), {
  secure: true // Compliant
}); // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/csurf">csurf</a> module:</p>
<pre>
const cookieParser = require('cookie-parser');
const csrf = require('csurf');
const express = require('express');

let csrfProtection = csrf({ cookie: { secure: true }}); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/614">MITRE, CWE-614</a> - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="flex:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=flex:S4507">
              flex:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> the application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers or applications distributed to end users.</p>
<h2>Sensitive Code Example</h2>
<pre>
if (unexpectedCondition)
{
  Alert.show("Unexpected Condition"); // Sensitive
}
</pre>
<p>The <code>trace()</code> function outputs debug statements, which can be read by anyone with a debug version of the Flash player:</p>
<pre>
var val:Number = doCalculation();
trace("Calculation result: " + val);  // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="docker:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=docker:S5332">
              docker:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against tampering or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
    </ul>  </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<pre>
RUN curl http://www.example.com/
</pre>
<h2>Compliant Solution</h2>
<pre>
RUN curl https://www.example.com/
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="docker:S6472"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=docker:S6472">
              docker:S6472
            </a>
          </td>
          <td >
            <details>
              <p>Using ENV to handle secrets can lead to sensitive information being disclosed to an inappropriate sphere.</p>
<p>The <code>ENV</code> commands in a Dockerfile are used to configure the container environment. The variables set that way can be used at image
build time, during the execution of commands in the container, or at run time.</p>
<p>In most cases, environment variables are used to propagate configuration items from the host to the container. A typical example is the
<code>PATH</code> variable, used to configure where system executables are searched for.</p>
<p>Using <code>ENV</code> to propagate configuration entries that contain secrets causes a security risk. Indeed, in most cases, artifacts of those
values are kept in the final container image and, thus, disclosed to its users. The secret information leak can happen either in the container
environment itself, the image metadata or the build environment logs.</p>
<p>The concrete impact of such an issue highly depends on the secret’s purpose and the exposure sphere:</p>
<ul>
  <li> Financial impact if a paid service API key is disclosed and used. </li>
  <li> Application compromise if an application’s secret, like a session signing key, is disclosed. </li>
  <li> Infrastructure component takeover, if a system secret, like a remote access key, is leaked. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The environment variable contains a value that should be kept confidential. </li>
  <li> The container image or Dockerfile will be distributed to users who do not need to know the secret value. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use Buildkit’s secret mount options when secrets have to be used at build time. </li>
  <li> For run time secret variables, best practices would recommend only setting them at runtime, for example with the <code>--env</code> option of
  the <code>docker run</code> command. </li>
</ul>
<p>Note that, in both cases, the files exposing the secrets should be securely stored and not exposed to a large sphere. In most cases, using a secret
vault or another similar component should be preferred. For example, <strong>Docker Swarm</strong> provides a <strong>secrets</strong> service that
can be used to handle most confidential data.</p>
<h2>Sensitive Code Example</h2>
<pre>
FROM example
ARG ACCESS_TOKEN
# Sensitive
ENV ACCESS_TOKEN=${ACCESS_TOKEN}
CMD /run.sh
</pre>
<h2>Compliant Solution</h2>
<p>For build time secrets, use <a href="https://docs.docker.com/engine/reference/builder/#run---mounttypesecret">Buildkit’s secret mount type</a>
instead:</p>
<pre>
FROM example
RUN --mount=type=secret,id=build_secret ./installer.sh
</pre>
<p>For runtime secrets, leave the environment variables empty until runtime:</p>
<pre>
FROM example
ENV ACCESS_TOKEN=""
CMD /run.sh
</pre>
<p>Store the runtime secrets in an <a href="https://docs.docker.com/compose/env-file/">environment file</a> (such as <code>.env</code>) and then start
the container with the <a
href="https://docs.docker.com/engine/reference/commandline/run/#set-environment-variables—​e---env---env-file"><code>--env-file</code></a>
argument:</p>
<pre>
docker run --env-file .env myImage
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.docker.com/engine/reference/builder/#env">Dockerfile reference</a> - ENV command </li>
  <li> <a href="https://docs.docker.com/engine/reference/builder/#run---mounttypesecret">Dockerfile reference</a> - RUN command secrets mount points
  </li>
  <li> <a href="https://docs.docker.com/engine/swarm/secrets/">Docker documentation</a> - Manage sensitive data with Docker secrets </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/522.html">MITRE, CWE-522</a> - Insufficiently Protected Credentials </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="docker:S6473"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=docker:S6473">
              docker:S6473
            </a>
          </td>
          <td >
            <details>
              <p>Exposing administration services can lead to unauthorized access of containers or escalation of privileges inside of containers.</p>
<p>A port that is commonly used for administration services is marked as being open through the <code>EXPOSE</code> command. Administration services
like SSH might contain vulnerabilities, hard-coded credentials, or other security issues that increase the attack surface of a Docker deployment.<br>
Even if the ports of the services do not get forwarded to the host system, by default they are reachable from other containers in the same network. A
malicious actor that gets access to one container could use such services to escalate access and privileges.</p>
<p>Removing the <code>EXPOSE</code> command is not sufficient to be secure. The port is still open and the service accessible. To be secure, no
administration services should be started. Instead, try to access the required information from the host system. For example, if the administration
service is included to access logs or debug a service, you can do this from the host system instead. Docker allows you to read out any file that is
inside of a container and to spawn a shell inside of a container if necessary.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The container starts an administration service. </li>
</ul>
<p>There is a risk if you answered yes to the question.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Do not start SSH, VNC, RDP or similar administration services in containers. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
FROM ubuntu:22.04
# Sensitive
EXPOSE 22
CMD ["/usr/sbin/sshd", "-f", "/etc/ssh/sshd_config", "-D"]
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://docs.docker.com/engine/reference/builder/#expose">Dockerfile reference</a> - EXPOSE </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="docker:S6470"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=docker:S6470">
              docker:S6470
            </a>
          </td>
          <td >
            <details>
              <p>When building a Docker image from a Dockerfile, a context directory is used and sent to the Docker daemon before the actual build starts. This
context directory usually contains the Dockerfile itself, along with all the files that will be necessary for the build to succeed. This generally
includes:</p>
<ul>
  <li> the source code of applications to set up in the container. </li>
  <li> configuration files for other software components. </li>
  <li> other necessary packages or components. </li>
</ul>
<p>The <code>COPY</code> and <code>ADD</code> directives in the Dockerfiles are then used to actually copy content from the context directory to the
image file system.</p>
<p>When <code>COPY</code> or <code>ADD</code> are used to recursively copy entire top-level directories or multiple items whose names are determined
at build-time, unexpected files might get copied to the image filesystem. It could affect their confidentiality.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The copied files and directories might contain sensitive data that should be kept confidential. </li>
  <li> The context directory contains files and directories that have no functional purpose for the final container image. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<p>Keep in mind that the content of the context directory might change depending on the build environment and over time.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Limit the usage of globbing in the <code>COPY</code> and <code>ADD</code> sources definition. </li>
  <li> Avoid copying the entire context directory to the image filesystem. </li>
  <li> Prefer providing an explicit list of files and directories that are required for the image to properly run. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>Copying the complete context directory:</p>
<pre>
FROM ubuntu:22.04
# Sensitive
COPY . .
CMD /run.sh
</pre>
<p>Copying multiple files and directories whose names are expanded at build time:</p>
<pre>
FROM ubuntu:22.04
# Sensitive
COPY ./example* /
COPY ./run.sh /
CMD /run.sh
</pre>
<h2>Compliant Solution</h2>
<pre>
FROM ubuntu:22.04
COPY ./example1 /example1
COPY ./example2 /example2
COPY ./run.sh /
CMD /run.sh
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.docker.com/engine/reference/builder/#copy">Dockerfile reference</a> - COPY directive </li>
  <li> <a href="https://docs.docker.com/engine/reference/builder/#add">Dockerfile reference</a> - ADD directive </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668.html">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/497.html">MITRE, CWE-497</a> - Exposure of Sensitive System Information to an Unauthorized
  Control Sphere </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="docker:S6471"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=docker:S6471">
              docker:S6471
            </a>
          </td>
          <td >
            <details>
              <p>Running containers as a privileged user weakens their runtime security, allowing any user whose code runs on the container to perform
administrative actions.<br> In Linux containers, the privileged user is usually named <code>root</code>. In Windows containers, the equivalent is
<code>ContainerAdministrator</code>.</p>
<p>A malicious user can run code on a system either thanks to actions that could be deemed legitimate - depending on internal business logic or
operational management shells - or thanks to malicious actions. For example, with arbitrary code execution after exploiting a service that the
container hosts.</p>
<p>Suppose the container is not hardened to prevent using a shell, interpreter, or <a
href="https://man7.org/linux/man-pages/man7/capabilities.7.html">Linux capabilities</a>. In this case, the malicious user can read and exfiltrate any
file (including from Docker volumes), open new network connections, install malicious software, or, worse, break out of the container’s isolation
context by exploiting other components.</p>
<p>Depending on the infrastructure’s resilience, attackers may then extend their attack to other services, such as Kubernetes clusters or cloud
providers, in order to maximize their reach.</p>
<h2>Ask Yourself Whether</h2>
<p>This container:</p>
<ul>
  <li> Serves internet-facing services. </li>
  <li> Does not require a privileged user to run. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>In the Dockerfile:</p>
<ul>
  <li> Create a new default user and use it with the <code>USER</code> statement.
    <ul>
      <li> Some container maintainers create a specific user to be used without explicitly setting it as default, such as <code>postgresql</code> or
      <code>zookeeper</code>. It is recommended to use these users instead of root. </li>
      <li> On Windows containers, the <code>ContainerUser</code> is available for this purpose. </li>
    </ul>  </li>
</ul>
<p>Or, at launch time:</p>
<ul>
  <li> Use the <code>user</code> argument when calling Docker or in the docker-compose file. </li>
  <li> Add fine-grained Linux capabilities to perform specific actions that require root privileges. </li>
</ul>
<p>If this image is already explicitly set to launch with a non-privileged user, you can add it to the safe images list rule property of your
SonarQube instance, without the tag.</p>
<h2>Sensitive Code Example</h2>
<p>For any image that does not provide a user by default, regardless of their underlying operating system:</p>
<pre>
# Sensitive
FROM alpine

ENTRYPOINT ["id"]
</pre>
<p>For multi-stage builds, the last stage is non-compliant if it does not contain the <code>USER</code> instruction with a non-root user:</p>
<pre>
FROM alpine as builder
COPY Makefile ./src /
RUN make build
USER nonroot

# Sensitive, previous user settings are dropped
FROM alpine as runtime
COPY --from=builder bin/production /app
ENTRYPOINT ["/app/production"]
</pre>
<h2>Compliant Solution</h2>
<p>For Linux-based images:</p>
<pre>
FROM alpine

RUN addgroup -S nonroot \
    &amp;&amp; adduser -S nonroot -G nonroot

USER nonroot

ENTRYPOINT ["id"]
</pre>
<p>For Windows-based images, you can use <code>ContainerUser</code> or create a new user:</p>
<pre>
FROM mcr.microsoft.com/windows/servercore:ltsc2019

RUN net user /add nonroot

USER nonroot
</pre>
<p>If the <code>scratch</code> Dockerfile untars a Linux distribution, the "Linux image" solution should be applied. Else, you have a choice between
using a pre-written <code>/etc/passwd</code> file (regardless of the host operating system) or using a multi-stage build.</p>
<pre>
FROM scratch

COPY etc_passwd /etc/passwd
# contains "nonroot:x:1337:1337:nonroot:/nonroot:/usr/sbin/nologin"

USER nonroot

COPY production_binary /app

ENTRYPOINT ["/app/production_binary"]
</pre>
<p>or you can use a multi-stage build:</p>
<pre>
FROM alpine:latest as security_provider
RUN addgroup -S nonroot \
    &amp;&amp; adduser -S nonroot -G nonroot

FROM scratch as production
COPY --from=security_provider /etc/passwd /etc/passwd
USER nonroot
COPY production_binary /app
ENTRYPOINT ["/app/production_binary"]
</pre>
<p>For multi-stage builds:</p>
<pre>
FROM alpine as builder
COPY Makefile ./src /
RUN make build

FROM alpine as runtime
RUN addgroup -S nonroot \
    &amp;&amp; adduser -S nonroot -G nonroot
COPY --from=builder bin/production /app
USER nonroot
ENTRYPOINT ["/app/production"]
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284.html">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://hub.docker.com/r/nginxinc/nginx-unprivileged">nginxinc/nginx-unprivileged: Example of a non-root container by default</a>
  </li>
  <li> <a
  href="https://learn.microsoft.com/en-us/virtualization/windowscontainers/manage-containers/container-security#when-to-use-containeradmin-and-containeruser-user-accounts">Microsoft docs, When to use ContainerAdmin and ContainerUser user accounts</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="scala:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=scala:S1313">
              scala:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
val ip = "192.168.12.42" // Sensitive
val socket = new Socket(ip, 6667)
</pre>
<h2>Compliant Solution</h2>
<pre>
val ips = Source.fromFile(configuration_file).getLines.toList // Compliant
val socket = new Socket(ips(0), 6667)
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="scala:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=scala:S2068">
              scala:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6304"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6304">
              terraform:S6304
            </a>
          </td>
          <td >
            <details>
              <p>A policy that allows identities to access all resources in an AWS account may violate <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity has permission to access
all resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive
information will occur.</p>
<h2>Ask Yourself Whether</h2>
<p>The AWS account has more than one resource with different levels of sensitivity.</p>
<p>A risk exists if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is
to organize or <a
href="https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/">tag</a>
resources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>
<h2>Noncompliant Code Example</h2>
<p>Update permission is granted for all policies using the wildcard (*) in the <code>Resource</code> property:</p>
<pre>
resource "aws_iam_policy" "noncompliantpolicy" {
  name        = "noncompliantpolicy"

  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Action = [
          "iam:CreatePolicyVersion"
        ]
        Effect   = "Allow"
        Resource = [
          "*" # Sensitive
        ]
      }
    ]
  })
}
</pre>
<h2>Compliant Solution</h2>
<p>Restrict update permission to the appropriate subset of policies:</p>
<pre>
resource "aws_iam_policy" "compliantpolicy" {
  name        = "compliantpolicy"

  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Action = [
          "iam:CreatePolicyVersion"
        ]
        Effect   = "Allow"
        Resource = [
          "arn:aws:iam::${data.aws_caller_identity.current.account_id}:policy/team1/*"
        ]
      }
    ]
  })
}
</pre>
<h2>Exceptions</h2>
<ul>
  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>
  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S5332">
              terraform:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://aws.amazon.com/kinesis/">AWS Kinesis</a> Data Streams server-side encryption:</p>
<pre>
resource "aws_kinesis_stream" "sensitive_stream" {
    encryption_type = "NONE" # Sensitive
}
</pre>
<p>For <a href="https://aws.amazon.com/elasticache/">Amazon ElastiCache</a>:</p>
<pre>
resource "aws_elasticache_replication_group" "example" {
    replication_group_id = "example"
    replication_group_description = "example"
    transit_encryption_enabled = false  # Sensitive
}
</pre>
<p>For <a href="https://aws.amazon.com/ecs/">Amazon ECS</a>:</p>
<pre>
resource "aws_ecs_task_definition" "ecs_task" {
  family = "service"
  container_definitions = file("task-definition.json")

  volume {
    name = "storage"
    efs_volume_configuration {
      file_system_id = aws_efs_file_system.fs.id
      transit_encryption = "DISABLED"  # Sensitive
    }
  }
}
</pre>
<p>For <a href="https://docs.aws.amazon.com/opensearch-service/index.html">Amazon OpenSearch domains</a>:</p>
<pre>
resource "aws_elasticsearch_domain" "example" {
  domain_name = "example"
  domain_endpoint_options {
    enforce_https = false # Sensitive
  }
  node_to_node_encryption {
    enabled = false # Sensitive
  }
}
</pre>
<p>For <a href="https://aws.amazon.com/msk/">Amazon MSK</a> communications between clients and brokers:</p>
<pre>
resource "aws_msk_cluster" "sensitive_data_cluster" {
    encryption_info {
        encryption_in_transit {
            client_broker = "TLS_PLAINTEXT" # Sensitive
            in_cluster = false # Sensitive
        }
    }
}
</pre>
<p>For <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Load Balancer Listeners</a>:</p>
<pre>
resource "aws_lb_listener" "front_load_balancer" {
  protocol = "HTTP" # Sensitive

  default_action {
    type = "redirect"

    redirect {
      protocol = "HTTP"
    }
  }
}
</pre>
<p>HTTP protocol is used for <a
href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_region_backend_service">GCP Region Backend
Services</a>:</p>
<pre>
resource "google_compute_region_backend_service" "example" {
  name                            = "example-service"
  region                          = "us-central1"
  health_checks                   = [google_compute_region_health_check.region.id]
  connection_draining_timeout_sec = 10
  session_affinity                = "CLIENT_IP"
  load_balancing_scheme           = "EXTERNAL"
  protocol                        = "HTTP" # Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://aws.amazon.com/kinesis/">AWS Kinesis</a> Data Streams server-side encryption:</p>
<pre>
resource "aws_kinesis_stream" "compliant_stream" {
    encryption_type = "KMS"
}
</pre>
<p>For <a href="https://aws.amazon.com/elasticache/">Amazon ElastiCache</a>:</p>
<pre>
resource "aws_elasticache_replication_group" "example" {
    replication_group_id = "example"
    replication_group_description = "example"
    transit_encryption_enabled = true
}
</pre>
<p>For <a href="https://aws.amazon.com/ecs/">Amazon ECS</a>:</p>
<pre>
resource "aws_ecs_task_definition" "ecs_task" {
  family = "service"
  container_definitions = file("task-definition.json")

  volume {
    name = "storage"
    efs_volume_configuration {
      file_system_id = aws_efs_file_system.fs.id
      transit_encryption = "ENABLED"
    }
  }
}
</pre>
<p>For <a href="https://docs.aws.amazon.com/opensearch-service/index.html">Amazon OpenSearch domains</a>:</p>
<pre>
resource "aws_elasticsearch_domain" "example" {
  domain_name = "example"
  domain_endpoint_options {
    enforce_https = true
  }
  node_to_node_encryption {
    enabled = true
  }
}
</pre>
<p>For <a href="https://aws.amazon.com/msk/">Amazon MSK</a> communications between clients and brokers, data in transit is encrypted by default,
allowing you to omit writing the <code>encryption_in_transit</code> configuration. However, if you need to configure it explicitly, this configuration
is compliant:</p>
<pre>
resource "aws_msk_cluster" "sensitive_data_cluster" {
    encryption_info {
        encryption_in_transit {
            client_broker = "TLS"
            in_cluster = true
        }
    }
}
</pre>
<p>For <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Load Balancer Listeners</a>:</p>
<pre>
resource "aws_lb_listener" "front_load_balancer" {
  protocol = "HTTP"

  default_action {
    type = "redirect"

    redirect {
      protocol = "HTTPS"
    }
  }
}
</pre>
<p>HTTPS protocol is used for <a
href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_region_backend_service">GCP Region Backend
Services</a>:</p>
<pre>
resource "google_compute_region_backend_service" "example" {
  name                            = "example-service"
  region                          = "us-central1"
  health_checks                   = [google_compute_region_health_check.region.id]
  connection_draining_timeout_sec = 10
  session_affinity                = "CLIENT_IP"
  load_balancing_scheme           = "EXTERNAL"
  protocol                        = "HTTPS"
}
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6303"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6303">
              terraform:S6303
            </a>
          </td>
          <td >
            <details>
              <p>Using unencrypted RDS DB resources exposes data to unauthorized access to the underlying storage.<br> This includes database data, logs, automatic
backups, read replicas, snapshots, and cluster metadata.</p>
<p>This situation can occur in a variety of scenarios, such as:</p>
<ul>
  <li> a malicious insider working at the cloud provider gains physical access to the storage device and exfiltrates data. </li>
  <li> unknown attackers penetrate the cloud provider’s logical infrastructure and systems for extortion. </li>
</ul>
<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is
required as encryption at rest is fully managed by AWS.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance">aws_db_instance</a> and <a
href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster">aws_rds_cluster</a>:</p>
<pre>
resource "aws_db_instance" "example" {
  storage_encrypted = false  # Sensitive, disabled by default
}

resource "aws_rds_cluster" "example" {
  storage_encrypted = false # Sensitive, disabled by default
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/db_instance">aws_db_instance</a> and <a
href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/rds_cluster">aws_rds_cluster</a>:</p>
<pre>
resource "aws_db_instance" "example" {
  storage_encrypted = true
}

resource "aws_rds_cluster" "example" {
  storage_encrypted = false # Sensitive, disabled by default
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html">AWS Documentation</a> - Encrypting Amazon RDS
  resources </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6388"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6388">
              terraform:S6388
            </a>
          </td>
          <td >
            <details>
              <p>Using unencrypted cloud storages can lead to data exposure. In the case that adversaries gain physical access to the storage medium they are able
to access unencrypted information.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The service contains sensitive information that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt cloud storages that contain sensitive information.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store">azurerm_data_lake_store</a>:</p>
<pre>
resource "azurerm_data_lake_store" "store" {
  name             = "store"
  encryption_state = "Disabled"  # Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_lake_store">azurerm_data_lake_store</a>:</p>
<pre>
resource "azurerm_data_lake_store" "store" {
  name             = "store"
  encryption_state = "Enabled"
  encryption_type  = "ServiceManaged"
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/efs/latest/ug/encryption.html">Data encryption in Amazon EFS</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6302"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6302">
              terraform:S6302
            </a>
          </td>
          <td >
            <details>
              <p>A policy that grants all permissions may indicate an improper access control, which violates <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity is granted full
permissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources
may occur and therefore result in loss of information.</p>
<h2>Ask Yourself Whether</h2>
<p>Identities obtaining all the permissions:</p>
<ul>
  <li> only require a subset of these permissions to perform the intended function. </li>
  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start
with the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in
production, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>
<h2>Noncompliant Code Example</h2>
<p>A customer-managed policy for AWS that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>
<pre>
resource "aws_iam_policy" "example" {
  name = "noncompliantpolicy"

  policy = jsonencode({
    Version   = "2012-10-17"
    Statement = [
      {
        Action   = [
          "*" # Sensitive
        ]
        Effect   = "Allow"
        Resource = [
          aws_s3_bucket.mybucket.arn
        ]
      }
    ]
  })
}
</pre>
<p>A customer-managed policy for GCP that grants all permissions by using the actions admin role <code>role</code> property:</p>
<pre>
resource "google_project_iam_binding" "example" {
  project = "example"
  role    = "roles/owner" # Sensitive

  members = [
    "user:jane@example.com",
  ]
}
</pre>
<h2>Compliant Solution</h2>
<p>A customer-managed policy for AWS that grants only the required permissions:</p>
<pre>
resource "aws_iam_policy" "example" {
  name = "compliantpolicy"

  policy = jsonencode({
    Version   = "2012-10-17"
    Statement = [
      {
        Action   = [
          "s3:GetObject"
        ]
        Effect   = "Allow"
        Resource = [
          aws_s3_bucket.mybucket.arn
        ]
      }
    ]
  })
}
</pre>
<p>A customer-managed policy for GCP that grants restricted permissions by using the actions admin role <code>role</code> property:</p>
<pre>
resource "google_project_iam_binding" "example" {
  project = "example"
  role    = "roles/actions.Viewer"

  members = [
    "user:jane@example.com",
  ]
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cloud.google.com/iam/docs/understanding-roles">Google Cloud Documentation</a> - Understanding roles </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6308"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6308">
              terraform:S6308
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elasticsearch Service (ES) is a managed service to host Elasticsearch instances.</p>
<p>To harden domain (cluster) data in case of unauthorized access, ES provides data-at-rest encryption if the Elasticsearch version is 5.1 or above.
Enabling encryption at rest will help protect:</p>
<ul>
  <li> indices </li>
  <li> logs </li>
  <li> swap files </li>
  <li> data in the application directory </li>
  <li> automated snapshots </li>
</ul>
<p>Thus, if adversaries gain physical access to the storage medium, they cannot access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to encrypt Elasticsearch domains that contain sensitive information.</p>
<p>Encryption and decryption are handled transparently by ES, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain">aws_elasticsearch_domain</a>:</p>
<pre>
resource "aws_elasticsearch_domain" "elasticsearch" {
  encrypt_at_rest {
    enabled = false  # Sensitive, disabled by default
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain">aws_elasticsearch_domain</a>:</p>
<pre>
resource "aws_elasticsearch_domain" "elasticsearch" {
  encrypt_at_rest {
    enabled = true
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/encryption-at-rest.html">AWS Documentation</a> - Encryption of
  data at rest for Amazon Elasticsearch Service </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="terraform:S6387"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6387">
              terraform:S6387
            </a>
          </td>
          <td >
            <details>
              <p>Azure RBAC roles can be assigned to users, groups, or service principals. A role assignment grants permissions on a predefined set of resources
called "scope".</p>
<p>The widest scopes a role can be assigned to are:</p>
<ul>
  <li> Subscription: a role assigned with this scope grants access to all resources of this Subscription. </li>
  <li> Management Group: a scope assigned with this scope grants access to all resources of all the Subscriptions in this Management Group. </li>
</ul>
<p>In case of security incidents involving a compromised identity (user, group, or service principal), limiting its role assignment to the narrowest
scope possible helps separate duties and limits what resources are at risk.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The user, group, or service principal doesn’t use the entirety of the resources in the scope to operate on a day-to-day basis. </li>
  <li> It is possible to follow the Separation of Duties principle and split the scope into multiple role assignments with a narrower scope. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Limit the scope of the role assignment to a Resource or Resource Group. </li>
  <li> Apply the least privilege principle by assigning roles granting as few permissions as possible. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
resource "azurerm_role_assignment" "example" {
  scope                = data.azurerm_subscription.primary.id # Sensitive
  role_definition_name = "Reader"
  principal_id         = data.azuread_user.user.object_id
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "azurerm_role_assignment" "example" {
  scope                = azurerm_resource_group.example.id
  role_definition_name = "Reader"
  principal_id         = data.azuread_user.user.object_id
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP Top 10 2017 Category A5</a> - Broken Access
  Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/scope-overview">Azure Documentation</a> - Understand scope for Azure
  RBAC </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices">Azure Documentation</a> - Best practices for Azure
  RBAC </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6265"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6265">
              terraform:S6265
            </a>
          </td>
          <td >
            <details>
              <p>Predefined permissions, also known as <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">canned ACLs</a>,
are an easy way to grant large privileges to predefined groups or users.</p>
<p>The following canned ACLs are security-sensitive:</p>
<ul>
  <li> <code>PublicRead</code>, <code>PublicReadWrite</code> grant respectively "read" and "read and write" privileges to everyone in the world
  (<code>AllUsers</code> group). </li>
  <li> <code>AuthenticatedRead</code> grants "read" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege policy, ie to grant necessary permissions only to users for their required tasks. In the context
of canned ACL, set it to <code>private</code> (the default one) and if needed more granularity then use an appropriate S3 policy.</p>
<h2>Sensitive Code Example</h2>
<p>All users (ie: anyone in the world authenticated or not) have read and write permissions with the <code>public-read-write</code> access
control:</p>
<pre>
resource "aws_s3_bucket" "mynoncompliantbucket" { # Sensitive
  bucket = "mynoncompliantbucketname"
  acl    = "public-read-write"
}
</pre>
<h2>Compliant Solution</h2>
<p>With the <code>private</code> access control (default), only the bucket owner has the read/write permissions on the buckets and its ACL.</p>
<pre>
resource "aws_s3_bucket" "mycompliantbucket" { # Compliant
  bucket = "mycompliantbucketname"
  acl    = "private"
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">AWS Documentation</a> - Access control list (ACL)
  overview (canned ACLs) </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html">AWS Documentation</a> - Controlling access to a bucket with
  user policies </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6380"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6380">
              terraform:S6380
            </a>
          </td>
          <td >
            <details>
              <p>Authorizing anonymous access can reduce an organization’s ability to protect itself against attacks on its Azure resources.</p>
<p>Security incidents may include disrupting critical functions, data theft, and additional Azure subscription costs due to resource overload.</p>
<p>Using authentication coupled with fine-grained authorizations helps bring Defense-In-Depth and bring traceability to investigators of security
incidents.</p>
<p>Depending on the affected Azure resource, multiple authentication choices are possible: Active Directory Authentication, OpenID implementations
(Google, Microsoft, etc.) or native Azure mechanisms.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This Azure resource is essential for the information system infrastructure. </li>
  <li> This Azure resource is essential for mission-critical functions. </li>
  <li> This Azure resource stores or processes sensitive data. </li>
  <li> Compliance policies require access to this resource to be authenticated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable authentication in this Azure resource, and disable anonymous access.</p>
<p>If only Basic Authentication is available, enable it.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://azure.microsoft.com/en-us/services/app-service/">App Services and equivalent</a>:</p>
<pre>
resource "azurerm_function_app" "example" {
  name = "example"

  auth_settings {
    enabled = false # Sensitive
  }

  auth_settings {
    enabled = true
    unauthenticated_client_action = "AllowAnonymous" # Sensitive
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/api-management/">API Management</a>:</p>
<pre>
resource "azurerm_api_management_api" "example" { # Sensitive, the openid_authentication block is missing
  name = "example-api"
}

resource "azurerm_api_management" "example" {
  sign_in {
    enabled = false # Sensitive
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/data-factory/">Data Factory</a> Linked Services:</p>
<pre>
resource "azurerm_data_factory_linked_service_sftp" "example" {
  authentication_type = "Anonymous"
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/product-categories/storage/">Storage Accounts</a>:</p>
<pre>
resource "azurerm_storage_account" "example" {
  allow_blob_public_access = true # Sensitive
}

resource "azurerm_storage_container" "example" {
  container_access_type = "blob" # Sensitive
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/cache/">Redis Caches</a>:</p>
<pre>
resource "azurerm_redis_cache" "example" {
  name = "example-cache"

  redis_configuration {
    enable_authentication = false # Sensitive
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://azure.microsoft.com/en-us/services/app-service/">App Services and equivalent</a>:</p>
<pre>
resource "azurerm_function_app" "example" {
  name = "example"

  auth_settings {
    enabled = true
    unauthenticated_client_action = "RedirectToLoginPage"
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/api-management/">API Management</a>:</p>
<pre>
resource "azurerm_api_management_api" "example" {
  name = "example-api"

  openid_authentication {
    openid_provider_name = azurerm_api_management_openid_connect_provider.example.name
  }
}

resource "azurerm_api_management" "example" {
  sign_in {
    enabled = true
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/data-factory/">Data Factory</a> Linked Services:</p>
<pre>
resource "azurerm_data_factory_linked_service_sftp" "example" {
  authentication_type = "Basic"
  username            = local.creds.username
  password            = local.creds.password
}

resource "azurerm_data_factory_linked_service_odata" "example" {
  basic_authentication {
    username = local.creds.username
    password = local.creds.password
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/product-categories/storage/">Storage Accounts</a>:</p>
<pre>
resource "azurerm_storage_account" "example" {
  allow_blob_public_access = true
}

resource "azurerm_storage_container" "example" {
  container_access_type = "private"
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/cache/">Redis Caches</a>:</p>
<pre>
resource "azurerm_redis_cache" "example" {
  name = "example-cache"

  redis_configuration {
    enable_authentication = true
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Boken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6381"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6381">
              terraform:S6381
            </a>
          </td>
          <td >
            <details>
              <p>Azure Resource Manager offers built-in roles that can be assigned to users, groups, or service principals. Some of these roles should be carefully
assigned as they grant sensitive permissions like the ability to reset passwords for all users.</p>
<p>An Azure account that fails to limit the use of such roles has a higher risk of being breached by a compromised owner.</p>
<p>This rule raises an issue when one of the following roles is assigned:</p>
<ul>
  <li> Contributor </li>
  <li> Owner </li>
  <li> User Access Administrator </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The user, group, or service principal doesn’t use the entirety of this extensive set of permissions to operate on a day-to-day basis. </li>
  <li> It is possible to follow the Separation of Duties principle and split permissions between multiple users, but it’s not enforced. There is a
  risk if you answered yes to any of these questions. </li>
</ul>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Limit the assignment of Owner roles to less than 3 people or service principals. </li>
  <li> Apply the least privilege principle by choosing a role with a limited set of permissions. </li>
  <li> If no built-in role meets your needs, create a custom role with as few permissions as possible. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
resource "azurerm_role_assignment" "example" {
  scope                = azurerm_resource_group.example.id
  role_definition_name = "Owner" # Sensitive
  principal_id         = data.azuread_user.example.id
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "azurerm_role_assignment" "example" {
  scope                = azurerm_resource_group.example.id
  role_definition_name = "Azure Maps Data Reader"
  principal_id         = data.azuread_user.example.id
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP Top 10 2017 Category A5</a> - Broken Access
  Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles">Azure Documentation</a> - Azure built-in roles </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices">Azure Documentation</a> - Best practices for Azure
  RBAC </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6383"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6383">
              terraform:S6383
            </a>
          </td>
          <td >
            <details>
              <p>Disabling Role-Based Access Control (RBAC) on Azure resources can reduce an organization’s ability to protect itself against access controls being
compromised.</p>
<p>To be considered safe, access controls must follow the principle of least privilege and correctly segregate duties amongst users. RBAC helps
enforce these practices by adapting the organization’s access control needs into explicit role-based policies: It helps keeping access controls
maintainable and sustainable.</p>
<p>Furthermore, RBAC allows operations teams to work faster during a security incident. It helps to mitigate account theft or intrusions by quickly
shutting down accesses.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This Azure resource is essential for the information system infrastructure. </li>
  <li> This Azure resource is essential for mission-critical functions. </li>
  <li> Compliance policies require access to this resource to be enforced through the use of Role-Based Access Control. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Enable Azure RBAC when the Azure resource supports it. </li>
  <li> For Kubernetes clusters, enable Azure RBAC if Azure AD integration is supported. Otherwise, use the built-in Kubernetes RBAC. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://azure.microsoft.com/fr-fr/services/kubernetes-service/">Azure Kubernetes Services</a>:</p>
<pre>
resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = false # Sensitive
  }
}

resource "azurerm_kubernetes_cluster" "example2" {
  role_based_access_control {
    enabled = true

    azure_active_directory {
      managed = true
      azure_rbac_enabled = false # Sensitive
    }
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/fr-fr/services/key-vault/">Key Vaults</a>:</p>
<pre>
resource "azurerm_key_vault" "example" {
  enable_rbac_authorization = false # Sensitive

}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://azure.microsoft.com/fr-fr/services/kubernetes-service/">Azure Kubernetes Services</a>:</p>
<pre>
resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = true
  }
}

resource "azurerm_kubernetes_cluster" "example" {
  role_based_access_control {
    enabled = true

    azure_active_directory {
      managed = true
      azure_rbac_enabled = true
    }
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/fr-fr/services/key-vault/">Key Vaults</a>:</p>
<pre>
resource "azurerm_key_vault" "example" {
  enable_rbac_authorization   = true

}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Boken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6275"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6275">
              terraform:S6275
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the
security of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access
to the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a
href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default">all new volumes and snapshots</a>. Volumes created
from snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The disk contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no
further modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption
globally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security
parameter will prevent any future unexpected security downgrade.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume">aws_ebs_volume</a>:</p>
<pre>
resource "aws_ebs_volume" "ebs_volume" {  # Sensitive as encryption is disabled by default
}
</pre>
<pre>
resource "aws_ebs_volume" "ebs_volume" {
  encrypted = false  # Sensitive
}
</pre>
<p>For <a
href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_encryption_by_default">aws_ebs_encryption_by_default</a>:</p>
<pre>
resource "aws_ebs_encryption_by_default" "default_encryption" {
  enabled = false  # Sensitive
}
</pre>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration">aws_launch_configuration</a>:</p>
<pre>
resource "aws_launch_configuration" "launch_configuration" {
  root_block_device {  # Sensitive as encryption is disabled by default
  }
  ebs_block_device {  # Sensitive as encryption is disabled by default
  }
}
</pre>
<pre>
resource "aws_launch_configuration" "launch_configuration" {
  root_block_device {
    encrypted = false  # Sensitive
  }
  ebs_block_device {
    encrypted = false  # Sensitive
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_volume">aws_ebs_volume</a>:</p>
<pre>
resource "aws_ebs_volume" "ebs_volume" {
  encrypted = true
}
</pre>
<p>For <a
href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/ebs_encryption_by_default">aws_ebs_encryption_by_default</a>:</p>
<pre>
resource "aws_ebs_encryption_by_default" "default_encryption" {
  enabled = true  # Optional, default is "true"
}
</pre>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/launch_configuration">aws_launch_configuration</a>:</p>
<pre>
resource "aws_launch_configuration" "launch_configuration" {
  root_block_device {
    encrypted = true
  }
  ebs_block_device {
    encrypted = true
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html">Amazon EBS encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="terraform:S6319"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6319">
              terraform:S6319
            </a>
          </td>
          <td >
            <details>
              <p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker
instances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries
physically access the storage media, they cannot decrypt encrypted data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The instance contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by
SageMaker, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_notebook_instance">aws_sagemaker_notebook_instance</a>:</p>
<pre>
resource "aws_sagemaker_notebook_instance" "notebook" {  # Sensitive, encryption disabled by default
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sagemaker_notebook_instance">aws_sagemaker_notebook_instance</a>:</p>
<pre>
resource "aws_sagemaker_notebook_instance" "notebook" {
  kms_key_id = aws_kms_key.enc_key.key_id
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html">Protect Data at Rest Using Encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6382"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6382">
              terraform:S6382
            </a>
          </td>
          <td >
            <details>
              <p>Disabling certificate-based authentication can reduce an organization’s ability to react against attacks on its critical functions and data if
any.</p>
<p>Azure offers various authentication options to access resources: Anonymous connections, Basic authentication, password-based authentication, and
certificate-based authentication.</p>
<p>Choosing certificate-based authentication helps bring client/host trust by allowing the host to verify the client and vice versa. In case of a
security incident, certificates help bring investigators traceability and allow security operations teams to react faster (by massively revoking
certificates, for example).</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This Azure resource is essential for the information system infrastructure. </li>
  <li> This Azure resource is essential for mission-critical functions. </li>
  <li> Compliance policies require access to this resource to be authenticated with certificates. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable certificate-based authentication.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://azure.microsoft.com/en-us/services/app-service/">App Service</a>:</p>
<pre>
resource "azurerm_app_service" "example" {
  client_cert_enabled = false # Sensitive
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/logic-apps/">Logic App Standards</a> and <a
href="https://azure.microsoft.com/en-us/services/functions/">Function Apps</a>:</p>
<pre>
resource "azurerm_function_app" "example" {
  client_cert_mode = "Optional" # Sensitive
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/data-factory/">Data Factory Linked Services</a>:</p>
<pre>
resource "azurerm_data_factory_linked_service_web" "example" {
  authentication_type = "Basic" # Sensitive
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/api-management/">API Management</a>:</p>
<pre>
resource "azurerm_api_management" "example" {
  sku_name = "Consumption_1"
  client_certificate_mode = "Optional" # Sensitive
}
</pre>
<p>For <a href="https://azure.microsoft.com/fr-fr/services/app-service/containers/">Linux and Windows Web Apps</a>:</p>
<pre>
resource "azurerm_linux_web_app" "example" {
  client_cert_enabled = false # Sensitive
}
resource "azurerm_linux_web_app" "exemple2" {
  client_cert_enabled = true
  client_cert_mode = "Optional" # Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://azure.microsoft.com/en-us/services/app-service/">App Service</a>:</p>
<pre>
resource "azurerm_app_service" "example" {
  client_cert_enabled = true
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/logic-apps/">Logic App Standards</a> and <a
href="https://azure.microsoft.com/en-us/services/functions/">Function Apps</a>:</p>
<pre>
resource "azurerm_function_app" "example" {
  client_cert_mode = "Required"
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/data-factory/">Data Factory Linked Services</a>:</p>
<pre>
resource "azurerm_data_factory_linked_service_web" "example" {
  authentication_type = "ClientCertificate"
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/api-management/">API Management</a>:</p>
<pre>
resource "azurerm_api_management" "example" {
  sku_name = "Consumption_1"
  client_certificate_mode = "Required"
}
</pre>
<p>For <a href="https://azure.microsoft.com/fr-fr/services/app-service/containers/">Linux and Windows Web Apps</a>:</p>
<pre>
resource "azurerm_linux_web_app" "exemple" {
  client_cert_enabled = true
  client_cert_mode = "Required"
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Boken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6270"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6270">
              terraform:S6270
            </a>
          </td>
          <td >
            <details>
              <p>Resource-based policies granting access to all users can lead to information leakage.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The AWS resource stores or processes sensitive data. </li>
  <li> The AWS resource is designed to be private. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the
context of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>
<h2>Sensitive Code Example</h2>
<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>
<pre>
resource "aws_s3_bucket_policy" "mynoncompliantpolicy" {  # Sensitive
  bucket = aws_s3_bucket.mybucket.id
  policy = jsonencode({
    Id = "mynoncompliantpolicy"
    Version = "2012-10-17"
    Statement = [{
            Effect = "Allow"
            Principal = {
                AWS = "*"
            }
            Action = [
                "s3:PutObject"
            ]
            Resource: "${aws_s3_bucket.mybucket.arn}/*"
        }
    ]
  })
}
</pre>
<h2>Compliant Solution</h2>
<p>This policy allows only the authorized users:</p>
<pre>
resource "aws_s3_bucket_policy" "mycompliantpolicy" {
  bucket = aws_s3_bucket.mybucket.id
  policy = jsonencode({
    Id = "mycompliantpolicy"
    Version = "2012-10-17"
    Statement = [{
            Effect = "Allow"
            Principal = {
                AWS = [
                    "arn:aws:iam::${data.aws_caller_identity.current.account_id}:root"
                ]
            }
            Action = [
                "s3:PutObject"
            ]
            Resource = "${aws_s3_bucket.mybucket.arn}/*"
        }
    ]
  })
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6404"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6404">
              terraform:S6404
            </a>
          </td>
          <td >
            <details>
              <p>Granting public access to GCP resources may reduce an organization’s ability to protect itself against attacks or theft of its GCP resources.<br>
Security incidents associated with misuse of public access include disruption of critical functions, data theft, and additional costs due to resource
overload.</p>
<p>To be as prepared as possible in the event of a security incident, authentication combined with fine-grained permissions helps maintain the
principle of defense in depth and trace incidents back to the perpetrators.</p>
<p>GCP also provides the ability to grant access to a large group of people:</p>
<ul>
  <li> If public access is granted to all Google users, the impact of a data theft is the same as if public access is granted to all Internet users.
  </li>
  <li> If access is granted to a large Google group, the impact of a data theft is limited based on the size of the group. </li>
</ul>
<p>The only thing that changes in these cases is the ability to track user access in the event of an incident.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This GCP resource is essential to the information system infrastructure. </li>
  <li> This GCP resource is essential to mission-critical functions. </li>
  <li> This GCP resource stores or processes sensitive data. </li>
  <li> Compliance policies require that access to this resource be authenticated. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Explicitly set access to this resource or function as private.</p>
<h2>Sensitive Code Example</h2>
<p>For IAM resources:</p>
<pre>
resource "google_cloudfunctions_function_iam_binding" "example" {
  members = [
    "allUsers",              # Sensitive
    "allAuthenticatedUsers", # Sensitive
  ]
}

resource "google_cloudfunctions_function_iam_member" "example" {
  member = "allAuthenticatedUsers" # Sensitive
}
</pre>
<p>For ACL resources:</p>
<pre>
resource "google_storage_bucket_access_control" "example" {
  entity = "allUsers" # Sensitive
}

resource "google_storage_bucket_acl" "example" {
  role_entity = [
    "READER:allUsers",              # Sensitive
    "READER:allAuthenticatedUsers", # Sensitive
  ]
}
</pre>
<p>For container clusters:</p>
<pre>
resource "google_container_cluster" "example" {
  private_cluster_config {
    enable_private_nodes    = false # Sensitive
    enable_private_endpoint = false # Sensitive
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>For IAM resources:</p>
<pre>
resource "google_cloudfunctions_function_iam_binding" "example" {
  members = [
    "serviceAccount:${google_service_account.example.email}",
    "group:${var.example_group}"
  ]
}

resource "google_cloudfunctions_function_iam_member" "example" {
  member = "user:${var.example_user}" # Sensitive
}
</pre>
<p>For ACL resources:</p>
<pre>
resource "google_storage_bucket_access_control" "example" {
  entity = "user-${var.example_user]"
}

resource "google_storage_bucket_acl" "example" {
  role_entity = [
    "READER:user-name@example.com",
    "READER:group-admins@example.com"
  ]
}
</pre>
<p>For container clusters:</p>
<pre>
resource "google_container_cluster" "example" {
  private_cluster_config {
    enable_private_nodes    = true
    enable_private_endpoint = true
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Boken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="terraform:S6249"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6249">
              terraform:S6249
            </a>
          </td>
          <td >
            <details>
              <p>By default, S3 buckets can be accessed through HTTP and HTTPs protocols.</p>
<p>As HTTP is a clear-text protocol, it lack the encryption of transported data, as well as the capability to build an authenticated connection. It
means that a malicious actor who is able to intersept traffic from the network can read, modify or corrupt the transported content.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure has to comply with AWS Foundational Security Best Practices standard. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to deny all HTTP requests:</p>
<ul>
  <li> for all objects (<code>*</code>) of the bucket </li>
  <li> for all principals (<code>*</code>) </li>
  <li> for all actions (<code>*</code>) </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>No secure policy is attached to this bucket:</p>
<pre>
resource "aws_s3_bucket" "mynoncompliantbucket" { # Sensitive
  bucket = "mynoncompliantbucketname"
}
</pre>
<p>A policy is defined but forces only HTTPs communication for some users:</p>
<pre>
resource "aws_s3_bucket" "mynoncompliantbucket" { # Sensitive
  bucket = "mynoncompliantbucketname"
}

resource "aws_s3_bucket_policy" "mynoncompliantbucketpolicy" {
  bucket = "mynoncompliantbucketname"

  policy = jsonencode({
    Version = "2012-10-17"
    Id      = "mynoncompliantbucketpolicy"
    Statement = [
      {
        Sid       = "HTTPSOnly"
        Effect    = "Deny"
        Principal = [
          "arn:aws:iam::123456789123:root"
        ] # secondary location: only one principal is forced to use https
        Action    = "s3:*"
        Resource = [
          aws_s3_bucket.mynoncompliantbucketpolicy.arn,
          "${aws_s3_bucket.mynoncompliantbucketpolicy.arn}/*",
        ]
        Condition = {
          Bool = {
            "aws:SecureTransport" = "false"
          }
        }
      },
    ]
  })
}
</pre>
<h2>Compliant Solution</h2>
<p>A secure policy that denies all HTTP requests is used:</p>
<pre>
resource "aws_s3_bucket" "mycompliantbucket" {
  bucket = "mycompliantbucketname"
}

resource "aws_s3_bucket_policy" "mycompliantpolicy" {
  bucket = "mycompliantbucketname"

  policy = jsonencode({
    Version = "2012-10-17"
    Id      = "mycompliantpolicy"
    Statement = [
      {
        Sid       = "HTTPSOnly"
        Effect    = "Deny"
        Principal = "*"
        Action    = "s3:*"
        Resource = [
          aws_s3_bucket.mycompliantbucket.arn,
          "${aws_s3_bucket.mycompliantbucket.arn}/*",
        ]
        Condition = {
          Bool = {
            "aws:SecureTransport" = "false"
          }
        }
      },
    ]
  })
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit">AWS documentation</a> - Enforce encryption
  of data in transit </li>
  <li> <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5">AWS Foundational Security
  Best Practices controls</a> - S3 buckets should require requests to use Secure Socket Layer </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6327"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6327">
              terraform:S6327
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)
communication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages
when they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to
access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The topic contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic">aws_sns_topic</a>:</p>
<pre>
resource "aws_sns_topic" "topic" {  # Sensitive, encryption disabled by default
  name = "sns-unencrypted"
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sns_topic">aws_sns_topic</a>:</p>
<pre>
resource "aws_sns_topic" "topic" {
  name = "sns-encrypted"
  kms_master_key_id = aws_kms_key.enc_key.key_id
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html">AWS Documentation</a> - Encryption at rest </li>
  <li> <a href="https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/">Encrypting messages published to
  Amazon SNS with AWS KMS</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6403"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6403">
              terraform:S6403
            </a>
          </td>
          <td >
            <details>
              <p>By default, GCP SQL instances offer encryption in transit, with support for TLS, but insecure connections are still accepted. On an unsecured
network, such as a public network, the risk of traffic being intercepted is high. When the data isn’t encrypted, an attacker can intercept it and read
confidential information.</p>
<p>When creating a GCP SQL instance, a public IP address is automatically assigned to it and connections to the SQL instance from public networks can
be authorized.</p>
<p>TLS is automatically used when connecting to SQL instances through:</p>
<ul>
  <li> The <a href="https://cloud.google.com/sql/docs/mysql/connect-admin-proxy">Cloud SQL Auth proxy</a>. </li>
  <li> The <a href="https://cloud.google.com/sql/docs/mysql/connect-overview#languages">Java Socket Library</a>. </li>
  <li> The built-in mechanisms in the <a href="https://cloud.google.com/appengine/docs">App Engine</a> environments. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<p>Connections are not already automatically encrypted by GCP (eg: SQL Auth proxy) and</p>
<ul>
  <li> Connections to the SQL instance are performed on untrusted networks. </li>
  <li> The data stored in the SQL instance is confidential. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt all connections to the SQL instance, whether using public or private IP addresses. However, since private networks can
be considered trusted, requiring TLS in this situation is usually a lower priority task.</p>
<h2>Sensitive Code Example</h2>
<pre>
resource "google_sql_database_instance" "example" { # Sensitive: tls is not required
  name             = "noncompliant-master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
    tier = "db-f1-micro"
  }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "google_sql_database_instance" "example" {
  name             = "compliant-master-instance"
  database_version = "POSTGRES_11"
  region           = "us-central1"

  settings {
    tier = "db-f1-micro"
    ip_configuration {
      require_ssl = true
      ipv4_enabled = true
    }
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://cloud.google.com/sql/docs/mysql/authorize-ssl">GCP Documentation</a> - Cloud SQL: Authorizing with SSL/TLS certificates </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6329"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6329">
              terraform:S6329
            </a>
          </td>
          <td >
            <details>
              <p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft
or disruption.</p>
<p>Depending on the component, inbound access from the Internet can be enabled via:</p>
<ul>
  <li> a boolean value that explicitly allows access to the public network. </li>
  <li> the assignment of a public IP address. </li>
  <li> database firewall rules that allow public IP ranges. </li>
</ul>
<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>
<p>This decision increases the likelihood of attacks on the organization, such as:</p>
<ul>
  <li> data breaches. </li>
  <li> intrusions into the infrastructure to permanently steal from it. </li>
  <li> and various malicious traffic, such as DDoS attacks. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<p>This cloud resource:</p>
<ul>
  <li> should be publicly accessible to any Internet user. </li>
  <li> requires inbound traffic from the Internet to function properly. </li>
</ul>
<p>There is a risk if you answered no to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce
sites.</p>
<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud
components.</p>
<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the
absence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>
<h2>Sensitive Code Example</h2>
<p>For AWS:</p>
<pre>
resource "aws_instance" "example" {
  associate_public_ip_address = true # Sensitive
}
</pre>
<pre>
resource "aws_dms_replication_instance" "example" {
  publicly_accessible = true # Sensitive
}
</pre>
<p>For Azure:</p>
<pre>
resource "azurerm_postgresql_server" "example"  {
  public_network_access_enabled = true # Sensitive
}
</pre>
<pre>
resource "azurerm_postgresql_server" "example"  {
  public_network_access_enabled = true # Sensitive
}
</pre>
<pre>
resource "azurerm_kubernetes_cluster" "production" {
  api_server_authorized_ip_ranges = ["176.0.0.0/4"] # Sensitive
  default_node_pool {
    enable_node_public_ip = true # Sensitive
  }
}
</pre>
<p>For GCP:</p>
<pre>
resource "google_compute_instance" "example" {
  network_interface {
    network = "default"

    access_config {  # Sensitive
      # Ephemeral public IP
    }
  }
</pre>
<h2>Compliant Solution</h2>
<p>For AWS:</p>
<pre>
resource "aws_instance" "example" {
  associate_public_ip_address = false
}
</pre>
<pre>
resource "aws_dms_replication_instance" "example" {
  publicly_accessible          = false
}
</pre>
<p>For Azure:</p>
<pre>
resource "azurerm_postgresql_server" "example"  {
  public_network_access_enabled = false
}
</pre>
<pre>
resource "azurerm_kubernetes_cluster" "production" {
  api_server_authorized_ip_ranges = ["192.168.0.0/16"]
  default_node_pool {
    enable_node_public_ip = false
  }
}
</pre>
<p>For GCP:</p>
<pre>
resource "google_compute_instance" "example" {
  network_interface {
    network = "default"
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html">AWS Documentation</a> - Amazon EC2 instance IP
  addressing </li>
  <li> <a href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html">AWS Documentation</a> - Public and
  private replication instances </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html">AWS Documentation</a> - VPC Peering </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6406"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6406">
              terraform:S6406
            </a>
          </td>
          <td >
            <details>
              <p>Excessive granting of GCP IAM permissions can allow attackers to exploit an organization’s cloud resources with malicious intent.</p>
<p>To prevent improper creation or deletion of resources after an account is compromised, proactive measures include both following GCP Security
Insights and ensuring custom roles contain as few privileges as possible.</p>
<p>After gaining a foothold in the target infrastructure, sophisticated attacks typically consist of two major parts.<br> First, attackers must deploy
new resources to carry out their malicious intent. To guard against this, operations teams must control what unexpectedly appears in the
infrastructure, such as what is:</p>
<ul>
  <li> added </li>
  <li> written down </li>
  <li> updated </li>
  <li> started </li>
  <li> appended </li>
  <li> applied </li>
  <li> accessed. </li>
</ul>
<p>Once the malicious intent is executed, attackers must avoid detection at all costs.<br> To counter attackers' attempts to remove their
fingerprints, operations teams must control what unexpectedly disappears from the infrastructure, such as what is:</p>
<ul>
  <li> stopped </li>
  <li> disabled </li>
  <li> canceled </li>
  <li> deleted </li>
  <li> destroyed </li>
  <li> detached </li>
  <li> disconnected </li>
  <li> suspended </li>
  <li> rejected </li>
  <li> removed. </li>
</ul>
<p>For operations teams to be resilient in this scenario, their organization must apply both:</p>
<ul>
  <li> Detection security: log these actions to better detect malicious actions. </li>
  <li> Preventive security: review and limit granted permissions. </li>
</ul>
<p>This rule raises an issue when a custom role grants a number of sensitive permissions (read-write or destructive permission) that is greater than a
given parameter.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This custom role will be mostly used for read-only purposes. </li>
  <li> Compliance policies require read-only access. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>To reduce the risks associated with this role after a compromise:</p>
<ul>
  <li> Reduce the list of permissions to grant only those that are actually needed. </li>
  <li> Favor read-only over read-write. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>This custom role grants more than 5 sensitive permissions:</p>
<pre>
resource "google_project_iam_custom_role" "example" {
  permissions = [ # Sensitive
    "resourcemanager.projects.create", # Sensitive permission
    "resourcemanager.projects.delete", # Sensitive permission
    "resourcemanager.projects.get",
    "resourcemanager.projects.list",
    "run.services.create", # Sensitive permission
    "run.services.delete", # Sensitive permission
    "run.services.get",
    "run.services.getIamPolicy",
    "run.services.setIamPolicy",  # Sensitive permission
    "run.services.list",
    "run.services.update",  # Sensitive permission
  ]
}
</pre>
<h2>Compliant Solution</h2>
<p>This custom role grants less than 5 sensitive permissions:</p>
<pre>
resource "google_project_iam_custom_role" "example" {
  permissions = [
    "resourcemanager.projects.get",
    "resourcemanager.projects.list",
    "run.services.create",
    "run.services.delete",
    "run.services.get",
    "run.services.getIamPolicy",
    "run.services.list",
    "run.services.update",
  ]
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cloud.google.com/iam/docs/recommender-overview">GCP Docs</a> - Enforce least privilege with role recommendations </li>
  <li> <a href="https://cloud.google.com/iam/docs/manage-policy-insights">GCP Docs</a> - Security Insights </li>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Boken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6245">
              terraform:S6245
            </a>
          </td>
          <td >
            <details>
              <p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is
read from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if
they were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure
itself.</p>
<p>There are three SSE options:</p>
<ul>
  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)
    <ul>
      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)
    <ul>
      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)
    <ul>
      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s
      encryption keys. </li>
    </ul>  </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>
<h2>Sensitive Code Example</h2>
<p>Server-side encryption is not used:</p>
<pre>
resource "aws_s3_bucket" "example" { # Sensitive
  bucket = "example"
}
</pre>
<h2>Compliant Solution</h2>
<p>Server-side encryption with Amazon S3-managed keys is used for AWS provider version 3 or below:</p>
<pre>
resource "aws_s3_bucket" "example" {
  bucket = "example"

  server_side_encryption_configuration {
    rule {
      apply_server_side_encryption_by_default {
        sse_algorithm = "AES256"
      }
    }
  }
}
</pre>
<p>Server-side encryption with Amazon S3-managed keys is used for AWS provider version 4 or above:</p>
<pre>
resource "aws_s3_bucket" "example" {
  bucket = "example"
}

resource "aws_s3_bucket_server_side_encryption_configuration" "example" {
  bucket = aws_s3_bucket.example.bucket

  rule {
    apply_server_side_encryption_by_default {
      sse_algorithm = "AES256"
    }
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html">AWS documentation</a> - Protecting data using
  server-side encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6400"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6400">
              terraform:S6400
            </a>
          </td>
          <td >
            <details>
              <p>Granting highly privileged resource rights to users or groups can reduce an organization’s ability to protect against account or service theft. It
prevents proper segregation of duties and creates potentially critical attack vectors on affected resources.</p>
<p>If elevated access rights are abused or compromised, both the data that the affected resources work with and their access tracking are at risk.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This GCP resource is essential to the information system infrastructure. </li>
  <li> This GCP resource is essential to mission-critical functions. </li>
  <li> Compliance policies require that administrative privileges for this resource be limited to a small group of individuals. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Grant IAM policies or members a less permissive role: In most cases, granting them read-only privileges is sufficient.</p>
<p>Separate tasks by creating multiple roles that do not use a full access role for day-to-day work.</p>
<p>If the predefined GCP roles do not include the specific permissions you need, create <a
href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/google_project_iam_custom_role">custom IAM roles</a>.</p>
<h2>Sensitive Code Example</h2>
<p>For an IAM policy setup:</p>
<pre>
data "google_iam_policy" "admin" {
  binding {
    role = "roles/run.admin" # Sensitive
    members = [
      "user:name@example.com",
    ]
  }
}

resource "google_cloud_run_service_iam_policy" "policy" {
  location = google_cloud_run_service.default.location
  project = google_cloud_run_service.default.project
  service = google_cloud_run_service.default.name
  policy_data = data.google_iam_policy.admin.policy_data
}
</pre>
<p>For an IAM policy binding:</p>
<pre>
resource "google_cloud_run_service_iam_binding" "example" {
  location = google_cloud_run_service.default.location
  project = google_cloud_run_service.default.project
  service = google_cloud_run_service.default.name
  role = "roles/run.admin" # Sensitive
  members = [
    "user:name@example.com",
  ]
}
</pre>
<p>For adding a member to a policy:</p>
<pre>
resource "google_cloud_run_service_iam_member" "example" {
  location = google_cloud_run_service.default.location
  project = google_cloud_run_service.default.project
  service = google_cloud_run_service.default.name
  role = "roles/run.admin" # Sensitive
  member = "user:name@example.com"
}
</pre>
<h2>Compliant Solution</h2>
<p>For an IAM policy setup:</p>
<pre>
data "google_iam_policy" "admin" {
  binding {
    role = "roles/viewer"
    members = [
      "user:name@example.com",
    ]
  }
}

resource "google_cloud_run_service_iam_policy" "example" {
  location = google_cloud_run_service.default.location
  project = google_cloud_run_service.default.project
  service = google_cloud_run_service.default.name
  policy_data = data.google_iam_policy.admin.policy_data
}
</pre>
<p>For an IAM policy binding:</p>
<pre>
resource "google_cloud_run_service_iam_binding" "example" {
  location = google_cloud_run_service.default.location
  project = google_cloud_run_service.default.project
  service = google_cloud_run_service.default.name
  role = "roles/viewer"
  members = [
    "user:name@example.com",
  ]
}
</pre>
<p>For adding a member to a policy:</p>
<pre>
resource "google_cloud_run_service_iam_member" "example" {
  location = google_cloud_run_service.default.location
  project = google_cloud_run_service.default.project
  service = google_cloud_run_service.default.name
  role = "roles/viewer"
  member = "user:name@example.com"
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6402"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6402">
              terraform:S6402
            </a>
          </td>
          <td >
            <details>
              <p>Domain Name Systems (DNS) are vulnerable by default to various types of attacks.</p>
<p>One of the biggest risks is DNS cache poisoning, which occurs when a DNS accepts spoofed DNS data, caches the malicious records, and potentially
sends them later in response to legitimate DNS request lookups. This attack typically relies on the attacker’s <a
href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">MITM</a> ability on the network and can be used to redirect users from an intended
website to a malicious website.</p>
<p>To prevent these vulnerabilities, Domain Name System Security Extensions (DNSSEC) ensure the integrity and authenticity of DNS data by digitally
signing DNS zones.</p>
<p>The public key of a DNS zone used to validate signatures can be trusted as DNSSEC is based on the following chain of trust:</p>
<ul>
  <li> The parent DNS zone adds a "fingerprint" of the public key of the child zone in a "DS record". </li>
  <li> The parent DNS zone signs it with its own private key. </li>
  <li> And this process continues until the root zone. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<p>The parent DNS zone (likely managed by the DNS registrar of the domain name) supports DNSSEC and</p>
<ul>
  <li> The DNS zone is public (contains data such as public reachable IP addresses). </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to use DNSSEC when creating private and public DNS zones.</p>
<p>Private DNS zones cannot be queried on the Internet and provide DNS name resolution for private networks. The risk of MITM attacks might be
considered low on these networks and therefore implementing DNSSEC is still recommended but not with a high priority.</p>
<p>Note: Choose a robust signing algorithm when setting up DNSSEC, such as <code>rsasha256</code>. The <a
href="https://en.wikipedia.org/wiki/SHA-1">insecure</a> <code>rsasha1</code> algorithm should no longer be used.</p>
<h2>Sensitive Code Example</h2>
<pre>
resource "google_dns_managed_zone" "example" { # Sensitive: dnssec_config is missing
  name     = "foobar"
  dns_name = "foo.bar."
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "google_dns_managed_zone" "example" {
  name     = "foobar"
  dns_name = "foo.bar."

  dnssec_config {
    default_key_specs {
      algorithm = "rsasha256"
    }
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cloud.google.com/dns/docs/dnssec-config">GCP Documentation</a> - Manage DNSSEC configuration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/345">MITRE, CWE-345</a> - Insufficient Verification of Data Authenticity </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/353">MITRE, CWE-353</a> - Missing Support for Integrity Check </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6405"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6405">
              terraform:S6405
            </a>
          </td>
          <td >
            <details>
              <p>SSH keys stored and managed in a project’s metadata can be used to access GCP VM instances. By default, GCP automatically deploys project-level SSH
keys to VM instances.</p>
<p>Project-level SSH keys can lead to unauthorized access because:</p>
<ul>
  <li> Their use prevents fine-grained VM-level access control and makes it difficult to follow <a
  href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. </li>
  <li> Unlike managed access control with <a href="https://cloud.google.com/compute/docs/instances/managing-instance-access">OS Login</a>, manual
  cryptographic key management is error-prone and requires careful attention. For example, if a user leaves a project, their SSH keys should be
  removed from the metadata to prevent unwanted access. </li>
  <li> If a project-level SSH key is compromised, all VM instances may be compromised. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> VM instances in a project have different security requirements. </li>
  <li> Many users with different profiles need access to the VM instances in that project. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Block project-level SSH keys by setting the <code>metadata.block-project-ssh-keys</code> argument to <code>true</code> </li>
  <li> Use <a href="https://cloud.google.com/compute/docs/instances/access-overview?_ga=2.125788746.-190863609.1642494607#oslogin">OSLogin</a> to
  benefit from managed access control. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
resource "google_compute_instance" "example" { # Sensitive, because metadata.block-project-ssh-keys is not set to true
  name         = "example"
  machine_type = "e2-micro"
  zone         = "us-central1-a"

  network_interface {
    network = "default"

    access_config {
    }
  }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "google_compute_instance" "example" {
  name         = "example"
  machine_type = "e2-micro"
  zone         = "us-central1-a"

  metadata = {
    block-project-ssh-keys = true
  }

  network_interface {
    network = "default"

    access_config {
    }
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication.html">OWASP Top 10 2017 Category A2</a> - Broken
  Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/269">MITRE, CWE-269</a> - Improper Privilege Management </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/272">MITRE, CWE-272</a> - Least Privilege Violation </li>
  <li> <a href="https://cloud.google.com/compute/docs/connect/restrict-ssh-keys#remove-metadata-key">GCP Documentation</a> - Restrict SSH keys from
  VMs </li>
  <li> <a href="https://cloud.google.com/compute/docs/instances/access-overview#risks">GCP Documentation</a> - Risks of manual key management </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6401"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6401">
              terraform:S6401
            </a>
          </td>
          <td >
            <details>
              <p>The likelihood of security incidents increases when cryptographic keys are used for a long time. Thus, to strengthen the data protection it’s
recommended to rotate the symmetric keys created with the Google Cloud Key Management Service (KMS) automatically and periodically. Note that it’s not
possible in GCP KMS to rotate asymmetric keys automatically.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The cryptographic key is a symmetric key. </li>
  <li> The application requires compliance with some security standards like PCI-DSS. </li>
</ul>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to rotate keys automatically and regularly. The shorter the key period, the less data can be decrypted by an attacker if a key is
compromised. So the key rotation period usually depends on the amount of data encrypted with a key or other requirements such as compliance with
security standards. In general, a period of time of 90 days can be used.</p>
<h2>Sensitive Code Example</h2>
<pre>
resource "google_kms_crypto_key" "noncompliant-key" { # Sensitive: a rotation period is not defined
  name            = "crypto-key-compliant"
  key_ring        = google_kms_key_ring.keyring.id"
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "google_kms_crypto_key" "compliant-key" {
  name            = "crypto-key-compliant"
  key_ring        = google_kms_key_ring.keyring.id
  rotation_period = "7776000s" # 90 days
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cloud.google.com/kms/docs/key-rotation">GCP Documentation</a> - KMS Key rotation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6407"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6407">
              terraform:S6407
            </a>
          </td>
          <td >
            <details>
              <p>App Engine supports encryption in transit through TLS. As soon as the app is deployed, it can be requested using <code>appspot.com</code> domains
or custom domains. By default, endpoints accept both clear-text and encrypted traffic. When communication isn’t encrypted, there is a risk that an
attacker could intercept it and read confidential information.</p>
<p>When creating an App Engine, request handlers can be set with different security level for encryption:</p>
<ul>
  <li> <code>SECURE_NEVER</code>: only HTTP requests are allowed (HTTPS requests are redirected to HTTP). </li>
  <li> <code>SECURE_OPTIONAL</code> and <code>SECURE_DEFAULT</code>: both HTTP and HTTPS requests are allowed. </li>
  <li> <code>SECURE_ALWAYS</code>: only HTTPS requests are allowed (HTTP requests are redirected to HTTPS). </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The handler serves confidential data in HTTP responses. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended for App Engine handlers to require TLS for all traffic. It can be achieved by setting the security level to
<code>SECURE_ALWAYS</code>.</p>
<h2>Sensitive Code Example</h2>
<p><code>SECURE_DEFAULT</code>, <code>SECURE_NEVER</code> and <code>SECURE_OPTIONAL</code> are sensitive TLS security level:</p>
<pre>
resource "google_app_engine_standard_app_version" "example" {
  version_id = "v1"
  service    = "default"
  runtime    = "nodejs"

  handlers {
    url_regex                   = ".*"
    redirect_http_response_code = "REDIRECT_HTTP_RESPONSE_CODE_301"
    security_level              = "SECURE_OPTIONAL" # Sensitive
    script {
      script_path = "auto"
    }
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>Force the use of TLS for the handler by setting the security level on <code>SECURE_ALWAYS</code>:</p>
<pre>
resource "google_app_engine_standard_app_version" "example" {
  version_id = "v1"
  service    = "default"
  runtime    = "nodejs"

  handlers {
    url_regex                   = ".*"
    redirect_http_response_code = "REDIRECT_HTTP_RESPONSE_CODE_301"
    security_level              = "SECURE_ALWAYS"
    script {
      script_path = "auto"
    }
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://cloud.google.com/appengine/docs/standard/nodejs/application-security">GCP Documentation</a> - Overview of App Security </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6408"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6408">
              terraform:S6408
            </a>
          </td>
          <td >
            <details>
              <p>Creating custom roles that allow privilege escalation can allow attackers to maliciously exploit an organization’s cloud resources.</p>
<p>Certain GCP permissions allow impersonation of one or more privileged principals within a GCP infrastructure.<br> To prevent privilege escalation
after an account has been compromised, proactively follow GCP Security Insights and ensure that custom roles contain as few privileges as possible
that allow direct or indirect impersonation.</p>
<p>For example, privileges like <code>deploymentmanager.deployments.create</code> allow impersonation of service accounts, even if the name does not
sound like it.<br> Other privileges like <code>setIamPolicy</code>, which are more explicit, directly allow their holder to extend their
privileges.</p>
<p>After gaining a foothold in the target infrastructure, sophisticated attackers typically map their newfound roles to understand what is
exploitable.</p>
<p>The riskiest privileges are either:</p>
<ul>
  <li> At the infrastructure level: privileges to perform project, folder, or organization-wide administrative tasks. </li>
  <li> At the resource level: privileges to perform resource-wide administrative tasks. </li>
</ul>
<p>In either case, the following privileges should be avoided or granted only with caution:</p>
<ul>
  <li> <code><strong>.</strong>.setIamPolicy</code> </li>
  <li> <code>cloudbuilds.builds.create</code> </li>
  <li> <code>cloudfunctions.functions.create</code> </li>
  <li> <code>cloudfunctions.functions.update</code> </li>
  <li> <code>cloudscheduler.jobs.create</code> </li>
  <li> <code>composer.environments.create</code> </li>
  <li> <code>compute.instances.create</code> </li>
  <li> <code>dataflow.jobs.create</code> </li>
  <li> <code>dataproc.clusters.create</code> </li>
  <li> <code>deploymentmanager.deployments.create</code> </li>
  <li> <code>iam.roles.update</code> </li>
  <li> <code>iam.serviceAccountKeys.create</code> </li>
  <li> <code>iam.serviceAccounts.actAs</code> </li>
  <li> <code>iam.serviceAccounts.getAccessToken</code> </li>
  <li> <code>iam.serviceAccounts.getOpenIdToken</code> </li>
  <li> <code>iam.serviceAccounts.implicitDelegation</code> </li>
  <li> <code>iam.serviceAccounts.signBlob</code> </li>
  <li> <code>iam.serviceAccounts.signJwt</code> </li>
  <li> <code>orgpolicy.policy.set</code> </li>
  <li> <code>run.services.create</code> </li>
  <li> <code>serviceusage.apiKeys.create</code> </li>
  <li> <code>serviceusage.apiKeys.list</code> </li>
  <li> <code>storage.hmacKeys.create</code> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This role requires impersonation to perform specific tasks with different privileges. </li>
  <li> This custom role is intended for a small group of administrators. </li>
</ul>
<p>There is a risk if you answered no to these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Use a permission that does not allow privilege escalation.</p>
<h2>Sensitive Code Example</h2>
<p>Lightweight custom role intended for a developer:</p>
<pre>
resource "google_organization_iam_custom_role" "example" {
  permissions = [
    "iam.serviceAccounts.getAccessToken",     # Sensitive
    "iam.serviceAccounts.getOpenIdToken",     # Sensitive
    "iam.serviceAccounts.actAs",              # Sensitive
    "iam.serviceAccounts.implicitDelegation", # Sensitive
    "resourcemanager.projects.get",
    "resourcemanager.projects.list",
    "run.services.create",
    "run.services.delete",
    "run.services.get",
    "run.services.getIamPolicy",
    "run.services.list",
    "run.services.update",
  ]
}
</pre>
<p>Lightweight custom role intended for a read-only user:</p>
<pre>
resource "google_project_iam_custom_role" "example" {
  permissions = [
    "iam.serviceAccountKeys.create",        # Sensitive
    "iam.serviceAccountKeys.get",           # Sensitive
    "deploymentmanager.deployments.create", # Sensitive
    "cloudbuild.builds.create",             # Sensitive
    "resourcemanager.projects.get",
    "resourcemanager.projects.list",
    "run.services.get",
    "run.services.getIamPolicy",
    "run.services.list",
  ]
}
</pre>
<h2>Compliant Solution</h2>
<p>Lightweight custom role intended for a developer:</p>
<pre>
resource "google_project_iam_custom_role" "example" {
  permissions = [
    "resourcemanager.projects.get",
    "resourcemanager.projects.list",
    "run.services.create",
    "run.services.delete",
    "run.services.get",
    "run.services.getIamPolicy",
    "run.services.list",
    "run.services.update",
  ]
}
</pre>
<p>Lightweight custom role intended for a read-only user:</p>
<pre>
resource "google_project_iam_custom_role" "example" {
  permissions = [
    "resourcemanager.projects.get",
    "resourcemanager.projects.list",
    "run.services.get",
    "run.services.getIamPolicy",
    "run.services.list",
  ]
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cloud.google.com/iam/docs/custom-roles-permissions-support">GCP IAM Docs</a> - Support levels for permissions in custom roles
  </li>
  <li> <a href="https://cloud.google.com/iam/docs/understanding-custom-roles">GCP IAM Docs</a> - Understanding IAM custom roles </li>
  <li> <a href="https://www.youtube.com/watch?v=Z-JFVJZ-HDA">DEFONConference Youtube Video</a> - DEF CON Safe Mode - Dylan Ayrey and Allison Donovan -
  Lateral Movement &amp; Privilege Escalation in GCP </li>
  <li> <a href="https://rhinosecuritylabs.com/gcp/privilege-escalation-google-cloud-platform-part-1/">Rhino Security Labs</a> - Privilege Escalation
  in Google Cloud Platform - Part 1 (IAM) </li>
  <li> <a href="https://rhinosecuritylabs.com/cloud-security/privilege-escalation-google-cloud-platform-part-2/">Rhino Security Labs</a> - Privilege
  Escalation in Google Cloud Platform - Part 2 (Non-IAM) </li>
  <li> <a href="https://www.praetorian.com/blog/google-cloud-platform-gcp-service-account-based-privilege-escalation-paths/">Praetorian</a> - Google
  Cloud Platform (GCP) Service Account-based Privilege Escalation paths </li>
  <li> <a href="https://cloud.google.com/iam/docs/manage-policy-insights">GCP Docs</a> - Security Insights </li>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Boken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6409"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6409">
              terraform:S6409
            </a>
          </td>
          <td >
            <details>
              <p>Enabling Legacy Authorization, Attribute-Based Access Control (ABAC), on Google Kubernetes Engine resources can reduce an organization’s ability to
protect itself against access controls being compromised.</p>
<p>For Kubernetes, Attribute-Based Access Control has been superseded by Role-Based Access Control. ABAC is not under active development anymore and
thus should be avoided.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This resource is essential for the information system infrastructure. </li>
  <li> This resource is essential for mission-critical functions. </li>
  <li> Compliance policies require access to this resource to be enforced through the use of Role-Based Access Control. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Unless you are relying on ABAC, leave it disabled.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://cloud.google.com/kubernetes-engine">Google Kubernetes Engine</a>:</p>
<pre>
resource "google_container_cluster" "example" {
  enable_legacy_abac = true # Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://cloud.google.com/kubernetes-engine">Google Kubernetes Engine</a>:</p>
<pre>
resource "google_container_cluster" "example" {
  enable_legacy_abac = false
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Boken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Boken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#leave_abac_disabled">Google Cloud Documentation</a> -
  Hardening your cluster’s security </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6281"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6281">
              terraform:S6281
            </a>
          </td>
          <td >
            <details>
              <p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>
<p>This access control can be relaxed with ACLs or policies.</p>
<p>To prevent permissive policies to be set on a S3 bucket the following settings can be configured:</p>
<ul>
  <li> <code>BlockPublicAcls</code>: to block or not public ACLs to be set to the S3 bucket. </li>
  <li> <code>IgnorePublicAcls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>
  <li> <code>BlockPublicPolicy</code>: to block or not public policies to be set to the S3 bucket. </li>
  <li> <code>RestrictPublicBuckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket
  owner account. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>
  <li> These settings are not already enforced to true at the account level. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to configure:</p>
<ul>
  <li> <code>BlockPublicAcls</code> to <code>true</code> to block new attempts to set public ACLs. </li>
  <li> <code>IgnorePublicAcls</code> to <code>true</code> to block existing public ACLs. </li>
  <li> <code>BlockPublicPolicy</code> to <code>true</code> to block new attempts to set public policies. </li>
  <li> <code>RestrictPublicBuckets</code> to <code>true</code> to restrict existing public policies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>By default, when not set, the <code>aws_s3_bucket_public_access_block</code> is fully deactivated (nothing is blocked):</p>
<pre>
resource "aws_s3_bucket" "example" { # Sensitive: no Public Access Block defined for this bucket
  bucket = "example"
}
</pre>
<p>This <code>aws_s3_bucket_public_access_block</code> allows public ACL to be set:</p>
<pre>
resource "aws_s3_bucket" "example" {  # Sensitive
  bucket = "examplename"
}

resource "aws_s3_bucket_public_access_block" "example-public-access-block" {
  bucket = aws_s3_bucket.example.id

  block_public_acls       = false # should be true
  block_public_policy     = true
  ignore_public_acls      = true
  restrict_public_buckets = true
}
</pre>
<h2>Compliant Solution</h2>
<p>This <code>aws_s3_bucket_public_access_block</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public
policies:</p>
<pre>
resource "aws_s3_bucket" "example" {
  bucket = "example"
}

resource "aws_s3_bucket_public_access_block" "example-public-access-block" {
  bucket = aws_s3_bucket.example.id

  block_public_acls       = true
  block_public_policy     = true
  ignore_public_acls      = true
  restrict_public_buckets = true
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html">AWS Documentation</a> - Blocking public
  access to your Amazon S3 storage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="terraform:S6364"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6364">
              terraform:S6364
            </a>
          </td>
          <td >
            <details>
              <p>Reducing the backup retention duration can reduce an organization’s ability to re-establish service in case of a security incident.</p>
<p>Data backups allow to overcome corruption or unavailability of data by recovering as efficiently as possible from a security incident.</p>
<p>Backup retention duration, coverage, and backup locations are essential criteria regarding functional continuity.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This component is essential for the information system infrastructure. </li>
  <li> This component is essential for mission-critical functions. </li>
  <li> Compliance policies require this component to be backed up for a specific amount of time. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Increase the backup retention period to an amount of time sufficient enough to be able to restore service in case of an incident.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://aws.amazon.com/rds/">Amazon Relational Database Service</a> clusters and instances:</p>
<pre>
resource "aws_db_instance" "example" {
  backup_retention_period = 2 # Sensitive
}
</pre>
<p>For <a href="https://docs.microsoft.com/en-us/azure/cosmos-db/introduction">Azure Cosmos DB</a> accounts:</p>
<pre>
resource "azurerm_cosmosdb_account" "example" {
  backup {
    type = "Periodic"
    retention_in_hours = 8 # Sensitive
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://aws.amazon.com/rds/">Amazon Relational Database Service</a> clusters and instances:</p>
<pre>
resource "aws_db_instance" "example" {
  backup_retention_period = 5
}
</pre>
<p>For <a href="https://docs.microsoft.com/en-us/azure/cosmos-db/introduction">Azure Cosmos DB</a> accounts:</p>
<pre>
resource "azurerm_cosmosdb_account" "example" {
  backup {
    type = "Periodic"
    retention_in_hours = 300
  }
}
</pre>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6414"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6414">
              terraform:S6414
            </a>
          </td>
          <td >
            <details>
              <p>The Google Cloud audit logs service records administrative activities and accesses to Google Cloud resources of the project. It’s important to
enable audit logs to be able to investigate malicious activities in the event of a security incident.</p>
<p>Some project members may be exempted from having their activities recorded in the Google Cloud audit log service, creating a blind spot and
reducing the capacity to investigate future security events.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The members exempted from having their activity logged have high privileges. </li>
  <li> Compliance rules require that audit log should be activated for all members. </li>
</ul>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to have a consistent audit logging policy for all project members and therefore not to create logging exemptions for certain
members.</p>
<h2>Sensitive Code Example</h2>
<pre>
resource "google_project_iam_audit_config" "example" {
  project = data.google_project.project.id
  service = "allServices"
  audit_log_config {
    log_type = "ADMIN_READ"
    exempted_members = [ # Sensitive
      "user:rogue.administrator@gmail.com",
    ]
  }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "google_project_iam_audit_config" "example" {
  project = data.google_project.project.id
  service = "allServices"
  audit_log_config {
    log_type = "ADMIN_READ"
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring.html">OWASP Top 10 2017 Category A10</a> -
  Insufficient Logging &amp; Monitoring </li>
  <li> <a href="https://cloud.google.com/logging/docs/audit">GCP Documentation</a> - Cloud Audit Logs overview </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6333"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6333">
              terraform:S6333
            </a>
          </td>
          <td >
            <details>
              <p>A public API, which can be requested by any authenticated or unauthenticated identities, can lead to unauthorized actions and information
disclosures.</p>
<h2>Ask Yourself Whether</h2>
<p>The public API:</p>
<ul>
  <li> exposes sensitive data like personal information. </li>
  <li> can be used to perform sensitive operations. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict API access to authorized entities, unless the API offers a non-sensitive service designed to be public.</p>
<h2>Noncompliant Code Example</h2>
<p>A public API that doesn’t have access control implemented:</p>
<pre>
resource "aws_api_gateway_method" "noncompliantapi" {
  authorization = "NONE" # Sensitive
  http_method   = "GET"
}
</pre>
<h2>Compliant Solution</h2>
<p>An API that implements AWS IAM permissions:</p>
<pre>
resource "aws_api_gateway_method" "compliantapi" {
  authorization = "AWS_IAM"
  http_method   = "GET"
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html">AWS Documentation</a> -
  Controlling and managing access to a REST API in API Gateway </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6378"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6378">
              terraform:S6378
            </a>
          </td>
          <td >
            <details>
              <p>Disabling Managed Identities can reduce an organization’s ability to protect itself against configuration faults and credentials leaks.</p>
<p>Authenticating via managed identities to an Azure resource solely relies on an API call with a non-secret token. The process is inner to Azure:
secrets used by Azure are not even accessible to end-users.</p>
<p>In typical scenarios without managed identities, the use of credentials can lead to mistakenly leaving them in code bases. In addition,
configuration faults may also happen when storing these values or assigning them permissions.</p>
<p>By transparently taking care of the Azure Active Directory authentication, Managed Identities allow getting rid of day-to-day credentials
management.</p>
<h2>Ask Yourself Whether</h2>
<p>The resource:</p>
<ul>
  <li> Needs to authenticate to Azure resources that support Azure Active Directory (AAD). </li>
  <li> Uses a different Access Control system that doesn’t guarantee the same security controls as AAD, or no Access Control system at all. </li>
</ul>
<p>There is a risk if you answered yes to all of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable the Managed Identities capabilities of this Azure resource. If supported, use a System-Assigned managed identity, as:</p>
<ul>
  <li> It cannot be shared across resources. </li>
  <li> Its life cycle is deeply tied to the life cycle of its Azure resource. </li>
  <li> It provides a unique independent identity. </li>
</ul>
<p>Alternatively, User-Assigned Managed Identities can also be used but don’t guarantee the properties listed above.</p>
<h2>Sensitive Code Example</h2>
<p>For Typical identity blocks:</p>
<pre>
resource "azurerm_api_management" "example" { # Sensitive, the identity block is missing
  name           = "example"
  publisher_name = "company"
}
</pre>
<p>For connections between Kusto Clusters and Azure Data Factory:</p>
<pre>
resource "azurerm_data_factory_linked_service_kusto" "example" {
  name                 = "example"
  use_managed_identity = false # Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<p>For Typical identity blocks:</p>
<pre>
resource "azurerm_api_management" "example" {
  name           = "example"
  publisher_name = "company"

  identity {
    type = "SystemAssigned"
  }
}
</pre>
<p>For connections between Kusto Clusters and Azure Data Factory:</p>
<pre>
resource "azurerm_data_factory_linked_service_kusto" "example" {
  name                 = "example"
  use_managed_identity = true
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A05</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A06</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview">Azure AD Documentation - Managed
  Identities Overview</a> </li>
  <li> <a
  href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/managed-identity-best-practice-recommendations">Azure AD Documentation - Managed Identities Best Practices</a> </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/services-support-managed-identities">Azure
  AD Documentation - Services that support managed identities</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="terraform:S6379"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6379">
              terraform:S6379
            </a>
          </td>
          <td >
            <details>
              <p>Enabling Azure resource-specific admin accounts can reduce an organization’s ability to protect itself against account or service account
thefts.</p>
<p>Full Administrator permissions fail to correctly separate duties and create potentially critical attack vectors on the impacted resources.</p>
<p>In case of abuse of elevated permissions, both the data on which impacted resources operate and their access traceability are at risk.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This Azure resource is essential for the information system infrastructure. </li>
  <li> This Azure resource is essential for mission-critical functions. </li>
  <li> Compliance policies require this resource to disable its administrative accounts or permissions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Disable the administrative accounts or permissions in this Azure resource.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.microsoft.com/en-us/azure/batch/nodes-and-pools#pools">Azure Batch Pools</a>:</p>
<pre>
resource "azurerm_batch_pool" "example" {
  name = "sensitive"

  start_task {
    command_line = "echo 'Hello World'"
    max_task_retry_count = 1
    wait_for_success = true

    user_identity {
      auto_user {
        elevation_level = "Admin" # Sensitive
        scope = "Task"
      }
    }
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/container-registry/">Azure Container Registries</a>:</p>
<pre>
resource "azurerm_container_registry" "example" {
  name = "example"
  admin_enabled = true # Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.microsoft.com/en-us/azure/batch/nodes-and-pools#pools">Azure Batch Pools</a>:</p>
<pre>
resource "azurerm_batch_pool" "example" {
  name = "example"

  start_task {
    command_line = "echo 'Hello World'"
    max_task_retry_count = 1
    wait_for_success = true

    user_identity {
      auto_user {
        elevation_level = "NonAdmin"
        scope = "Task"
      }
    }
  }
}
</pre>
<p>For <a href="https://azure.microsoft.com/en-us/services/container-registry/">Azure Container Registries</a>:</p>
<pre>
resource "azurerm_container_registry" "exemple" {
  name = "example"
  admin_enabled = false
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6412"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6412">
              terraform:S6412
            </a>
          </td>
          <td >
            <details>
              <p>When object versioning for Google Cloud Storage (GCS) buckets is enabled, different versions of an object are stored in the bucket, preventing
accidental deletion. A specific version can always be deleted when the generation number of an object version is specified in the request.</p>
<p>Object versioning cannot be enabled on a bucket with a retention policy. A retention policy ensures that an object is retained for a specific
period of time even if a request is made to delete or replace it. Thus, a retention policy locks the single current version of an object in the
bucket, which differs from object versioning where different versions of an object are retained.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The bucket stores information that require high availability. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable GCS bucket versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>
<h2>Sensitive Code Example</h2>
<p>Versioning is disabled by default:</p>
<pre>
resource "google_storage_bucket" "example" { # Sensitive
  name          = "example"
  location      = "US"
}
</pre>
<h2>Compliant Solution</h2>
<p>Versioning is enabled:</p>
<pre>
resource "google_storage_bucket" "example" {
  name          = "example"
  location      = "US"

  versioning {
    enabled = "true"
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cloud.google.com/storage/docs/object-versioning?hl=en">GCP documentation</a> - Object Versioning </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6413"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6413">
              terraform:S6413
            </a>
          </td>
          <td >
            <details>
              <p>Defining a short log retention duration can reduce an organization’s ability to backtrace the actions of malicious actors in case of a security
incident.</p>
<p>Logging allows operational and security teams to get detailed and real-time feedback on an information system’s events. The logging coverage
enables them to quickly react to events, ranging from the most benign bugs to the most impactful security incidents, such as intrusions.</p>
<p>Apart from security detection, logging capabilities also directly influence future digital forensic analyses. For example, detailed logging will
allow investigators to establish a timeline of the actions perpetrated by an attacker.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This component is essential for the information system infrastructure. </li>
  <li> This component is essential for mission-critical functions. </li>
  <li> Compliance policies require traceability for a longer duration. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Setting log retention period to 14 days is the bare minimum. It’s recommended to increase it to 30 days or above.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.microsoft.com/en-us/azure/firewall-manager/policy-overview">Azure Firewall Policy</a>:</p>
<pre>
resource "azurerm_firewall_policy" "example" {
  insights {
    enabled = true
    retention_in_days = 7 # Sensitive
  }
}
</pre>
<p>For <a href="https://cloud.google.com/logging/docs/routing/overview#buckets">Google Cloud Logging buckets</a>:</p>
<pre>
resource "google_logging_project_bucket_config" "example" {
    project = var.project
    location = "global"
    retention_days = 7 # Sensitive
    bucket_id = "_Default"
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.microsoft.com/en-us/azure/firewall-manager/policy-overview">Azure Firewall Policy</a>:</p>
<pre>
resource "azurerm_firewall_policy" "example" {
  insights {
    enabled = true
    retention_in_days = 30
  }
}
</pre>
<p>For <a href="https://cloud.google.com/logging/docs/routing/overview#buckets">Google Cloud Logging buckets</a>:</p>
<pre>
resource "google_logging_project_bucket_config" "example" {
    project = var.project
    location = "global"
    retention_days = 30
    bucket_id = "_Default"
}
</pre>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6252"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6252">
              terraform:S6252
            </a>
          </td>
          <td >
            <details>
              <p>S3 buckets can be in three states related to versioning:</p>
<ul>
  <li> unversioned (default one) </li>
  <li> enabled </li>
  <li> suspended </li>
</ul>
<p>When the S3 bucket is unversioned or has versioning suspended it means that a new version of an object overwrites an existing one in the S3
bucket.</p>
<p>It can lead to unintentional or intentional information loss.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The bucket stores information that require high availability. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>
<h2>Sensitive Code Example</h2>
<p>Versioning is disabled by default:</p>
<pre>
resource "aws_s3_bucket" "example" { # Sensitive
  bucket = "example"
}
</pre>
<h2>Compliant Solution</h2>
<p>Versioning is enabled for AWS provider version 4 or above:</p>
<pre>
resource "aws_s3_bucket" "example" {
  bucket = "example"
}

resource "aws_s3_bucket_versioning" "example-versioning" {
  bucket = aws_s3_bucket.example.id
  versioning_configuration {
    status = "Enabled"
  }
}
</pre>
<p>Versioning is enabled for AWS provider version 3 or below:</p>
<pre>
resource "aws_s3_bucket" "example" {
  bucket = "example"

  versioning {
    enabled = true
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html">AWS documentation</a> - Using versioning in S3 buckets </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6258"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6258">
              terraform:S6258
            </a>
          </td>
          <td >
            <details>
              <p>Disabling logging of this component can lead to missing traceability in case of a security incident.</p>
<p>Logging allows operational and security teams to get detailed and real-time feedback on an information system’s events. The logging coverage
enables them to quickly react to events, ranging from the most benign bugs to the most impactful security incidents, such as intrusions.</p>
<p>Apart from security detection, logging capabilities also directly influence future digital forensic analyses. For example, detailed logging will
allow investigators to establish a timeline of the actions perpetrated by an attacker.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This component is essential for the information system infrastructure. </li>
  <li> This component is essential for mission-critical functions. </li>
  <li> Compliance policies require this component to be monitored. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable the logging capabilities of this component. Depending on the component, new permissions might be required by the logging storage
components.<br> You should consult the official documentation to enable logging for the impacted components. For example, AWS Application Load
Balancer Access Logs <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/enable-access-logging.html">require an additional
bucket policy</a>.</p>
<h2>Sensitive Code Example</h2>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket">S3 access requests</a>:</p>
<pre>
resource "aws_s3_bucket" "example" { # Sensitive
  bucket = "example"
}
</pre>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage">API Gateway stages</a>:</p>
<pre>
resource "aws_api_gateway_stage" "example" { # Sensitive
  xray_tracing_enabled = false # Sensitive
}
</pre>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster">MSK Broker logs</a>:</p>
<pre>
resource "aws_msk_cluster" "example" {
  cluster_name           = "example"
  kafka_version          = "2.7.1"
  number_of_broker_nodes = 3

  logging_info {
    broker_logs { # Sensitive
      firehose {
        enabled = false
      }
      s3 {
        enabled = false
      }
    }
  }
}
</pre>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker">MQ Brokers</a>:</p>
<pre>
resource "aws_mq_broker" "example" {
  logs {  # Sensitive
    audit   = false
    general = false
  }
}
</pre>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster">Amazon DocumentDB</a>:</p>
<pre>
resource "aws_docdb_cluster" "example" { # Sensitive
  cluster_identifier = "example"
}
</pre>
<p>For Azure <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service">App Services</a>:</p>
<pre>
resource "azurerm_app_service" "example" {
  logs {
    application_logs {
      file_system_level = "Off" # Sensitive
      azure_blob_storage {
        level = "Off"           # Sensitive
      }
    }
  }
}
</pre>
<p>For GCP <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork/">VPC Subnetwork</a>:</p>
<pre>
resource "google_compute_subnetwork" "example" { # Sensitive
  name          = "example"
  ip_cidr_range = "10.2.0.0/16"
  region        = "us-central1"
  network       = google_compute_network.example.id
}
</pre>
<p>For GCP <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance/">SQL Database
Instance</a>:</p>
<pre>
resource "google_sql_database_instance" "example" {
  name = "example"

  settings { # Sensitive
    tier = "db-f1-micro"
    ip_configuration {
      require_ssl  = true
      ipv4_enabled = true
    }
  }
}
</pre>
<p>For GCP <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster/">Kubernetes Engine (GKE)
cluster</a>:</p>
<pre>
resource "google_container_cluster" "example" {
  name               = "example"
  logging_service    = "none" # Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket">S3 access requests</a>:</p>
<pre>
resource "aws_s3_bucket" "example-logs" {
  bucket = "example_logstorage"
  acl    = "log-delivery-write"
}

resource "aws_s3_bucket" "example" {
  bucket = "example"

  logging { # AWS provider &lt;= 3
      target_bucket = aws_s3_bucket.example-logs.id
      target_prefix = "log/example"
  }
}

resource "aws_s3_bucket_logging" "example" { # AWS provider &gt;= 4
  bucket = aws_s3_bucket.example.id

  target_bucket = aws_s3_bucket.example-logs.id
  target_prefix = "log/example"
}
</pre>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/api_gateway_stage">API Gateway stages</a>:</p>
<pre>
resource "aws_api_gateway_stage" "example" {
  xray_tracing_enabled = true

  access_log_settings {
    destination_arn = "arn:aws:logs:eu-west-1:123456789:example"
    format = "..."
  }
}
</pre>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/msk_cluster">MSK Broker logs</a>:</p>
<pre>
resource "aws_msk_cluster" "example" {
  cluster_name           = "example"
  kafka_version          = "2.7.1"
  number_of_broker_nodes = 3

  logging_info {
    broker_logs {
      firehose   {
        enabled = false
      }
      s3 {
        enabled = true
        bucket  = "example"
        prefix  = "log/msk-"
      }
    }
  }
}
</pre>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/mq_broker">MQ Brokers</a>, enable
<code>audit</code> or <code>general</code>:</p>
<pre>
resource "aws_mq_broker" "example" {
  logs {
    audit   = true
    general = true
  }
}
</pre>
<p>For Amazon <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/docdb_cluster">Amazon DocumentDB</a>:</p>
<pre>
resource "aws_docdb_cluster" "example" {
  cluster_identifier              = "example"
  enabled_cloudwatch_logs_exports = ["audit"]
}
</pre>
<p>For Azure <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/app_service">App Services</a>:</p>
<pre>
resource "azurerm_app_service" "example" {
 logs {
    http_logs {
      file_system {
        retention_in_days = 90
        retention_in_mb   = 100
      }
    }

 application_logs {
      file_system_level = "Error"
      azure_blob_storage {
        retention_in_days = 90
        level             = "Error"
      }
    }
  }
}
</pre>
<p>For GCP <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_subnetwork/">VPC Subnetwork</a>:</p>
<pre>
resource "google_compute_subnetwork" "example" {
  name          = "example"
  ip_cidr_range = "10.2.0.0/16"
  region        = "us-central1"
  network       = google_compute_network.example.id

  log_config {
    aggregation_interval = "INTERVAL_10_MIN"
    flow_sampling        = 0.5
    metadata             = "INCLUDE_ALL_METADATA"
  }
}
</pre>
<p>For GCP <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance/">SQL Database
Instance</a>:</p>
<pre>
resource "google_sql_database_instance" "example" {
  name             = "example"

  settings {
    ip_configuration {
      require_ssl  = true
      ipv4_enabled = true
    }
    database_flags {
      name  = "log_connections"
      value = "on"
    }
    database_flags {
      name  = "log_disconnections"
      value = "on"
    }
    database_flags {
      name  = "log_checkpoints"
      value = "on"
    }
    database_flags {
      name  = "log_lock_waits"
      value = "on"
    }
  }
}
</pre>
<p>For GCP <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster/">Kubernetes Engine (GKE)
cluster</a>:</p>
<pre>
resource "google_container_cluster" "example" {
  name               = "example"
  logging_service    = "logging.googleapis.com/kubernetes"
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html">AWS Documentation</a> - Logging requests using server access
  logging </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/778">MITRE, CWE-778</a> - Insufficient Logging </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring">OWASP Top 10 2017 Category A10</a> -
  Insufficient Logging &amp; Monitoring </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6330">
              terraform:S6330
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store
messages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message
from the file system, for example through a vulnerability in the service, they are not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The queue contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue">aws_sqs_queue</a>:</p>
<pre>
resource "aws_sqs_queue" "queue" {  # Sensitive, encryption disabled by default
  name = "sqs-unencrypted"
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sqs_queue">aws_sqs_queue</a>:</p>
<pre>
resource "aws_sqs_queue" "queue" {
  name = "sqs-encrypted"
  kms_master_key_id = aws_kms_key.enc_key.key_id
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html">AWS Documentation</a> -
  Encryption at rest </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6255"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6255">
              terraform:S6255
            </a>
          </td>
          <td >
            <details>
              <p>When S3 buckets versioning is enabled it’s possible to add an additional authentication factor before being allowed to delete versions of an object
or changing the versioning state of a bucket. It prevents accidental object deletion by forcing the user sending the delete request to prove that he
has a valid MFA device and a corresponding valid token.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information that is required to be preserved on the long term. </li>
  <li> The S3 bucket grants delete permission to many users. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable S3 MFA delete, note that:</p>
<ul>
  <li> MFA delete can only be enabled with the AWS CLI or API and with the root account. </li>
  <li> To delete an object version, the API should be used with the <code>x-amz-mfa</code> header. </li>
  <li> The API request, with the <code>x-amz-mfa</code> header, can only be used in HTTPS. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>A versioned S3 bucket does not have MFA delete enabled for AWS provider version 3 or below:</p>
<pre>
resource "aws_s3_bucket" "example" { # Sensitive
  bucket = "example"

  versioning {
    enabled = true
  }
}
</pre>
<p>A versioned S3 bucket does not have MFA delete enabled for AWS provider version 4 or above:</p>
<pre>
resource "aws_s3_bucket" "example" {
  bucket = "example"
}

resource "aws_s3_bucket_versioning" "example" { # Sensitive
  bucket = aws_s3_bucket.example.id
  versioning_configuration {
    status = "Enabled"
  }
}
</pre>
<h2>Compliant Solution</h2>
<p>MFA delete is enabled for AWS provider version 3 or below:</p>
<pre>
resource "aws_s3_bucket" "example" {
  bucket = "example"

  versioning {
    enabled = true
    mfa_delete = true
  }
}
</pre>
<p>MFA delete is enabled for AWS provider version 4 or above:</p>
<pre>
resource "aws_s3_bucket" "example" {
  bucket = "example"
}

resource "aws_s3_bucket_versioning" "example" {
  bucket = aws_s3_bucket.example.id
  versioning_configuration {
    status = "Enabled"
    mfa_delete = "Enabled"
  }
  mfa = "${var.MFA}"
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html">AWS documentation</a> - Configuring MFA
  delete </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/308">MITRE, CWE-308</a> - Use of Single-factor Authentication </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6332">
              terraform:S6332
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be
automatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are
not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The file system contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system">aws_efs_file_system</a>:</p>
<pre>
resource "aws_efs_file_system" "fs" {  # Sensitive, encryption disabled by default
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/efs_file_system">aws_efs_file_system</a>:</p>
<pre>
resource "aws_efs_file_system" "fs" {
  encrypted = true
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/efs/latest/ug/encryption.html">AWS Documentation</a> - Data encryption in Amazon EFS </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="terraform:S6375"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6375">
              terraform:S6375
            </a>
          </td>
          <td >
            <details>
              <p>Azure Active Directory offers built-in roles that can be assigned to users, groups, or service principals. Some of these roles should be carefully
assigned as they grant sensitive permissions like the ability to reset passwords for all users.</p>
<p>An Azure account that fails to limit the use of such roles has a higher risk of being breached by a compromised owner.</p>
<p>This rule raises an issue when one of the following roles is assigned:</p>
<ul>
  <li> Application Administrator </li>
  <li> Authentication Administrator </li>
  <li> Cloud Application Administrator </li>
  <li> Global Administrator </li>
  <li> Groups Administrator </li>
  <li> Helpdesk Administrator </li>
  <li> Password Administrator </li>
  <li> Privileged Authentication Administrator </li>
  <li> Privileged Role Administrator </li>
  <li> User Administrator </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The user, group, or service principal doesn’t use the entirety of this extensive set of permissions to operate on a day-to-day basis. </li>
  <li> It is possible to follow the Separation of Duties principle and split permissions between multiple users, but it’s not enforced. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Limit the assignment of Global Administrator roles to less than five people or service principals. </li>
  <li> Apply the least privilege principle by choosing a role with a limited set of permissions. </li>
  <li> If no built-in role meets your needs, create a custom role with as few permissions as possible. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
resource "azuread_directory_role" "example" {
  display_name = "Privileged Role Administrator" # Sensitive
}

resource "azuread_directory_role_member" "example" {
  role_object_id   = azuread_directory_role.example.object_id
  member_object_id = data.azuread_user.example.object_id
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "azuread_directory_role" "example" {
  display_name = "Usage Summary Reports Reader"
}

resource "azuread_directory_role_member" "example" {
  role_object_id   = azuread_directory_role.example.object_id
  member_object_id = data.azuread_user.example.object_id
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP Top 10 2017 Category A5</a> - Broken Access
  Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference">Azure AD Documentation</a> - Azure AD built-in
  roles </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/active-directory/roles/best-practices">Azure AD Documentation</a> - Best practices for Azure AD
  roles </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="Web:AvoidHtmlCommentCheck"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=Web:AvoidHtmlCommentCheck">
              Web:AvoidHtmlCommentCheck
            </a>
          </td>
          <td >
            <details>
              <p>Using HTML-style comments in a page that will be generated or interpolated server-side before being served to the user increases the risk of
exposing data that should be kept private. For instance, a developer comment or line of debugging information that’s left in a page could easily (and
has) inadvertently expose:</p>
<ul>
  <li> Version numbers and host names </li>
  <li> Full, server-side path names </li>
  <li> Sensitive user data </li>
</ul>
<p>Every other language has its own native comment format, thus there is no justification for using HTML-style comments in anything other than a pure
HTML or XML file.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The comment contains sensitive information. </li>
  <li> The comment can be removed. </li>
</ul>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to remove the comment or change its style so that it is not output to the client.</p>
<h2>Sensitive Code Example</h2>
<pre>
  &lt;%
      out.write("&lt;!-- ${username} --&gt;");  // Sensitive
  %&gt;
      &lt;!-- &lt;% out.write(userId) %&gt; --&gt;  // Sensitive
      &lt;!-- #{userPhone} --&gt;  // Sensitive
      &lt;!-- ${userAddress} --&gt; // Sensitive

      &lt;!-- Replace 'world' with name --&gt; // Sensitive
      &lt;h2&gt;Hello world!&lt;/h2&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
      &lt;%-- Replace 'world' with name --%&gt;  // Compliant
      &lt;h2&gt;Hello world!&lt;/h2&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/615">MITRE, CWE-615</a> - Information Exposure Through Comments </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="Web:S5148"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=Web:S5148">
              Web:S5148
            </a>
          </td>
          <td >
            <details>
              <p>A newly opened window having access back to the originating window could allow basic phishing attacks (the <code>window.opener</code> object is not
<code>null</code> and thus <code>window.opener.location</code> can be set to a malicious website by the opened page).</p>
<p>For instance, an attacker can put a link (say: "http://example.com/mylink") on a popular website that changes, when opened, the original page to
"http://example.com/fake_login". On "http://example.com/fake_login" there is a fake login page which could trick real users to enter their
credentials.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application opens untrusted external URL. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Use <code>noopener</code> to prevent untrusted pages from abusing <code>window.opener</code>.</p>
<p>Note: In Chrome 88+, Firefox 79+ or Safari 12.1+ <code>target=_blank</code> on anchors implies <code>rel=noopener</code> which make the protection
enabled by default.</p>
<h2>Sensitive Code Example</h2>
<pre>
&lt;a href="http://example.com/dangerous" target="_blank"&gt; &lt;!-- Sensitive --&gt;

&lt;a href="{{variable}}" target="_blank"&gt; &lt;!-- Sensitive --&gt;
</pre>
<h2>Compliant Solution</h2>
<p>To prevent pages from abusing <code>window.opener</code>, use <code>rel=noopener</code> on <code>&lt;a href=&gt;</code> to force its value to be
<code>null</code> on the opened pages.</p>
<pre>
&lt;a href="http://petssocialnetwork.io" target="_blank" rel="noopener"&gt; &lt;!-- Compliant --&gt;
</pre>
<h2>Exceptions</h2>
<p>No Issue will be raised when <code>href</code> contains a hardcoded relative url as there it has less chances of being vulnerable. An url is
considered hardcoded and relative if it doesn’t start with <code>http://</code> or <code>https://</code>, and if it does not contain any of the
characters {}$()[]</p>
<pre>
&lt;a href="internal.html" target="_blank" &gt; &lt;!-- Compliant --&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/Reverse_Tabnabbing">Reverse Tabnabbing</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1022">MITRE, CWE-1022</a> - Use of Web Link to Untrusted Target with window.opener Access </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mathiasbynens.github.io/rel-noopener/">https://mathiasbynens.github.io/rel-noopener/</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="Web:S5725"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=Web:S5725">
              Web:S5725
            </a>
          </td>
          <td >
            <details>
              <p>Fetching external resources, for example from a CDN, without verifying their integrity could impact the security of an application if the CDN gets
compromised and resources are replaced by malicious ones. Resources integrity feature will block resources inclusion into an application if the
pre-computed digest of the expected resource doesn’t match with the digest of the retrieved resource.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The resources are fetched from external CDNs. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> implement resources integrity checks for all static resources (where "static" means that the resource’s content doesn’t change dynamically
  based on the browser) </li>
  <li> use versioned resources instead of using "latest" version of the resources </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
&lt;script src="https://cdnexample.com/script.js"&gt;&lt;/script&gt; &lt;!-- Sensitive --&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;script src="https://cdnexample.com/script.js" integrity="sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC"&gt;&lt;/script&gt; &lt;!-- Compliant: integrity value should be replaced with the digest of the expected resource --&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/353">MITRE, CWE-353</a> - Missing Support for Integrity Check </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration.html">OWASP Top 10 2017 Category
  A6</a> - Security Misconfiguration </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">developer.mozilla.org</a> - Subresource Integrity </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5732"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5732">
              javascript:S5732
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Clickjacking">Clickjacking</a> attacks occur when an attacker try to trick an user to click on certain
buttons/links of a legit website. This attack can take place with malicious HTML frames well hidden in an attacker website.</p>
<p>For instance, suppose a safe and authentic page of a social network (https://socialnetworkexample.com/makemyprofilpublic) which allows an user to
change the visibility of his profile by clicking on a button. This is a critical feature with high privacy concerns. Users are generally well informed
on the social network of the consequences of this action. An attacker can trick users, without their consent, to do this action with the below
embedded code added on a malicious website:</p>
<pre>
&lt;html&gt;
&lt;b&gt;Click on the button below to win 5000$&lt;/b&gt;
&lt;br&gt;
&lt;iframe src="https://socialnetworkexample.com/makemyprofilpublic" width="200" height="200"&gt;&lt;/iframe&gt;
&lt;/html&gt;
</pre>
<p>Playing with the size of the iframe it’s sometimes possible to display only the critical parts of a page, in this case the button of the
<em>makemyprofilpublic</em> page.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> <a href="https://en.wikipedia.org/wiki/Clickjacking#Clickjacking_categories">Critical actions</a> of the application are prone to clickjacking
  attacks because a simple click on a link or a button can trigger them. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement content security policy <em>frame-ancestors</em> directive which is supported by all modern browsers and will specify the origins of
frame allowed to be loaded by the browser (this directive deprecates <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options">X-Frame-Options</a>).</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/helmet-csp">helmet-csp</a> or <a
href="https://www.npmjs.com/package/helmet">helmet</a> middleware is used without the <code>frameAncestors</code> directive (or if
<code>frameAncestors</code> is set to <code>'none'</code>):</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.contentSecurityPolicy({
    directives: {
      // other directives
      frameAncestors: ["'none'"] // Sensitive: frameAncestors  is set to none
    }
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application a standard way to implement CSP frame-ancestors directive is the <a
href="https://www.npmjs.com/package/helmet-csp">helmet-csp</a> or <a href="https://www.npmjs.com/package/helmet">helmet</a> middleware:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.contentSecurityPolicy({
    directives: {
      // other directives
      frameAncestors: ["'example.com'"] // Compliant
    }
  })
);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Clickjacking_Defense_Cheat_Sheet.html">OWASP Cheat Sheets</a> - Clickjacking Defense
  Cheat Sheet </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors">developer.mozilla.org</a> -
  Frame-ancestors </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">developer.mozilla.org</a> - Content Security Policy (CSP) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/451">MITRE, CWE-451</a> - User Interface (UI) Misrepresentation of Critical Information </li>
  <li> <a href="https://www.w3.org/TR/CSP3/">w3.org</a> - Content Security Policy Level 3 </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5734"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5734">
              javascript:S5734
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://blog.mozilla.org/security/2016/08/26/mitigating-mime-confusion-attacks-in-firefox/">MIME confusion</a> attacks occur when an
attacker successfully tricks a web-browser to interpret a resource as a different type than the one expected. To correctly interpret a resource
(script, image, stylesheet …​) web browsers look for the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type">Content-Type
header</a> defined in the HTTP response received from the server, but often this header is not set or is set with an incorrect value. To avoid
content-type mismatch and to provide the best user experience, web browsers try to deduce the right content-type, generally by inspecting the content
of the resources (the first bytes). This "guess mechanism" is called <a href="https://en.wikipedia.org/wiki/Content_sniffing">MIME type
sniffing</a>.</p>
<p>Attackers can take advantage of this feature when a website ("example.com" here) allows to upload arbitrary files. In that case, an attacker can
upload a malicious image <em>fakeimage.png</em> (containing malicious JavaScript code or <a
href="https://docs.microsoft.com/fr-fr/archive/blogs/ieinternals/script-polyglots">a polyglot content</a> file) such as:</p>
<pre>
&lt;script&gt;alert(document.cookie)&lt;/script&gt;
</pre>
<p>When the victim will visit the website showing the uploaded image, the malicious script embedded into the image will be executed by web browsers
performing MIME type sniffing.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type">Content-Type</a> header is not systematically set for all
  resources. </li>
  <li> Content of resources can be controlled by users. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options">X-Content-Type-Options</a> header with
<em>nosniff</em> value (the only existing value for this header) which is supported by all modern browsers and will prevent browsers from performing
MIME type sniffing, so that in case of Content-Type header mismatch, the resource is not interpreted. For example within a &lt;script&gt; object
context, JavaScript MIME types are expected (like <em>application/javascript</em>) in the Content-Type header.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if, when using <a href="https://www.npmjs.com/package/helmet">helmet</a>, the <code>noSniff</code>
middleware is disabled:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet({
    noSniff: false, // Sensitive
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>When using <code>helmet</code> in an Express.js application, the <code>noSniff</code> middleware should be enabled (it is also done by
default):</p>
<pre>
const express = require('express');
const helmet= require('helmet');

let app = express();

app.use(helmet.noSniff());
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options">developer.mozilla.org</a> - X-Content-Type-Options
  </li>
  <li> <a href="https://blog.mozilla.org/security/2016/08/26/mitigating-mime-confusion-attacks-in-firefox/">blog.mozilla.org</a> - Mitigating MIME
  Confusion Attacks in Firefox </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6268"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6268">
              javascript:S6268
            </a>
          </td>
          <td >
            <details>
              <p>Angular prevents XSS vulnerabilities by treating all values as untrusted by default. Untrusted values are systematically sanitized by the framework
before they are inserted into the DOM.</p>
<p>Still, developers have the ability to manually mark a value as trusted if they are sure that the value is already sanitized. Accidentally trusting
malicious data will introduce an XSS vulnerability in the application and enable a wide range of serious attacks like accessing/modifying sensitive
information or impersonating other users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The value for which sanitization has been disabled is user-controlled. </li>
  <li> It’s difficult to understand how this value is constructed. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Avoid including dynamic executable code and thus disabling Angular’s built-in sanitization unless it’s absolutely necessary. Try instead to
  rely as much as possible on static templates and Angular built-in sanitization to define web page content. </li>
  <li> Make sure to understand how the value to consider as trusted is constructed and never concatenate it with user-controlled data. </li>
  <li> Make sure to choose the correct <a href="https://angular.io/api/platform-browser/DomSanitizer">DomSanitizer</a> "bypass" method based on the
  context. For instance, only use <code>bypassSecurityTrustUrl</code> to trust urls in an <code>href</code> attribute context. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
import { Component, OnInit } from '@angular/core';
import { DomSanitizer, SafeHtml } from "@angular/platform-browser";
import { ActivatedRoute } from '@angular/router';

@Component({
  template: '&lt;div id="hello" [innerHTML]="hello"&gt;&lt;/div&gt;'
})
export class HelloComponent implements OnInit {
  hello: SafeHtml;

  constructor(private sanitizer: DomSanitizer, private route: ActivatedRoute) { }

  ngOnInit(): void {
    let name = this.route.snapshot.queryParams.name;
    let html = "&lt;h1&gt;Hello " + name + "&lt;/h1&gt;";
    this.hello = this.sanitizer.bypassSecurityTrustHtml(html); // Sensitive
  }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import { Component, OnInit } from '@angular/core';
import { DomSanitizer } from "@angular/platform-browser";
import { ActivatedRoute } from '@angular/router';

@Component({
  template: '&lt;div id="hello"&gt;&lt;h1&gt;Hello {{name}}&lt;/h1&gt;&lt;/div&gt;',
})
export class HelloComponent implements OnInit {
  name: string;

  constructor(private sanitizer: DomSanitizer, private route: ActivatedRoute) { }

  ngOnInit(): void {
    this.name = this.route.snapshot.queryParams.name;
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
  <li> <a href="https://angular.io/guide/security">Angular - Best Practices - Security</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5730"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5730">
              javascript:S5730
            </a>
          </td>
          <td >
            <details>
              <p>A mixed-content is when a resource is loaded with the HTTP protocol, from a website accessed with the HTTPs protocol, thus mixed-content are not
encrypted and exposed to <a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">MITM attacks</a> and could break the entire level of
protection that was desired by implementing encryption with the HTTPs protocol.</p>
<p>The main threat with mixed-content is not only the confidentiality of resources but the whole website integrity:</p>
<ul>
  <li> A passive mixed-content (eg: <em>&lt;img src="http://example.com/picture.png"&gt;</em>) allows an attacker to access and replace only these
  resources, like images, with malicious ones that could lead to successful phishing attacks. </li>
  <li> With active mixed-content (eg: <em>&lt;script src="http://example.com/library.js"&gt;</em>) an attacker can compromise the entire website by
  injecting malicious javascript code for example (accessing and modifying the DOM, steal cookies, etc). </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The HTTPS protocol is in place and external resources are fetched from the website pages. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement content security policy <em>block-all-mixed-content</em> directive which is supported by all modern browsers and will block loading of
mixed-contents.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/helmet-csp">helmet-csp</a> or <a
href="https://www.npmjs.com/package/helmet">helmet</a> middleware is used without the <code>blockAllMixedContent</code> directive:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.contentSecurityPolicy({
    directives: {
      "default-src": ["'self'", 'example.com', 'code.jquery.com']
    } // Sensitive: blockAllMixedContent directive is missing
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application a standard way to block mixed-content is to put in place the <a
href="https://www.npmjs.com/package/helmet-csp">helmet-csp</a> or <a href="https://www.npmjs.com/package/helmet">helmet</a> middleware with the
<code>blockAllMixedContent</code> directive:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.contentSecurityPolicy({
    directives: {
      "default-src": ["'self'", 'example.com', 'code.jquery.com'],
      blockAllMixedContent: [] // Compliant
    }
  })
);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> -
  Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">developer.mozilla.org</a> - Mixed-content </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">developer.mozilla.org</a> - Content Security Policy (CSP) </li>
  <li> <a href="https://www.w3.org/TR/CSP3/">w3.org</a> - Content Security Policy Level 3 </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5852"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5852">
              javascript:S5852
            </a>
          </td>
          <td >
            <details>
              <p>Most of the regular expression engines use backtracking to try all possible execution paths of the regular expression when evaluating an input, in
some cases it can cause performance issues, called <strong>catastrophic backtracking</strong> situations. In the worst case, the complexity of the
regular expression is exponential in the size of the input, this means that a small carefully-crafted input (like 20 chars) can trigger catastrophic
backtracking and cause a denial of service of the application. Super-linear regex complexity can lead to the same impact too with, in this case, a
large carefully-crafted input (thousands chars).</p>
<p>This rule determines the runtime complexity of a regular expression and informs you if it is not linear.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The input is user-controlled. </li>
  <li> The input size is not restricted to a small number of characters. </li>
  <li> There is no timeout in place to limit the regex evaluation time. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>To avoid catastrophic backtracking situations, make sure that none of the following conditions apply to your regular expression.</p>
<p>In all of the following cases, catastrophic backtracking can only happen if the problematic part of the regex is followed by a pattern that can
fail, causing the backtracking to actually happen.</p>
<ul>
  <li> If you have a repetition <code>r*</code> or <code>r*?</code>, such that the regex <code>r</code> could produce different possible matches (of
  possibly different lengths) on the same input, the worst case matching time can be exponential. This can be the case if <code>r</code> contains
  optional parts, alternations or additional repetitions (but not if the repetition is written in such a way that there’s only one way to match it).
  </li>
  <li> If you have multiple repetitions that can match the same contents and are consecutive or are only separated by an optional separator or a
  separator that can be matched by both of the repetitions, the worst case matching time can be polynomial (O(n^c) where c is the number of
  problematic repetitions). For example <code>a*b*</code> is not a problem because <code>a*</code> and <code>b*</code> match different things and
  <code>a*_a*</code> is not a problem because the repetitions are separated by a <code>'_'</code> and can’t match that <code>'_'</code>. However,
  <code>a*a*</code> and <code>.*_.*</code> have quadratic runtime. </li>
  <li> If the regex is not anchored to the beginning of the string, quadratic runtime is especially hard to avoid because whenever a match fails, the
  regex engine will try again starting at the next index. This means that any unbounded repetition, if it’s followed by a pattern that can fail, can
  cause quadratic runtime on some inputs. For example <code>str.split(/\s*,/)</code> will run in quadratic time on strings that consist entirely of
  spaces (or at least contain large sequences of spaces, not followed by a comma). </li>
</ul>
<p>In order to rewrite your regular expression without these patterns, consider the following strategies:</p>
<ul>
  <li> If applicable, define a maximum number of expected repetitions using the bounded quantifiers, like <code>{1,5}</code> instead of <code>+</code>
  for instance. </li>
  <li> Refactor nested quantifiers to limit the number of way the inner group can be matched by the outer quantifier, for instance this nested
  quantifier situation <code>(ba+)+</code> doesn’t cause performance issues, indeed, the inner group can be matched only if there exists exactly one
  <code>b</code> char per repetition of the group. </li>
  <li> Optimize regular expressions by emulating <em>possessive quantifiers</em> and <em>atomic grouping</em>. </li>
  <li> Use negated character classes instead of <code>.</code> to exclude separators where applicable. For example the quadratic regex
  <code>.*_.*</code> can be made linear by changing it to <code>[^_]*_.*</code> </li>
</ul>
<p>Sometimes it’s not possible to rewrite the regex to be linear while still matching what you want it to match. Especially when the regex is not
anchored to the beginning of the string, for which it is quite hard to avoid quadratic runtimes. In those cases consider the following approaches:</p>
<ul>
  <li> Solve the problem without regular expressions </li>
  <li> Use an alternative non-backtracking regex implementations such as Google’s <a href="https://github.com/google/re2">RE2</a> or <a
  href="https://github.com/uhop/node-re2/">node-re2</a>. </li>
  <li> Use multiple passes. This could mean pre- and/or post-processing the string manually before/after applying the regular expression to it or
  using multiple regular expressions. One example of this would be to replace <code>str.split(/\s*,\s*/)</code> with <code>str.split(",")</code> and
  then trimming the spaces from the strings as a second step. </li>
  <li> It is often possible to make the regex infallible by making all the parts that could fail optional, which will prevent backtracking. Of course
  this means that you’ll accept more strings than intended, but this can be handled by using capturing groups to check whether the optional parts were
  matched or not and then ignoring the match if they weren’t. For example the regex <code>x*y</code> could be replaced with <code>x*(y)?</code> and
  then the call to <code>str.match(regex)</code> could be replaced with <code>matched = str.match(regex)</code> and <code>matched[1] !==
  undefined</code>. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>The regex evaluation will never end:</p>
<pre>
/(a+)+$/.test(
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaa!"
); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Possessive quantifiers do not keep backtracking positions, thus can be used, if possible, to avoid performance issues. Unfortunately, they are not
supported in JavaScript, but one can still mimick them using lookahead assertions and backreferences:</p>
<pre>
/((?=(a+))\2)+$/.test(
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaa!"
); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1333">MITRE, CWE-1333</a> - Inefficient Regular Expression Complexity </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">owasp.org</a> - OWASP Regular expression Denial
  of Service - ReDoS </li>
  <li> <a
  href="https://web.archive.org/web/20220506215733/https://stackstatus.net/post/147710624694/outage-postmortem-july-20-2016">stackstatus.net(archived)</a> - Outage Postmortem - July 20, 2016 </li>
  <li> <a href="https://www.regular-expressions.info/catastrophic.html">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic
  Backtracking </li>
  <li> <a
  href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions#backtracking-with-nested-optional-quantifiers">docs.microsoft.com</a> - Backtracking with Nested Optional Quantifiers </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5736"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5736">
              javascript:S5736
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://en.wikipedia.org/wiki/HTTP_referer">HTTP header referer</a> contains a URL set by web browsers and used by applications to track
from where the user came from, it’s for instance a relevant value for web analytic services, but it can cause <a
href="https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns">serious privacy and security problems</a>
if the URL contains confidential information. Note that Firefox for instance, to prevent data leaks, <a
href="https://blog.mozilla.org/security/2018/01/31/preventing-data-leaks-by-stripping-path-information-in-http-referrers/">removes path
information</a> in the Referer header while browsing privately.</p>
<p>Suppose an e-commerce website asks the user his credit card number to purchase a product:</p>
<pre>
&lt;html&gt;
&lt;body&gt;
&lt;form action="/valid_order" method="GET"&gt;
Type your credit card number to purchase products:
&lt;input type=text id="cc" value="1111-2222-3333-4444"&gt;
&lt;input type=submit&gt;
&lt;/form&gt;
&lt;/body&gt;
</pre>
<p>When submitting the above HTML form, a HTTP GET request will be performed, the URL requested will be
https://example.com/valid_order?cc=1111-2222-3333-4444 with credit card number inside and it’s obviously not secure for these reasons:</p>
<ul>
  <li> URLs are stored in the history of browsers. </li>
  <li> URLs could be accidentally shared when doing copy/paste actions. </li>
  <li> URLs can be stolen if a malicious person looks at the computer screen of an user. </li>
</ul>
<p>In addition to these threats, when further requests will be performed from the "valid_order" page with a simple legitimate embedded script like
that:</p>
<pre>
&lt;script src="https://webanalyticservices_example.com/track"&gt;
</pre>
<p>The referer header which contains confidential information will be send to a third party web analytic service and cause privacy issue:</p>
<pre>
GET /track HTTP/2.0
Host: webanalyticservices_example.com
Referer: https://example.com/valid_order?cc=1111-2222-3333-4444
</pre>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Confidential information exists in URLs. </li>
  <li> Semantic of HTTP methods is not respected (eg: use of a GET method instead of POST when the state of the application is changed). </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Confidential information should not be set inside URLs (GET requests) of the application and a safe (ie: different from <code>unsafe-url</code> or
<code>no-referrer-when-downgrade</code>) <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">referrer-Policy</a>
header, to control how much information is included in the referer header, should be used.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/helmet">helmet</a> <code>referrerPolicy</code>
middleware is disabled or used with <code>no-referrer-when-downgrade</code> or <code>unsafe-url</code>:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

app.use(
  helmet.referrerPolicy({
    policy: 'no-referrer-when-downgrade' // Sensitive: no-referrer-when-downgrade is used
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application a secure solution is to user the <a href="https://www.npmjs.com/package/helmet">helmet</a> referrer policy middleware set
to <code>no-referrer</code>:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.referrerPolicy({
    policy: 'no-referrer' // Compliant
  })
);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> -
  Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referrer-Policy">developer.mozilla.org</a> - Referrer-Policy </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Referer_header:_privacy_and_security_concerns">developer.mozilla.org</a> -
  Referer header: privacy and security concerns </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5739"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5739">
              javascript:S5739
            </a>
          </td>
          <td >
            <details>
              <p>When implementing the HTTPS protocol, the website mostly continue to support the HTTP protocol to redirect users to HTTPS when they request a HTTP
version of the website. These redirects are not encrypted and are therefore vulnerable to man in the middle attacks. The <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">Strict-Transport-Security policy header</a> (HSTS) set by
an application instructs the web browser to convert any HTTP request to HTTPS.</p>
<p>Web browsers that see the Strict-Transport-Security policy header for the first time record information specified in the header:</p>
<ul>
  <li> the <code>max-age</code> directive which specify how long the policy should be kept on the web browser. </li>
  <li> the <code>includeSubDomains</code> optional directive which specify if the policy should apply on all sub-domains or not. </li>
  <li> the <code>preload</code> optional directive which is not part of the HSTS specification but supported on all modern web browsers. </li>
</ul>
<p>With the <code>preload</code> directive the web browser never connects in HTTP to the website and to use this directive, it is required <a
href="https://hstspreload.org/">to submit</a> the concerned application to a preload service maintained by Google.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The website is accessible with the unencrypted HTTP protocol. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement Strict-Transport-Security policy header, it is recommended to apply this policy to all subdomains (<code>includeSubDomains</code>) and
for at least 6 months (<code>max-age=15552000</code>) or even better for 1 year (<code>max-age=31536000</code>).</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/helmet">helmet</a> or <a
href="https://www.npmjs.com/package/hsts">hsts</a> middleware are disabled or used without recommended values:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(helmet.hsts({
  maxAge: 3153600, // Sensitive, recommended &gt;= 15552000
  includeSubDomains: false // Sensitive, recommended 'true'
}));
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application a standard way to implement HSTS is with the <a href="https://www.npmjs.com/package/helmet">helmet</a> or <a
href="https://www.npmjs.com/package/hsts">hsts</a> middleware:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(helmet.hsts({
  maxAge: 31536000,
  includeSubDomains: true
})); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> -
  Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Strict-Transport-Security">developer.mozilla.org</a> - Strict Transport
  Security </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6265"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6265">
              javascript:S6265
            </a>
          </td>
          <td >
            <details>
              <p>Predefined permissions, also known as <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">canned ACLs</a>,
are an easy way to grant large privileges to predefined groups or users.</p>
<p>The following canned ACLs are security-sensitive:</p>
<ul>
  <li> <code>PUBLIC_READ</code>, <code>PUBLIC_READ_WRITE</code> grant respectively "read" and "read and write" privileges to anyone, either
  authenticated or anonymous (<code>AllUsers</code> group). </li>
  <li> <code>AUTHENTICATED_READ</code> grants "read" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege policy, i.e., to only grant users the necessary permissions for their required tasks. In the
context of canned ACL, set it to <code>PRIVATE</code> (the default one), and if needed more granularity then use an appropriate S3 policy.</p>
<h2>Sensitive Code Example</h2>
<p>All users, either authenticated or anonymous, have read and write permissions with the <code>PUBLIC_READ_WRITE</code> access control:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'bucket', {
    accessControl: s3.BucketAccessControl.PUBLIC_READ_WRITE // Sensitive
});

new s3deploy.BucketDeployment(this, 'DeployWebsite', {
    accessControl: s3.BucketAccessControl.PUBLIC_READ_WRITE // Sensitive
});
</pre>
<h2>Compliant Solution</h2>
<p>With the <code>PRIVATE</code> access control (default), only the bucket owner has the read/write permissions on the bucket and its ACL.</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'bucket', {
    accessControl: s3.BucketAccessControl.PRIVATE
});

new s3deploy.BucketDeployment(this, 'DeployWebsite', {
    accessControl: s3.BucketAccessControl.PRIVATE
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">AWS Documentation</a> - Access control list (ACL)
  overview (canned ACLs) </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html">AWS Documentation</a> - Controlling access to a bucket with
  user policies </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html">AWS CDK version 2</a> - Class Bucket (construct) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5743"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5743">
              javascript:S5743
            </a>
          </td>
          <td >
            <details>
              <p>By default, web browsers perform <a href="https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch/">DNS prefetching</a> to reduce
latency due to DNS resolutions required when an user clicks links from a website page.</p>
<p>For instance on example.com the hyperlink below contains a cross-origin domain name that must be resolved to an IP address by the web browser:</p>
<pre>
&lt;a href="https://otherexample.com"&gt;go on our partner website&lt;/a&gt;
</pre>
<p>It can add significant latency during requests, especially if the page contains many links to cross-origin domains. DNS prefetch allows web
browsers to perform DNS resolving in the background before the user clicks a link. This feature can cause privacy issues because DNS resolving from
the user’s computer is performed without his consent if he doesn’t intent to go to the linked website.</p>
<p>On a complex private webpage, a combination "of unique links/DNS resolutions" can indicate, to a eavesdropper for instance, that the user is
visiting the private page.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Links to cross-origin domains could result in leakage of confidential information about the user’s navigation/behavior of the website. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control">X-DNS-Prefetch-Control</a> header with an
<em>off</em> value but this could significantly degrade website performances.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/dns-prefetch-control">dns-prefetch-control</a>
middleware is disabled or used without the recommended value:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.dnsPrefetchControl({
    allow: true // Sensitive: allowing DNS prefetching is security-sensitive
  })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application the <a href="https://www.npmjs.com/package/dns-prefetch-control">dns-prefetch-control</a> or <a
href="https://www.npmjs.com/package/helmet">helmet</a> middleware is the standard way to implement <code>X-DNS-Prefetch-Control</code> header:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
  helmet.dnsPrefetchControl({
    allow: false // Compliant
  })
);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html">OWASP Top 10 2017 Category
  A3</a> - Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control">developer.mozilla.org</a> - X-DNS-Prefetch-Control
  </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Performance/dns-prefetch">developer.mozilla.org</a> - Using dns-prefetch </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="javascript:S5742"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5742">
              javascript:S5742
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency">Certificate Transparency</a> (CT) is an open-framework to
protect against identity theft when certificates are issued. <a href="https://en.wikipedia.org/wiki/Certificate_authority">Certificate Authorities</a>
(CA) electronically sign certificate after verifying the identify of the certificate owner. Attackers use, among other things, social engineering
attacks to trick a CA to correctly verifying a spoofed identity/forged certificate.</p>
<p>CAs implement Certificate Transparency framework to publicly log the records of newly issued certificates, allowing the public and in particular
the identity owner to monitor these logs to verify that his identify was not usurped.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The website identity is valuable and well-known, therefore prone to theft. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Expect-CT">Expect-CT</a> HTTP header which instructs the web browser
to check <a href="https://www.certificate-transparency.org/known-logs">public CT logs</a> in order to verify if the website appears inside and if it
is not, the browser will block the request and display a warning to the user.</p>
<h2>Sensitive Code Example</h2>
<p>In Express.js application the code is sensitive if the <a href="https://www.npmjs.com/package/expect-ct">expect-ct</a> middleware is disabled:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(
    helmet({
      expectCt: false // Sensitive
    })
);
</pre>
<h2>Compliant Solution</h2>
<p>In Express.js application the <a href="https://www.npmjs.com/package/expect-ct">expect-ct</a> middleware is the standard way to implement
expect-ct. Usually, the deployment of this policy starts with the report only mode (<code>enforce: false</code>) and with a low <code>maxAge</code>
(the number of seconds the policy will apply) value and next if everything works well it is recommended to block future connections that violate
Expect-CT policy (<code>enforce: true</code>) and greater value for maxAge directive:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();

app.use(helmet.expectCt({
  enforce: true,
  maxAge: 86400
})); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> -
  Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Certificate_Transparency">developer.mozilla.org</a> - Certificate Transparency
  </li>
  <li> <a href="https://en.wikipedia.org/wiki/Certificate_authority">wikipedia.org</a> - Certificate Authority </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6275"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6275">
              javascript:S6275
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the
security of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access
to the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a
href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default">all new volumes and snapshots</a>. Volumes created
from snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The disk contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no
further modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption
globally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security
parameter will prevent any future unexpected security downgrade.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html">aws_cdk.aws_ec2.Volume</a>:</p>
<pre>
import { Size } from 'aws-cdk-lib';
import { Volume } from 'aws-cdk-lib/aws-ec2';

new Volume(this, 'unencrypted-explicit', {
      availabilityZone: 'us-west-2a',
      size: Size.gibibytes(1),
      encrypted: false // Sensitive
    });
</pre>
<pre>
import { Size } from 'aws-cdk-lib';
import { Volume } from 'aws-cdk-lib/aws-ec2';

new Volume(this, 'unencrypted-implicit', {
      availabilityZone: 'eu-west-1a',
      size: Size.gibibytes(1),
    }); // Sensitive as encryption is disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html">aws_cdk.aws_ec2.Volume</a>:</p>
<pre>
import { Size } from 'aws-cdk-lib';
import { Volume } from 'aws-cdk-lib/aws-ec2';

new Volume(this, 'encrypted-explicit', {
      availabilityZone: 'eu-west-1a',
      size: Size.gibibytes(1),
      encrypted: true
    });
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html">Amazon EBS encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6270"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6270">
              javascript:S6270
            </a>
          </td>
          <td >
            <details>
              <p>Resource-based policies granting access to all users can lead to information leakage.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The AWS resource stores or processes sensitive data. </li>
  <li> The AWS resource is designed to be private. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the
context of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>
<h2>Sensitive Code Example</h2>
<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'
import { aws_s3 as s3 } from 'aws-cdk-lib'

const bucket = new s3.Bucket(this, "ExampleBucket")

bucket.addToResourcePolicy(new iam.PolicyStatement({
    effect: iam.Effect.ALLOW,
    actions: ["s3:*"],
    resources: [bucket.arnForObjects("*")],
    principals: [new iam.AnyPrincipal()] // Sensitive
}))
</pre>
<h2>Compliant Solution</h2>
<p>This policy allows only the authorized users:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'
import { aws_s3 as s3 } from 'aws-cdk-lib'

const bucket = new s3.Bucket(this, "ExampleBucket")

bucket.addToResourcePolicy(new iam.PolicyStatement({
    effect: iam.Effect.ALLOW,
    actions: ["s3:*"],
    resources: [bucket.arnForObjects("*")],
    principals: [new iam.AccountRootPrincipal()]
}))
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6249"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6249">
              javascript:S6249
            </a>
          </td>
          <td >
            <details>
              <p>By default, S3 buckets can be accessed through HTTP and HTTPs protocols.</p>
<p>As HTTP is a clear-text protocol, it lack the encryption of transported data, as well as the capability to build an authenticated connection. It
means that a malicious actor who is able to intersept traffic from the network can read, modify or corrupt the transported content.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure has to comply with AWS Foundational Security Best Practices standard. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enforce HTTPS only access by setting <code>enforceSSL</code> property to <code>true</code></p>
<h2>Sensitive Code Example</h2>
<p>S3 bucket objects access through TLS is not enforced by default:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

const bucket = new s3.Bucket(this, 'example'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

const bucket = new s3.Bucket(this, 'example', {
    bucketName: 'example',
    versioned: true,
    publicReadAccess: false,
    enforceSSL: true
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/security-best-practices.html#transit">AWS documentation</a> - Enforce encryption
  of data in transit </li>
  <li> <a href="https://docs.aws.amazon.com/securityhub/latest/userguide/securityhub-standards-fsbp-controls.html#fsbp-s3-5">AWS Foundational Security
  Best Practices controls</a> - S3 buckets should require requests to use Secure Socket Layer </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html">AWS CDK version 2</a> - Bucket </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4502"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4502">
              javascript:S4502
            </a>
          </td>
          <td >
            <details>
              <p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive
actions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the
application.</p>
<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a
hidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The web application uses cookies to authenticate users. </li>
  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>
  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Protection against CSRF attacks is strongly recommended:
    <ul>
      <li> to be activated by default for all <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">unsafe HTTP
      methods</a>. </li>
      <li> implemented, for example, with an unguessable CSRF token </li>
    </ul>  </li>
  <li> Of course all sensitive operations should not be performed with <a
  href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">safe HTTP</a> methods like <code>GET</code> which are designed to be
  used only for information retrieval. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/csurf">Express.js CSURF middleware</a> protection is not found on an unsafe HTTP method like POST
method:</p>
<pre>
let csrf = require('csurf');
let express = require('express');

let csrfProtection = csrf({ cookie: true });

let app = express();

// Sensitive: this operation doesn't look like protected by CSURF middleware (csrfProtection is not used)
app.post('/money_transfer', parseForm, function (req, res) {
  res.send('Money transferred');
});
</pre>
<p>Protection provided by <a href="https://www.npmjs.com/package/csurf">Express.js CSURF middleware</a> is globally disabled on unsafe methods:</p>
<pre>
let csrf = require('csurf');
let express = require('express');

app.use(csrf({ cookie: true, ignoreMethods: ["POST", "GET"] })); // Sensitive as POST is unsafe method
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/csurf">Express.js CSURF middleware</a> protection is used on unsafe methods:</p>
<pre>
let csrf = require('csurf');
let express = require('express');

let csrfProtection = csrf({ cookie:  true });

let app = express();

app.post('/money_transfer', parseForm, csrfProtection, function (req, res) { // Compliant
  res.send('Money transferred')
});
</pre>
<p>Protection provided by <a href="https://www.npmjs.com/package/csurf">Express.js CSURF middleware</a> is enabled on unsafe methods:</p>
<pre>
let csrf = require('csurf');
let express = require('express');

app.use(csrf({ cookie: true, ignoreMethods: ["GET"] })); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/352">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF) </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/csrf">OWASP: Cross-Site Request Forgery</a> </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6245">
              javascript:S6245
            </a>
          </td>
          <td >
            <details>
              <p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is
read from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if
they were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure
itself.</p>
<p>There are three SSE options:</p>
<ul>
  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)
    <ul>
      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)
    <ul>
      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)
    <ul>
      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s
      encryption keys. </li>
    </ul>  </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>
<h2>Sensitive Code Example</h2>
<p>Server-side encryption is not used:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'default'
}); // Sensitive
</pre>
<p>Bucket encryption is disabled by default.</p>
<h2>Compliant Solution</h2>
<p>Server-side encryption with Amazon S3-Managed Keys is used:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    encryption: s3.BucketEncryption.KMS_MANAGED
});

# Alternatively with a KMS key managed by the user.

new s3.Bucket(this, 'id', {
    encryption: s3.BucketEncryption.KMS_MANAGED,
    encryptionKey: access_key
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html">AWS documentation</a> - Protecting data using
  server-side encryption </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BucketEncryption.html">AWS CDK version 2</a> - BucketEncryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4507">
              javascript:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> The application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers or applications distributed to end users.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/errorhandler">errorhandler Express.js middleware</a> should not be used in production:</p>
<pre>
const express = require('express');
const errorhandler = require('errorhandler');

let app = express();
app.use(errorhandler()); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/errorhandler">errorhandler Express.js middleware</a> used only in development mode:</p>
<pre>
const express = require('express');
const errorhandler = require('errorhandler');

let app = express();

if (process.env.NODE_ENV === 'development') {
  app.use(errorhandler());
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5604"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5604">
              javascript:S5604
            </a>
          </td>
          <td >
            <details>
              <p><a href="https://www.w3.org/TR/permissions/#powerful-feature">Powerful features</a> are browser features (geolocation, camera, microphone …​) that
can be accessed with JavaScript API and may require a permission granted by the user. These features can have a high impact on privacy and user
security thus they should only be used if they are really necessary to implement the critical parts of an application.</p>
<p>This rule highlights intrusive permissions when requested with <a href="https://developer.mozilla.org/en-US/docs/Web/API/Permissions/query">the
future standard (but currently experimental) web browser query API</a> and specific APIs related to the permission. It is highly recommended to
customize this rule with the permissions considered as intrusive in the context of the web application.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some powerful features used by the application are not really necessary. </li>
  <li> Users are not clearly informed why and when powerful features are used by the application. </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> In order to respect user privacy it is recommended to avoid using intrusive powerful features. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>When using <a href="https://developer.mozilla.org/en-US/docs/Web/API/Geolocation_API">geolocation API</a>, Firefox for example retrieves personal
information like nearby wireless access points and IP address and sends it to the default geolocation service provider, <a
href="https://www.google.com/privacy/lsf.html">Google Location Services</a>:</p>
<pre>
navigator.permissions.query({name:"geolocation"}).then(function(result) {
});  // Sensitive: geolocation is a powerful feature with high privacy concerns

navigator.geolocation.getCurrentPosition(function(position) {
  console.log("coordinates x="+position.coords.latitude+" and y="+position.coords.longitude);
}); // Sensitive: geolocation is a powerful feature with high privacy concerns
</pre>
<h2>Compliant Solution</h2>
<p>If geolocation is required, always explain to the user why the application needs it and prefer requesting an approximate location when
possible:</p>
<pre>
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;
        Retailer website example
    &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    Type a city, street or zip code where you want to retrieve the closest retail locations of our products:
    &lt;form method=post&gt;
        &lt;input type=text value="New York"&gt; &lt;!-- Compliant --&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Web Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/250">MITRE, CWE-250</a> - Execution with Unnecessary Privileges </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/359">MITRE, CWE-359</a> - Exposure of Private Information </li>
  <li> <a href="https://www.w3.org/TR/permissions/">W3C</a> - Permissions </li>
  <li> <a href="https://support.mozilla.org/en-US/kb/does-firefox-share-my-location-websites">Mozilla</a> - Does Firefox share my location with
  websites? </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5725"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5725">
              javascript:S5725
            </a>
          </td>
          <td >
            <details>
              <p>Using remote artifacts without integrity checks can lead to the unexpected execution of malicious code in the application.</p>
<p>On the client side, where front-end code is executed, malicious code could:</p>
<ul>
  <li> impersonate users' identities and take advantage of their privileges on the application. </li>
  <li> add quiet malware that monitors users' session and capture sensitive secrets. </li>
  <li> gain access to sensitive clients' personal data. </li>
  <li> deface, or otherwise affect the general availability of the application. </li>
  <li> mine cryptocurrencies in the background. </li>
</ul>
<p>Likewise, a compromised software piece that would be deployed on a server-side application could badly affect the application’s security. For
example, server-side malware could:</p>
<ul>
  <li> access and modify sensitive technical and business data. </li>
  <li> elevate its privileges on the underlying operating system. </li>
  <li> Use the compromised application as a pivot to attack the local network. </li>
</ul>
<p>By ensuring that a remote artifact is exactly what it is supposed to be before using it, the application is protected from unexpected changes
applied to it before it is downloaded.<br> Especially, integrity checks will allow for identifying an artifact replaced by malware on the publication
website or that was legitimately changed by its author, in a more benign scenario.</p>
<p>Important note: downloading an artifact over HTTPS only protects it while in transit from one host to another. It provides authenticity and
integrity checks <strong>for the network stream</strong> only. It does not ensure the authenticity or security of the artifact itself.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The artifact is a file intended to execute code. </li>
  <li> The artifact is a file that is intended to configure or affect running code in some way. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>To check the integrity of a remote artifact, hash verification is the most reliable solution. It does ensure that the file has not been modified
since the fingerprint was computed.</p>
<p>In this case, the artifact’s hash must:</p>
<ul>
  <li> Be computed with a secure hash algorithm such as <code>SHA512</code>, <code>SHA384</code> or <code>SHA256</code>. </li>
  <li> Be compared with a secure hash that was <strong>not</strong> downloaded from the same source. </li>
</ul>
<p>To do so, the best option is to add the hash in the code explicitly, by following <a
href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity#tools_for_generating_sri_hashes">Mozilla’s official documentation on
how to generate integrity strings</a>.</p>
<p><strong>Note: Use this fix together with version binding on the remote file. Avoid downloading files named "latest" or similar, so that the
front-end pages do not break when the code of the latest remote artifact changes.</strong></p>
<h2>Sensitive Code Example</h2>
<p>The following code sample uses neither integrity checks nor version pinning:</p>
<pre>
let script = document.createElement("script");
script.src = "https://cdn.example.com/latest/script.js"; // Sensitive
script.crossOrigin = "anonymous";
document.head.appendChild(script);
</pre>
<h2>Compliant Solution</h2>
<pre>
let script = document.createElement("script");
script.src = "https://cdn.example.com/v5.3.6/script.js";
script.integrity = "sha384-oqVuAfXRKap7fdgcCY5uykM6+R9GqQ8K/uxy9rx7HNQlGYl1kPzQho1wx4JwY8wC";
script.crossOrigin = "anonymous";
document.head.appendChild(script);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/353">MITRE, CWE-353</a> - Missing Support for Integrity Check </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration.html">OWASP Top 10 2017 Category
  A6</a> - Security Misconfiguration </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Subresource_Integrity">developer.mozilla.org</a> - Subresource Integrity </li>
  <li> <a href="https://en.wikipedia.org/wiki/Watering_hole_attack">Wikipedia, Watering Hole Attacks</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5042"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5042">
              javascript:S5042
            </a>
          </td>
          <td >
            <details>
              <p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can
lead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of
uncompressed data. To achieve this extreme <a href="https://en.wikipedia.org/wiki/Data_compression_ratio">compression ratio</a>, attackers will
compress irrelevant data (eg: a long string of repeated bytes).</p>
<h2>Ask Yourself Whether</h2>
<p>Archives to expand are untrusted and:</p>
<ul>
  <li> There is no validation of the number of entries in the archive. </li>
  <li> There is no validation of the total size of the uncompressed data. </li>
  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is
  1 to 3. </li>
  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>
  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in
  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://github.com/npm/node-tar">tar</a> module:</p>
<pre>
const tar = require('tar');

tar.x({ // Sensitive
  file: 'foo.tar.gz'
});
</pre>
<p>For <a href="https://github.com/cthackers/adm-zip">adm-zip</a> module:</p>
<pre>
const AdmZip = require('adm-zip');

let zip = new AdmZip("./foo.zip");
zip.extractAllTo("."); // Sensitive
</pre>
<p>For <a href="https://stuk.github.io/jszip/">jszip</a> module:</p>
<pre>
const fs = require("fs");
const JSZip = require("jszip");

fs.readFile("foo.zip", function(err, data) {
  if (err) throw err;
  JSZip.loadAsync(data).then(function (zip) { // Sensitive
    zip.forEach(function (relativePath, zipEntry) {
      if (!zip.file(zipEntry.name)) {
        fs.mkdirSync(zipEntry.name);
      } else {
        zip.file(zipEntry.name).async('nodebuffer').then(function (content) {
          fs.writeFileSync(zipEntry.name, content);
        });
      }
    });
  });
});
</pre>
<p>For <a href="https://github.com/thejoshwolfe/yauzl">yauzl</a> module</p>
<pre>
const yauzl = require('yauzl');

yauzl.open('foo.zip', function (err, zipfile) {
  if (err) throw err;

  zipfile.on("entry", function(entry) {
    zipfile.openReadStream(entry, function(err, readStream) {
      if (err) throw err;
      // TODO: extract
    });
  });
});
</pre>
<p>For <a href="https://github.com/maxogden/extract-zip">extract-zip</a> module:</p>
<pre>
const extract = require('extract-zip')

async function main() {
  let target = __dirname + '/test';
  await extract('test.zip', { dir: target }); // Sensitive
}
main();
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://github.com/npm/node-tar">tar</a> module:</p>
<pre>
const tar = require('tar');
const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB

let fileCount = 0;
let totalSize = 0;

tar.x({
  file: 'foo.tar.gz',
  filter: (path, entry) =&gt; {
    fileCount++;
    if (fileCount &gt; MAX_FILES) {
      throw 'Reached max. number of files';
    }

    totalSize += entry.size;
    if (totalSize &gt; MAX_SIZE) {
      throw 'Reached max. size';
    }

    return true;
  }
});
</pre>
<p>For <a href="https://github.com/cthackers/adm-zip">adm-zip</a> module:</p>
<pre>
const AdmZip = require('adm-zip');
const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB
const THRESHOLD_RATIO = 10;

let fileCount = 0;
let totalSize = 0;
let zip = new AdmZip("./foo.zip");
let zipEntries = zip.getEntries();
zipEntries.forEach(function(zipEntry) {
    fileCount++;
    if (fileCount &gt; MAX_FILES) {
        throw 'Reached max. number of files';
    }

    let entrySize = zipEntry.getData().length;
    totalSize += entrySize;
    if (totalSize &gt; MAX_SIZE) {
        throw 'Reached max. size';
    }

    let compressionRatio = entrySize / zipEntry.header.compressedSize;
    if (compressionRatio &gt; THRESHOLD_RATIO) {
        throw 'Reached max. compression ratio';
    }

    if (!zipEntry.isDirectory) {
        zip.extractEntryTo(zipEntry.entryName, ".");
    }
});
</pre>
<p>For <a href="https://stuk.github.io/jszip/">jszip</a> module:</p>
<pre>
const fs = require("fs");
const pathmodule = require("path");
const JSZip = require("jszip");

const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB

let fileCount = 0;
let totalSize = 0;
let targetDirectory = __dirname + '/archive_tmp';

fs.readFile("foo.zip", function(err, data) {
  if (err) throw err;
  JSZip.loadAsync(data).then(function (zip) {
    zip.forEach(function (relativePath, zipEntry) {
      fileCount++;
      if (fileCount &gt; MAX_FILES) {
        throw 'Reached max. number of files';
      }

      // Prevent ZipSlip path traversal (S6096)
      const resolvedPath = pathmodule.join(targetDirectory, zipEntry.name);
      if (!resolvedPath.startsWith(targetDirectory)) {
        throw 'Path traversal detected';
      }

      if (!zip.file(zipEntry.name)) {
        fs.mkdirSync(resolvedPath);
      } else {
        zip.file(zipEntry.name).async('nodebuffer').then(function (content) {
          totalSize += content.length;
          if (totalSize &gt; MAX_SIZE) {
            throw 'Reached max. size';
          }

          fs.writeFileSync(resolvedPath, content);
        });
      }
    });
  });
});
</pre>
<p>Be aware that due to the similar structure of sensitive and compliant code the issue will be raised in both cases. It is up to the developer to
decide if the implementation is secure.</p>
<p>For <a href="https://github.com/thejoshwolfe/yauzl">yauzl</a> module</p>
<pre>
const yauzl = require('yauzl');

const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB
const THRESHOLD_RATIO = 10;

yauzl.open('foo.zip', function (err, zipfile) {
  if (err) throw err;

  let fileCount = 0;
  let totalSize = 0;

  zipfile.on("entry", function(entry) {
    fileCount++;
    if (fileCount &gt; MAX_FILES) {
      throw 'Reached max. number of files';
    }

    // The uncompressedSize comes from the zip headers, so it might not be trustworthy.
    // Alternatively, calculate the size from the readStream.
    let entrySize = entry.uncompressedSize;
    totalSize += entrySize;
    if (totalSize &gt; MAX_SIZE) {
      throw 'Reached max. size';
    }

    if (entry.compressedSize &gt; 0) {
      let compressionRatio = entrySize / entry.compressedSize;
      if (compressionRatio &gt; THRESHOLD_RATIO) {
        throw 'Reached max. compression ratio';
      }
    }

    zipfile.openReadStream(entry, function(err, readStream) {
      if (err) throw err;
      // TODO: extract
    });
  });
});
</pre>
<p>Be aware that due to the similar structure of sensitive and compliant code the issue will be raised in both cases. It is up to the developer to
decide if the implementation is secure.</p>
<p>For <a href="https://github.com/maxogden/extract-zip">extract-zip</a> module:</p>
<pre>
const extract = require('extract-zip')

const MAX_FILES = 10000;
const MAX_SIZE = 1000000000; // 1 GB
const THRESHOLD_RATIO = 10;

async function main() {
  let fileCount = 0;
  let totalSize = 0;

  let target = __dirname + '/foo';
  await extract('foo.zip', {
    dir: target,
    onEntry: function(entry, zipfile) {
      fileCount++;
      if (fileCount &gt; MAX_FILES) {
        throw 'Reached max. number of files';
      }

      // The uncompressedSize comes from the zip headers, so it might not be trustworthy.
      // Alternatively, calculate the size from the readStream.
      let entrySize = entry.uncompressedSize;
      totalSize += entrySize;
      if (totalSize &gt; MAX_SIZE) {
        throw 'Reached max. size';
      }

      if (entry.compressedSize &gt; 0) {
        let compressionRatio = entrySize / entry.compressedSize;
        if (compressionRatio &gt; THRESHOLD_RATIO) {
          throw 'Reached max. compression ratio';
        }
      }
    }
  });
}
main();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/409">MITRE, CWE-409</a> - Improper Handling of Highly Compressed Data (Data Amplification)
  </li>
  <li> <a href="https://www.bamsoftware.com/hacks/zipbomb/">bamsoftware.com</a> - A better Zip Bomb </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5728"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5728">
              javascript:S5728
            </a>
          </td>
          <td >
            <details>
              <p>Content security policy (CSP) (fetch directives) is a <a href="https://www.w3.org/TR/CSP3/">W3C standard </a> which is used by a server to specify,
via a http header, the origins from where the browser is allowed to load resources. It can help to mitigate the risk of cross site scripting (XSS)
attacks and reduce privileges used by an application. If the website doesn’t define CSP header the browser will apply <a
href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">same-origin policy</a> by default.</p>
<pre>
Content-Security-Policy: default-src 'self'; script-src ‘self ‘ http://www.example.com
</pre>
<p>In the above example, all resources are allowed from the website where this header is set and script resources fetched from example.com are also
authorized:</p>
<pre>
&lt;img src="selfhostedimage.png&gt;&lt;/script&gt; &lt;!-- will be loaded because default-src 'self'; directive is applied  --&gt;
&lt;img src="http://www.example.com/image.png&gt;&lt;/script&gt;  &lt;!-- will NOT be loaded because default-src 'self'; directive is applied  --&gt;
&lt;script src="http://www.example.com/library.js&gt;&lt;/script&gt; &lt;!-- will be loaded because script-src ‘self ‘ http://www.example.comdirective is applied  --&gt;
&lt;script src="selfhostedscript.js&gt;&lt;/script&gt; &lt;!-- will be loaded because script-src ‘self ‘ http://www.example.com directive is applied  --&gt;
&lt;script src="http://www.otherexample.com/library.js&gt;&lt;/script&gt; &lt;!-- will NOT be loaded because script-src ‘self ‘ http://www.example.comdirective is applied  --&gt;
</pre>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The resources of the application are fetched from various untrusted locations. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Implement content security policy fetch directives, in particular <em>default-src</em> directive and continue to properly sanitize and validate all
inputs of the application, indeed CSP fetch directives is only a tool to reduce the impact of cross site scripting attacks.</p>
<h2>Sensitive Code Example</h2>
<p>In a Express.js application, the code is sensitive if the <a href="https://www.npmjs.com/package/helmet">helmet</a> contentSecurityPolicy
middleware is disabled:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();
app.use(
    helmet({
      contentSecurityPolicy: false, // sensitive
    })
);
</pre>
<h2>Compliant Solution</h2>
<p>In a Express.js application, a standard way to implement CSP is the <a href="https://www.npmjs.com/package/helmet">helmet contentSecurityPolicy
middleware</a>:</p>
<pre>
const express = require('express');
const helmet = require('helmet');

let app = express();
app.use(helmet.contentSecurityPolicy()); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.w3.org/TR/CSP3/">w3.org</a> - Content Security Policy Level 3 </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration.html">OWASP Top 10 2017 Category
  A6</a> - Security Misconfiguration </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP">developer.mozilla.org</a> - Content Security Policy (CSP) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6252"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6252">
              javascript:S6252
            </a>
          </td>
          <td >
            <details>
              <p>S3 buckets can be versioned. When the S3 bucket is unversioned it means that a new version of an object overwrites an existing one in the S3
bucket.</p>
<p>It can lead to unintentional or intentional information loss.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The bucket stores information that require high availability. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>
<h2>Sensitive Code Example</h2>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    versioned: false // Sensitive
});
</pre>
<p>The default value of <code>versioned</code> is <code>false</code> so the absence of this parameter is also sensitive.</p>
<h2>Compliant Solution</h2>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    versioned: true
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html">AWS documentation</a> - Using versioning in S3 buckets </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html#versioned">AWS CDK version 2</a> - Using versioning in S3
  buckets </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="javascript:S4787"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4787">
              javascript:S4787
            </a>
          </td>
          <td >
            <details>
              <p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902">CVE-2017-7902</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378">CVE-2006-1378</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376">CVE-2003-1376</a> </li>
</ul>
<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed
regularly. However these are not the only means to defeat or weaken an encryption.</p>
<p>This rule flags function calls that initiate encryption/decryption.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>
  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>
  <li> the key exchange is made without properly authenticating the receiver. </li>
  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time
  passes. </li>
  <li> the chosen encryption library is deemed unsafe. </li>
  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>
  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.
  </li>
  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random
  algorithm, or it is reused. </li>
  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.
  </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Generate encryption keys using secure random algorithms. </li>
  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force
  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.
  </li>
  <li> Regenerate the keys regularly. </li>
  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>
  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>
  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are
  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most
  probably have flaws. </li>
  <li> When a nonce is used, generate it randomly every time. </li>
  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>
  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks
  like "Chosen-Plaintext Attacks". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption
  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>
  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be
  preferred to the following combinations which are not secured:
    <ul>
      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it
      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in
      cryptographic protocols at all. </li>
      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
// === Client side ===
crypto.subtle.encrypt(algo, key, plainData); // Sensitive
crypto.subtle.decrypt(algo, key, encData); // Sensitive
</pre>
<pre>
// === Server side ===
const crypto = require("crypto");
const cipher = crypto.createCipher(algo, key); // Sensitive
const cipheriv = crypto.createCipheriv(algo, key, iv); // Sensitive
const decipher = crypto.createDecipher(algo, key); // Sensitive
const decipheriv = crypto.createDecipheriv(algo, key, iv); // Sensitive
const pubEnc = crypto.publicEncrypt(key, buf); // Sensitive
const privDec = crypto.privateDecrypt({ key: key, passphrase: secret }, pubEnc); // Sensitive
const privEnc = crypto.privateEncrypt({ key: key, passphrase: secret }, buf); // Sensitive
const pubDec = crypto.publicDecrypt(key, privEnc); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/321">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/322">MITRE, CWE-322</a> - Key Exchange without Entity Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/323">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/324">MITRE, CWE-324</a> - Use of a Key Past its Expiration Date </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/325">MITRE, CWE-325</a> - Missing Required Cryptographic Step </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=javascript%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=javascript%3AS5547'>S5547</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="javascript:S2245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2245">
              javascript:S2245
            </a>
          </td>
          <td >
            <details>
              <p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386">CVE-2013-6386</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419">CVE-2006-3419</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102">CVE-2008-4102</a> </li>
</ul>
<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that
will be generated, and use this guess to impersonate another user or access sensitive information.</p>
<p>As the <code>Math.random()</code> function relies on a weak pseudorandom number generator, this function should not be used for security-critical
applications or for protecting sensitive data. In such context, a cryptographically strong pseudorandom number generator (CSPRNG) should be used
instead.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such
  as a password, is hashed. </li>
  <li> the function you use generates a value which can be predicted (pseudo-random). </li>
  <li> the generated value is used multiple times. </li>
  <li> an attacker can access the generated value. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a cryptographically strong pseudorandom number generator (CSPRNG) like <code>crypto.getRandomValues()</code>. </li>
  <li> Use the generated random values only once. </li>
  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
const val = Math.random(); // Sensitive
// Check if val is used in a security context.
</pre>
<h2>Compliant Solution</h2>
<pre>
// === Client side ===
const crypto = window.crypto || window.msCrypto;
var array = new Uint32Array(1);
crypto.getRandomValues(array); // Compliant for security-sensitive use cases

// === Server side ===
const crypto = require('crypto');
const buf = crypto.randomBytes(1); // Compliant for security-sensitive use cases
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/338">MITRE, CWE-338</a> - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1241">MITRE, CWE-1241</a> - Use of Predictable Algorithm in Random Number Generator </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM">Predictable Pseudo Random Number
  Generator</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="javascript:S5757"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5757">
              javascript:S5757
            </a>
          </td>
          <td >
            <details>
              <p>Log management is an important topic, especially for the security of a web application, to ensure user activity, including potential attackers, is
recorded and available for an analyst to understand what’s happened on the web application in case of malicious activities.</p>
<p>Retention of specific logs for a defined period of time is often necessary to comply with regulations such as GDPR, <a
href="https://www.pcisecuritystandards.org/documents/Effective-Daily-Log-Monitoring-Guidance.pdf">PCI DSS</a> and others. However, to protect user’s
privacy, certain informations are forbidden or strongly discouraged from being logged, such as user passwords or credit card numbers, which obviously
should not be stored or at least not in clear text.</p>
<h2>Ask Yourself Whether</h2>
<p>In a production environment:</p>
<ul>
  <li> The web application uses confidential information and logs a significant amount of data. </li>
  <li> Logs are externalized to SIEM or Big Data repositories. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Loggers should be configured with a list of confidential, personal information that will be hidden/masked or removed from logs.</p>
<h2>Sensitive Code Example</h2>
<p>With <a href="https://www.npmjs.com/package/signale">Signale log management framework</a> the code is sensitive when an empty list of secrets is
defined:</p>
<pre>
const { Signale } = require('signale');

const CREDIT_CARD_NUMBERS = fetchFromWebForm()
// here we suppose the credit card numbers are retrieved somewhere and CREDIT_CARD_NUMBERS looks like ["1234-5678-0000-9999", "1234-5678-0000-8888"]; for instance

const options = {
  secrets: []         // empty list of secrets
};

const logger = new Signale(options); // Sensitive

CREDIT_CARD_NUMBERS.forEach(function(CREDIT_CARD_NUMBER) {
  logger.log('The customer ordered products with the credit card number = %s', CREDIT_CARD_NUMBER);
});
</pre>
<h2>Compliant Solution</h2>
<p>With <a href="https://www.npmjs.com/package/signale">Signale log management framework</a> it is possible to define a list of secrets that will be
hidden in logs:</p>
<pre>
const { Signale } = require('signale');

const CREDIT_CARD_NUMBERS = fetchFromWebForm()
// here we suppose the credit card numbers are retrieved somewhere and CREDIT_CARD_NUMBERS looks like ["1234-5678-0000-9999", "1234-5678-0000-8888"]; for instance

const options = {
  secrets: ["([0-9]{4}-?)+"]
};

const logger = new Signale(options); // Compliant

CREDIT_CARD_NUMBERS.forEach(function(CREDIT_CARD_NUMBER) {
  logger.log('The customer ordered products with the credit card number = %s', CREDIT_CARD_NUMBER);
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/532">MITRE, CWE-532</a> - Insertion of Sensitive Information into Log File </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html">OWASP Top 10 2017 Category
  A3</a> - Sensitive Data Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S3330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S3330">
              javascript:S3330
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will
be able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer
to decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target
the theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS
vulnerability to steal session-cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>
  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)
  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /
  sensitive-security cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> module:</p>
<pre>
let session = cookieSession({
  httpOnly: false,// Sensitive
});  // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/express-session">express-session</a> module:</p>
<pre>
const express = require('express'),
const session = require('express-session'),

let app = express()
app.use(session({
  cookie:
  {
    httpOnly: false // Sensitive
  }
})),
</pre>
<p><a href="https://www.npmjs.com/package/cookies">cookies</a> module:</p>
<pre>
let cookies = new Cookies(req, res, { keys: keys });

cookies.set('LastVisit', new Date().toISOString(), {
  httpOnly: false // Sensitive
}); // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/csurf">csurf</a> module:</p>
<pre>
const cookieParser = require('cookie-parser');
const csrf = require('csurf');
const express = require('express');

let csrfProtection = csrf({ cookie: { httpOnly: false }}); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> module:</p>
<pre>
let session = cookieSession({
  httpOnly: true,// Compliant
});  // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/express-session">express-session</a> module:</p>
<pre>
const express = require('express');
const session = require('express-session');

let app = express();
app.use(session({
  cookie:
  {
    httpOnly: true // Compliant
  }
}));
</pre>
<p><a href="https://www.npmjs.com/package/cookies">cookies</a> module:</p>
<pre>
let cookies = new Cookies(req, res, { keys: keys });

cookies.set('LastVisit', new Date().toISOString(), {
  httpOnly: true // Compliant
}); // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/csurf">csurf</a> module:</p>
<pre>
const cookieParser = require('cookie-parser');
const csrf = require('csurf');
const express = require('express');

let csrfProtection = csrf({ cookie: { httpOnly: true }}); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/HttpOnly">OWASP HttpOnly</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1004">MITRE, CWE-1004</a> - Sensitive Cookie Without 'HttpOnly' Flag </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE">HTTPONLY_COOKIE</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4784"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4784">
              javascript:S4784
            </a>
          </td>
          <td >
            <details>
              <p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021">CVE-2017-16021</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863">CVE-2018-13863</a> </li>
</ul>
<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as
<code>(a+)+s</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with
every additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular
expression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>
<p>Evaluating such regular expressions opens the door to <a
href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">Regular expression Denial of Service (ReDoS)</a> attacks.
In the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making
the service inaccessible to genuine users.</p>
<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and at least two instances of any of the following
characters: <code>*+{</code>.</p>
<p>Example: <code>(a+)*</code></p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>
  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for
vulnerability reports mentioning the one engine you’re are using.</p>
<p>Use if possible a library which is not vulnerable to Redos Attacks such as <a href="https://github.com/google/re2">Google Re2</a>.</p>
<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>
<h2>Sensitive Code Example</h2>
<pre>
const regex = /(a+)+b/; // Sensitive
const regex2 = new RegExp("(a+)+b"); // Sensitive

str.search("(a+)+b"); // Sensitive
str.match("(a+)+b"); // Sensitive
str.split("(a+)+b"); // Sensitive
</pre>
<p>Note: String.matchAll does not raise any issue as it is not supported by NodeJS.</p>
<h2>Exceptions</h2>
<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,
<code>(a|a?)+</code>.</p>
<p>It is a good idea to test your regular expression if it has the same pattern on both side of a "<code>|</code>".</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">MITRE, CWE-624</a> - Executable Regular
  Expression Error </li>
  <li> OWASP Regular expression Denial of Service - ReDoS </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS5852'>S5852</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5759"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5759">
              javascript:S5759
            </a>
          </td>
          <td >
            <details>
              <p>Users often connect to web servers through HTTP proxies.</p>
<p>Proxy can be configured to forward the client IP address via the <code>X-Forwarded-For</code> or <code>Forwarded</code> HTTP headers.</p>
<p>IP address is a personal information which can identify a single user and thus impact his privacy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The web application uses reverse proxies or similar but doesn’t need to know the IP address of the user. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>User IP address should not be forwarded unless the application needs it, as part of an authentication, authorization scheme or log management for
examples.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://github.com/http-party/node-http-proxy">node-http-proxy</a></p>
<pre>
var httpProxy = require('http-proxy');

httpProxy.createProxyServer({target:'http://localhost:9000', xfwd:true}) // Noncompliant
  .listen(8000);
</pre>
<p><a href="https://github.com/chimurai/http-proxy-middleware">http-proxy-middleware</a></p>
<pre>
var express = require('express');

const { createProxyMiddleware } = require('http-proxy-middleware');

const app = express();

app.use('/proxy', createProxyMiddleware({ target: 'http://localhost:9000', changeOrigin: true, xfwd: true })); // Noncompliant
app.listen(3000);
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://github.com/http-party/node-http-proxy">node-http-proxy</a></p>
<pre>
var httpProxy = require('http-proxy');

// By default xfwd option is false
httpProxy.createProxyServer({target:'http://localhost:9000'}) // Compliant
  .listen(8000);
</pre>
<p><a href="https://github.com/chimurai/http-proxy-middleware">http-proxy-middleware</a></p>
<pre>
var express = require('express');

const { createProxyMiddleware } = require('http-proxy-middleware');

const app = express();

// By default xfwd option is false
app.use('/proxy', createProxyMiddleware({ target: 'http://localhost:9000', changeOrigin: true})); // Compliant
app.listen(3000);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A3-Sensitive_Data_Exposure.html">OWASP Top 10 2017 Category
  A3</a> - Sensitive Data Exposure </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Forwarded-For">developer.mozilla.org</a> - X-Forwarded-For </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6281"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6281">
              javascript:S6281
            </a>
          </td>
          <td >
            <details>
              <p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>
<p>This access control can be relaxed with ACLs or policies.</p>
<p>To prevent permissive policies or ACLs to be set on a S3 bucket the following booleans settings can be enabled:</p>
<ul>
  <li> <code>blockPublicAcls</code>: to block or not public ACLs to be set to the S3 bucket. </li>
  <li> <code>ignorePublicAcls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>
  <li> <code>blockPublicPolicy</code>: to block or not public policies to be set to the S3 bucket. </li>
  <li> <code>restrictPublicBuckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket
  owner account. </li>
</ul>
<p>The other attribute <code>BlockPublicAccess.BLOCK_ACLS</code> only turns on <code>blockPublicAcls</code> and <code>ignorePublicAcls</code>. The
public policies can still affect the S3 bucket.</p>
<p>However, all of those options can be enabled by setting the <code>blockPublicAccess</code> property of the S3 bucket to
<code>BlockPublicAccess.BLOCK_ALL</code>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>
  <li> These settings are not already enforced to true at the account level. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to configure:</p>
<ul>
  <li> <code>blockPublicAcls</code> to <code>True</code> to block new attempts to set public ACLs. </li>
  <li> <code>ignorePublicAcls</code> to <code>True</code> to block existing public ACLs. </li>
  <li> <code>blockPublicPolicy</code> to <code>True</code> to block new attempts to set public policies. </li>
  <li> <code>restrictPublicBuckets</code> to <code>True</code> to restrict existing public policies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>By default, when not set, the <code>blockPublicAccess</code> is fully deactivated (nothing is blocked):</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket'
}); // Sensitive
</pre>
<p>This <code>block_public_access</code> allows public ACL to be set:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    blockPublicAccess: new s3.BlockPublicAccess({
        blockPublicAcls         : false, // Sensitive
        blockPublicPolicy       : true,
        ignorePublicAcls        : true,
        restrictPublicBuckets   : true
    })
});
</pre>
<p>The attribute <code>BLOCK_ACLS</code> only blocks and ignores public ACLs:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ACLS // Sensitive
});
</pre>
<h2>Compliant Solution</h2>
<p>This <code>blockPublicAccess</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public policies:</p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL
});
</pre>
<p>A similar configuration to the one above can be obtained by setting all parameters of the <code>blockPublicAccess</code></p>
<pre>
const s3 = require('aws-cdk-lib/aws-s3');

new s3.Bucket(this, 'id', {
    bucketName: 'bucket',
    blockPublicAccess: new s3.BlockPublicAccess({
        blockPublicAcls         : true,
        blockPublicPolicy       : true,
        ignorePublicAcls        : true,
        restrictPublicBuckets   : true
    })
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html">AWS Documentation</a> - Blocking public
  access to your Amazon S3 storage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BlockPublicAccess.html">AWS CDK version 2</a> - BlockPublicAccess </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S2255"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2255">
              javascript:S2255
            </a>
          </td>
          <td >
            <details>
              <p>Using cookies is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11639">CVE-2018-11639</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6537">CVE-2016-6537</a> </li>
</ul>
<p>Attackers can use widely-available tools to read cookies. Any sensitive information they may contain will be exposed.</p>
<p>This rule flags code that writes cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sensitive information is stored inside the cookie. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Cookies should only be used to manage the user session. The best practice is to keep all user-related information server-side and link them to the
user session, never sending them to the client. In a very few corner cases, cookies can be used for non-sensitive information that need to live longer
than the user session.</p>
<p>Do not try to encode sensitive information in a non human-readable format before writing them in a cookie. The encoding can be reverted and the
original information will be exposed.</p>
<p>Using cookies only for session IDs doesn’t make them secure. Follow <a
href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies">OWASP best practices</a> when you configure your
cookies.</p>
<p>As a side note, every information read from a cookie should be <a
href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitized</a>.</p>
<h2>Sensitive Code Example</h2>
<pre>
// === Built-in NodeJS modules ===
const http = require('http');
const https = require('https');

http.createServer(function(req, res) {
  res.setHeader('Set-Cookie', ['type=ninja', 'lang=js']); // Sensitive
});
https.createServer(function(req, res) {
  res.setHeader('Set-Cookie', ['type=ninja', 'lang=js']); // Sensitive
});
</pre>
<pre>
// === ExpressJS ===
const express = require('express');
const app = express();
app.use(function(req, res, next) {
  res.cookie('name', 'John'); // Sensitive
});
</pre>
<pre>
// === In browser ===
// Set cookie
document.cookie = "name=John"; // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/312">MITRE, CWE-312</a> - Cleartext Storage of Sensitive Information </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#COOKIE_USAGE">COOKIE_USAGE</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="javascript:S4790"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4790">
              javascript:S4790
            </a>
          </td>
          <td >
            <details>
              <p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,
<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,
<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little
computational effort is enough to find two or more different inputs that produce the same hash).</p>
<h2>Ask Yourself Whether</h2>
<p>The hashed value is used in a security context like:</p>
<ul>
  <li> User-password storage. </li>
  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>
  <li> To compute some message integrity. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even
better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>
because it slows down <code>brute force attacks</code>.</p>
<h2>Sensitive Code Example</h2>
<pre>
const crypto = require("crypto");

const hash = crypto.createHash('sha1'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
const crypto = require("crypto");

const hash = crypto.createHash('sha512'); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1240">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6299"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6299">
              javascript:S6299
            </a>
          </td>
          <td >
            <details>
              <p>Vue.js framework prevents XSS vulnerabilities by automatically escaping HTML contents with the use of native API browsers like
<code>innerText</code> instead of <code>innerHtml</code>.</p>
<p>It’s still possible to explicity use <code>innerHtml</code> and similar APIs to render HTML. Accidentally rendering malicious HTML data will
introduce an XSS vulnerability in the application and enable a wide range of serious attacks like accessing/modifying sensitive information or
impersonating other users.</p>
<h2>Ask Yourself Whether</h2>
<p>The application needs to render HTML content which:</p>
<ul>
  <li> could be user-controlled and not previously sanitized. </li>
  <li> is difficult to understand how it was constructed. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Avoid injecting HTML content with <code>v-html</code> directive unless the content can be considered 100% safe, instead try to rely as much as
  possible on built-in auto-escaping Vue.js features. </li>
  <li> Take care when using the <code>v-bind:href</code> directive to set URLs which can contain malicious Javascript
  (<code>javascript:onClick(...)</code>). </li>
  <li> Event directives like <code>:onmouseover</code> are also prone to Javascript injection and should not be used with unsafe values. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>When using Vue.js templates, the <code>v-html</code> directive enables HTML rendering without any sanitization:</p>
<pre>
&lt;div v-html="htmlContent"&gt;&lt;/div&gt; &lt;!-- Noncompliant --&gt;
</pre>
<p>When using a rendering function, the <code>innerHTML</code> attribute enables HTML rendering without any sanitization:</p>
<pre>
Vue.component('element', {
  render: function (createElement) {
    return createElement(
      'div',
      {
        domProps: {
          innerHTML: this.htmlContent, // Noncompliant
        }
      }
    );
  },
});
</pre>
<p>When using JSX, the <code>domPropsInnerHTML</code> attribute enables HTML rendering without any sanitization:</p>
<pre>
&lt;div domPropsInnerHTML={this.htmlContent}&gt;&lt;/div&gt; &lt;!-- Noncompliant --&gt;
</pre>
<h2>Compliant Solution</h2>
<p>When using Vue.js templates, putting the content as a child node of the element is safe:</p>
<pre>
&lt;div&gt;{{ htmlContent }}&lt;/div&gt;
</pre>
<p>When using a rendering function, using the <code>innerText</code> attribute or putting the content as a child node of the element is safe:</p>
<pre>
Vue.component('element', {
  render: function (createElement) {
    return createElement(
      'div',
      {
        domProps: {
          innerText: this.htmlContent,
        }
      },
      this.htmlContent // Child node
    );
  },
});
</pre>
<p>When using JSX, putting the content as a child node of the element is safe:</p>
<pre>
&lt;div&gt;{this.htmlContent}&lt;/div&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
  <li> <a href="https://vuejs.org/v2/guide/security.html#Injecting-HTML">Vue.js - Security - Injecting HTML</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6304"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6304">
              javascript:S6304
            </a>
          </td>
          <td >
            <details>
              <p>A policy that allows identities to access all resources in an AWS account may violate <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity has permission to access
all resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive
information will occur.</p>
<h2>Ask Yourself Whether</h2>
<p>The AWS account has more than one resource with different levels of sensitivity.</p>
<p>A risk exists if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is
to organize or <a
href="https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/">tag</a>
resources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>
<h2>Noncompliant Code Example</h2>
<p>The wildcard <code>"*"</code> is specified as the resource for this <code>PolicyStatement</code>. This grants the update permission for all
policies of the account:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'

new iam.PolicyDocument({
    statements: [
        new iam.PolicyStatement({
            effect: iam.Effect.ALLOW,
            actions: ["iam:CreatePolicyVersion"],
            resources: ["*"] // Sensitive
        })
    ]
})
</pre>
<h2>Compliant Solution</h2>
<p>Restrict the update permission to the appropriate subset of policies:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'

new iam.PolicyDocument({
    statements: [
        new iam.PolicyStatement({
            effect: iam.Effect.ALLOW,
            actions: ["iam:CreatePolicyVersion"],
            resources: ["arn:aws:iam:::policy/team1/*"]
        })
    ]
})
</pre>
<h2>Exceptions</h2>
<ul>
  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>
  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5332">
              javascript:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<pre>
url = "http://example.com"; // Sensitive
url = "ftp://anonymous@example.com"; // Sensitive
url = "telnet://anonymous@example.com"; // Sensitive
</pre>
<p>For <a href="https://nodemailer.com">nodemailer</a>:</p>
<pre>
const nodemailer = require("nodemailer");
let transporter = nodemailer.createTransport({
  secure: false, // Sensitive
  requireTLS: false // Sensitive
});
</pre>
<pre>
const nodemailer = require("nodemailer");
let transporter = nodemailer.createTransport({}); // Sensitive
</pre>
<p>For <a href="https://github.com/mscdex/node-ftp">ftp</a>:</p>
<pre>
var Client = require('ftp');
var c = new Client();
c.connect({
  'secure': false // Sensitive
});
</pre>
<p>For <a href="https://github.com/mkozjak/node-telnet-client">telnet-client</a>:</p>
<pre>
const Telnet = require('telnet-client'); // Sensitive
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>
<pre>
import { ApplicationLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

const alb = new ApplicationLoadBalancer(this, 'ALB', {
  vpc: vpc,
  internetFacing: true
});

alb.addListener('listener-http-default', {
  port: 8080,
  open: true
}); // Sensitive

alb.addListener('listener-http-explicit', {
  protocol: ApplicationProtocol.HTTP, // Sensitive
  port: 8080,
  open: true
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationListener</a>:</p>
<pre>
import { ApplicationListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new ApplicationListener(this, 'listener-http-explicit-constructor', {
  loadBalancer: alb,
  protocol: ApplicationProtocol.HTTP, // Sensitive
  port: 8080,
  open: true
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>
<pre>
import { NetworkLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

const nlb = new NetworkLoadBalancer(this, 'nlb', {
  vpc: vpc,
  internetFacing: true
});

var listenerNLB = nlb.addListener('listener-tcp-default', {
  port: 1234
}); // Sensitive

listenerNLB = nlb.addListener('listener-tcp-explicit', {
  protocol: Protocol.TCP, // Sensitive
  port: 1234
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkListener</a>:</p>
<pre>
import { NetworkListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new NetworkListener(this, 'listener-tcp-explicit-constructor', {
  loadBalancer: nlb,
  protocol: Protocol.TCP, // Sensitive
  port: 8080
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.CfnListener</a>:</p>
<pre>
import { CfnListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new CfnListener(this, 'listener-http', {
  defaultActions: defaultActions,
  loadBalancerArn: alb.loadBalancerArn,
  protocol: "HTTP", // Sensitive
  port: 80
});

new CfnListener(this, 'listener-tcp', {
  defaultActions: defaultActions,
  loadBalancerArn: alb.loadBalancerArn,
  protocol: "TCP", // Sensitive
  port: 80
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.CfnLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancing.CfnLoadBalancer</a>:</p>
<pre>
import { CfnLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';

new CfnLoadBalancer(this, 'elb-tcp', {
  listeners: [{
    instancePort: '1000',
    loadBalancerPort: '1000',
    protocol: 'tcp' // Sensitive
  }]
});

new CfnLoadBalancer(this, 'elb-http', {
  listeners: [{
    instancePort: '1000',
    loadBalancerPort: '1000',
    protocol: 'http' // Sensitive
  }]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.LoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancing.LoadBalancer</a>:</p>
<pre>
import { LoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';

const loadBalancer = new LoadBalancer(this, 'elb-tcp-dict', {
    vpc,
    internetFacing: true,
    healthCheck: {
    port: 80,
    },
    listeners: [
    {
        externalPort:10000,
        externalProtocol: LoadBalancingProtocol.TCP, // Sensitive
        internalPort:10000
    }]
});

loadBalancer.addListener({
  externalPort:10001,
  externalProtocol:LoadBalancingProtocol.TCP, // Sensitive
  internalPort:10001
});
loadBalancer.addListener({
  externalPort:10002,
  externalProtocol:LoadBalancingProtocol.HTTP, // Sensitive
  internalPort:10002
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticache.CfnReplicationGroup.html">aws-cdk-lib.aws-elasticache.CfnReplicationGroup</a>:</p>
<pre>
import { CfnReplicationGroup } from 'aws-cdk-lib/aws-elasticache';

new CfnReplicationGroup(this, 'unencrypted-implicit', {
  replicationGroupDescription: 'exampleDescription'
}); // Sensitive

new CfnReplicationGroup(this, 'unencrypted-explicit', {
  replicationGroupDescription: 'exampleDescription',
  transitEncryptionEnabled: false // Sensitive
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.CfnStream.html">aws-cdk-lib.aws-kinesis.CfnStream</a>:</p>
<pre>
import { CfnStream } from 'aws-cdk-lib/aws-kinesis';

new CfnStream(this, 'cfnstream-implicit-unencrytped', undefined); // Sensitive

new CfnStream(this, 'cfnstream-explicit-unencrytped', {
  streamEncryption: undefined // Sensitive
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.Stream.html">aws-cdk-lib.aws-kinesis.Stream</a>:</p>
<pre>
import { Stream } from 'aws-cdk-lib/aws-kinesis';

new Stream(this, 'stream-explicit-unencrypted', {
  encryption: StreamEncryption.UNENCRYPTED // Sensitive
});
</pre>
<h2>Compliant Solution</h2>
<pre>
url = "https://example.com";
url = "sftp://anonymous@example.com";
url = "ssh://anonymous@example.com";
</pre>
<p>For <a href="https://nodemailer.com">nodemailer</a> one of the following options must be set:</p>
<pre>
const nodemailer = require("nodemailer");
let transporter = nodemailer.createTransport({
  secure: true,
  requireTLS: true,
  port: 465,
  secured: true
});
</pre>
<p>For <a href="https://github.com/mscdex/node-ftp">ftp</a>:</p>
<pre>
var Client = require('ftp');
var c = new Client();
c.connect({
  'secure': true
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>
<pre>
import { ApplicationLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

const alb = new ApplicationLoadBalancer(this, 'ALB', {
  vpc: vpc,
  internetFacing: true
});

alb.addListener('listener-https-explicit', {
  protocol: ApplicationProtocol.HTTPS,
  port: 8080,
  open: true,
  certificates: [certificate]
});

alb.addListener('listener-https-implicit', {
  port: 8080,
  open: true,
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.ApplicationListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.ApplicationListener</a>:</p>
<pre>
import { ApplicationListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new ApplicationListener(this, 'listener-https-explicit', {
  loadBalancer: loadBalancer,
  protocol: ApplicationProtocol.HTTPS,
  port: 8080,
  open: true,
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>
<pre>
import { NetworkLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

const nlb = new NetworkLoadBalancer(this, 'nlb', {
  vpc: vpc,
  internetFacing: true
});

nlb.addListener('listener-tls-explicit', {
  protocol: Protocol.TLS,
  port: 1234,
  certificates: [certificate]
});

nlb.addListener('listener-tls-implicit', {
  port: 1234,
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.NetworkListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.NetworkListener</a>:</p>
<pre>
import { NetworkListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new NetworkListener(this, 'listener-tls-explicit', {
  loadBalancer: loadBalancer,
  protocol: Protocol.TLS,
  port: 8080,
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancingv2.CfnListener.html">aws-cdk-lib.aws-elasticloadbalancingv2.CfnListener</a>:</p>
<pre>
import { CfnListener } from 'aws-cdk-lib/aws-elasticloadbalancingv2';

new CfnListener(this, 'listener-https', {
  defaultActions: defaultActions,
  loadBalancerArn: loadBalancerArn,
  protocol: "HTTPS",
  port: 80
  certificates: [certificate]
});

new CfnListener(this, 'listener-tls', {
  defaultActions: defaultActions,
  loadBalancerArn: loadBalancerArn,
  protocol: "TLS",
  port: 80
  certificates: [certificate]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.CfnLoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancing.CfnLoadBalancer</a>:</p>
<pre>
import { CfnLoadBalancer } from 'aws-cdk-lib/aws-elasticloadbalancing';

new CfnLoadBalancer(this, 'elb-ssl', {
  listeners: [{
    instancePort: '1000',
    loadBalancerPort: '1000',
    protocol: 'ssl',
    sslCertificateId: sslCertificateId
  }]
});

new CfnLoadBalancer(this, 'elb-https', {
  listeners: [{
    instancePort: '1000',
    loadBalancerPort: '1000',
    protocol: 'https',
    sslCertificateId: sslCertificateId
  }]
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticloadbalancing.LoadBalancer.html">aws-cdk-lib.aws-elasticloadbalancing.LoadBalancer</a>:</p>
<pre>
import { LoadBalancer, LoadBalancingProtocol } from 'aws-cdk-lib/aws-elasticloadbalancing';

const lb = new LoadBalancer(this, 'elb-ssl', {
  vpc,
  internetFacing: true,
  healthCheck: {
    port: 80,
  },
  listeners: [
    {
      externalPort:10000,
      externalProtocol:LoadBalancingProtocol.SSL,
      internalPort:10000
    }]
});

lb.addListener({
  externalPort:10001,
  externalProtocol:LoadBalancingProtocol.SSL,
  internalPort:10001
});
lb.addListener({
  externalPort:10002,
  externalProtocol:LoadBalancingProtocol.HTTPS,
  internalPort:10002
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_elasticache.CfnReplicationGroup.html">aws-cdk-lib.aws-elasticache.CfnReplicationGroup</a>:</p>
<pre>
import { CfnReplicationGroup } from 'aws-cdk-lib/aws-elasticache';

new CfnReplicationGroup(this, 'encrypted-explicit', {
  replicationGroupDescription: 'example',
  transitEncryptionEnabled: true
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.Stream.html">aws-cdk-lib.aws-kinesis.Stream</a>:</p>
<pre>
import { Stream } from 'aws-cdk-lib/aws-kinesis';

new Stream(this, 'stream-implicit-encrypted');

new Stream(this, 'stream-explicit-encrypted-selfmanaged', {
  encryption: StreamEncryption.KMS,
  encryptionKey: encryptionKey,
});

new Stream(this, 'stream-explicit-encrypted-managed', {
  encryption: StreamEncryption.MANAGED
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_kinesis.CfnStream.html">aws-cdk-lib.aws-kinesis.CfnStream</a>:</p>
<pre>
import { CfnStream } from 'aws-cdk-lib/aws-kinesis';

new CfnStream(this, 'cfnstream-explicit-encrypted', {
  streamEncryption: {
    encryptionType: encryptionType,
    keyId: encryptionKey.keyId,
  }
});
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2068">
              javascript:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
var mysql = require('mysql');

var connection = mysql.createConnection(
{
  host:'localhost',
  user: "admin",
  database: "project",
  password: "mypassword", // sensitive
  multipleStatements: true
});

connection.connect();
</pre>
<h2>Compliant Solution</h2>
<pre>
var mysql = require('mysql');

var connection = mysql.createConnection({
  host: process.env.MYSQL_URL,
  user: process.env.MYSQL_USERNAME,
  password: process.env.MYSQL_PASSWORD,
  database: process.env.MYSQL_DATABASE
});
connection.connect();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6302"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6302">
              javascript:S6302
            </a>
          </td>
          <td >
            <details>
              <p>A policy that grants all permissions may indicate an improper access control, which violates <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity is granted full
permissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources
may occur and therefore result in loss of information.</p>
<h2>Ask Yourself Whether</h2>
<p>Identities obtaining all the permissions:</p>
<ul>
  <li> only require a subset of these permissions to perform the intended function. </li>
  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start
with the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in
production, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>
<h2>Sensitive Code Example</h2>
<p>A customer-managed policy that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'

new iam.PolicyStatement({
    effect: iam.Effect.ALLOW,
    actions: ["*"], // Sensitive
    resources: ["arn:aws:iam:::user/*"],
})
</pre>
<h2>Compliant Solution</h2>
<p>A customer-managed policy that grants only the required permissions:</p>
<pre>
import { aws_iam as iam } from 'aws-cdk-lib'

new iam.PolicyStatement({
    effect: iam.Effect.ALLOW,
    actions: ["iam:GetAccountSummary"],
    resources: ["arn:aws:iam:::user/*"],
})
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cloud.google.com/iam/docs/understanding-roles">Google Cloud Documentation</a> - Understanding roles </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6303"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6303">
              javascript:S6303
            </a>
          </td>
          <td >
            <details>
              <p>Using unencrypted RDS DB resources exposes data to unauthorized access to the underlying storage.<br> This includes database data, logs, automatic
backups, read replicas, snapshots, and cluster metadata.</p>
<p>This situation can occur in a variety of scenarios, such as:</p>
<ul>
  <li> a malicious insider working at the cloud provider gains physical access to the storage device and exfiltrates data. </li>
  <li> unknown attackers penetrate the cloud provider’s logical infrastructure and systems for extortion. </li>
</ul>
<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is
required as encryption at rest is fully managed by AWS.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html"><code>aws-cdk-lib.aws_rds.CfnDBCluster</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

new rds.CfnDBCluster(this, 'example', {
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html"><code>aws-cdk-lib.aws_rds.CfnDBInstance</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

new rds.CfnDBInstance(this, 'example', {
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html"><code>aws-cdk-lib.aws_rds.DatabaseCluster</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';
import { aws_ec2 as ec2 } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

const cluster = new rds.DatabaseCluster(this, 'example', {
  engine: rds.DatabaseClusterEngine.auroraMysql({ version: rds.AuroraMysqlEngineVersion.VER_2_08_1 }),
  instanceProps: {
    vpcSubnets: {
      subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,
    },
    vpc,
  },
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot.html"><code>aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

new rds.DatabaseClusterFromSnapshot(this, 'example', {
  engine: rds.DatabaseClusterEngine.aurora({ version: rds.AuroraEngineVersion.VER_1_22_2 }),
  instanceProps: {
    vpc,
  },
  snapshotIdentifier: 'exampleSnapshot',
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html"><code>aws-cdk-lib.aws_rds.DatabaseInstance</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

new rds.DatabaseInstance(this, 'example', {
  engine: rds.DatabaseInstanceEngine.POSTGRES,
  vpc,
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica.html"><code>aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const sourceInstance: rds.DatabaseInstance;

new rds.DatabaseInstanceReadReplica(this, 'example', {
  sourceDatabaseInstance: sourceInstance,
  instanceType: ec2.InstanceType.of(ec2.InstanceClass.BURSTABLE2, ec2.InstanceSize.LARGE),
  vpc,
  storageEncrypted: false, // Sensitive
});
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html"><code>aws-cdk-lib.aws_rds.CfnDBCluster</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

new rds.CfnDBCluster(this, 'example', {
  storageEncrypted: true,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html"><code>aws-cdk-lib.aws_rds.CfnDBInstance</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

new rds.CfnDBInstance(this, 'example', {
  storageEncrypted: true,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html"><code>aws-cdk-lib.aws_rds.DatabaseCluster</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

const cluster = new rds.DatabaseCluster(this, 'example', {
  engine: rds.DatabaseClusterEngine.auroraMysql({ version: rds.AuroraMysqlEngineVersion.VER_2_08_1 }),
  instanceProps: {
    vpcSubnets: {
      subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS,
    },
    vpc,
  },
  storageEncrypted: false, // Sensitive
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot.html"><code>aws-cdk-lib.aws_rds.DatabaseClusterFromSnapshot</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

new rds.DatabaseClusterFromSnapshot(this, 'example', {
  engine: rds.DatabaseClusterEngine.aurora({ version: rds.AuroraEngineVersion.VER_1_22_2 }),
  instanceProps: {
    vpc,
  },
  snapshotIdentifier: 'exampleSnapshot',
  storageEncrypted: true,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html"><code>aws-cdk-lib.aws_rds.DatabaseInstance</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const vpc: ec2.Vpc;

new rds.DatabaseInstance(this, 'example', {
  engine: rds.DatabaseInstanceEngine.POSTGRES,
  vpc,
  storageEncrypted: true,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica.html"><code>aws-cdk-lib.aws_rds.DatabaseInstanceReadReplica</code></a>:</p>
<pre>
import { aws_rds as rds } from 'aws-cdk-lib';

declare const sourceInstance: rds.DatabaseInstance;

new rds.DatabaseInstanceReadReplica(this, 'example', {
  sourceDatabaseInstance: sourceInstance,
  instanceType: ec2.InstanceType.of(ec2.InstanceClass.BURSTABLE2, ec2.InstanceSize.LARGE),
  vpc,
  storageEncrypted: true,
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html">AWS Documentation</a> - Encrypting Amazon RDS
  resources </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6308"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6308">
              javascript:S6308
            </a>
          </td>
          <td >
            <details>
              <p>Amazon OpenSearch Service is a managed service to host OpenSearch instances. It replaces Elasticsearch Service, which has been deprecated.</p>
<p>To harden domain (cluster) data in case of unauthorized access, OpenSearch provides data-at-rest encryption if the engine is OpenSearch (any
version), or Elasticsearch with a version of 5.1 or above. Enabling encryption at rest will help protect:</p>
<ul>
  <li> indices </li>
  <li> logs </li>
  <li> swap files </li>
  <li> data in the application directory </li>
  <li> automated snapshots </li>
</ul>
<p>Thus, adversaries cannot access the data if they gain physical access to the storage medium.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to encrypt OpenSearch domains that contain sensitive information.</p>
<p>OpenSearch handles encryption and decryption transparently, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>
<pre>
import { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';

const exampleDomain = new opensearchservice.Domain(this, 'ExampleDomain', {
  version: EngineVersion.OPENSEARCH_1_3,
}); // Sensitive, encryption must be explicitly enabled
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.CfnDomain.html">aws-cdk-lib.aws_opensearchservice.CfnDomain</a>:</p>
<pre>
import { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';

const exampleCfnDomain = new opensearchservice.CfnDomain(this, 'ExampleCfnDomain', {
  engineVersion: 'OpenSearch_1.3',
}); // Sensitive, encryption must be explicitly enabled
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>
<pre>
import { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';

const exampleDomain = new opensearchservice.Domain(this, 'ExampleDomain', {
  version: EngineVersion.OPENSEARCH_1_3,
  encryptionAtRest: {
    enabled: true,
  },
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.CfnDomain.html">aws-cdk-lib.aws_opensearchservice.CfnDomain</a>:</p>
<pre>
import { aws_opensearchservice as opensearchservice } from 'aws-cdk-lib';

const exampleCfnDomain = new opensearchservice.CfnDomain(this, 'ExampleCfnDomain', {
  engineVersion: 'OpenSearch_1.3',
  encryptionAtRestOptions: {
    enabled: true,
  },
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/opensearch-service/latest/developerguide/encryption-at-rest.html">AWS Documentation</a> - Encryption of
  data at rest for Amazon OpenSearch Service </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5691"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5691">
              javascript:S5691
            </a>
          </td>
          <td >
            <details>
              <p>Hidden files are created automatically by many tools to save user-preferences, well-known examples are <code>.profile</code>, <code>.bashrc</code>,
<code>.bash_history</code> or .<code>git</code>. To simplify the view these files are not displayed by default using operating system commands like
<code>ls</code>.</p>
<p>Outside of the user environment, hidden files are sensitive because they are used to store privacy-related information or even hard-coded
secrets.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Hidden files may have been inadvertently uploaded to the static server’s public directory and it accepts requests to hidden files. </li>
  <li> There is no business use cases linked to serve files in <code>.name</code> format but the server is not configured to reject requests to this
  type of files. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Disable the serving of hidden files. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/serve-static">Express.js serve-static</a> middleware:</p>
<pre>
let serveStatic = require("serve-static");
let app = express();
let serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'allow'});   // Sensitive
app.use(serveStaticMiddleware);
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/serve-static">Express.js serve-static</a> middleware:</p>
<pre>
let serveStatic = require("serve-static");
let app = express();
let serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'ignore'});   // Compliant: ignore or deny are recommended values
let serveStaticDefault = serveStatic('public', { 'index': false});   // Compliant: by default, "dotfiles" (file or directory that begins with a dot) are not served (with the exception that files within a directory that begins with a dot are not ignored), see serve-static module documentation
app.use(serveStaticMiddleware);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://github.com/mtojek/go-url-fuzzer">github.com/mtojek/go-url-fuzzer</a> - Discover hidden files and directories on a web server.
  </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Web Top 10 2017 Category A6</a> - Security
  Misconfiguration. </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/538">MITRE, CWE-538</a> - File and Directory Information Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5693"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5693">
              javascript:S5693
            </a>
          </td>
          <td >
            <details>
              <p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in
order to prevents DoS attacks.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> size limits are not defined for the different resources of the web application. </li>
  <li> the web application is not protected by <a href="https://en.wikipedia.org/wiki/Rate_limiting">rate limiting</a> features. </li>
  <li> the web application infrastructure has limited resources. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> For most of the features of an application, it is recommended to limit the size of requests to:
    <ul>
      <li> lower or equal to 8mb for file uploads. </li>
      <li> lower or equal to 2mb for other requests. </li>
    </ul>  </li>
</ul>
<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/formidable">formidable</a> file upload module:</p>
<pre>
const form = new Formidable();
form.maxFileSize = 10000000; // Sensitive: 10MB is more than the recommended limit of 8MB

const formDefault = new Formidable(); // Sensitive, the default value is 200MB
</pre>
<p><a href="https://www.npmjs.com/package/multer">multer</a> (Express.js middleware) file upload module:</p>
<pre>
let diskUpload = multer({
  storage: diskStorage,
  limits: {
    fileSize: 10000000; // Sensitive: 10MB is more than the recommended limit of 8MB
  }
});

let diskUploadUnlimited = multer({ // Sensitive: the default value is no limit
  storage: diskStorage,
});
</pre>
<p><a href="https://www.npmjs.com/package/body-parser">body-parser</a> module:</p>
<pre>
// 4MB is more than the recommended limit of 2MB for non-file-upload requests
let jsonParser = bodyParser.json({ limit: "4mb" }); // Sensitive
let urlencodedParser = bodyParser.urlencoded({ extended: false, limit: "4mb" }); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/formidable">formidable</a> file upload module:</p>
<pre>
const form = new Formidable();
form.maxFileSize = 8000000; // Compliant: 8MB
</pre>
<p><a href="https://www.npmjs.com/package/multer">multer</a> (Express.js middleware) file upload module:</p>
<pre>
let diskUpload = multer({
  storage: diskStorage,
  limits: {
     fileSize: 8000000 // Compliant: 8MB
  }
});
</pre>
<p><a href="https://www.npmjs.com/package/body-parser">body-parser</a> module:</p>
<pre>
let jsonParser = bodyParser.json(); // Compliant, when the limit is not defined, the default value is set to 100kb
let urlencodedParser = bodyParser.urlencoded({ extended: false, limit: "2mb" }); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html">Owasp Cheat Sheet</a> - Owasp Denial of Service
  Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/770">MITRE, CWE-770</a> - Allocation of Resources Without Limits or Throttling </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="javascript:S2077"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2077">
              javascript:S2077
            </a>
          </td>
          <td >
            <details>
              <p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the
query. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=javascript%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted
queries.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some parts of the query come from untrusted values (like user inputs). </li>
  <li> The query is repeated/duplicated in other parts of the code. </li>
  <li> The application must support different types of relational databases. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">parameterized queries, prepared
  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>
  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
// === MySQL ===
const mysql = require('mysql');
const mycon = mysql.createConnection({ host: host, user: user, password: pass, database: db });
mycon.connect(function(err) {
  mycon.query('SELECT * FROM users WHERE id = ' + userinput, (err, res) =&gt; {}); // Sensitive
});

// === PostgreSQL ===
const pg = require('pg');
const pgcon = new pg.Client({ host: host, user: user, password: pass, database: db });
pgcon.connect();
pgcon.query('SELECT * FROM users WHERE id = ' + userinput, (err, res) =&gt; {}); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
// === MySQL ===
const mysql = require('mysql');
const mycon = mysql.createConnection({ host: host, user: user, password: pass, database: db });
mycon.connect(function(err) {
  mycon.query('SELECT name FROM users WHERE id = ?', [userinput], (err, res) =&gt; {});
});

// === PostgreSQL ===
const pg = require('pg');
const pgcon = new pg.Client({ host: host, user: user, password: pass, database: db });
pgcon.connect();
pgcon.query('SELECT name FROM users WHERE id = $1', [userinput], (err, res) =&gt; {});
</pre>
<h2>Exceptions</h2>
<p>This rule’s current implementation does not follow variables. It will only detect SQL queries which are formatted directly in the function
call.</p>
<pre>
const sql = 'SELECT * FROM users WHERE id = ' + userinput;
mycon.query(sql, (err, res) =&gt; {}); // Sensitive but no issue is raised.
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/89">MITRE, CWE-89</a> - Improper Neutralization of Special Elements used in an SQL Command
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rules <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA">Potential SQL/JPQL Injection
  (JPA)</a>, <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO">Potential SQL/JDOQL Injection (JDO)</a>, <a
  href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE">Potential SQL/HQL Injection (Hibernate)</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4817"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4817">
              javascript:S4817
            </a>
          </td>
          <td >
            <details>
              <p>Executing XPATH expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6272">CVE-2016-6272</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-9149">CVE-2016-9149</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-4837">CVE-2012-4837</a> </li>
</ul>
<p>User-provided data such as URL parameters should always be considered as untrusted and tainted. Constructing XPath expressions directly from
tainted data enables attackers to inject specially crafted values that changes the initial meaning of the expression itself. Successful XPath
injections attacks can read sensitive information from the XML document.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the XPATH expression might contain some unsafe input coming from a user. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Sanitize any user input before using it in an XPATH expression.</p>
<h2>Sensitive Code Example</h2>
<pre>
// === Server side ===

var xpath = require('xpath');
var xmldom = require('xmldom');

var doc = new xmldom.DOMParser().parseFromString(xml);
var nodes = xpath.select(userinput, doc); // Sensitive
var node = xpath.select1(userinput, doc); // Sensitive
</pre>
<pre>
// === Client side ===

// Chrome, Firefox, Edge, Opera, and Safari use the evaluate() method to select nodes:
var nodes = document.evaluate(userinput, xmlDoc, null, XPathResult.ANY_TYPE, null); // Sensitive

// Internet Explorer uses its own methods to select nodes:
var nodes = xmlDoc.selectNodes(userinput); // Sensitive
var node = xmlDoc.SelectSingleNode(userinput); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/643">MITRE, CWE-643</a> - Improper Neutralization of Data within XPath Expressions </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4818"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4818">
              javascript:S4818
            </a>
          </td>
          <td >
            <details>
              <p>Using sockets is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1785">CVE-2011-178</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5645">CVE-2017-5645</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6597">CVE-2018-6597</a> </li>
</ul>
<p>Sockets are vulnerable in multiple ways:</p>
<ul>
  <li> They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive
  sensitive information or inject dangerous input. </li>
  <li> The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. </li>
</ul>
<p>This rules flags code that creates sockets. It matches only the direct use of sockets, not use through frameworks or high-level APIs such as the
use of http connections.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sockets are created without any limit every time a user performs an action. </li>
  <li> input received from sockets is used without being sanitized. </li>
  <li> sensitive data is sent via sockets without being encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols. </li>
  <li> Encrypt all data sent if it is sensitive. Usually it is better to encrypt it even if the data is not sensitive as it might change later. </li>
  <li> <a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> any input read from the socket. </li>
  <li> Limit the number of sockets a given user can create. Close the sockets as soon as possible. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
const net = require('net');

var socket = new net.Socket(); // Sensitive
socket.connect(80, 'google.com');

// net.createConnection creates a new net.Socket, initiates connection with socket.connect(), then returns the net.Socket that starts the connection
net.createConnection({ port: port }, () =&gt; {}); // Sensitive

// net.connect is an alias to net.createConnection
net.connect({ port: port }, () =&gt; {}); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption ('Resource Exhaustion') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6319"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6319">
              javascript:S6319
            </a>
          </td>
          <td >
            <details>
              <p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker
instances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries
physically access the storage media, they cannot decrypt encrypted data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The instance contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by
SageMaker, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sagemaker.CfnNotebookInstance.html"><code>aws-cdk-lib.aws-sagemaker.CfnNotebookInstance</code></a></p>
<pre>
import { CfnNotebookInstance } from 'aws-cdk-lib/aws-sagemaker';

new CfnNotebookInstance(this, 'example', {
      instanceType: 'instanceType',
      roleArn: 'roleArn'
}); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sagemaker.CfnNotebookInstance.html"><code>aws-cdk-lib.aws-sagemaker.CfnNotebookInstance</code></a></p>
<pre>
import { CfnNotebookInstance } from 'aws-cdk-lib/aws-sagemaker';

const encryptionKey = new Key(this, 'example', {
    enableKeyRotation: true,
});
new CfnNotebookInstance(this, 'example', {
    instanceType: 'instanceType',
    roleArn: 'roleArn',
    kmsKeyId: encryptionKey.keyId
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html">Protect Data at Rest Using Encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="javascript:S5689"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5689">
              javascript:S5689
            </a>
          </td>
          <td >
            <details>
              <p>Disclosing technology fingerprints allows an attacker to gather information about the technologies used to develop the web application and to
perform relevant security assessments more quickly (like the identification of known vulnerable components).</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The <code>x-powered-by</code> HTTP header or similar is used by the application. </li>
  <li> Technologies used by the application are confidential and should not be easily guessed. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to not disclose technologies used on a website, with <code>x-powered-by</code> HTTP header for example.</p>
<p>In addition, it’s better to completely disable this HTTP header rather than setting it a random value.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/express">Express.js</a> name is disclosed by default into the <code>x-powered-by</code> HTTP header:</p>
<pre>
let express = require('express');
let app = express(); // Sensitive

app.get('/', function (req, res) {
  res.send('hello')
});
</pre>
<h2>Compliant Solution</h2>
<p><code>x-powered-by</code> HTTP header should be disabled in <a href="https://www.npmjs.com/package/express">Express.js</a> with
<code>app.disable</code> or with helmet <a href="https://www.npmjs.com/package/helmet">hidePoweredBy</a> middleware:</p>
<pre>
let express = require('express');

let app1 = express();  // Compliant
app1.disable("x-powered-by");

let helmet = require("helmet");
let app2 = express(); // Compliant
app2.use(helmet.hidePoweredBy());
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework.html">OWASP Testing Guide - OTG-INFO-008</a> - Fingerprint Web Application Framework </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Information Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5443"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5443">
              javascript:S5443
            </a>
          </td>
          <td >
            <details>
              <p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like
<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious
user can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,
modified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2012-2451">CVE-2012-2451</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2015-1838">CVE-2015-1838</a> </li>
</ul>
<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It
also detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>
<ul>
  <li> <code>/tmp</code> </li>
  <li> <code>/var/tmp</code> </li>
  <li> <code>/usr/tmp</code> </li>
  <li> <code>/dev/shm</code> </li>
  <li> <code>/dev/mqueue</code> </li>
  <li> <code>/run/lock</code> </li>
  <li> <code>/var/run/lock</code> </li>
  <li> <code>/Library/Caches</code> </li>
  <li> <code>/Users/Shared</code> </li>
  <li> <code>/private/tmp</code> </li>
  <li> <code>/private/var/tmp</code> </li>
  <li> <code>\Windows\Temp</code> </li>
  <li> <code>\Temp</code> </li>
  <li> <code>\TMP</code> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Files are read from or written into a publicly writable folder </li>
  <li> The application creates files with predictable names into a publicly writable folder </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a dedicated sub-folder with tightly controlled permissions </li>
  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:
    <ul>
      <li> The generated filename is unpredictable </li>
      <li> The file is readable and writable only by the creating user ID </li>
      <li> The file descriptor is not inherited by child processes </li>
      <li> The file will be destroyed as soon as it is closed </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
const fs = require('fs');

let tmp_file = "/tmp/temporary_file"; // Sensitive
fs.readFile(tmp_file, 'utf8', function (err, data) {
  // ...
});
</pre>
<pre>
const fs = require('fs');

let tmp_dir = process.env.TMPDIR; // Sensitive
fs.readFile(tmp_dir + "/temporary_file", 'utf8', function (err, data) {
  // ...
});
</pre>
<h2>Compliant Solution</h2>
<pre>
const tmp = require('tmp');

const tmpobj = tmp.fileSync(); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="javascript:S1523"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S1523">
              javascript:S1523
            </a>
          </td>
          <td >
            <details>
              <p>Executing code dynamically is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807">CVE-2017-9807</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802">CVE-2017-9802</a> </li>
</ul>
<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific
meta-programming use-cases. However most of the time their use is frowned upon as they also increase the risk of <a
href="https://owasp.org/www-community/attacks/Code_Injection">Injected Code</a>. Such attacks can either run on the server or in the client (exemple:
XSS attack) and have a huge impact on an application’s security.</p>
<p>This rule raises issues on calls to <code>eval</code> and <code>Function</code> constructor. This rule does not detect code injections. It only
highlights the use of APIs which should be used sparingly and very carefully. The goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>
  <li> you really need to run code dynamically. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Regarding the execution of unknown code, the best solution is to not run code provided by an untrusted source. If you really need to do it, run the
code in a <a href="https://en.wikipedia.org/wiki/Sandbox_(computer_security)">sandboxed</a> environment. Use jails, firewalls and whatever means your
operating system and programming language provide (example: <a
href="https://wiki.sei.cmu.edu/confluence/display/java/SEC54-J.+Create+a+secure+sandbox+using+a+security+manager">Security Managers</a> in java, <a
href="https://www.w3schools.com/tags/att_iframe_sandbox.asp">iframes</a> and <a href="https://en.wikipedia.org/wiki/Same-origin_policy">same-origin
policy</a> for javascript in a web browser).</p>
<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>
<p>Avoid using dynamic code APIs whenever possible. Hard-coded code is always safer.</p>
<h2>Sensitive Code Example</h2>
<pre>
let value = eval('obj.' + propName); // Sensitive
let func = Function('obj' + propName); // Sensitive
</pre>
<h2>Exceptions</h2>
<p>This rule will not raise an issue when the argument of the <code>eval</code> or <code>Function</code> is a literal string as it is reasonably
safe.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/95">MITRE, CWE-95</a> - Improper Neutralization of Directives in Dynamically Evaluated Code
  ('Eval Injection') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S2612"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2612">
              javascript:S2612
            </a>
          </td>
          <td >
            <details>
              <p>In Unix, "<code>others</code>" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>
<p>Granting permissions to this group can lead to unintended access to files.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application is designed to be run on a multi-user environment. </li>
  <li> Corresponding files and directories may contain confidential information. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
<h2>Sensitive Code Example</h2>
<p>Node.js <a href="https://nodejs.org/api/fs.html"><code>fs</code></a></p>
<pre>
const fs = require('fs');

fs.chmodSync("/tmp/fs", 0o777); // Sensitive
</pre>
<pre>
const fs = require('fs');
const fsPromises = fs.promises;

fsPromises.chmod("/tmp/fsPromises", 0o777); // Sensitive
</pre>
<pre>
const fs = require('fs');
const fsPromises = fs.promises

async function fileHandler() {
  let filehandle;
  try {
    filehandle = fsPromises.open('/tmp/fsPromises', 'r');
    filehandle.chmod(0o777); // Sensitive
  } finally {
    if (filehandle !== undefined)
      filehandle.close();
  }
}
</pre>
<p>Node.js <a href="https://nodejs.org/api/process.html#process_process_umask_mask"><code>process.umask</code></a></p>
<pre>
const process = require('process');

process.umask(0o000); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Node.js <a href="https://nodejs.org/api/fs.html"><code>fs</code></a></p>
<pre>
const fs = require('fs');

fs.chmodSync("/tmp/fs", 0o770); // Compliant
</pre>
<pre>
const fs = require('fs');
const fsPromises = fs.promises;

fsPromises.chmod("/tmp/fsPromises", 0o770); // Compliant
</pre>
<pre>
const fs = require('fs');
const fsPromises = fs.promises

async function fileHandler() {
  let filehandle;
  try {
    filehandle = fsPromises.open('/tmp/fsPromises', 'r');
    filehandle.chmod(0o770); // Compliant
  } finally {
    if (filehandle !== undefined)
      filehandle.close();
  }
}
</pre>
<p>Node.js <a href="https://nodejs.org/api/process.html#process_process_umask_mask"><code>process.umask</code></a></p>
<pre>
const process = require('process');

process.umask(0o007); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission">OWASP File Permission</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4721"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4721">
              javascript:S4721
            </a>
          </td>
          <td >
            <details>
              <p>Arbitrary OS command injection vulnerabilities are more likely when a shell is spawned rather than a new process, indeed shell meta-chars can be
used (when parameters are user-controlled for instance) to inject OS commands.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> OS command name or parameters are user-controlled. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Use functions that don’t spawn a shell.</p>
<h2>Sensitive Code Example</h2>
<pre>
const cp = require('child_process');

// A shell will be spawn in these following cases:
cp.exec(cmd); // Sensitive
cp.execSync(cmd); // Sensitive

cp.spawn(cmd, { shell: true }); // Sensitive
cp.spawnSync(cmd, { shell: true }); // Sensitive
cp.execFile(cmd, { shell: true }); // Sensitive
cp.execFileSync(cmd, { shell: true }); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
const cp = require('child_process');

cp.spawnSync("/usr/bin/file.exe", { shell: false }); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/78">MITRE, CWE-78</a> - Improper Neutralization of Special Elements used in an OS Command </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5148"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5148">
              javascript:S5148
            </a>
          </td>
          <td >
            <details>
              <p>A newly opened window having access back to the originating window could allow basic phishing attacks (the <code>window.opener</code> object is not
<code>null</code> and thus <code>window.opener.location</code> can be set to a malicious website by the opened page).</p>
<p>For instance, an attacker can put a link (say: "http://example.com/mylink") on a popular website that changes, when opened, the original page to
"http://example.com/fake_login". On "http://example.com/fake_login" there is a fake login page which could trick real users to enter their
credentials.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application opens untrusted external URL. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Use <code>noopener</code> to prevent untrusted pages from abusing <code>window.opener</code>.</p>
<p>Note: In Chrome 88+, Firefox 79+ or Safari 12.1+ <code>target=_blank</code> on anchors implies <code>rel=noopener</code> which make the protection
enabled by default.</p>
<h2>Sensitive Code Example</h2>
<pre>
window.open("https://example.com/dangerous");
</pre>
<h2>Compliant Solution</h2>
<pre>
window.open("https://example.com/dangerous", "WindowName", "noopener");
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/Reverse_Tabnabbing">Reverse Tabnabbing</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1022">MITRE, CWE-1022</a> - Use of Web Link to Untrusted Target with window.opener Access </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mathiasbynens.github.io/rel-noopener/">https://mathiasbynens.github.io/rel-noopener/</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S1313">
              javascript:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
ip = "192.168.12.42"; // Sensitive

const net = require('net');
var client = new net.Socket();
client.connect(80, ip, function() {
  // ...
});
</pre>
<h2>Compliant Solution</h2>
<pre>
ip = process.env.IP_ADDRESS; // Compliant

const net = require('net');
var client = new net.Socket();
client.connect(80, ip, function() {
  // ...
});
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID). </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the 2001:db8::/32 range, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6327"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6327">
              javascript:S6327
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)
communication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages
when they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to
access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The topic contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html"><code>aws_cdk.aws_sns.Topic</code></a></p>
<pre>
import { Topic } from 'aws-cdk-lib/aws-sns';

new Topic(this, 'exampleTopic'); // Sensitive
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html"><code>aws_cdk.aws_sns.CfnTopic</code></a></p>
<pre>
import { Topic, CfnTopic } from 'aws-cdk-lib/aws-sns';

new CfnTopic(this, 'exampleCfnTopic'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html"><code>aws_cdk.aws_sns.Topic</code></a></p>
<pre>
import { Topic } from 'aws-cdk-lib/aws-sns';

const encryptionKey = new Key(this, 'exampleKey', {
    enableKeyRotation: true,
});

new Topic(this, 'exampleTopic', {
    masterKey: encryptionKey
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html"><code>aws_cdk.aws_sns.CfnTopic</code></a></p>
<pre>
import { CfnTopic } from 'aws-cdk-lib/aws-sns';

const encryptionKey = new Key(this, 'exampleKey', {
    enableKeyRotation: true,
});

cfnTopic = new CfnTopic(this, 'exampleCfnTopic', {
    kmsMasterKeyId: encryptionKey.keyId
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html">AWS Documentation</a> - Encryption at rest </li>
  <li> <a href="https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/">Encrypting messages published to
  Amazon SNS with AWS KMS</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6329"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6329">
              javascript:S6329
            </a>
          </td>
          <td >
            <details>
              <p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft
or disruption.</p>
<p>Depending on the component, inbound access from the Internet can be enabled via:</p>
<ul>
  <li> a boolean value that explicitly allows access to the public network. </li>
  <li> the assignment of a public IP address. </li>
  <li> database firewall rules that allow public IP ranges. </li>
</ul>
<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>
<p>This decision increases the likelihood of attacks on the organization, such as:</p>
<ul>
  <li> data breaches. </li>
  <li> intrusions into the infrastructure to permanently steal from it. </li>
  <li> and various malicious traffic, such as DDoS attacks. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<p>This cloud resource:</p>
<ul>
  <li> should be publicly accessible to any Internet user. </li>
  <li> requires inbound traffic from the Internet to function properly. </li>
</ul>
<p>There is a risk if you answered no to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce
sites.</p>
<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud
components.</p>
<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the
absence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html">aws-cdk-lib.aws_ec2.Instance</a> and similar
constructs:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.Instance(this, "example", {
    instanceType: nanoT2,
    machineImage: ec2.MachineImage.latestAmazonLinux(),
    vpc: vpc,
    vpcSubnets: {subnetType: ec2.SubnetType.PUBLIC} // Sensitive
})
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnInstance.html">aws-cdk-lib.aws_ec2.CfnInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnInstance(this, "example", {
    instanceType: "t2.micro",
    imageId: "ami-0ea0f26a6d50850c5",
    networkInterfaces: [
        {
            deviceIndex: "0",
            associatePublicIpAddress: true, // Sensitive
            deleteOnTermination: true,
            subnetId: vpc.selectSubnets({subnetType: ec2.SubnetType.PUBLIC}).subnetIds[0]
        }
    ]
})
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_dms.CfnReplicationInstance.html">aws-cdk-lib.aws_dms.CfnReplicationInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new dms.CfnReplicationInstance(
    this, "example", {
    replicationInstanceClass: "dms.t2.micro",
    allocatedStorage: 5,
    publiclyAccessible: true, // Sensitive
    replicationSubnetGroupIdentifier: subnetGroup.replicationSubnetGroupIdentifier,
    vpcSecurityGroupIds: [vpc.vpcDefaultSecurityGroup]
})
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html">aws-cdk-lib.aws_rds.CfnDBInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const rdsSubnetGroupPublic = new rds.CfnDBSubnetGroup(this, "publicSubnet", {
    dbSubnetGroupDescription: "Subnets",
    dbSubnetGroupName: "publicSn",
    subnetIds: vpc.selectSubnets({
        subnetType: ec2.SubnetType.PUBLIC
    }).subnetIds
})

new rds.CfnDBInstance(this, "example", {
    engine: "postgres",
    masterUsername: "foobar",
    masterUserPassword: "12345678",
    dbInstanceClass: "db.r5.large",
    allocatedStorage: "200",
    iops: 1000,
    dbSubnetGroupName: rdsSubnetGroupPublic.ref,
    publiclyAccessible: true, // Sensitive
    vpcSecurityGroups: [sg.securityGroupId]
})
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html">aws-cdk-lib.aws_ec2.Instance</a> and similar
constructs:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.Instance(
    this,
    "example", {
    instanceType: nanoT2,
    machineImage: ec2.MachineImage.latestAmazonLinux(),
    vpc: vpc,
    vpcSubnets: {subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS}
})
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnInstance.html">aws-cdk-lib.aws_ec2.CfnInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnInstance(this, "example", {
    instanceType: "t2.micro",
    imageId: "ami-0ea0f26a6d50850c5",
    networkInterfaces: [
        {
            deviceIndex: "0",
            associatePublicIpAddress: false,
            deleteOnTermination: true,
            subnetId: vpc.selectSubnets({subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS}).subnetIds[0]
        }
    ]
})
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_dms.CfnReplicationInstance.html">aws-cdk-lib.aws_dms.CfnReplicationInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new dms.CfnReplicationInstance(
    this, "example", {
    replicationInstanceClass: "dms.t2.micro",
    allocatedStorage: 5,
    publiclyAccessible: false,
    replicationSubnetGroupIdentifier: subnetGroup.replicationSubnetGroupIdentifier,
    vpcSecurityGroupIds: [vpc.vpcDefaultSecurityGroup]
})
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html">aws-cdk-lib.aws_rds.CfnDBInstance</a>:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const rdsSubnetGroupPrivate = new rds.CfnDBSubnetGroup(this, "example",{
    dbSubnetGroupDescription: "Subnets",
    dbSubnetGroupName: "privateSn",
    subnetIds: vpc.selectSubnets({
        subnetType: ec2.SubnetType.PRIVATE_WITH_EGRESS
    }).subnetIds
})

new rds.CfnDBInstance(this, "example", {
    engine: "postgres",
    masterUsername: "foobar",
    masterUserPassword: "12345678",
    dbInstanceClass: "db.r5.large",
    allocatedStorage: "200",
    iops: 1000,
    dbSubnetGroupName: rdsSubnetGroupPrivate.ref,
    publiclyAccessible: false,
    vpcSecurityGroups: [sg.securityGroupId]
})
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html">AWS Documentation</a> - Amazon EC2 instance IP
  addressing </li>
  <li> <a href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html">AWS Documentation</a> - Public and
  private replication instances </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html">AWS Documentation</a> - VPC Peering </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4829"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4829">
              javascript:S4829
            </a>
          </td>
          <td >
            <details>
              <p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337">CVE-2005-2337</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449">CVE-2017-11449</a> </li>
</ul>
<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)
can be dangerous and should be validated.</p>
<p>This rule flags code that reads from the standard input.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> data read from the standard input is not sanitized before being used. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all data read from the standard input before using it.</p>
<h2>Sensitive Code Example</h2>
<pre>
// The process object is a global that provides information about, and control over, the current Node.js process
// All uses of process.stdin are security-sensitive and should be reviewed

process.stdin.on('readable', () =&gt; {
	const chunk = process.stdin.read(); // Sensitive
	if (chunk !== null) {
		dosomething(chunk);
	}
});

const readline = require('readline');
readline.createInterface({
	input: process.stdin // Sensitive
}).on('line', (input) =&gt; {
	dosomething(input);
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4823"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4823">
              javascript:S4823
            </a>
          </td>
          <td >
            <details>
              <p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281">CVE-2018-7281</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326">CVE-2018-12326</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198">CVE-2011-3198</a> </li>
</ul>
<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>
<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus
passing sensitive information via command line arguments should be considered as insecure.</p>
<p>This rule raises an issue when on every program entry points (<code>main</code> methods) when command line arguments are used. The goal is to guide
security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> any of the command line arguments are used without being sanitized first. </li>
  <li> your application accepts sensitive information via command line arguments. </li>
</ul>
<p>If you answered yes to any of these questions you are at risk.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all command line arguments before using them.</p>
<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing
sensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the
path to a file containing the information.</p>
<h2>Sensitive Code Example</h2>
<pre>
// The process object is a global that provides information about, and control over, the current Node.js process
var param = process.argv[2]; // Sensitive: check how the argument is used
console.log('Param: ' + param);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/88">MITRE, CWE-88</a> - Argument Injection or Modification </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/214">MITRE, CWE-214</a> - Information Exposure Through Process Environment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="javascript:S4036"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4036">
              javascript:S4036
            </a>
          </td>
          <td >
            <details>
              <p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>
environment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in
<code>PATH</code> is a directory under his control.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>
<h2>Sensitive Code Example</h2>
<pre>
const cp = require('child_process');
cp.exec('file.exe'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
const cp = require('child_process');
cp.exec('/usr/bin/file.exe'); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/426">MITRE, CWE-426</a> - Untrusted Search Path </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/427">MITRE, CWE-427</a> - Uncontrolled Search Path Element </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6333"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6333">
              javascript:S6333
            </a>
          </td>
          <td >
            <details>
              <p>A public API, which can be requested by any authenticated or unauthenticated identities, can lead to unauthorized actions and information
disclosures.</p>
<h2>Ask Yourself Whether</h2>
<p>The public API:</p>
<ul>
  <li> exposes sensitive data like personal information. </li>
  <li> can be used to perform sensitive operations. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict API access to authorized entities, unless the API offers a non-sensitive service designed to be public.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.Resource.html">aws-cdk-lib.aws_apigateway.Resource</a>:</p>
<pre>
import {aws_apigateway as apigateway} from "aws-cdk-lib"

const resource = api.root.addResource("example")
resource.addMethod(
    "GET",
    new apigateway.HttpIntegration("https://example.org"),
    {
        authorizationType: apigateway.AuthorizationType.NONE // Sensitive
    }
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html">aws-cdk-lib.aws_apigatewayv2.CfnRoute</a>:</p>
<pre>
import {aws_apigatewayv2 as apigateway} from "aws-cdk-lib"

new apigateway.CfnRoute(this, "no-auth", {
    apiId: api.ref,
    routeKey: "GET /no-auth",
    authorizationType: "NONE", // Sensitive
    target: exampleIntegration
})
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.Resource.html">aws-cdk-lib.aws_apigateway.Resource</a>:</p>
<pre>
import {aws_apigateway as apigateway} from "aws-cdk-lib"

const resource = api.root.addResource("example",{
    defaultMethodOptions:{
        authorizationType: apigateway.AuthorizationType.IAM
    }
})
resource.addMethod(
    "POST",
    new apigateway.HttpIntegration("https://example.org"),
    {
        authorizationType: apigateway.AuthorizationType.IAM
    }
)
resource.addMethod(  // authorizationType is inherited from the Resource's configured defaultMethodOptions
    "GET"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html">aws-cdk-lib.aws_apigatewayv2.CfnRoute</a>:</p>
<pre>
import {aws_apigatewayv2 as apigateway} from "aws-cdk-lib"

new apigateway.CfnRoute(this, "auth", {
    apiId: api.ref,
    routeKey: "POST /auth",
    authorizationType: "AWS_IAM",
    target: exampleIntegration
})
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html">AWS Documentation</a> -
  Controlling and managing access to a REST API in API Gateway </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5247"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5247">
              javascript:S5247
            </a>
          </td>
          <td >
            <details>
              <p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,
<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters
that make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>
<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a
href="https://twig.symfony.com/doc/3.x/filters/escape.html">the strategy applied</a> and the context, for example a "html auto-escaping" strategy
(which only transforms html characters into <a href="https://developer.mozilla.org/en-US/docs/Glossary/Entity">html entities</a>) will not be relevant
when variables are used in a <a href="https://en.wikipedia.org/wiki/HTML_attribute">html attribute</a> because '<code>:</code>' character is not
escaped and thus an attack as below is possible:</p>
<pre>
&lt;a href="{{ myLink }}"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)
&lt;a href="javascript:alert(document.cookie)"&gt;link&lt;/a&gt; // JS injection (XSS attack)
</pre>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Templates are used to render web content and
    <ul>
      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>
      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>
    </ul>  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right
one.</p>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/mustache">mustache.js</a> template engine:</p>
<pre>
let Mustache = require("mustache");

Mustache.escape = function(text) {return text;}; // Sensitive

let rendered = Mustache.render(template, { name: inputName });
</pre>
<p><a href="https://www.npmjs.com/package/handlebars">handlebars.js</a> template engine:</p>
<pre>
const Handlebars = require('handlebars');

let source = "&lt;p&gt;attack {{name}}&lt;/p&gt;";

let template = Handlebars.compile(source, { noEscape: true }); // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/markdown-it">markdown-it</a> markup language parser:</p>
<pre>
const markdownIt = require('markdown-it');
let md = markdownIt({
  html: true // Sensitive
});

let result = md.render('# &lt;b&gt;attack&lt;/b&gt;');
</pre>
<p><a href="https://www.npmjs.com/package/marked">marked</a> markup language parser:</p>
<pre>
const marked = require('marked');

marked.setOptions({
  renderer: new marked.Renderer(),
  sanitize: false // Sensitive
});

console.log(marked("# test &lt;b&gt;attack/b&gt;"));
</pre>
<p><a href="https://www.npmjs.com/package/kramed">kramed</a> markup language parser:</p>
<pre>
let kramed = require('kramed');

var options = {
  renderer: new kramed.Renderer({
    sanitize: false // Sensitive
  })
};
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/mustache">mustache.js</a> template engine:</p>
<pre>
let Mustache = require("mustache");

let rendered = Mustache.render(template, { name: inputName }); // Compliant autoescaping is on by default
</pre>
<p><a href="https://www.npmjs.com/package/handlebars">handlebars.js</a> template engine:</p>
<pre>
const Handlebars = require('handlebars');

let source = "&lt;p&gt;attack {{name}}&lt;/p&gt;";
let data = { "name": "&lt;b&gt;Alan&lt;/b&gt;" };

let template = Handlebars.compile(source); // Compliant by default noEscape is set to false
</pre>
<p><a href="https://www.npmjs.com/package/markdown-it">markdown-it</a> markup language parser:</p>
<pre>
let md = require('markdown-it')(); // Compliant by default html is set to false

let result = md.render('# &lt;b&gt;attack&lt;/b&gt;');
</pre>
<p><a href="https://www.npmjs.com/package/marked">marked</a> markup language parser:</p>
<pre>
const marked = require('marked');

marked.setOptions({
  renderer: new marked.Renderer()
}); // Compliant by default sanitize is set to true

console.log(marked("# test &lt;b&gt;attack/b&gt;"));
</pre>
<p><a href="https://www.npmjs.com/package/kramed">kramed</a> markup language parser:</p>
<pre>
let kramed = require('kramed');

let options = {
  renderer: new kramed.Renderer({
    sanitize: true // Compliant
  })
};

console.log(kramed('Attack [xss?](javascript:alert("xss")).', options));
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md">OWASP Cheat
  Sheet</a> - XSS Prevention Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5122"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5122">
              javascript:S5122
            </a>
          </td>
          <td >
            <details>
              <p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269">CVE-2018-0269</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460">CVE-2017-14460</a> </li>
</ul>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same origin policy</a> in browsers prevents, by default and for
security-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)
from its own. The requested target can append additional HTTP headers in response, called <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>, that act like directives for the browser and change the access control policy
/ relax the same origin policy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>
  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>
  <li> Your access control policy is dynamically defined by a user-controlled input like <a
  href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin"><code>origin</code></a> header. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>
  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or
  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://nodejs.org/api/http.html">nodejs http</a> built-in module:</p>
<pre>
const http = require('http');
const srv = http.createServer((req, res) =&gt; {
  res.writeHead(200, { 'Access-Control-Allow-Origin': '*' }); // Sensitive
  res.end('ok');
});
srv.listen(3000);
</pre>
<p><a href="https://www.npmjs.com/package/express">Express.js</a> framework with <a href="https://www.npmjs.com/package/cors">cors middleware</a>:</p>
<pre>
const cors = require('cors');

let app1 = express();
app1.use(cors()); // Sensitive: by default origin is set to *

let corsOptions = {
  origin: '*' // Sensitive
};

let app2 = express();
app2.use(cors(corsOptions));
</pre>
<p>User-controlled origin:</p>
<pre>
function (req, res) {
  const origin = req.header('Origin');
  res.setHeader('Access-Control-Allow-Origin', origin); // Sensitive
};
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/http.html">nodejs http</a> built-in module:</p>
<pre>
const http = require('http');
const srv = http.createServer((req, res) =&gt; {
  res.writeHead(200, { 'Access-Control-Allow-Origin': 'trustedwebsite.com' }); // Compliant
  res.end('ok');
});
srv.listen(3000);
</pre>
<p><a href="https://www.npmjs.com/package/express">Express.js</a> framework with <a href="https://www.npmjs.com/package/cors">cors middleware</a>:</p>
<pre>
const cors = require('cors');

let corsOptions = {
  origin: 'trustedwebsite.com' // Compliant
};

let app = express();
app.use(cors(corsOptions));
</pre>
<p>User-controlled origin validated with an allow-list:</p>
<pre>
function (req, res) {
  const origin = req.header('Origin');

  if (trustedOrigins.indexOf(origin) &gt;= 0) {
    res.setHeader('Access-Control-Allow-Origin', origin);
  }
};
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">developer.mozilla.org</a> - CORS </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">developer.mozilla.org</a> - Same origin policy </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing">OWASP HTML5 Security
  Cheat Sheet</a> - Cross Origin Resource Sharing </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/346">MITRE, CWE-346</a> - Origin Validation Error </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/942">MITRE, CWE-942</a> - Overly Permissive Cross-domain Whitelist </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6330">
              javascript:S6330
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store
messages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message
from the file system, for example through a vulnerability in the service, they are not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The queue contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html"><code>aws-cdk-lib.aws-sqs.Queue</code></a></p>
<pre>
import { Queue } from 'aws-cdk-lib/aws-sqs';

new Queue(this, 'example'); // Sensitive
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html"><code>aws-cdk-lib.aws-sqs.CfnQueue</code></a></p>
<pre>
import { CfnQueue } from 'aws-cdk-lib/aws-sqs';

new CfnQueue(this, 'example'); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html"><code>aws-cdk-lib.aws-sqs.Queue</code></a></p>
<pre>
import { Queue } from 'aws-cdk-lib/aws-sqs';

new Queue(this, 'example', {
    encryption: QueueEncryption.KMS_MANAGED
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html"><code>aws-cdk-lib.aws-sqs.CfnQueue</code></a></p>
<pre>
import { CfnQueue } from 'aws-cdk-lib/aws-sqs';

const encryptionKey = new Key(this, 'example', {
    enableKeyRotation: true,
});

new CfnQueue(this, 'example', {
    kmsMasterKeyId: encryptionKey.keyId
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html">AWS Documentation</a> -
  Encryption at rest </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S6332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6332">
              javascript:S6332
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be
automatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are
not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The file system contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html"><code>aws_cdk.aws_efs.FileSystem</code></a></p>
<pre>
import { FileSystem } from 'aws-cdk-lib/aws-efs';

new FileSystem(this, 'unencrypted-explicit', {
    vpc: new Vpc(this, 'VPC'),
    encrypted: false // Sensitive
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html"><code>aws_cdk.aws_efs.CfnFileSystem</code></a></p>
<pre>
import { CfnFileSystem } from 'aws-cdk-lib/aws-efs';

new CfnFileSystem(this, 'unencrypted-implicit-cfn', {
}); // Sensitive as encryption is disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html"><code>aws_cdk.aws_efs.FileSystem</code></a></p>
<pre>
import { FileSystem } from 'aws-cdk-lib/aws-efs';

new FileSystem(this, 'encrypted-explicit', {
    vpc: new Vpc(this, 'VPC'),
    encrypted: true
});
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html"><code>aws_cdk.aws_efs.CfnFileSystem</code></a></p>
<pre>
import { CfnFileSystem } from 'aws-cdk-lib/aws-efs';

new CfnFileSystem(this, 'encrypted-explicit-cfn', {
    encrypted: true
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/efs/latest/ug/encryption.html">AWS Documentation</a> - Data encryption in Amazon EFS </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S2092"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2092">
              javascript:S2092
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP
request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>
  <li> it’s not sure that the website contains <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">mixed content</a> or not
  (ie HTTPS everywhere or not) </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour
  when creating cookies. </li>
  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> module:</p>
<pre>
let session = cookieSession({
  secure: false,// Sensitive
});  // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/express-session">express-session</a> module:</p>
<pre>
const express = require('express');
const session = require('express-session');

let app = express();
app.use(session({
  cookie:
  {
    secure: false // Sensitive
  }
}));
</pre>
<p><a href="https://www.npmjs.com/package/cookies">cookies</a> module:</p>
<pre>
let cookies = new Cookies(req, res, { keys: keys });

cookies.set('LastVisit', new Date().toISOString(), {
  secure: false // Sensitive
}); // Sensitive
</pre>
<p><a href="https://www.npmjs.com/package/csurf">csurf</a> module:</p>
<pre>
const cookieParser = require('cookie-parser');
const csrf = require('csurf');
const express = require('express');

let csrfProtection = csrf({ cookie: { secure: false }}); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/cookie-session">cookie-session</a> module:</p>
<pre>
let session = cookieSession({
  secure: true,// Compliant
});  // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/express-session">express-session</a> module:</p>
<pre>
const express = require('express');
const session = require('express-session');

let app = express();
app.use(session({
  cookie:
  {
    secure: true // Compliant
  }
}));
</pre>
<p><a href="https://www.npmjs.com/package/cookies">cookies</a> module:</p>
<pre>
let cookies = new Cookies(req, res, { keys: keys });

cookies.set('LastVisit', new Date().toISOString(), {
  secure: true // Compliant
}); // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/csurf">csurf</a> module:</p>
<pre>
const cookieParser = require('cookie-parser');
const csrf = require('csurf');
const express = require('express');

let csrfProtection = csrf({ cookie: { secure: true }}); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/614">MITRE, CWE-614</a> - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="python:S6265"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6265">
              python:S6265
            </a>
          </td>
          <td >
            <details>
              <p>Predefined permissions, also known as <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">canned ACLs</a>,
are an easy way to grant large privileges to predefined groups or users.</p>
<p>The following canned ACLs are security-sensitive:</p>
<ul>
  <li> <code>PUBLIC_READ</code>, <code>PUBLIC_READ_WRITE</code> grant respectively "read" and "read and write" privileges to everyone in the world
  (<code>AllUsers</code> group). </li>
  <li> <code>AUTHENTICATED_READ</code> grants "read" privilege to all authenticated users (<code>AuthenticatedUsers</code> group). </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege policy, i.e., to grant necessary permissions only to users for their required tasks. In the
context of canned ACL, set it to <code>PRIVATE</code> (the default one), and if needed more granularity then use an appropriate S3 policy.</p>
<h2>Sensitive Code Example</h2>
<p>All users (ie: anyone in the world authenticated or not) have read and write permissions with the <code>PUBLIC_READ_WRITE</code> access
control:</p>
<pre>
bucket = s3.Bucket(self, "bucket",
    access_control=s3.BucketAccessControl.PUBLIC_READ_WRITE     # Sensitive
)

s3deploy.BucketDeployment(self, "DeployWebsite",
    access_control=s3.BucketAccessControl.PUBLIC_READ_WRITE     # Sensitive
)
</pre>
<h2>Compliant Solution</h2>
<p>With the <code>PRIVATE</code> access control (default), only the bucket owner has the read/write permissions on the buckets and its ACL.</p>
<pre>
bucket = s3.Bucket(self, "bucket",
    access_control=s3.BucketAccessControl.PRIVATE       # Compliant
)

# Another example
s3deploy.BucketDeployment(self, "DeployWebsite",
    access_control=s3.BucketAccessControl.PRIVATE       # Compliant
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl">AWS Documentation</a> - Access control list (ACL)
  overview (canned ACLs) </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/walkthrough1.html">AWS Documentation</a> - Controlling access to a bucket with
  user policies </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html">AWS CDK version 2</a> - Class Bucket (construct) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S6275"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6275">
              python:S6275
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic Block Store (EBS) is a block-storage service for Amazon Elastic Compute Cloud (EC2). EBS volumes can be encrypted, ensuring the
security of both data-at-rest and data-in-transit between an instance and its attached EBS storage. In the case that adversaries gain physical access
to the storage medium they are not able to access the data. Encryption can be enabled for specific volumes or for <a
href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default">all new volumes and snapshots</a>. Volumes created
from snapshots inherit their encryption configuration. A volume created from an encrypted snapshot will also be encrypted by default.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The disk contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EBS volumes that contain sensitive information. Encryption and decryption are handled transparently by EC2, so no
further modifications to the application are necessary. Instead of enabling encryption for every volume, it is also possible to enable encryption
globally for a specific region. While creating volumes from encrypted snapshots will result in them being encrypted, explicitly enabling this security
parameter will prevent any future unexpected security downgrade.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html">aws_cdk.aws_ec2.Volume</a>:</p>
<pre>
from aws_cdk.aws_ec2 import Volume

class EBSVolumeStack(Stack):

    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        Volume(self,
            "unencrypted-explicit",
            availability_zone="eu-west-1a",
            size=Size.gibibytes(1),
            encrypted=False  # Sensitive
        )
</pre>
<pre>
from aws_cdk.aws_ec2 import Volume

class EBSVolumeStack(Stack):

    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        Volume(self,
            "unencrypted-implicit",
            availability_zone="eu-west-1a",
            size=Size.gibibytes(1)
        ) # Sensitive as encryption is disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Volume.html">aws_cdk.aws_ec2.Volume</a>:</p>
<pre>
from aws_cdk.aws_ec2 import Volume

class EBSVolumeStack(Stack):

    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        Volume(self,
            "encrypted-explicit",
            availability_zone="eu-west-1a",
            size=Size.gibibytes(1),
            encrypted=True
        )
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html">Amazon EBS encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6270"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6270">
              python:S6270
            </a>
          </td>
          <td >
            <details>
              <p>Resource-based policies granting access to all users can lead to information leakage.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The AWS resource stores or processes sensitive data. </li>
  <li> The AWS resource is designed to be private. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to implement the least privilege principle, i.e. to grant necessary permissions only to users for their required tasks. In the
context of resource-based policies, list the principals that need the access and grant to them only the required privileges.</p>
<h2>Sensitive Code Example</h2>
<p>This policy allows all users, including anonymous ones, to access an S3 bucket:</p>
<pre>
from aws_cdk.aws_iam import PolicyStatement, AnyPrincipal, Effect
from aws_cdk.aws_s3 import Bucket

bucket = Bucket(self, "ExampleBucket")

bucket.add_to_resource_policy(PolicyStatement(
  effect=Effect.ALLOW,
  actions=["s3:*"],
  resources=[bucket.arn_for_objects("*")],
  principals=[AnyPrincipal()] # Sensitive
))
</pre>
<h2>Compliant Solution</h2>
<p>This policy allows only the authorized users:</p>
<pre>
from aws_cdk.aws_iam import PolicyStatement, AccountRootPrincipal, Effect
from aws_cdk.aws_s3 import Bucket

bucket = Bucket(self, "ExampleBucket")

bucket.add_to_resource_policy(PolicyStatement(
  effect=Effect.ALLOW,
  actions=["s3:*"],
  resources=[bucket.arn_for_objects("*")],
  principals=[AccountRootPrincipal()]
))
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S4502"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4502">
              python:S4502
            </a>
          </td>
          <td >
            <details>
              <p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive
actions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the
application.</p>
<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a
hidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The web application uses cookies to authenticate users. </li>
  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>
  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Protection against CSRF attacks is strongly recommended:
    <ul>
      <li> to be activated by default for all <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">unsafe HTTP
      methods</a>. </li>
      <li> implemented, for example, with an unguessable CSRF token </li>
    </ul>  </li>
  <li> Of course all sensitive operations should not be performed with <a
  href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">safe HTTP</a> methods like <code>GET</code> which are designed to be
  used only for information retrieval. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>For a <a href="https://docs.djangoproject.com/fr/3.0/ref/csrf/">Django</a> application, the code is sensitive when,</p>
<ul>
  <li> <code>django.middleware.csrf.CsrfViewMiddleware</code> is not used in the <a
  href="https://docs.djangoproject.com/en/3.0/topics/settings/">Django settings</a>: </li>
</ul>
<pre>
MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
] # Sensitive: django.middleware.csrf.CsrfViewMiddleware is missing
</pre>
<ul>
  <li> the CSRF protection is disabled on a view: </li>
</ul>
<pre>
@csrf_exempt # Sensitive
def example(request):
    return HttpResponse("default")
</pre>
<p>For a <a href="https://flask-wtf.readthedocs.io/en/latest/csrf.html">Flask</a> application, the code is sensitive when,</p>
<ul>
  <li> the <code>WTF_CSRF_ENABLED</code> setting is set to <code>false</code>: </li>
</ul>
<pre>
app = Flask(__name__)
app.config['WTF_CSRF_ENABLED'] = False # Sensitive
</pre>
<ul>
  <li> the application doesn’t use the <code>CSRFProtect</code> module: </li>
</ul>
<pre>
app = Flask(__name__) # Sensitive: CSRFProtect is missing

@app.route('/')
def hello_world():
    return 'Hello, World!'
</pre>
<ul>
  <li> the CSRF protection is disabled on a view: </li>
</ul>
<pre>
app = Flask(__name__)
csrf = CSRFProtect()
csrf.init_app(app)

@app.route('/example/', methods=['POST'])
@csrf.exempt # Sensitive
def example():
    return 'example '
</pre>
<ul>
  <li> the CSRF protection is disabled on a form: </li>
</ul>
<pre>
class unprotectedForm(FlaskForm):
    class Meta:
        csrf = False # Sensitive

    name = TextField('name')
    submit = SubmitField('submit')
</pre>
<h2>Compliant Solution</h2>
<p>For a <a href="https://docs.djangoproject.com/fr/3.0/ref/csrf/">Django</a> application,</p>
<ul>
  <li> it is recommended to protect all the views with <code>django.middleware.csrf.CsrfViewMiddleware</code>: </li>
</ul>
<pre>
MIDDLEWARE = [
    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware', # Compliant
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]
</pre>
<ul>
  <li> and to not disable the CSRF protection on specific views: </li>
</ul>
<pre>
def example(request): # Compliant
    return HttpResponse("default")
</pre>
<p>For a <a href="https://flask-wtf.readthedocs.io/en/latest/csrf.html">Flask</a> application,</p>
<ul>
  <li> the <code>CSRFProtect</code> module should be used (and not disabled further with <code>WTF_CSRF_ENABLED</code> set to <code>false</code>):
  </li>
</ul>
<pre>
app = Flask(__name__)
csrf = CSRFProtect()
csrf.init_app(app) # Compliant
</pre>
<ul>
  <li> and it is recommended to not disable the CSRF protection on specific views or forms: </li>
</ul>
<pre>
@app.route('/example/', methods=['POST']) # Compliant
def example():
    return 'example '

class unprotectedForm(FlaskForm):
    class Meta:
        csrf = True # Compliant

    name = TextField('name')
    submit = SubmitField('submit')
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/352">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF) </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/csrf">OWASP: Cross-Site Request Forgery</a> </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6245">
              python:S6245
            </a>
          </td>
          <td >
            <details>
              <p>Server-side encryption (SSE) encrypts an object (not the metadata) as it is written to disk (where the S3 bucket resides) and decrypts it as it is
read from disk. This doesn’t change the way the objects are accessed, as long as the user has the necessary permissions, objects are retrieved as if
they were unencrypted. Thus, SSE only helps in the event of disk thefts, improper disposals of disks and other attacks on the AWS infrastructure
itself.</p>
<p>There are three SSE options:</p>
<ul>
  <li> Server-Side Encryption with Amazon S3-Managed Keys (SSE-S3)
    <ul>
      <li> AWS manages encryption keys and the encryption itself (with AES-256) on its own. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer Master Keys (CMKs) Stored in AWS Key Management Service (SSE-KMS)
    <ul>
      <li> AWS manages the encryption (AES-256) of objects and encryption keys provided by the AWS KMS service. </li>
    </ul>  </li>
  <li> Server-Side Encryption with Customer-Provided Keys (SSE-C)
    <ul>
      <li> AWS manages only the encryption (AES-256) of objects with encryption keys provided by the customer. AWS doesn’t store the customer’s
      encryption keys. </li>
    </ul>  </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive information. </li>
  <li> The infrastructure needs to comply to some regulations, like HIPAA or PCI DSS, and other standards. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to use SSE. Choosing the appropriate option depends on the level of control required for the management of encryption keys.</p>
<h2>Sensitive Code Example</h2>
<p>Server-side encryption is not used:</p>
<pre>
bucket = s3.Bucket(self,"bucket",
    encryption=s3.BucketEncryption.UNENCRYPTED       # Sensitive
)
</pre>
<p>The default value of <code>encryption</code> is <code>KMS</code> if <code>encryptionKey</code> is set. Otherwise, if both parameters are absent the
bucket is unencrypted.</p>
<h2>Compliant Solution</h2>
<p>Server-side encryption with Amazon S3-Managed Keys is used:</p>
<pre>
bucket = s3.Bucket(self,"bucket",
    encryption=s3.BucketEncryption.S3_MANAGED
)

# Alternatively with a KMS key managed by the user.

bucket = s3.Bucket(self,"bucket",
    encryptionKey=access_key
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html">AWS documentation</a> - Protecting data using
  server-side encryption </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.BucketEncryption.html">AWS CDK version 2</a> - BucketEncryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4507">
              python:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> The application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers or applications distributed to end users.</p>
<h2>Sensitive Code Example</h2>
<pre>
from django.conf import settings

settings.configure(DEBUG=True)  # Sensitive when set to True
settings.configure(DEBUG_PROPAGATE_EXCEPTIONS=True)  # Sensitive when set to True

def custom_config(config):
    settings.configure(default_settings=config, DEBUG=True)  # Sensitive
</pre>
<p>Django’s "settings.py" or "global_settings.py" configuration file:</p>
<pre>
# NOTE: The following code raises issues only if the file is named "settings.py" or "global_settings.py". This is the default
# name of Django configuration file

DEBUG = True  # Sensitive
DEBUG_PROPAGATE_EXCEPTIONS = True  # Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S5042"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5042">
              python:S5042
            </a>
          </td>
          <td >
            <details>
              <p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can
lead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of
uncompressed data. To achieve this extreme <a href="https://en.wikipedia.org/wiki/Data_compression_ratio">compression ratio</a>, attackers will
compress irrelevant data (eg: a long string of repeated bytes).</p>
<h2>Ask Yourself Whether</h2>
<p>Archives to expand are untrusted and:</p>
<ul>
  <li> There is no validation of the number of entries in the archive. </li>
  <li> There is no validation of the total size of the uncompressed data. </li>
  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is
  1 to 3. </li>
  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>
  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in
  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.python.org/3.5/library/tarfile.html">tarfile</a> module:</p>
<pre>
import tarfile

tfile = tarfile.open("TarBomb.tar")
tfile.extractall('./tmp/')  # Sensitive
tfile.close()
</pre>
<p>For <a href="https://docs.python.org/dev/library/zipfile.html">zipfile</a> module:</p>
<pre>
import zipfile

zfile = zipfile.ZipFile('ZipBomb.zip', 'r')
zfile.extractall('./tmp/') # Sensitive
zfile.close()
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.python.org/3.5/library/tarfile.html">tarfile</a> module:</p>
<pre>
import tarfile

THRESHOLD_ENTRIES = 10000
THRESHOLD_SIZE = 1000000000
THRESHOLD_RATIO = 10

totalSizeArchive = 0;
totalEntryArchive = 0;

tfile = tarfile.open("TarBomb.tar")
for entry in tfile:
  tarinfo = tfile.extractfile(entry)

  totalEntryArchive += 1
  sizeEntry = 0
  result = b''
  while True:
    sizeEntry += 1024
    totalSizeArchive += 1024

    ratio = sizeEntry / entry.size
    if ratio &gt; THRESHOLD_RATIO:
      # ratio between compressed and uncompressed data is highly suspicious, looks like a Zip Bomb Attack
      break

    chunk = tarinfo.read(1024)
    if not chunk:
      break

    result += chunk

  if totalEntryArchive &gt; THRESHOLD_ENTRIES:
    # too much entries in this archive, can lead to inodes exhaustion of the system
    break

  if totalSizeArchive &gt; THRESHOLD_SIZE:
    # the uncompressed data size is too much for the application resource capacity
    break

tfile.close()
</pre>
<p>For <a href="https://docs.python.org/dev/library/zipfile.html">zipfile</a> module:</p>
<pre>
import zipfile

THRESHOLD_ENTRIES = 10000
THRESHOLD_SIZE = 1000000000
THRESHOLD_RATIO = 10

totalSizeArchive = 0;
totalEntryArchive = 0;

zfile = zipfile.ZipFile('ZipBomb.zip', 'r')
for zinfo in zfile.infolist():
    print('File', zinfo.filename)
    data = zfile.read(zinfo)

    totalEntryArchive += 1

    totalSizeArchive = totalSizeArchive + len(data)
    ratio = len(data) / zinfo.compress_size
    if ratio &gt; THRESHOLD_RATIO:
      # ratio between compressed and uncompressed data is highly suspicious, looks like a Zip Bomb Attack
      break

    if totalSizeArchive &gt; THRESHOLD_SIZE:
      # the uncompressed data size is too much for the application resource capacity
      break

    if totalEntryArchive &gt; THRESHOLD_ENTRIES:
      # too much entries in this archive, can lead to inodes exhaustion of the system
      break

zfile.close()
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/409">MITRE, CWE-409</a> - Improper Handling of Highly Compressed Data (Data Amplification)
  </li>
  <li> <a href="https://www.bamsoftware.com/hacks/zipbomb/">bamsoftware.com</a> - A better Zip Bomb </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6252"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6252">
              python:S6252
            </a>
          </td>
          <td >
            <details>
              <p>S3 buckets can be versioned. When the S3 bucket is unversioned it means that a new version of an object overwrites an existing one in the S3
bucket.</p>
<p>It can lead to unintentional or intentional information loss.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The bucket stores information that require high availability. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable S3 versioning and thus to have the possibility to retrieve and restore different versions of an object.</p>
<h2>Sensitive Code Example</h2>
<pre>
bucket = s3.Bucket(self, "bucket",
    versioned=False       # Sensitive
)
</pre>
<p>The default value of <code>versioned</code> is <code>False</code> so the absence of this parameter is also sensitive.</p>
<h2>Compliant Solution</h2>
<pre>
bucket = s3.Bucket(self, "bucket",
    versioned=True
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html">AWS documentation</a> - Using versioning in S3 buckets </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_s3.Bucket.html#versioned">AWS CDK version 2</a> - Using versioning in S3
  buckets </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="python:S5300"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5300">
              python:S5300
            </a>
          </td>
          <td >
            <details>
              <p>Sending emails is security-sensitive and can expose an application to a large range of vulnerabilities.</p>
<p><strong>Information Exposure</strong></p>
<p>Emails often contain sensitive information which might be exposed to an attacker if he can add an arbitrary address to the recipient list.</p>
<p><strong>Spamming / Phishing</strong></p>
<p>Malicious user can abuse email based feature to send spam or phishing content.</p>
<p><strong>Dangerous Content Injection</strong></p>
<p>Emails can contain HTML and JavaScript code, thus they can be used for XSS attacks.</p>
<p><strong>Email Headers Injection</strong></p>
<p>Email fields such as <code>subject</code>, <code>to</code>, <code>cc</code>, <code>bcc</code>, <code>from</code> are set in email "headers".&nbsp;
Using unvalidated user input to set those fields&nbsp;might allow attackers to inject new line characters in headers to craft malformed SMTP requests.
Although modern libraries are filtering new line character by default, user data used in&nbsp;email "headers" should always be validated.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9801">CVE-2017-9801</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-4803">CVE-2016-4803</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Unvalidated user input are used to set email headers. </li>
  <li> Email content contains data provided by users and it is not sanitized. </li>
  <li> Email recipient list or body are based on user inputs. </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use an email library which sanitizes headers (Flask-Mail or django.core.mail). </li>
  <li> Use html escape functions to sanitize every piece of data used to in the email body. </li>
  <li> Verify application logic to make sure that email base feature can not be abuse to:
    <ul>
      <li> Send arbitrary email for spamming or fishing </li>
      <li> Disclose sensitive email content </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>smtplib</p>
<pre>
import smtplib

def send(from_email, to_email, msg):
  server = smtplib.SMTP('localhost', 1025)
  server.sendmail(from_email, to_email, msg) # Sensitive
</pre>
<p>Django</p>
<pre>
from django.core.mail import send_mail

def send(subject, msg, from_email, to_email):
  send_mail(subject, msg, from_email, [to_email]) # Sensitive
</pre>
<p>Flask-Mail</p>
<pre>
from flask import Flask
from flask_mail import Mail, Message

app = Flask(__name__)

def send(subject, msg, from_email, to_email):
    mail = Mail(app)
    msg = Message(subject, [to_email], body, sender=from_email)
    mail.send(msg) # Sensitive{code}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.damonkohler.com/2008/12/email-injection.html">Email Injection</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/93">MITRE, CWE-93</a> - Improper Neutralization of CRLF Sequences ('CRLF Injection') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/80">MITRE, CWE-80</a> - Improper Neutralization of Script-Related HTML Tags in a Web Page
  (Basic XSS) </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S4787"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4787">
              python:S4787
            </a>
          </td>
          <td >
            <details>
              <p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902">CVE-2017-7902</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378">CVE-2006-1378</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376">CVE-2003-1376</a> </li>
</ul>
<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed
regularly. However these are not the only means to defeat or weaken an encryption.</p>
<p>This rule flags function calls that initiate encryption/decryption.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>
  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>
  <li> the key exchange is made without properly authenticating the receiver. </li>
  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time
  passes. </li>
  <li> the chosen encryption library is deemed unsafe. </li>
  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>
  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.
  </li>
  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random
  algorithm, or it is reused. </li>
  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.
  </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Generate encryption keys using secure random algorithms. </li>
  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force
  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.
  </li>
  <li> Regenerate the keys regularly. </li>
  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>
  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>
  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are
  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most
  probably have flaws. </li>
  <li> When a nonce is used, generate it randomly every time. </li>
  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>
  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks
  like "Chosen-Plaintext Attacks". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption
  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>
  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be
  preferred to the following combinations which are not secured:
    <ul>
      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it
      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in
      cryptographic protocols at all. </li>
      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><code>cryptography</code> module</p>
<pre>
from cryptography.fernet import Fernet
from cryptography.hazmat.primitives.ciphers.aead import ChaCha20Poly1305, AESGCM, AESCCM
from cryptography.hazmat.primitives.asymmetric import rsa
from cryptography.hazmat.primitives.ciphers import Cipher


def encrypt(key):
    Fernet(key)  # Sensitive
    ChaCha20Poly1305(key)  # Sensitive
    AESGCM(key)  # Sensitive
    AESCCM(key)  # Sensitive


private_key = rsa.generate_private_key()  # Sensitive


def encrypt2(algorithm, mode, backend):
    Cipher(algorithm, mode, backend)  # Sensitive
</pre>
<p><code>pynacl</code> library</p>
<pre>
from nacl.public import Box
from nacl.secret import SecretBox


def public_encrypt(secret_key, public_key):
    Box(secret_key, public_key)  # Sensitive


def secret_encrypt(key):
    SecretBox(key)  # Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/321">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/322">MITRE, CWE-322</a> - Key Exchange without Entity Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/323">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/324">MITRE, CWE-324</a> - Use of a Key Past its Expiration Date </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/325">MITRE, CWE-325</a> - Missing Required Cryptographic Step </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=python%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=python%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=python%3AS5547'>S5547</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S2245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2245">
              python:S2245
            </a>
          </td>
          <td >
            <details>
              <p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386">CVE-2013-6386</a> </li>
  <li> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419">CVE-2006-3419</a> </li>
  <li> <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102">CVE-2008-4102</a> </li>
</ul>
<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that
will be generated, and use this guess to impersonate another user or access sensitive information.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such
  as a password, is hashed. </li>
  <li> the function you use generates a value which can be predicted (pseudo-random). </li>
  <li> the generated value is used multiple times. </li>
  <li> an attacker can access the generated value. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Only use random number generators which are <a
  href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation">recommended by
  OWASP</a> or any other trusted organization. </li>
  <li> Use the generated random values only once. </li>
  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
import random

random.getrandbits(1) # Sensitive
random.randint(0,9) # Sensitive
random.random()  # Sensitive

# the following functions are sadly used to generate salt by selecting characters in a string ex: "abcdefghijk"...
random.sample(['a', 'b'], 1)  # Sensitive
random.choice(['a', 'b'])  # Sensitive
random.choices(['a', 'b'])  # Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/338">MITRE, CWE-338</a> - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1241">MITRE, CWE-1241</a> - Use of Predictable Algorithm in Random Number Generator </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM">Predictable Pseudo Random Number
  Generator</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S3330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S3330">
              python:S3330
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will
be able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer
to decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target
the theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS
vulnerability to steal session-cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>
  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)
  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /
  sensitive-security cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>Flask:</p>
<pre>
from flask import Response

@app.route('/')
def index():
    response = Response()
    response.set_cookie('key', 'value') # Sensitive
    return response
</pre>
<h2>Compliant Solution</h2>
<p>Flask:</p>
<pre>
from flask import Response

@app.route('/')
def index():
    response = Response()
    response.set_cookie('key', 'value', httponly=True) # Compliant
    return response
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/HttpOnly">OWASP HttpOnly</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1004">MITRE, CWE-1004</a> - Sensitive Cookie Without 'HttpOnly' Flag </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE">HTTPONLY_COOKIE</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S4784"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4784">
              python:S4784
            </a>
          </td>
          <td >
            <details>
              <p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021">CVE-2017-16021</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863">CVE-2018-13863</a> </li>
</ul>
<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as
<code>(a+)+s</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with
every additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular
expression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>
<p>Evaluating such regular expressions opens the door to <a
href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">Regular expression Denial of Service (ReDoS)</a> attacks.
In the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making
the service inaccessible to genuine users.</p>
<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and at least two instances of any of the following
characters: <code>*+{</code>.</p>
<p>Example: <code>(a+)*</code></p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>
  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for
vulnerability reports mentioning the one engine you’re are using.</p>
<p>Use if possible a library which is not vulnerable to Redos Attacks such as <a href="https://github.com/google/re2">Google Re2</a>.</p>
<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>
<h2>Sensitive Code Example</h2>
<p>Django</p>
<pre>
from django.core.validators import RegexValidator
from django.urls import re_path

RegexValidator('(a*)*b')  # Sensitive

def define_http_endpoint(view):
    re_path(r'^(a*)*b/$', view)  # Sensitive
</pre>
<p><code>re</code> module</p>
<pre>
import re
from re import compile, match, search, fullmatch, split, findall, finditer, sub, subn


input = 'input string'
replacement = 'replacement'

re.compile('(a*)*b')  # Sensitive
re.match('(a*)*b', input)  # Sensitive
re.search('(a*)*b', input)  # Sensitive
re.fullmatch('(a*)*b', input)  # Sensitive
re.split('(a*)*b', input)  # Sensitive
re.findall('(a*)*b', input)  # Sensitive
re.finditer('(a*)*b',input)  # Sensitive
re.sub('(a*)*b', replacement, input)  # Sensitive
re.subn('(a*)*b', replacement, input)  # Sensitive
</pre>
<p><code>regex</code> module</p>
<pre>
import regex
from regex import compile, match, search, fullmatch, split, findall, finditer, sub, subn, subf, subfn, splititer

input = 'input string'
replacement = 'replacement'

regex.subf('(a*)*b', replacement, input)  # Sensitive
regex.subfn('(a*)*b', replacement, input)  # Sensitive
regex.splititer('(a*)*b', input)  # Sensitive

regex.compile('(a*)*b')  # Sensitive
regex.match('(a*)*b', input)  # Sensitive
regex.search('(a*)*b', input)  # Sensitive
regex.fullmatch('(a*)*b', input)  # Sensitive
regex.split('(a*)*b', input)  # Sensitive
regex.findall('(a*)*b', input)  # Sensitive
regex.finditer('(a*)*b',input)  # Sensitive
regex.sub('(a*)*b', replacement, input)  # Sensitive
regex.subn('(a*)*b', replacement, input)  # Sensitive
</pre>
<h2>Exceptions</h2>
<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,
<code>(a|a?)+</code>.</p>
<p>It is a good idea to test your regular expression if it has the same pattern on both side of a "<code>|</code>".</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">MITRE, CWE-624</a> - Executable Regular
  Expression Error </li>
  <li> OWASP Regular expression Denial of Service - ReDoS </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=pythonsecurity%3AS2631'>S2631</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6281"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6281">
              python:S6281
            </a>
          </td>
          <td >
            <details>
              <p>By default S3 buckets are private, it means that only the bucket owner can access it.</p>
<p>This access control can be relaxed with ACLs or policies.</p>
<p>To prevent permissive policies to be set on a S3 bucket the following booleans settings can be enabled:</p>
<ul>
  <li> <code>block_public_acls</code>: to block or not public ACLs to be set to the S3 bucket. </li>
  <li> <code>ignore_public_acls</code>: to consider or not existing public ACLs set to the S3 bucket. </li>
  <li> <code>block_public_policy</code>: to block or not public policies to be set to the S3 bucket. </li>
  <li> <code>restrict_public_buckets</code>: to restrict or not the access to the S3 endpoints of public policies to the principals within the bucket
  owner account. </li>
</ul>
<p>The other attribute <code>BlockPublicAccess.BLOCK_ACLS</code> only turns on <code>block_public_acls</code> and <code>ignore_public_acls</code>. The
public policies can still affect the S3 bucket.</p>
<p>However, all of those options can be enabled by setting the <code>block_public_access</code> property of the S3 bucket to
<code>BlockPublicAccess.BLOCK_ALL</code>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The S3 bucket stores sensitive data. </li>
  <li> The S3 bucket is not used to store static resources of websites (images, css …​). </li>
  <li> Many users have the permission to set ACL or policy to the S3 bucket. </li>
  <li> These settings are not already enforced to true at the account level. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to configure:</p>
<ul>
  <li> <code>block_public_acls</code> to <code>True</code> to block new attempts to set public ACLs. </li>
  <li> <code>ignore_public_acls</code> to <code>True</code> to block existing public ACLs. </li>
  <li> <code>block_public_policy</code> to <code>True</code> to block new attempts to set public policies. </li>
  <li> <code>restrict_public_buckets</code> to <code>True</code> to restrict existing public policies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>By default, when not set, the <code>block_public_access</code> is fully deactivated (nothing is blocked):</p>
<pre>
bucket = s3.Bucket(self,
    "bucket"        # Sensitive
)
</pre>
<p>This <code>block_public_access</code> allows public ACL to be set:</p>
<pre>
bucket = s3.Bucket(self,
    "bucket",
    block_public_access=s3.BlockPublicAccess(
        block_public_acls=False,       # Sensitive
        ignore_public_acls=True,
        block_public_policy=True,
        restrict_public_buckets=True
    )
)
</pre>
<p>The attribute <code>BLOCK_ACLS</code> only blocks and ignores public ACLs:</p>
<pre>
bucket = s3.Bucket(self,
    "bucket",
    block_public_access=s3.BlockPublicAccess.BLOCK_ACLS     # Sensitive
)
</pre>
<h2>Compliant Solution</h2>
<p>This <code>block_public_access</code> blocks public ACLs and policies, ignores existing public ACLs and restricts existing public policies:</p>
<pre>
bucket = s3.Bucket(self,
    "bucket",
    block_public_access=s3.BlockPublicAccess.BLOCK_ALL # Compliant
)
</pre>
<p>A similar configuration to the one above can obtained by setting all parameters of the <code>block_public_access</code></p>
<pre>
bucket = s3.Bucket(self, "bucket",
    block_public_access=s3.BlockPublicAccess(       # Compliant
        block_public_acls=True,
        ignore_public_acls=True,
        block_public_policy=True,
        restrict_public_buckets=True
    )
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html">AWS Documentation</a> - Blocking public
  access to your Amazon S3 storage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_s3/Bucket.html">AWS CDK version 2</a> - Bucket </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S2257"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2257">
              python:S2257
            </a>
          </td>
          <td >
            <details>
              <p>The use of a non-standard algorithm is dangerous because a determined attacker may be able to break the algorithm and compromise whatever data has
been protected. Standard algorithms like <code>Argon2PasswordHasher</code>, <code>BCryptPasswordHasher</code>, …​ should be used instead.</p>
<p>This rule tracks creation of <code>BasePasswordHasher</code> subclasses for Django applications.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a standard algorithm instead of creating a custom one. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
class CustomPasswordHasher(BasePasswordHasher):  # Sensitive
    # ...
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="python:S4790"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4790">
              python:S4790
            </a>
          </td>
          <td >
            <details>
              <p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,
<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,
<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little
computational effort is enough to find two or more different inputs that produce the same hash).</p>
<h2>Ask Yourself Whether</h2>
<p>The hashed value is used in a security context like:</p>
<ul>
  <li> User-password storage. </li>
  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>
  <li> To compute some message integrity. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even
better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>
because it slows down <code>brute force attacks</code>.</p>
<h2>Sensitive Code Example</h2>
<pre>
import hashlib
m = hashlib.md5() // Sensitive
</pre>
<pre>
import hashlib
m = hashlib.sha1() // Sensitive
</pre>
<pre>
import md5 // Sensitive and deprecated since Python 2.5; use the hashlib module instead.
m = md5.new()

import sha // Sensitive and deprecated since Python 2.5; use the hashlib module instead.
m = sha.new()
</pre>
<h2>Compliant Solution</h2>
<pre>
import hashlib
m = hashlib.sha512() // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1240">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S4792"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4792">
              python:S4792
            </a>
          </td>
          <td >
            <details>
              <p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285">CVE-2018-0285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127">CVE-2000-1127</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113">CVE-2017-15113</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742">CVE-2015-5742</a> </li>
</ul>
<p>Logs are useful before, during and after a security incident.</p>
<ul>
  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it
  is the first step to prevent an attack from ever happening. </li>
  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>
</ul>
<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information
logged and how they are logged.</p>
<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives
  access to them. </li>
  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>
  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the
  user can perform the action as many times as he/she wants. </li>
  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)
  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>
  <li> the logs are only stored locally instead of being backuped or replicated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Check that your production deployment doesn’t have its loggers in "debug" mode as it might write sensitive information in logs. </li>
  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>
  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the
  hostname. </li>
  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the
  impact is known and limited. </li>
  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the
  service are secure too. </li>
  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control
  the logged information. An attacker could just repeat a logged action many times. </li>
</ul>
<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your
logs:</p>
<ul>
  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user
  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>
  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user
  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example
  use all your storage space or compromise your log indexing service. </li>
  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as
  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>
  <li> Monitor the logs for any suspicious activity. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
import logging
from logging import Logger, Handler, Filter
from logging.config import fileConfig, dictConfig

logging.basicConfig()  # Sensitive

logging.disable()  # Sensitive


def update_logging(logger_class):
    logging.setLoggerClass(logger_class)  # Sensitive


def set_last_resort(last_resort):
    logging.lastResort = last_resort  # Sensitive


class CustomLogger(Logger):  # Sensitive
    pass


class CustomHandler(Handler):  # Sensitive
    pass


class CustomFilter(Filter):  # Sensitive
    pass


def update_config(path, config):
    fileConfig(path)  # Sensitive
    dictConfig(config)  # Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring">OWASP Top 10 2017 Category A10</a> -
  Insufficient Logging &amp; Monitoring </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/117">MITRE, CWE-117</a> - Improper Output Neutralization for Logs </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/532">MITRE, CWE-532</a> - Information Exposure Through Log Files </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5332">
              python:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<pre>
url = "http://example.com" # Sensitive
url = "ftp://anonymous@example.com" # Sensitive
url = "telnet://anonymous@example.com" # Sensitive

import telnetlib
cnx = telnetlib.Telnet("towel.blinkenlights.nl") # Sensitive

import ftplib
cnx = ftplib.FTP("ftp.example.com") # Sensitive

import smtplib
smtp = smtplib.SMTP("smtp.example.com", port=587) # Sensitive
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/ApplicationLoadBalancer.html">aws_cdk.aws_elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)

lb = elbv2.ApplicationLoadBalancer(
    self,
    "LB",
    vpc=vpc,
    internet_facing=True
)

lb.add_listener(
    "Listener-default",
    port=80, # Sensitive
    open=True
)
lb.add_listener(
    "Listener-http-explicit",
    protocol=elbv2.ApplicationProtocol.HTTP, # Sensitive
    port=8080,
    open=True
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/ApplicationListener.html">aws_cdk.aws_elasticloadbalancingv2.ApplicationListener</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)

elbv2.ApplicationListener(
    self,
    "listener-http-explicit-const",
    load_balancer=lb,
    protocol=elbv2.ApplicationProtocol.HTTP, # Sensitive
    port=8081,
    open=True
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/NetworkLoadBalancer.html">aws_cdk.aws_elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)
lb = elbv2.NetworkLoadBalancer(
    self,
    "LB",
    vpc=vpc,
    internet_facing=True
)

lb.add_listener( # Sensitive
    "Listener-default",
    port=1234
)
lb.add_listener(
    "Listener-TCP-explicit",
    protocol=elbv2.Protocol.TCP, # Sensitive
    port=1337
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/NetworkListener.html">aws_cdk.aws_elasticloadbalancingv2.NetworkListener</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)

elbv2.NetworkListener(
    self,
    "Listener-TCP-explicit",
    protocol=elbv2.Protocol.TCP, # Sensitive
    port=1338,
    load_balancer=lb
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/CfnListener.html">aws_cdk.aws_elasticloadbalancingv2.CfnListener</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)

elbv2.CfnListener(
    self,
    "listener-http",
    default_actions=[application_default_action],
    load_balancer_arn=lb.load_balancer_arn,
    protocol="HTTP", # Sensitive
    port=80
)

elbv2.CfnListener(
    self,
    "listener-tcp",
    default_actions=[network_default_action],
    load_balancer_arn=lb.load_balancer_arn,
    protocol="TCP", # Sensitive
    port=1000
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/LoadBalancerListener.html">aws_cdk.aws_elasticloadbalancing.LoadBalancerListener</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancing as elb,
)

elb.LoadBalancerListener(
    external_port=10000,
    external_protocol=elb.LoadBalancingProtocol.TCP, # Sensitive
    internal_port=10000
)

elb.LoadBalancerListener(
    external_port=10080,
    external_protocol=elb.LoadBalancingProtocol.HTTP, # Sensitive
    internal_port=10080
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/CfnLoadBalancer.html">aws_cdk.aws_elasticloadbalancing.CfnLoadBalancer</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancing as elb
)

elb.CfnLoadBalancer(
    self,
    "elb-tcp",
    listeners=[
        elb.CfnLoadBalancer.ListenersProperty(
            instance_port="10000",
            load_balancer_port="10000",
            protocol="tcp" # Sensitive
        )
    ],
    subnets=vpc.select_subnets().subnet_ids
)

elb.CfnLoadBalancer(
    self,
    "elb-http-dict",
    listeners=[
        {
            "instancePort":"10000",
            "loadBalancerPort":"10000",
            "protocol":"http" # Sensitive
        }
    ],
    subnets=vpc.select_subnets().subnet_ids
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/LoadBalancer.html">aws_cdk.aws_elasticloadbalancing.LoadBalancer</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancing as elb,
)

elb.LoadBalancer(
    self,
    "elb-tcp-dict",
    vpc=vpc,
    listeners=[
        {
            "externalPort":10000,
            "externalProtocol":elb.LoadBalancingProtocol.TCP, # Sensitive
            "internalPort":10000
        }
    ]
)

loadBalancer.add_listener(
    external_port=10081,
    external_protocol=elb.LoadBalancingProtocol.HTTP, # Sensitive
    internal_port=10081
)
loadBalancer.add_listener(
    external_port=10001,
    external_protocol=elb.LoadBalancingProtocol.TCP, # Sensitive
    internal_port=10001
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticache/CfnReplicationGroup.html">aws_cdk.aws_elasticache.CfnReplicationGroup</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticache as elasticache
)

elasticache.CfnReplicationGroup(
    self,
    "unencrypted-explicit",
    replication_group_description="a replication group",
    automatic_failover_enabled=False,
    transit_encryption_enabled=False, # Sensitive
    cache_subnet_group_name="test",
    engine="redis",
    engine_version="3.2.6",
    num_cache_clusters=1,
    cache_node_type="cache.t2.micro"
)

elasticache.CfnReplicationGroup( # Sensitive, encryption is disabled by default
    self,
    "unencrypted-implicit",
    replication_group_description="a test replication group",
    automatic_failover_enabled=False,
    cache_subnet_group_name="test",
    engine="redis",
    engine_version="3.2.6",
    num_cache_clusters=1,
    cache_node_type="cache.t2.micro"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_kinesis/CfnStream.html">aws_cdk.aws_kinesis.CfnStream</a>:</p>
<pre>
from aws_cdk import (
    aws_kinesis as kinesis,
)

kinesis.CfnStream( # Sensitive, encryption is disabled by default for CfnStreams
    self,
    "cfnstream-implicit-unencrytped",
    shard_count=1
)

kinesis.CfnStream(self,
    "cfnstream-explicit-unencrytped",
    shard_count=1,
    stream_encryption=None # Sensitive
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_kinesis/Stream.html">aws_cdk.aws_kinesis.Stream</a>:</p>
<pre>
from aws_cdk import (
    aws_kinesis as kinesis,
)

stream = kinesis.Stream(self,
    "stream-explicit-unencrypted",
    shard_count=1,
    encryption=kinesis.StreamEncryption.UNENCRYPTED # Sensitive
)
</pre>
<h2>Compliant Solution</h2>
<pre>
url = "https://example.com"
url = "sftp://anonymous@example.com"
url = "ssh://anonymous@example.com"

import ftplib
cnx = ftplib.FTP_TLS("ftp.example.com")

import smtplib
smtp = smtplib.SMTP("smtp.example.com", port=587)
smtp.starttls(context=context)

smtp_ssl = smtplib.SMTP_SSL("smtp.gmail.com", port=465)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/ApplicationLoadBalancer.html">aws_cdk.aws_elasticloadbalancingv2.ApplicationLoadBalancer</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)

lb = elbv2.ApplicationLoadBalancer(
    self,
    "LB",
    vpc=vpc,
    internet_facing=True
)

lb.add_listener(
    "Listener-https-explicit",
    protocol=elbv2.ApplicationProtocol.HTTPS,
    certificates=[elbv2.ListenerCertificate("certificateARN")],
    port=443,
    open=True
)

lb.add_listener(
    "Listener-https-implicit",
    certificates=[elbv2.ListenerCertificate("certificateARN")],
    port=8443,
    open=True
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/ApplicationListener.html">
aws_cdk.aws_elasticloadbalancingv2.ApplicationListener</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)

elbv2.ApplicationListener(
    self,
    "listener-https-explicit-const",
    load_balancer=lb,
    protocol=elbv2.ApplicationProtocol.HTTPS,
    certificates=[elbv2.ListenerCertificate("certificateARN")],
    port=444,
    open=True
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/NetworkLoadBalancer.html">aws_cdk.aws_elasticloadbalancingv2.NetworkLoadBalancer</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)
lb = elbv2.NetworkLoadBalancer(
    self,
    "LB",
    vpc=vpc,
    internet_facing=True
)

lb.add_listener(
    "Listener-TLS-explicit",
    protocol=elbv2.Protocol.TLS,
    certificates=[elbv2.ListenerCertificate("certificateARN")],
    port=443
)
lb.add_listener(
    "Listener-TLS-implicit",
    certificates=[elbv2.ListenerCertificate("certificateARN")],
    port=1024
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/NetworkListener.html">aws_cdk.aws_elasticloadbalancingv2.NetworkListener</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)

elbv2.NetworkListener(
    self,
    "Listener-TLS-explicit",
    protocol=elbv2.Protocol.TLS,
    certificates=[elbv2.ListenerCertificate("certificateARN")],
    port=443,
    load_balancer=lb
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancingv2/CfnListener.html">aws_cdk.aws_elasticloadbalancingv2.CfnListener</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancingv2 as elbv2,
)

elbv2.CfnListener(
    self,
    "listener-https",
    default_actions=[application_default_action],
    load_balancer_arn=lb.load_balancer_arn,
    protocol="HTTPS",
    port=443,
    certificates=[elbv2.CfnListener.CertificateProperty(
        certificate_arn="certificateARN"
    )]
)

elbv2.CfnListener(
    self,
    "listener-tls",
    default_actions=[network_default_action],
    load_balancer_arn=lb.load_balancer_arn,
    protocol="TLS",
    port=1001,
    certificates=[elbv2.CfnListener.CertificateProperty(
        certificate_arn="certificateARN"
    )]
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/LoadBalancerListener.html">aws_cdk.aws_elasticloadbalancing.LoadBalancerListener</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancing as elb,
)

elb.LoadBalancerListener(
    external_port=10043,
    external_protocol=elb.LoadBalancingProtocol.SSL,
    internal_port=10043,
    ssl_certificate_arn="certificateARN"
)

elb.LoadBalancerListener(
    external_port=10443,
    external_protocol=elb.LoadBalancingProtocol.HTTPS,
    internal_port=10443,
    ssl_certificate_arn="certificateARN"
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/CfnLoadBalancer.html">aws_cdk.aws_elasticloadbalancing.CfnLoadBalancer</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancing as elb,
)

elb.CfnLoadBalancer(
    self,
    "elb-ssl",
    listeners=[
        elb.CfnLoadBalancer.ListenersProperty(
            instance_port="10043",
            load_balancer_port="10043",
            protocol="ssl",
            ssl_certificate_id=CERTIFICATE_ARN
        )
    ],
    subnets=vpc.select_subnets().subnet_ids
)

elb.CfnLoadBalancer(
    self,
    "elb-https-dict",
    listeners=[
        {
            "instancePort":"10443",
            "loadBalancerPort":"10443",
            "protocol":"https",
            "sslCertificateId":CERTIFICATE_ARN
        }
    ],
    subnets=vpc.select_subnets().subnet_ids
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticloadbalancing/LoadBalancer.html">aws_cdk.aws_elasticloadbalancing.LoadBalancer</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticloadbalancing as elb,
)

elb.LoadBalancer(
    self,
    "elb-ssl",
    vpc=vpc,
    listeners=[
        {
            "externalPort":10044,
            "externalProtocol":elb.LoadBalancingProtocol.SSL,
            "internalPort":10044,
            "sslCertificateArn":"certificateARN"
        },
        {
            "externalPort":10444,
            "externalProtocol":elb.LoadBalancingProtocol.HTTPS,
            "internalPort":10444,
            "sslCertificateArn":"certificateARN"
        }
    ]
)

loadBalancer = elb.LoadBalancer(
        self,
        "elb-multi-listener",
        vpc=vpc
)
loadBalancer.add_listener(
    external_port=10045,
    external_protocol=elb.LoadBalancingProtocol.SSL,
    internal_port=10045,
    ssl_certificate_arn="certificateARN"
)
loadBalancer.add_listener(
    external_port=10445,
    external_protocol=elb.LoadBalancingProtocol.HTTPS,
    internal_port=10445,
    ssl_certificate_arn="certificateARN"
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_elasticache/CfnReplicationGroup.html">aws_cdk.aws_elasticache.CfnReplicationGroup</a>:</p>
<pre>
from aws_cdk import (
    aws_elasticache as elasticache
)

elasticache.CfnReplicationGroup(
    self,
    "encrypted-explicit",
    replication_group_description="a test replication group",
    automatic_failover_enabled=False,
    transit_encryption_enabled=True,
    cache_subnet_group_name="test",
    engine="redis",
    engine_version="3.2.6",
    num_cache_clusters=1,
    cache_node_type="cache.t2.micro"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_kinesis/CfnStream.html">aws_cdk.aws_kinesis.CfnStream</a>:</p>
<pre>
from aws_cdk import (
    aws_kinesis as kinesis,
)

kinesis.CfnStream(
    self,
    "cfnstream-explicit-encrytped",
    shard_count=1,
    stream_encryption=kinesis.CfnStream.StreamEncryptionProperty(
        encryption_type="KMS",
        key_id="alias/aws/kinesis"
    )
)

stream = kinesis.CfnStream(
    self,
    "cfnstream-explicit-encrytped-dict",
    shard_count=1,
    stream_encryption={
        "encryptionType": "KMS",
        "keyId": "alias/aws/kinesis"
    }
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_kinesis/Stream.html">aws_cdk.aws_kinesis.Stream</a>:</p>
<pre>
from aws_cdk import (
    aws_kinesis as kinesis,
    aws_kms as kms
)

stream = kinesis.Stream( # Encryption is enabled by default for Streams
    self,
    "stream-implicit-encrypted",
    shard_count=1
)

stream = kinesis.Stream(
    self,
    "stream-explicit-encrypted-managed",
    shard_count=1,
    encryption=kinesis.StreamEncryption.MANAGED
)

key = kms.Key(self, "managed_key")
stream = kinesis.Stream(
    self,
    "stream-explicit-encrypted-selfmanaged",
    shard_count=1,
    encryption=kinesis.StreamEncryption.KMS,
    encryption_key=key
)
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6304"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6304">
              python:S6304
            </a>
          </td>
          <td >
            <details>
              <p>A policy that allows identities to access all resources in an AWS account may violate <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity has permission to access
all resources even though it only requires access to some non-sensitive ones. In this case, unauthorized access and disclosure of sensitive
information will occur.</p>
<h2>Ask Yourself Whether</h2>
<p>The AWS account has more than one resource with different levels of sensitivity.</p>
<p>A risk exists if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e., by only granting access to necessary resources. A good practice to achieve this is
to organize or <a
href="https://aws.amazon.com/blogs/security/simplify-granting-access-to-your-aws-resources-by-using-tags-on-aws-iam-users-and-roles/">tag</a>
resources depending on the sensitivity level of data they store or process. Therefore, managing a secure access control is less prone to errors.</p>
<h2>Noncompliant Code Example</h2>
<p>The wildcard <code>"*"</code> is specified as the resource for this <code>PolicyStatement</code>. This grants the update permission for all
policies of the account:</p>
<pre>
from aws_cdk.aws_iam import Effect, PolicyDocument, PolicyStatement

PolicyDocument(
    statements=[
        PolicyStatement(
            effect=Effect.ALLOW,
            actions="iam:CreatePolicyVersion",
            resources=["*"] # Sensitive
        )
    ]
)
</pre>
<h2>Compliant Solution</h2>
<p>Restrict the update permission to the appropriate subset of policies:</p>
<pre>
from aws_cdk import Aws
from aws_cdk.aws_iam import Effect, PolicyDocument, PolicyStatement

PolicyDocument(
    statements=[
        PolicyStatement(
            effect=Effect.ALLOW,
            actions="iam:CreatePolicyVersion",
            resources=[f"arn:aws:iam::{Aws.ACCOUNT_ID}:policy/team1/*"]
        )
    ]
)
</pre>
<h2>Exceptions</h2>
<ul>
  <li> Should not be raised on key policies (when AWS KMS actions are used.) </li>
  <li> Should not be raised on policies not using any resources (if and only if all actions in the policy never require resources.) </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2068">
              python:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
username = 'admin'
password = 'admin' # Sensitive
usernamePassword = 'user=admin&amp;password=admin' # Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
import os

username = os.getenv("username") # Compliant
password = os.getenv("password") # Compliant
usernamePassword = 'user=%s&amp;password=%s' % (username, password) # Compliant{code}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6303"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6303">
              python:S6303
            </a>
          </td>
          <td >
            <details>
              <p>Using unencrypted RDS DB resources exposes data to unauthorized access to the underlying storage.<br> This includes database data, logs, automatic
backups, read replicas, snapshots, and cluster metadata.</p>
<p>This situation can occur in a variety of scenarios, such as:</p>
<ul>
  <li> a malicious insider working at the cloud provider gains physical access to the storage device and exfiltrates data. </li>
  <li> unknown attackers penetrate the cloud provider’s logical infrastructure and systems for extortion. </li>
</ul>
<p>AWS-managed encryption at rest reduces this risk with a simple switch.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to enable encryption at rest on any RDS DB resource, regardless of the engine.<br> In any case, no further maintenance is
required as encryption at rest is fully managed by AWS.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html">aws_cdk.aws_rds.DatabaseCluster</a> and <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html">aws_cdk.aws_rds.DatabaseInstance</a>:</p>
<pre>
from aws_cdk import (
    aws_rds as rds
)

class DatabaseStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        rds.DatabaseCluster( # Sensitive, unencrypted by default
            self,
            "example"
        )
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html">aws_cdk.aws_rds.CfnDBCluster</a> and <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html">aws_cdk.aws_rds.CfnDBInstance</a>:</p>
<pre>
from aws_cdk import (
    aws_rds as rds
)

class DatabaseStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        rds.CfnDBCluster( # Sensitive, unencrypted by default
            self,
            "example"
        )
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseCluster.html">aws_cdk.aws_rds.DatabaseCluster</a> and <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.DatabaseInstance.html">aws_cdk.aws_rds.DatabaseInstance</a>:</p>
<pre>
from aws_cdk import (
    aws_rds as rds
)

class DatabaseStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        rds.DatabaseCluster(
            self,
            "example",
            storage_encrypted=True
        )
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBCluster.html">aws_cdk.aws_rds.CfnDBCluster</a> and <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_rds.CfnDBInstance.html">aws_cdk.aws_rds.CfnDBInstance</a>:</p>
<pre>
from aws_cdk import (
    aws_rds as rds
)

class DatabaseStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        rds.CfnDBCluster(
            self,
            "example",
            storage_encrypted=True
        )
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html">AWS Documentation</a> - Encrypting Amazon RDS
  resources </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6302"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6302">
              python:S6302
            </a>
          </td>
          <td >
            <details>
              <p>A policy that grants all permissions may indicate an improper access control, which violates <a
href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a>. Suppose an identity is granted full
permissions to a resource even though it only requires read permission to work as expected. In this case, an unintentional overwriting of resources
may occur and therefore result in loss of information.</p>
<h2>Ask Yourself Whether</h2>
<p>Identities obtaining all the permissions:</p>
<ul>
  <li> only require a subset of these permissions to perform the intended function. </li>
  <li> have monitored activity showing that only a subset of these permissions is actually used. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to apply the least privilege principle, i.e. by only granting the necessary permissions to identities. A good practice is to start
with the very minimum set of permissions and to refine the policy over time. In order to fix overly permissive policies already deployed in
production, a strategy could be to review the monitored activity in order to reduce the set of permissions to those most used.</p>
<h2>Sensitive Code Example</h2>
<p>A customer-managed policy that grants all permissions by using the wildcard (*) in the <code>Action</code> property:</p>
<pre>
from aws_cdk.aws_iam import PolicyStatement, Effect

PolicyStatement(
    effect=Effect.ALLOW,
    actions=["*"], # Sensitive
    resources=["arn:aws:iam:::user/*"]
)
</pre>
<h2>Compliant Solution</h2>
<p>A customer-managed policy that grants only the required permissions:</p>
<pre>
from aws_cdk.aws_iam import PolicyStatement, Effect

PolicyStatement(
    effect=Effect.ALLOW,
    actions=["iam:GetAccountSummary"],
    resources=["arn:aws:iam:::user/*"]
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege">AWS Documentation</a> - Grant least
  privilege </li>
  <li> <a href="https://cloud.google.com/iam/docs/understanding-roles">Google Cloud Documentation</a> - Understanding roles </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6308"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6308">
              python:S6308
            </a>
          </td>
          <td >
            <details>
              <p>Amazon OpenSearch Service is a managed service to host OpenSearch instances. It replaces Elasticsearch Service, which has been deprecated.</p>
<p>To harden domain (cluster) data in case of unauthorized access, OpenSearch provides data-at-rest encryption if the engine is OpenSearch (any
version), or Elasticsearch with a version of 5.1 or above. Enabling encryption at rest will help protect:</p>
<ul>
  <li> indices </li>
  <li> logs </li>
  <li> swap files </li>
  <li> data in the application directory </li>
  <li> automated snapshots </li>
</ul>
<p>Thus, adversaries cannot access the data if they gain physical access to the storage medium.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to encrypt OpenSearch domains that contain sensitive information.</p>
<p>OpenSearch handles encryption and decryption transparently, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/Domain.html">aws_cdk.aws_opensearchservice.Domain</a>:</p>
<pre>
from aws_cdk.aws_opensearchservice import Domain, EngineVersion

class DomainStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)

        Domain(self, "Sensitive",
            version=EngineVersion.OPENSEARCH_1_3
        ) # Sensitive, encryption is disabled by default
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/CfnDomain.html">aws_cdk.aws_opensearchservice.CfnDomain</a>:</p>
<pre>
from aws_cdk.aws_opensearchservice import CfnDomain

class CfnDomainStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)

        CfnDomain(self, "Sensitive") # Sensitive, encryption is disabled by default
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/Domain.html">aws_cdk.aws_opensearchservice.Domain</a>:</p>
<pre>
from aws_cdk.aws_opensearchservice import Domain, EncryptionAtRestOptions, EngineVersion

class DomainStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)

        Domain(self, "Compliant",
            version=EngineVersion.OPENSEARCH_1_3,
            encryption_at_rest=EncryptionAtRestOptions(
                enabled=True
            )
        )
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/CfnDomain.html">aws_cdk.aws_opensearchservice.CfnDomain</a>:</p>
<pre>
from aws_cdk.aws_opensearchservice import CfnDomain

class CfnDomainStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)

        CfnDomain(self, "Compliant",
            encryption_at_rest_options=CfnDomain.EncryptionAtRestOptionsProperty(
                enabled=True
            )
        )
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/opensearch-service/latest/developerguide/encryption-at-rest.html">AWS Documentation</a> - Encryption of
  data at rest for Amazon OpenSearch Service </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S2077"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2077">
              python:S2077
            </a>
          </td>
          <td >
            <details>
              <p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the
query. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=python%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted
queries.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some parts of the query come from untrusted values (like user inputs). </li>
  <li> The query is repeated/duplicated in other parts of the code. </li>
  <li> The application must support different types of relational databases. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">parameterized queries, prepared
  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>
  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
from django.db import models
from django.db import connection
from django.db import connections
from django.db.models.expressions import RawSQL

value = input()


class MyUser(models.Model):
    name = models.CharField(max_length=200)


def query_my_user(request, params, value):
    with connection.cursor() as cursor:
        cursor.execute("{0}".format(value))  # Sensitive

    # https://docs.djangoproject.com/en/2.1/ref/models/expressions/#raw-sql-expressions

    RawSQL("select col from %s where mycol = %s and othercol = " + value, ("test",))  # Sensitive

    # https://docs.djangoproject.com/en/2.1/ref/models/querysets/#extra

    MyUser.objects.extra(
        select={
            'mycol':  "select col from sometable here mycol = %s and othercol = " + value}, # Sensitive
           select_params=(someparam,),
        },
    )
</pre>
<h2>Compliant Solution</h2>
<pre>
cursor = connection.cursor(prepared=True)
sql_insert_query = """ select col from sometable here mycol = %s and othercol = %s """

select_tuple = (1, value)

cursor.execute(sql_insert_query, select_tuple) # Compliant, the query is parameterized
connection.commit()
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/89">MITRE, CWE-89</a> - Improper Neutralization of Special Elements used in an SQL Command
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rules <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA">Potential SQL/JPQL Injection
  (JPA)</a>, <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO">Potential SQL/JDOQL Injection (JDO)</a>, <a
  href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE">Potential SQL/HQL Injection (Hibernate)</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6319"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6319">
              python:S6319
            </a>
          </td>
          <td >
            <details>
              <p>Amazon SageMaker is a managed machine learning service in a hosted production-ready environment. To train machine learning models, SageMaker
instances can process potentially sensitive data, such as personal information that should not be stored unencrypted. In the event that adversaries
physically access the storage media, they cannot decrypt encrypted data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The instance contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SageMaker notebook instances that contain sensitive information. Encryption and decryption are handled transparently by
SageMaker, so no further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_sagemaker/CfnNotebookInstance.html">aws_cdk.aws_sagemaker.CfnNotebookInstance</a>:</p>
<pre>
from aws_cdk import (
    aws_sagemaker as sagemaker
)

class CfnSagemakerStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)

        sagemaker.CfnNotebookInstance(
            self, "Sensitive",
            instance_type="instanceType",
            role_arn="roleArn"
        )  # Sensitive, no KMS key is set by default; thus, encryption is disabled
</pre>
<h2>Compliant Solution</h2>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_sagemaker/CfnNotebookInstance.html">aws_cdk.aws_sagemaker.CfnNotebookInstance</a>:</p>
<pre>
from aws_cdk import (
    aws_sagemaker as sagemaker,
    aws_kms as kms
)

class CfnSagemakerStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)

        my_key = kms.Key(self, "Key")
        sagemaker.CfnNotebookInstance(
            self, "Compliant",
            instance_type="instanceType",
            role_arn="roleArn",
            kms_key_id=my_key.key_id
        )
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sagemaker/latest/dg/encryption-at-rest.html">Protect Data at Rest Using Encryption</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="python:S5443"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5443">
              python:S5443
            </a>
          </td>
          <td >
            <details>
              <p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like
<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious
user can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,
modified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2012-2451">CVE-2012-2451</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2015-1838">CVE-2015-1838</a> </li>
</ul>
<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It
also detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>
<ul>
  <li> <code>/tmp</code> </li>
  <li> <code>/var/tmp</code> </li>
  <li> <code>/usr/tmp</code> </li>
  <li> <code>/dev/shm</code> </li>
  <li> <code>/dev/mqueue</code> </li>
  <li> <code>/run/lock</code> </li>
  <li> <code>/var/run/lock</code> </li>
  <li> <code>/Library/Caches</code> </li>
  <li> <code>/Users/Shared</code> </li>
  <li> <code>/private/tmp</code> </li>
  <li> <code>/private/var/tmp</code> </li>
  <li> <code>\Windows\Temp</code> </li>
  <li> <code>\Temp</code> </li>
  <li> <code>\TMP</code> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Files are read from or written into a publicly writable folder </li>
  <li> The application creates files with predictable names into a publicly writable folder </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a dedicated sub-folder with tightly controlled permissions </li>
  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:
    <ul>
      <li> The generated filename is unpredictable </li>
      <li> The file is readable and writable only by the creating user ID </li>
      <li> The file descriptor is not inherited by child processes </li>
      <li> The file will be destroyed as soon as it is closed </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
file = open("/tmp/temporary_file","w+") # Sensitive
</pre>
<pre>
tmp_dir = os.environ.get('TMPDIR') # Sensitive
file = open(tmp_dir+"/temporary_file","w+")
</pre>
<h2>Compliant Solution</h2>
<pre>
import tempfile

file = tempfile.TemporaryFile(dir="/tmp/my_subdirectory", mode='"w+") # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
  <li> <a href="https://docs.python.org/3/library/tempfile.html">Python tempfile module</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S2612"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2612">
              python:S2612
            </a>
          </td>
          <td >
            <details>
              <p>In Unix, "<code>others</code>" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>
<p>Granting permissions to this group can lead to unintended access to files.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application is designed to be run on a multi-user environment. </li>
  <li> Corresponding files and directories may contain confidential information. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.python.org/3/library/os.html#os.umask">os.umask</a>:</p>
<pre>
os.umask(0)  # Sensitive
</pre>
<p>For <a href="https://docs.python.org/3/library/os.html#os.chmod">os.chmod</a>, <a
href="https://docs.python.org/3/library/os.html#os.lchmod">os.lchmod</a>, and <a
href="https://docs.python.org/3/library/os.html#os.fchmod">os.fchmod</a>:</p>
<pre>
os.chmod("/tmp/fs", stat.S_IRWXO)   # Sensitive
os.lchmod("/tmp/fs", stat.S_IRWXO)  # Sensitive
os.fchmod(fd, stat.S_IRWXO)         # Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.python.org/3/library/os.html#os.umask">os.umask</a>:</p>
<pre>
os.umask(0o777)
</pre>
<p>For <a href="https://docs.python.org/3/library/os.html#os.chmod">os.chmod</a>, <a
href="https://docs.python.org/3/library/os.html#os.lchmod">os.lchmod</a>, and <a
href="https://docs.python.org/3/library/os.html#os.fchmod">os.fchmod</a>:</p>
<pre>
os.chmod("/tmp/fs", stat.S_IRWXU)
os.lchmod("/tmp/fs", stat.S_IRWXU)
os.fchmod(fd, stat.S_IRWXU)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission">OWASP File Permission</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S1523"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S1523">
              python:S1523
            </a>
          </td>
          <td >
            <details>
              <p>Executing code dynamically is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9807">CVE-2017-9807</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-9802">CVE-2017-9802</a> </li>
</ul>
<p>Some APIs enable the execution of dynamic code by providing it as strings at runtime. These APIs might be useful in some very specific
meta-programming use-cases. However most of the time their use is frowned upon because they also increase the risk of maliciously <a
href="https://owasp.org/www-community/attacks/Code_Injection">Injected Code</a>. Such attacks can either run on the server or in the client (example:
XSS attack) and have a huge impact on an application’s security.</p>
<p>This rule marks for review each occurrence of such dynamic code execution. This rule does not detect code injections. It only highlights the use of
APIs which should be used sparingly and very carefully.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed code may come from an untrusted source and hasn’t been sanitized. </li>
  <li> you really need to run code dynamically. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Regarding the execution of unknown code, the best solution is to not run code provided by an untrusted source. If you really need to do it, run the
code in a <a href="https://en.wikipedia.org/wiki/Sandbox_(computer_security)">sandboxed</a> environment. Use jails, firewalls and whatever means your
operating system and programming language provide (example: <a
href="https://wiki.sei.cmu.edu/confluence/display/java/SEC54-J.+Create+a+secure+sandbox+using+a+security+manager">Security Managers</a> in java, <a
href="https://www.w3schools.com/tags/att_iframe_sandbox.asp">iframes</a> and <a href="https://en.wikipedia.org/wiki/Same-origin_policy">same-origin
policy</a> for javascript in a web browser).</p>
<p>Do not try to create a blacklist of dangerous code. It is impossible to cover all attacks that way.</p>
<p>Avoid using dynamic code APIs whenever possible. Hard-coded code is always safer.</p>
<h2>Sensitive Code Example</h2>
<pre>
import os

value = input()
command = 'os.system("%s")' % value

def evaluate(command, file, mode):
    eval(command)  # Sensitive.

eval(command)  # Sensitive. Dynamic code

def execute(code, file, mode):
    exec(code)  # Sensitive.
    exec(compile(code, file, mode))  # Sensitive.

exec(command)  # Sensitive.
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/95">MITRE, CWE-95</a> - Improper Neutralization of Directives in Dynamically Evaluated Code
  ('Eval Injection') </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S3752"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S3752">
              python:S3752
            </a>
          </td>
          <td >
            <details>
              <p>An HTTP method is safe when used to perform a read-only operation, such as retrieving information. In contrast, an unsafe HTTP method is used to
change the state of an application, for instance to update a user’s profile on a web application.</p>
<p>Common safe HTTP methods are GET, HEAD, or OPTIONS.</p>
<p>Common unsafe HTTP methods are POST, PUT and DELETE.</p>
<p>Allowing both safe and unsafe HTTP methods to perform a specific operation on a web application could impact its security, for example CSRF
protections are most of the time only protecting operations performed by unsafe HTTP methods.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> HTTP methods are not defined at all for a route/controller of the application. </li>
  <li> Safe HTTP methods are defined and used for a route/controller that can change the state of an application. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>For all the routes/controllers of an application, the authorized HTTP methods should be explicitly defined and safe HTTP methods should only be
used to perform read-only operations.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://www.djangoproject.com/">Django</a>:</p>
<pre>
# No method restriction
def view(request):  # Sensitive
    return HttpResponse("...")
</pre>
<pre>
@require_http_methods(["GET", "POST"])  # Sensitive
def view(request):
    return HttpResponse("...")
</pre>
<p>For <a href="https://flask.palletsprojects.com/en/1.1.x/">Flask</a>:</p>
<pre>
@methods.route('/sensitive', methods=['GET', 'POST'])  # Sensitive
def view():
    return Response("...", 200)
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://www.djangoproject.com/">Django</a>:</p>
<pre>
@require_http_methods(["POST"])
def view(request):
    return HttpResponse("...")
</pre>
<pre>
@require_POST
def view(request):
    return HttpResponse("...")
</pre>
<pre>
@require_GET
def view(request):
    return HttpResponse("...")
</pre>
<pre>
@require_safe
def view(request):
    return HttpResponse("...")
</pre>
<p>For <a href="https://flask.palletsprojects.com/en/1.1.x/">Flask</a>:</p>
<pre>
@methods.route('/compliant1')
def view():
    return Response("...", 200)
</pre>
<pre>
@methods.route('/compliant2', methods=['GET'])
def view():
    return Response("...", 200)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A5-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> -
  Broken Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/352">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF) </li>
  <li> <a href="https://owasp.org/www-community/attacks/csrf">OWASP: Cross-Site Request Forgery</a> </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> <a href="https://docs.djangoproject.com/en/3.1/topics/http/decorators/#allowed-http-methods">Django</a> - Allowed HTTP Methods </li>
  <li> <a href="https://flask.palletsprojects.com/en/1.1.x/quickstart/#http-methods">Flask</a> - HTTP Methods </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S4721"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4721">
              python:S4721
            </a>
          </td>
          <td >
            <details>
              <p>Arbitrary OS command injection vulnerabilities are more likely when a shell is spawned rather than a new process, indeed shell meta-chars can be
used (when parameters are user-controlled for instance) to inject OS commands.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> OS command name or parameters are user-controlled. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Use functions that don’t spawn a shell.</p>
<h2>Sensitive Code Example</h2>
<p>Python 3</p>
<pre>
subprocess.run(cmd, shell=True)  # Sensitive
subprocess.Popen(cmd, shell=True)  # Sensitive
subprocess.call(cmd, shell=True)  # Sensitive
subprocess.check_call(cmd, shell=True)  # Sensitive
subprocess.check_output(cmd, shell=True)  # Sensitive
os.system(cmd)  # Sensitive: a shell is always spawn
</pre>
<p>Python 2</p>
<pre>
cmd = "when a string is passed through these function, a shell is spawn"
(_, child_stdout, _) = os.popen2(cmd)  # Sensitive
(_, child_stdout, _) = os.popen3(cmd)  # Sensitive
(_, child_stdout) = os.popen4(cmd)  # Sensitive


(child_stdout, _) = popen2.popen2(cmd)  # Sensitive
(child_stdout, _, _) = popen2.popen3(cmd)  # Sensitive
(child_stdout, _) = popen2.popen4(cmd)  # Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Python 3</p>
<pre>
# by default shell=False, a shell is not spawn
subprocess.run(cmd)  # Compliant
subprocess.Popen(cmd)  # Compliant
subprocess.call(cmd)  # Compliant
subprocess.check_call(cmd)  # Compliant
subprocess.check_output(cmd)  # Compliant

# always in a subprocess:
os.spawnl(mode, path, *cmd)  # Compliant
os.spawnle(mode, path, *cmd, env)  # Compliant
os.spawnlp(mode, file, *cmd)  # Compliant
os.spawnlpe(mode, file, *cmd, env)  # Compliant
os.spawnv(mode, path, cmd)  # Compliant
os.spawnve(mode, path, cmd, env)  # Compliant
os.spawnvp(mode, file, cmd)  # Compliant
os.spawnvpe(mode, file, cmd, env)  # Compliant

(child_stdout) = os.popen(cmd, mode, 1)  # Compliant
(_, output) = subprocess.getstatusoutput(cmd)  # Compliant
out = subprocess.getoutput(cmd)  # Compliant
os.startfile(path)  # Compliant
os.execl(path, *cmd)  # Compliant
os.execle(path, *cmd, env)  # Compliant
os.execlp(file, *cmd)  # Compliant
os.execlpe(file, *cmd, env)  # Compliant
os.execv(path, cmd)  # Compliant
os.execve(path, cmd, env)  # Compliant
os.execvp(file, cmd)  # Compliant
os.execvpe(file, cmd, env)  # Compliant
</pre>
<p>Python 2</p>
<pre>
cmdsargs = ("use", "a", "sequence", "to", "directly", "start", "a", "subprocess")

(_, child_stdout) = os.popen2(cmdsargs)  # Compliant
(_, child_stdout, _) = os.popen3(cmdsargs)  # Compliant
(_, child_stdout) = os.popen4(cmdsargs)  # Compliant

(child_stdout, _) = popen2.popen2(cmdsargs)  # Compliant
(child_stdout, _, _) = popen2.popen3(cmdsargs)  # Compliant
(child_stdout, _) = popen2.popen4(cmdsargs)  # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/78">MITRE, CWE-78</a> - Improper Neutralization of Special Elements used in an OS Command </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6463"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6463">
              python:S6463
            </a>
          </td>
          <td >
            <details>
              <p>Allowing unrestricted outbound communications can lead to data leaks.</p>
<p>A restrictive security group is an additional layer of protection that might prevent the abuse or exploitation of a resource. For example, it
complicates the exfiltration of data in the case of a successfully exploited vulnerability.</p>
<p>When deciding if outgoing connections should be limited, consider that limiting the connections results in additional administration and
maintenance work.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The resource has access to sensitive data. </li>
  <li> The resource is part of a private network. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to restrict outgoing connections to a set of trusted destinations.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html">aws_cdk.aws_ec2.SecurityGroup</a>:</p>
<pre>
from aws_cdk import (
    aws_ec2 as ec2
)

ec2.SecurityGroup(  # Sensitive; allow_all_outbound is enabled by default
    self,
    "example",
    vpc=vpc
)
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html">aws_cdk.aws_ec2.SecurityGroup</a>:</p>
<pre>
from aws_cdk import (
    aws_ec2 as ec2
)

sg = ec2.SecurityGroup(
    self,
    "example",
    vpc=vpc,
    allow_all_outbound=False
)

sg.add_egress_rule(
    peer=ec2.Peer.ipv4("203.0.113.127/32"),
    connection=ec2.Port.tcp(443)
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">AWS Documentation</a> - Control traffic to resources using
  security groups </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S1313">
              python:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
ip = '192.168.12.42'
sock = socket.socket()
sock.bind((ip, 9090))
</pre>
<h2>Compliant Solution</h2>
<pre>
ip = config.get(section, ipAddress)
sock = socket.socket()
sock.bind((ip, 9090))
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6327"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6327">
              python:S6327
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Notification Service (SNS) is a managed messaging service for application-to-application (A2A) and application-to-person (A2P)
communication. SNS topics allows publisher systems to fanout messages to a large number of subscriber systems. Amazon SNS allows to encrypt messages
when they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are not able to
access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The topic contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SNS topics that contain sensitive information. Encryption and decryption are handled transparently by SNS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html">aws_cdk.aws_sns.Topic</a>:</p>
<pre>
from aws_cdk import (
    aws_sns as sns
)

class TopicStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        sns.Topic( # Sensitive, unencrypted by default
            self,
            "example"
        )
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html">aws_cdk.aws_sns.CfnTopic</a>:</p>
<pre>
from aws_cdk import (
    aws_sns as sns
)

class TopicStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        sns.CfnTopic( # Sensitive, unencrypted by default
            self,
            "example"
        )
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.Topic.html">aws_cdk.aws_sns.Topic</a>:</p>
<pre>
from aws_cdk import (
    aws_sns as sns
)

class TopicStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        my_key = kms.Key(self, "key")
        sns.Topic(
            self,
            "example",
            master_key=my_key
        )
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sns.CfnTopic.html">aws_cdk.aws_sns.CfnTopic</a>:</p>
<pre>
from aws_cdk import (
    aws_sns as sns
)

class TopicStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        my_key = kms.Key(self, "key")
        sns.CfnTopic(
            self,
            "example",
            kms_master_key_id=my_key.key_id
        )
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html">AWS Documentation</a> - Encryption at rest </li>
  <li> <a href="https://aws.amazon.com/blogs/compute/encrypting-messages-published-to-amazon-sns-with-aws-kms/">Encrypting messages published to
  Amazon SNS with AWS KMS</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6329"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6329">
              python:S6329
            </a>
          </td>
          <td >
            <details>
              <p>Enabling public network access to cloud resources can affect an organization’s ability to protect its data or internal operations from data theft
or disruption.</p>
<p>Depending on the component, inbound access from the Internet can be enabled via:</p>
<ul>
  <li> a boolean value that explicitly allows access to the public network. </li>
  <li> the assignment of a public IP address. </li>
  <li> database firewall rules that allow public IP ranges. </li>
</ul>
<p>Deciding to allow public access may happen for various reasons such as for quick maintenance, time saving, or by accident.</p>
<p>This decision increases the likelihood of attacks on the organization, such as:</p>
<ul>
  <li> data breaches. </li>
  <li> intrusions into the infrastructure to permanently steal from it. </li>
  <li> and various malicious traffic, such as DDoS attacks. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<p>This cloud resource:</p>
<ul>
  <li> should be publicly accessible to any Internet user. </li>
  <li> requires inbound traffic from the Internet to function properly. </li>
</ul>
<p>There is a risk if you answered no to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Avoid publishing cloud services on the Internet unless they are intended to be publicly accessible, such as customer portals or e-commerce
sites.</p>
<p>Use private networks (and associated private IP addresses) and VPC peering or other secure communication tunnels to communicate with other cloud
components.</p>
<p>The goal is to prevent the component from intercepting traffic coming in via the public IP address. If the cloud resource does not support the
absence of a public IP address, assign a public IP address to it, but do not create listeners for the public IP address.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/Instance.html">aws_cdk.aws_ec2.Instance</a> and similar constructs:</p>
<pre>
from aws_cdk import aws_ec2 as ec2

ec2.Instance(
    self,
    "vpc_subnet_public",
    instance_type=nano_t2,
    machine_image=ec2.MachineImage.latest_amazon_linux(),
    vpc=vpc,
    vpc_subnets=ec2.SubnetSelection(subnet_type=ec2.SubnetType.PUBLIC) # Sensitive
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnInstance.html">aws_cdk.aws_ec2.CfnInstance</a>:</p>
<pre>
from aws_cdk import aws_ec2 as ec2

ec2.CfnInstance(
    self,
    "cfn_public_exposed",
    instance_type="t2.micro",
    image_id="ami-0ea0f26a6d50850c5",
    network_interfaces=[
        ec2.CfnInstance.NetworkInterfaceProperty(
            device_index="0",
            associate_public_ip_address=True, # Sensitive
            delete_on_termination=True,
            subnet_id=vpc.select_subnets(subnet_type=ec2.SubnetType.PUBLIC).subnet_ids[0]
        )
    ]
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_dms/CfnReplicationInstance.html">aws_cdk.aws_dms.CfnReplicationInstance</a>:</p>
<pre>
from aws_cdk import aws_dms as dms

rep_instance = dms.CfnReplicationInstance(
    self,
    "explicit_public",
    replication_instance_class="dms.t2.micro",
    allocated_storage=5,
    publicly_accessible=True, # Sensitive
    replication_subnet_group_identifier=subnet_group.replication_subnet_group_identifier,
    vpc_security_group_ids=[vpc.vpc_default_security_group]
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_rds/CfnDBInstance.html">aws_cdk.aws_rds.CfnDBInstance</a>:</p>
<pre>
from aws_cdk import aws_rds as rds
from aws_cdk import aws_ec2 as ec2

rds_subnet_group_public = rds.CfnDBSubnetGroup(
    self,
    "public_subnet",
    db_subnet_group_description="Subnets",
    subnet_ids=vpc.select_subnets(
        subnet_type=ec2.SubnetType.PUBLIC
    ).subnet_ids
)

rds.CfnDBInstance(
    self,
    "public-public-subnet",
    engine="postgres",
    master_username="foobar",
    master_user_password="12345678",
    db_instance_class="db.r5.large",
    allocated_storage="200",
    iops=1000,
    db_subnet_group_name=rds_subnet_group_public.ref,
    publicly_accessible=True, # Sensitive
    vpc_security_groups=[sg.security_group_id]
)
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/Instance.html">aws_cdk.aws_ec2.Instance</a>:</p>
<pre>
from aws_cdk import aws_ec2 as ec2

ec2.Instance(
    self,
    "vpc_subnet_private",
    instance_type=nano_t2,
    machine_image=ec2.MachineImage.latest_amazon_linux(),
    vpc=vpc,
    vpc_subnets=ec2.SubnetSelection(subnet_type=ec2.SubnetType.PRIVATE_WITH_NAT)
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnInstance.html">aws_cdk.aws_ec2.CfnInstance</a>:</p>
<pre>
from aws_cdk import aws_ec2 as ec2

ec2.CfnInstance(
    self,
    "cfn_private",
    instance_type="t2.micro",
    image_id="ami-0ea0f26a6d50850c5",
    network_interfaces=[
        ec2.CfnInstance.NetworkInterfaceProperty(
            device_index="0",
            associate_public_ip_address=False, # Compliant
            delete_on_termination=True,
            subnet_id=vpc.select_subnets(subnet_type=ec2.SubnetType.PRIVATE_WITH_NAT).subnet_ids[0]
        )
    ]
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_dms/CfnReplicationInstance.html">aws_cdk.aws_dms.CfnReplicationInstance</a>:</p>
<pre>
from aws_cdk import aws_dms as dms

rep_instance = dms.CfnReplicationInstance(
    self,
    "explicit_private",
    replication_instance_class="dms.t2.micro",
    allocated_storage=5,
    publicly_accessible=False,
    replication_subnet_group_identifier=subnet_group.replication_subnet_group_identifier,
    vpc_security_group_ids=[vpc.vpc_default_security_group]
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_rds/CfnDBInstance.html">aws_cdk.aws_rds.CfnDBInstance</a>:</p>
<pre>
from aws_cdk import aws_rds as rds
from aws_cdk import aws_ec2 as ec2

rds_subnet_group_private = rds.CfnDBSubnetGroup(
    self,
    "private_subnet",
    db_subnet_group_description="Subnets",
    subnet_ids=vpc.select_subnets(
        subnet_type=ec2.SubnetType.PRIVATE_WITH_NAT
    ).subnet_ids
)

rds.CfnDBInstance(
    self,
    "private-private-subnet",
    engine="postgres",
    master_username="foobar",
    master_user_password="12345678",
    db_instance_class="db.r5.large",
    allocated_storage="200",
    iops=1000,
    db_subnet_group_name=rds_subnet_group_private.ref,
    publicly_accessible=False,
    vpc_security_groups=[sg.security_group_id]
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html">AWS Documentation</a> - Amazon EC2 instance IP
  addressing </li>
  <li> <a href="https://docs.aws.amazon.com/dms/latest/userguide/CHAP_ReplicationInstance.PublicPrivate.html">AWS Documentation</a> - Public and
  private replication instances </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/peering/what-is-vpc-peering.html">AWS Documentation</a> - VPC Peering </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S4828"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4828">
              python:S4828
            </a>
          </td>
          <td >
            <details>
              <p>Signaling processes or process groups can seriously affect the stability of this application or other applications on the same system.</p>
<p>Accidentally setting an incorrect <code>PID</code> or <code>signal</code> or allowing untrusted sources to assign arbitrary values to these
parameters may result in a denial of service.</p>
<p>Also, the system treats the signal differently if the destination <code>PID</code> is less than or equal to 0. This different behavior may affect
multiple processes with the same (E)UID simultaneously if the call is left uncontrolled.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The parameters <code>pid</code> and <code>sig</code> are untrusted (they come from an external source). </li>
  <li> This function is triggered by non-administrators. </li>
  <li> Signal handlers on the target processes stop important functions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> For stateful applications with user management, ensure that only administrators trigger this code. </li>
  <li> Verify that the <code>pid</code> and <code>sig</code> parameters are correct before using them. </li>
  <li> Ensure that the process sending the signals runs with as few OS privileges as possible. </li>
  <li> Isolate the process on the system based on its (E)UID. </li>
  <li> Ensure that the signal does not interrupt any essential functions when intercepted by a target’s signal handlers. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
import os

@app.route("/kill-pid/&lt;pid&gt;")
def send_signal(pid):
    os.kill(pid, 9)  # Sensitive

@app.route("/kill-pgid/&lt;pgid&gt;")
def send_signal(pgid):
    os.killpg(pgid, 9)  # Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
import os

@app.route("/kill-pid/&lt;pid&gt;")
def send_signal(pid):
    # Validate the untrusted PID,
    # With a pre-approved list or authorization checks
    if is_valid_pid(pid):
        os.kill(pid, 9)

@app.route("/kill-pgid/&lt;pgid&gt;")
def send_signal(pgid):
    # Validate the untrusted PGID,
    # With a pre-approved list or authorization checks
    if is_valid_pgid(pgid):
        os.kill(pgid, 9)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/283">MITRE, CWE-283</a> - Unverified Ownership </li>
  <li> <a href="https://man7.org/linux/man-pages/man1/kill.1.html">kill(1) — Linux manual page</a> </li>
  <li> <a href="https://man7.org/linux/man-pages/man2/kill.2.html">kill(2) — Linux manual page</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S4829"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4829">
              python:S4829
            </a>
          </td>
          <td >
            <details>
              <p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337">CVE-2005-2337</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449">CVE-2017-11449</a> </li>
</ul>
<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)
can be dangerous and should be validated.</p>
<p>This rule flags code that reads from the standard input.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> data read from the standard input is not sanitized before being used. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all data read from the standard input before using it.</p>
<h2>Sensitive Code Example</h2>
<p>Python 2 and Python 3</p>
<pre>
import sys
from sys import stdin, __stdin__

# Any reference to sys.stdin or sys.__stdin__ without a method call is Sensitive
sys.stdin  # Sensitive

for line in sys.stdin:  # Sensitive
    print(line)

it = iter(sys.stdin)  # Sensitive
line = next(it)

# Calling the following methods on stdin or __stdin__ is sensitive
sys.stdin.read()  # Sensitive
sys.stdin.readline()  # Sensitive
sys.stdin.readlines()  # Sensitive

# Calling other methods on stdin or __stdin__ does not require a review, thus it is not Sensitive
sys.stdin.seekable()  # Ok
# ...
</pre>
<p>Python 2 only</p>
<pre>
raw_input('What is your password?')  # Sensitive
</pre>
<p>Python 3 only</p>
<pre>
input('What is your password?')  # Sensitive
</pre>
<p>Function <code>fileinput.input</code> and class <code>fileinput.FileInput</code> read the standard input when the list of files is empty.</p>
<pre>
for line in fileinput.input():  # Sensitive
    print(line)

for line in fileinput.FileInput():  # Sensitive
    print(line)

for line in fileinput.input(['setup.py']):  # Ok
    print(line)

for line in fileinput.FileInput(['setup.py']):  # Ok
    print(line)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S4823"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4823">
              python:S4823
            </a>
          </td>
          <td >
            <details>
              <p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281">CVE-2018-7281</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326">CVE-2018-12326</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198">CVE-2011-3198</a> </li>
</ul>
<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>
<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus
passing sensitive information via command line arguments should be considered as insecure.</p>
<p>This rule raises an issue on every reference to <code>sys.argv</code>, call to <code>optparse.OptionParser()</code> or a call to
<code>argparse.ArgumentParser()</code>. The goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> any of the command line arguments are used without being sanitized first. </li>
  <li> your application accepts sensitive information via command line arguments. </li>
</ul>
<p>If you answered yes to any of these questions you are at risk.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all command line arguments before using them.</p>
<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing
sensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the
path to a file containing the information.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/88">MITRE, CWE-88</a> - Argument Injection or Modification </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/214">MITRE, CWE-214</a> - Information Exposure Through Process Environment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="python:S6333"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6333">
              python:S6333
            </a>
          </td>
          <td >
            <details>
              <p>A public API, which can be requested by any authenticated or unauthenticated identities, can lead to unauthorized actions and information
disclosures.</p>
<h2>Ask Yourself Whether</h2>
<p>The public API:</p>
<ul>
  <li> exposes sensitive data like personal information. </li>
  <li> can be used to perform sensitive operations. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict API access to authorized entities, unless the API offers a non-sensitive service designed to be public.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_apigateway/Resource.html">aws_cdk.aws_apigateway.Resource</a>:</p>
<pre>
from aws_cdk import (
    aws_apigateway as apigateway
)

resource = api.root.add_resource("example")
resource.add_method(
    "GET",
    authorization_type=apigateway.AuthorizationType.NONE  # Sensitive
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html">aws_cdk.aws_apigatewayv2.CfnRoute</a>:</p>
<pre>
from aws_cdk import (
    aws_apigatewayv2 as apigateway
)

apigateway.CfnRoute(
    self,
    "no-auth",
    api_id=api.ref,
    route_key="GET /test",
    authorization_type="NONE"  # Sensitive
)
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_apigateway/Resource.html">aws_cdk.aws_apigateway.Resource</a>:</p>
<pre>
from aws_cdk import (
    aws_apigateway as apigateway
)

opts = apigateway.MethodOptions(
    authorization_type=apigateway.AuthorizationType.IAM
)
resource = api.root.add_resource(
    "example",
    default_method_options=opts
)
resource.add_method(
    "POST",
    authorization_type=apigateway.AuthorizationType.IAM
)
resource.add_method(  # authorization_type is inherited from the Resource's configured default_method_options
    "POST"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigatewayv2.CfnRoute.html">aws_cdk.aws_apigatewayv2.CfnRoute</a>:</p>
<pre>
from aws_cdk import (
    aws_apigatewayv2 as apigateway
)

apigateway.CfnRoute(
    self,
    "auth",
    api_id=api.ref,
    route_key="GET /test",
    authorization_type="AWS_IAM"
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-to-api.html">AWS Documentation</a> -
  Controlling and managing access to a REST API in API Gateway </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S5247"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5247">
              python:S5247
            </a>
          </td>
          <td >
            <details>
              <p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,
<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters
that make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>
<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a
href="https://twig.symfony.com/doc/3.x/filters/escape.html">the strategy applied</a> and the context, for example a "html auto-escaping" strategy
(which only transforms html characters into <a href="https://developer.mozilla.org/en-US/docs/Glossary/Entity">html entities</a>) will not be relevant
when variables are used in a <a href="https://en.wikipedia.org/wiki/HTML_attribute">html attribute</a> because '<code>:</code>' character is not
escaped and thus an attack as below is possible:</p>
<pre>
&lt;a href="{{ myLink }}"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)
&lt;a href="javascript:alert(document.cookie)"&gt;link&lt;/a&gt; // JS injection (XSS attack)
</pre>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Templates are used to render web content and
    <ul>
      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>
      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>
    </ul>  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right
one.</p>
<h2>Sensitive Code Example</h2>
<pre>
from jinja2 import Environment

env = Environment() # Sensitive: New Jinja2 Environment has autoescape set to false
env = Environment(autoescape=False) # Sensitive:
</pre>
<h2>Compliant Solution</h2>
<pre>
from jinja2 import Environment
env = Environment(autoescape=True) # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md">OWASP Cheat
  Sheet</a> - XSS Prevention Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6330">
              python:S6330
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Simple Queue Service (SQS) is a managed message queuing service for application-to-application (A2A) communication. Amazon SQS can store
messages encrypted as soon as they are received. In the case that adversaries gain physical access to the storage medium or otherwise leak a message
from the file system, for example through a vulnerability in the service, they are not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The queue contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt SQS queues that contain sensitive information. Encryption and decryption are handled transparently by SQS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html">aws_cdk.aws_sqs.Queue</a>:</p>
<pre>
from aws_cdk import (
    aws_sqs as sqs
)

class QueueStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        sqs.Queue( # Sensitive, unencrypted by default
            self,
            "example"
        )
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html">aws_cdk.aws_sqs.CfnQueue</a>:</p>
<pre>
from aws_cdk import (
    aws_sqs as sqs
)

class CfnQueueStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        sqs.CfnQueue( # Sensitive, unencrypted by default
            self,
            "example"
        )
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.Queue.html">aws_cdk.aws_sqs.Queue</a>:</p>
<pre>
from aws_cdk import (
    aws_sqs as sqs
)

class QueueStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        sqs.Queue(
            self,
            "example",
            encryption=sqs.QueueEncryption.KMS_MANAGED
        )
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_sqs.CfnQueue.html">aws_cdk.aws_sqs.CfnQueue</a>:</p>
<pre>
from aws_cdk import (
    aws_sqs as sqs
)

class CfnQueueStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        my_key = kms.Key(self, "key")
        sqs.CfnQueue(
            self,
            "example",
            kms_master_key_id=my_key.key_id
        )
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html">AWS Documentation</a> -
  Encryption at rest </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S5122"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5122">
              python:S5122
            </a>
          </td>
          <td >
            <details>
              <p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269">CVE-2018-0269</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460">CVE-2017-14460</a> </li>
</ul>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same origin policy</a> in browsers prevents, by default and for
security-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)
from its own. The requested target can append additional HTTP headers in response, called <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>, that act like directives for the browser and change the access control policy
/ relax the same origin policy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>
  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>
  <li> Your access control policy is dynamically defined by a user-controlled input like <a
  href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin"><code>origin</code></a> header. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>
  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or
  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>Django:</p>
<pre>
CORS_ORIGIN_ALLOW_ALL = True # Sensitive
</pre>
<p>Flask:</p>
<pre>
from flask import Flask
from flask_cors import CORS

app = Flask(__name__)
CORS(app, resources={r"/*": {"origins": "*", "send_wildcard": "True"}}) # Sensitive
</pre>
<p>User-controlled origin:</p>
<pre>
origin = request.headers['ORIGIN']
resp = Response()
resp.headers['Access-Control-Allow-Origin'] = origin # Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Django:</p>
<pre>
CORS_ORIGIN_ALLOW_ALL = False # Compliant
</pre>
<p>Flask:</p>
<pre>
from flask import Flask
from flask_cors import CORS

app = Flask(__name__)
CORS(app, resources={r"/*": {"origins": "*", "send_wildcard": "False"}}) # Compliant
</pre>
<p>User-controlled origin validated with an allow-list:</p>
<pre>
origin = request.headers['ORIGIN']
resp = Response()
if origin in TRUSTED_ORIGINS:
   resp.headers['Access-Control-Allow-Origin'] = origin
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">developer.mozilla.org</a> - CORS </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">developer.mozilla.org</a> - Same origin policy </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing">OWASP HTML5 Security
  Cheat Sheet</a> - Cross Origin Resource Sharing </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/346">MITRE, CWE-346</a> - Origin Validation Error </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/942">MITRE, CWE-942</a> - Overly Permissive Cross-domain Whitelist </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6332">
              python:S6332
            </a>
          </td>
          <td >
            <details>
              <p>Amazon Elastic File System (EFS) is a serverless file system that does not require provisioning or managing storage. Stored files can be
automatically encrypted by the service. In the case that adversaries gain physical access to the storage medium or otherwise leak a message they are
not able to access the data.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The file system contains sensitive data that could cause harm when leaked. </li>
  <li> There are compliance requirements for the service to store data encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to encrypt EFS file systems that contain sensitive information. Encryption and decryption are handled transparently by EFS, so no
further modifications to the application are necessary.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html">aws_cdk.aws_efs.FileSystem</a> and <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html">aws_cdk.aws_efs.CfnFileSystem</a>:</p>
<pre>
from aws_cdk import (
    aws_efs as efs
)

efs.FileSystem(
    self,
    "example",
    encrypted=False  # Sensitive
)
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.FileSystem.html">aws_cdk.aws_efs.FileSystem</a> and <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_efs.CfnFileSystem.html">aws_cdk.aws_efs.CfnFileSystem</a>:</p>
<pre>
from aws_cdk import (
    aws_efs as efs
)

efs.FileSystem(
    self,
    "example",
    encrypted=True
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://docs.aws.amazon.com/efs/latest/ug/encryption.html">AWS Documentation</a> - Data encryption in Amazon EFS </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S2092"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2092">
              python:S2092
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP
request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>
  <li> it’s not sure that the website contains <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">mixed content</a> or not
  (ie HTTPS everywhere or not) </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour
  when creating cookies. </li>
  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>Flask</p>
<pre>
from flask import Response

@app.route('/')
def index():
    response = Response()
    response.set_cookie('key', 'value') # Sensitive
    return response
</pre>
<h2>Compliant Solution</h2>
<p>Flask</p>
<pre>
from flask import Response

@app.route('/')
def index():
    response = Response()
    response.set_cookie('key', 'value', secure=True) # Compliant
    return response
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/614">MITRE, CWE-614</a> - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="text:S6389"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=text:S6389">
              text:S6389
            </a>
          </td>
          <td >
            <details>
              <p>Using bidirectional (BIDI) characters can lead to incomprehensible code.</p>
<p>The Unicode encoding contains BIDI control characters that are used to display text right-to-left (RTL) instead of left-to-right (LTR). This is
necessary for certain languages that use RTL text. The BIDI characters can be used to create a difference in the code between what a human sees and
what a compiler or interpreter sees. An advisary might use this feature to hide a backdoor in the code that will not be spotted by a human reviewer as
it is not visible.</p>
<p>This can lead to supply chain attacks since the backdoored code might persist over a long time without being detected and can even be included in
other projects, for example in the case of libraries.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This text requires a right-to-left writing system (to use Arabic or Hebrew words, for example). </li>
  <li> The author of this text is a legitimate user. </li>
  <li> This text contains a standard instruction, comment or sequence of characters. </li>
</ul>
<p>There is a risk if you answered no to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Open the file in an editor that reveals non-ASCII characters and remove all BIDI control characters that are not intended.</p>
<p>If hidden characters are illegitimate, this issue could indicate a potential ongoing attack on the code. Therefore, it would be best to warn your
organization’s security team about this issue.</p>
<p>Required opening BIDI characters should be explicitly closed with the PDI character.</p>
<h2>Sensitive Code Example</h2>
<p>A hidden BIDI character is present in front of <code>return</code>:</p>
<pre>
def subtract_funds(account: str, amount: int):
    ''' Subtract funds from bank account then ⁧''' ;return
    bank[account] -= amount
    return
</pre>
<p>The executed code looks like the following:</p>
<pre>
def subtract_funds(account: str, amount: int):
    ''' Subtract funds from bank account then &lt;RLI&gt;''' ;return
    bank[account] -= amount
    return
</pre>
<h2>Compliant Solution</h2>
<p>No hidden BIDI characters are present:</p>
<pre>
def subtract_funds(account: str, amount: int):
    ''' Subtract funds from bank account then return; '''
    bank[account] -= amount
    return
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://unicode.org/reports/tr9/">Bidirectional Algorithm</a> - Unicode Standard </li>
  <li> <a href="https://en.wikipedia.org/wiki/Bidirectional_text">Wikipedia</a> - Bidirectional Text </li>
  <li> <a href="https://www.trojansource.codes/trojan-source.pdf">Trojan Source Report</a> </li>
  <li> <a href="https://www.trojansource.codes/trojan-source.pdf#page=15">Trojan Source Report</a> - IDEs revealing hidden characters </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/94">MITRE, CWE-94</a> - Improper Control of Generation of Code ('Code Injection') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S4502"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4502">
              csharpsquid:S4502
            </a>
          </td>
          <td >
            <details>
              <p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive
actions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the
application.</p>
<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a
hidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The web application uses cookies to authenticate users. </li>
  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>
  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Protection against CSRF attacks is strongly recommended:
    <ul>
      <li> to be activated by default for all <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">unsafe HTTP
      methods</a>. </li>
      <li> implemented, for example, with an unguessable CSRF token </li>
    </ul>  </li>
  <li> Of course all sensitive operations should not be performed with <a
  href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">safe HTTP</a> methods like <code>GET</code> which are designed to be
  used only for information retrieval. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
public void ConfigureServices(IServiceCollection services)
{
    // ...
    services.AddControllersWithViews(options =&gt; options.Filters.Add(new IgnoreAntiforgeryTokenAttribute())); // Sensitive
    // ...
}
</pre>
<pre>
[HttpPost, IgnoreAntiforgeryToken] // Sensitive
public IActionResult ChangeEmail(ChangeEmailModel model) =&gt; View("~/Views/...");
</pre>
<h2>Compliant Solution</h2>
<pre>
public void ConfigureServices(IServiceCollection services)
{
    // ...
    services.AddControllersWithViews(options =&gt; options.Filters.Add(new AutoValidateAntiforgeryTokenAttribute()));
    // or
    services.AddControllersWithViews(options =&gt; options.Filters.Add(new ValidateAntiForgeryTokenAttribute()));
    // ...
}
</pre>
<pre>
[HttpPost]
[AutoValidateAntiforgeryToken]
public IActionResult ChangeEmail(ChangeEmailModel model) =&gt; View("~/Views/...");
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/352">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF) </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/csrf">OWASP: Cross-Site Request Forgery</a> </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4507">
              csharpsquid:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> the application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers.</p>
<p>The .Net Core framework offers multiple features which help during debug.
<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDeveloperExceptionPage</code> and
<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDatabaseErrorPage</code> are two of them. Make sure that those features are disabled in
production.</p>
<p>Use <code>if (env.IsDevelopment())</code> to disable debug code.</p>
<h2>Sensitive Code Example</h2>
<p>This rule raises issues when the following .Net Core methods are called:
<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDeveloperExceptionPage</code>,
<code>Microsoft.AspNetCore.Builder.IApplicationBuilder.UseDatabaseErrorPage</code>.</p>
<pre>
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;

namespace mvcApp
{
    public class Startup2
    {
        public void Configure(IApplicationBuilder app, IHostingEnvironment env)
        {
            // Those calls are Sensitive because it seems that they will run in production
            app.UseDeveloperExceptionPage(); // Sensitive
            app.UseDatabaseErrorPage(); // Sensitive
        }
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;

namespace mvcApp
{
    public class Startup2
    {
        public void Configure(IApplicationBuilder app, IHostingEnvironment env)
        {
            if (env.IsDevelopment())
            {
                // The following calls are ok because they are disabled in production
                app.UseDeveloperExceptionPage(); // Compliant
                app.UseDatabaseErrorPage(); // Compliant
            }
        }
    }
}
</pre>
<h2>Exceptions</h2>
<p>This rule does not analyze configuration files. Make sure that debug mode is not enabled by default in those files.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S4787"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4787">
              csharpsquid:S4787
            </a>
          </td>
          <td >
            <details>
              <p>Encrypting data is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7902">CVE-2017-7902</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-1378">CVE-2006-1378</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2003-1376">CVE-2003-1376</a> </li>
</ul>
<p>Proper encryption requires both the encryption algorithm and the key to be strong. Obviously the private key needs to remain secret and be renewed
regularly. However these are not the only means to defeat or weaken an encryption.</p>
<p>This rule flags function calls that initiate encryption/decryption.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the private key might not be random, strong enough or the same key is reused for a long long time. </li>
  <li> the private key might be compromised. It can happen when it is stored in an unsafe place or when it was transferred in an unsafe manner. </li>
  <li> the key exchange is made without properly authenticating the receiver. </li>
  <li> the encryption algorithm is not strong enough for the level of protection required. Note that encryption algorithms strength decreases as time
  passes. </li>
  <li> the chosen encryption library is deemed unsafe. </li>
  <li> a nonce is used, and the same value is reused multiple times, or the nonce is not random. </li>
  <li> the RSA algorithm is used, and it does not incorporate an Optimal Asymmetric Encryption Padding (OAEP), which might weaken the encryption.
  </li>
  <li> the CBC (Cypher Block Chaining) algorithm is used for encryption, and it’s IV (Initialization Vector) is not generated using a secure random
  algorithm, or it is reused. </li>
  <li> the Advanced Encryption Standard (AES) encryption algorithm is used with an unsecure mode. See the recommended practices for more information.
  </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Generate encryption keys using secure random algorithms. </li>
  <li> When generating cryptographic keys (or key pairs), it is important to use a key length that provides enough entropy against brute-force
  attacks. For the Blowfish algorithm the key should be at least 128 bits long, while for the RSA algorithm it should be at least 2048 bits long.
  </li>
  <li> Regenerate the keys regularly. </li>
  <li> Always store the keys in a safe location and transfer them only over safe channels. </li>
  <li> If there is an exchange of cryptographic keys, check first the identity of the receiver. </li>
  <li> Only use strong encryption algorithms. Check regularly that the algorithm is still deemed secure. It is also imperative that they are
  implemented correctly. Use only encryption libraries which are deemed secure. Do not define your own encryption algorithms as they will most
  probably have flaws. </li>
  <li> When a nonce is used, generate it randomly every time. </li>
  <li> When using the RSA algorithm, incorporate an Optimal Asymmetric Encryption Padding (OAEP). </li>
  <li> When CBC is used for encryption, the IV must be random and unpredictable. Otherwise it exposes the encrypted value to crypto-analysis attacks
  like "Chosen-Plaintext Attacks". Thus a secure random algorithm should be used. An IV value should be associated to one and only one encryption
  cycle, because the IV’s purpose is to ensure that the same plaintext encrypted twice will yield two different ciphertexts. </li>
  <li> The Advanced Encryption Standard (AES) encryption algorithm can be used with various modes. Galois/Counter Mode (GCM) with no padding should be
  preferred to the following combinations which are not secured:
    <ul>
      <li> Electronic Codebook (ECB) mode: Under a given key, any given plaintext block always gets encrypted to the same ciphertext block. Thus, it
      does not hide data patterns well. In some senses, it doesn’t provide serious message confidentiality, and it is not recommended for use in
      cryptographic protocols at all. </li>
      <li> Cipher Block Chaining (CBC) with PKCS#5 padding (or PKCS#7) is susceptible to padding oracle attacks. </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
using System;
using System.Security.Cryptography;

namespace MyNamespace
{
    public class MyClass
    {
        public void Main()
        {
            Byte[] data = {1,1,1};

            RSA myRSA = RSA.Create();
            RSAEncryptionPadding padding = RSAEncryptionPadding.CreateOaep(HashAlgorithmName.SHA1);
            // Review all base RSA class' Encrypt/Decrypt calls
            myRSA.Encrypt(data, padding); // Sensitive
            myRSA.EncryptValue(data); // Sensitive
            myRSA.Decrypt(data, padding); // Sensitive
            myRSA.DecryptValue(data); // Sensitive

            RSACryptoServiceProvider myRSAC = new RSACryptoServiceProvider();
            // Review the use of any TryEncrypt/TryDecrypt and specific Encrypt/Decrypt of RSA subclasses.
            myRSAC.Encrypt(data, false); // Sensitive
            myRSAC.Decrypt(data, false); // Sensitive
            int written;
            myRSAC.TryEncrypt(data, Span&lt;byte&gt;.Empty, padding, out written); // Sensitive
            myRSAC.TryDecrypt(data, Span&lt;byte&gt;.Empty, padding, out written); // Sensitive

            byte[] rgbKey = {1,2,3};
            byte[] rgbIV = {4,5,6};
            SymmetricAlgorithm rijn = SymmetricAlgorithm.Create();
            // Review the creation of Encryptors from any SymmetricAlgorithm instance.
            rijn.CreateEncryptor(); // Sensitive
            rijn.CreateEncryptor(rgbKey, rgbIV); // Sensitive
            rijn.CreateDecryptor(); // Sensitive
            rijn.CreateDecryptor(rgbKey, rgbIV); // Sensitive
        }

        public class MyCrypto : System.Security.Cryptography.AsymmetricAlgorithm // Sensitive
        {
            // ...
        }

        public class MyCrypto2 : System.Security.Cryptography.SymmetricAlgorithm // Sensitive
        {
            // ...
        }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/321">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/322">MITRE, CWE-322</a> - Key Exchange without Entity Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/323">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/324">MITRE, CWE-324</a> - Use of a Key Past its Expiration Date </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/325">MITRE, CWE-325</a> - Missing Required Cryptographic Step </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=csharpsquid%3AS4426'>S4426</a>, <a href='/coding_rules#rule_key=csharpsquid%3AS5542'>S5542</a>, <a href='/coding_rules#rule_key=csharpsquid%3AS5547'>S5547</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S2245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2245">
              csharpsquid:S2245
            </a>
          </td>
          <td >
            <details>
              <p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386">CVE-2013-6386</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419">CVE-2006-3419</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102">CVE-2008-4102</a> </li>
</ul>
<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that
will be generated, and use this guess to impersonate another user or access sensitive information.</p>
<p>As the <code>System.Random</code> class relies on a pseudorandom number generator, it should not be used for security-critical applications or for
protecting sensitive data. In such context, the <code>System.Cryptography.RandomNumberGenerator</code> class which relies on a cryptographically
strong random number generator (RNG) should be used in place.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such
  as a password, is hashed. </li>
  <li> the function you use generates a value which can be predicted (pseudo-random). </li>
  <li> the generated value is used multiple times. </li>
  <li> an attacker can access the generated value. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Only use random number generators which are <a
  href="https://cheatsheetseries.owasp.org/cheatsheets/Cryptographic_Storage_Cheat_Sheet.html#secure-random-number-generation">recommended by
  OWASP</a> or any other trusted organization. </li>
  <li> Use the generated random values only once. </li>
  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
var random = new Random(); // Sensitive use of Random
byte[] data = new byte[16];
random.NextBytes(data);
return BitConverter.ToString(data); // Check if this value is used for hashing or encryption
</pre>
<h2>Compliant Solution</h2>
<pre>
using System.Security.Cryptography;
...
var randomGenerator = RandomNumberGenerator.Create(); // Compliant for security-sensitive use cases
byte[] data = new byte[16];
randomGenerator.GetBytes(data);
return BitConverter.ToString(data);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/338">MITRE, CWE-338</a> - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1241">MITRE, CWE-1241</a> - Use of Predictable Algorithm in Random Number Generator </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM">Predictable Pseudo Random Number
  Generator</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S3330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S3330">
              csharpsquid:S3330
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will
be able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer
to decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target
the theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS
vulnerability to steal session-cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>
  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)
  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /
  sensitive-security cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>When the <code>HttpCookie.HttpOnly</code> property is set to <code>false</code> then the cookie can be accessed by client side code:</p>
<pre>
HttpCookie myCookie = new HttpCookie("Sensitive cookie");
myCookie.HttpOnly = false; // Sensitive: this cookie is created with the httponly flag set to false and so it can be stolen easily in case of XSS vulnerability
</pre>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcookie.httponly?view=netframework-4.8">default value</a> of
<code>HttpOnly</code> flag is <code>false</code>, unless overwritten by an application’s configuration file:</p>
<pre>
HttpCookie myCookie = new HttpCookie("Sensitive cookie");
// Sensitive: this cookie is created without the httponly flag  (by default set to false) and so it can be stolen easily in case of XSS vulnerability
</pre>
<h2>Compliant Solution</h2>
<p>Set the <code>HttpCookie.HttpOnly</code> property to <code>true</code>:</p>
<pre>
HttpCookie myCookie = new HttpCookie("Sensitive cookie");
myCookie.HttpOnly = true; // Compliant: the sensitive cookie is protected against theft thanks to the HttpOnly property set to true (HttpOnly = true)
</pre>
<p>Or change the default flag values for the whole application by editing the <a
href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/ms228262(v=vs.100)">Web.config configuration file</a>:</p>
<pre>
&lt;httpCookies httpOnlyCookies="true" requireSSL="true" /&gt;
</pre>
<ul>
  <li> the <code>requireSSL</code> attribute corresponds programmatically to the <code>Secure</code> field. </li>
  <li> the <code>httpOnlyCookies</code> attribute corresponds programmatically to the <code>httpOnly</code> field. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/HttpOnly">OWASP HttpOnly</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1004">MITRE, CWE-1004</a> - Sensitive Cookie Without 'HttpOnly' Flag </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE">HTTPONLY_COOKIE</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5753"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5753">
              csharpsquid:S5753
            </a>
          </td>
          <td >
            <details>
              <p>ASP.NET 1.1+ comes with a feature called <em>Request Validation</em>, preventing the server to accept content containing un-encoded HTML. This
feature comes as a first protection layer against Cross-Site Scripting (XSS) attacks and act as a simple Web Application Firewall (WAF) rejecting
requests potentially containing malicious content.</p>
<p>While this feature is not a silver bullet to prevent all XSS attacks, it helps to catch basic ones. It will for example prevent <code>&lt;script
type="text/javascript" src="https://malicious.domain/payload.js"&gt;</code> to reach your Controller.</p>
<p>Note: <em>Request Validation</em> feature being only available for ASP.NET, no Security Hotspot is raised on ASP.NET Core applications.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the developer doesn’t know the impact to deactivate the Request Validation feature </li>
  <li> the web application accepts user-supplied data </li>
  <li> all user-supplied data are not validated </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Activate the Request Validation feature for all HTTP requests </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>At Controller level:</p>
<pre>
[ValidateInput(false)]
public ActionResult Welcome(string name)
{
  ...
}
</pre>
<p>At application level, configured in the Web.config file:</p>
<pre>
&lt;configuration&gt;
   &lt;system.web&gt;
      &lt;pages validateRequest="false" /&gt;
      ...
      &lt;httpRuntime requestValidationMode="0.0" /&gt;
   &lt;/system.web&gt;
&lt;/configuration&gt;
</pre>
<h2>Compliant Solution</h2>
<p>At Controller level:</p>
<pre>
[ValidateInput(true)]
public ActionResult Welcome(string name)
{
  ...
}
</pre>
<p>or</p>
<pre>
public ActionResult Welcome(string name)
{
  ...
}
</pre>
<p>At application level, configured in the Web.config file:</p>
<pre>
&lt;configuration&gt;
   &lt;system.web&gt;
      &lt;pages validateRequest="true" /&gt;
      ...
      &lt;httpRuntime requestValidationMode="4.5" /&gt;
   &lt;/system.web&gt;
&lt;/configuration&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a
  href="https://docs.microsoft.com/en-us/dotnet/api/system.web.configuration.httpruntimesection.requestvalidationmode?view=netframework-4.8">HttpRuntimeSection.RequestValidationMode Property</a> </li>
  <li> <a href="https://owasp.org/www-community/ASP-NET_Request_Validation">OWASP ASP.NET Request Validation</a> </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP Cheat Sheet</a> - XSS
  Prevention Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4784"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4784">
              csharpsquid:S4784
            </a>
          </td>
          <td >
            <details>
              <p>Using regular expressions is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-16021">CVE-2017-16021</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-13863">CVE-2018-13863</a> </li>
</ul>
<p>Evaluating regular expressions against input strings is potentially an extremely CPU-intensive task. Specially crafted regular expressions such as
<code>(a+)+s</code> will take several seconds to evaluate the input string <code>aaaaaaaaaaaaaaaaaaaaaaaaaaaaabs</code>. The problem is that with
every additional <code>a</code> character added to the input, the time required to evaluate the regex doubles. However, the equivalent regular
expression, <code>a+s</code> (without grouping) is efficiently evaluated in milliseconds and scales linearly with the input size.</p>
<p>Evaluating such regular expressions opens the door to <a
href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">Regular expression Denial of Service (ReDoS)</a> attacks.
In the context of a web application, attackers can force the web server to spend all of its resources evaluating regular expressions thereby making
the service inaccessible to genuine users.</p>
<p>This rule flags any execution of a hardcoded regular expression which has at least 3 characters and at least two instances of any of the following
characters: <code>*+{</code>.</p>
<p>Example: <code>(a+)*</code></p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the executed regular expression is sensitive and a user can provide a string which will be analyzed by this regular expression. </li>
  <li> your regular expression engine performance decrease with specially crafted inputs and regular expressions. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Check whether your regular expression engine (the algorithm executing your regular expression) has any known vulnerabilities. Search for
vulnerability reports mentioning the one engine you’re are using.</p>
<p>If the regular expression is vulnerable to ReDos attacks, mitigate the risk by using a "match timeout" to limit the time spent running the regular
expression.</p>
<p>Remember also that a ReDos attack is possible if a user-provided regular expression is executed. This rule won’t detect this kind of injection.</p>
<h2>Sensitive Code Example</h2>
<pre>
using System;
using System.Collections.Generic;
using System.Linq;
using System.Runtime.Serialization;
using System.Text.RegularExpressions;
using System.Web;

namespace N
{
    public class RegularExpression
    {
        void Foo(RegexOptions options, TimeSpan matchTimeout, string input,
                 string replacement, MatchEvaluator evaluator)
        {
            // All the following instantiations are Sensitive.
            new System.Text.RegularExpressions.Regex("(a+)+");
            new System.Text.RegularExpressions.Regex("(a+)+", options);
            new System.Text.RegularExpressions.Regex("(a+)+", options, matchTimeout);

            // All the following static methods are Sensitive.
            System.Text.RegularExpressions.Regex.IsMatch(input, "(a+)+");
            System.Text.RegularExpressions.Regex.IsMatch(input, "(a+)+", options);
            System.Text.RegularExpressions.Regex.IsMatch(input, "(a+)+", options, matchTimeout);

            System.Text.RegularExpressions.Regex.Match(input, "(a+)+");
            System.Text.RegularExpressions.Regex.Match(input, "(a+)+", options);
            System.Text.RegularExpressions.Regex.Match(input, "(a+)+", options, matchTimeout);

            System.Text.RegularExpressions.Regex.Matches(input, "(a+)+");
            System.Text.RegularExpressions.Regex.Matches(input, "(a+)+", options);
            System.Text.RegularExpressions.Regex.Matches(input, "(a+)+", options, matchTimeout);

            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+", evaluator);
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+", evaluator, options);
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+", evaluator, options, matchTimeout);
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+", replacement);
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+", replacement, options);
            System.Text.RegularExpressions.Regex.Replace(input, "(a+)+", replacement, options, matchTimeout);

            System.Text.RegularExpressions.Regex.Split(input, "(a+)+");
            System.Text.RegularExpressions.Regex.Split(input, "(a+)+", options);
            System.Text.RegularExpressions.Regex.Split(input, "(a+)+", options, matchTimeout);
        }
    }
}
</pre>
<h2>Exceptions</h2>
<p>Some corner-case regular expressions will not raise an issue even though they might be vulnerable. For example: <code>(a|aa)+</code>,
<code>(a|a?)+</code>.</p>
<p>It is a good idea to test your regular expression if it has the same pattern on both side of a "<code>|</code>".</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">MITRE, CWE-624</a> - Executable Regular
  Expression Error </li>
  <li> OWASP Regular expression Denial of Service - ReDoS </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=roslyn.sonaranalyzer.security.cs%3AS2631'>S2631</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5766"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5766">
              csharpsquid:S5766
            </a>
          </td>
          <td >
            <details>
              <p>Deserialization process extracts data from the serialized representation of an object and reconstruct it directly, without calling constructors.
Thus, data validation implemented in constructors can be bypassed if serialized objects are controlled by an attacker.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The data validation implemented in constructors enforces a relevant security check. </li>
  <li> Objects instantiated via deserialization don’t run the same security checks as the ones executed when objects are created through constructors.
  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> At the end of the deserialization process it is recommended to perform the same validation checks as the ones performed in constructors,
  especially when the serialized object can be controlled by an attacker. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>When a <code>serializable</code> class doesn’t inherit from <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.iserializable?view=netframework-4.8">ISerializable</a> or <a
href="https://docs.microsoft.com/fr-fr/dotnet/api/system.runtime.serialization.ideserializationcallback?view=netframework-4.8">IDeserializationCallback</a>
types and has a constructor using its parameters in conditions:</p>
<pre>
[Serializable]
public class InternalUrl
{
    private string url;

    public InternalUrl(string tmpUrl) // Sensitive
    {
       if(!tmpUrl.StartsWith("http://localhost/")) // there is some input validation
       {
          url= "http://localhost/default";
       }
       else
       {
          url= tmpUrl;
       }
    }
}
</pre>
<p>When a class inherit from <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.iserializable?view=netframework-4.8">ISerializable</a> type, has a
regular constructor using its parameters in conditions, but doesn’t perform the same validation after deserialization:</p>
<pre>
[Serializable]
public class InternalUrl : ISerializable
{
    private string url;

    public InternalUrl(string tmpUrl) // Sensitive
    {
        if(!tmpUrl.StartsWith("http://localhost/")) // there is some input validation
        {
            url= "http://localhost/default";
        }
        else
        {
            url= tmpUrl;
        }
    }

    // special constructor used during deserialization
    protected InternalUrl(SerializationInfo info, StreamingContext context) // Sensitive
    {
       url= (string) info.GetValue("url", typeof(string));
       // the same validation as seen in the regular constructor is not performed
     }

    void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("url", url);
    }
}
</pre>
<p>When a class inherit from <a
href="https://docs.microsoft.com/fr-fr/dotnet/api/system.runtime.serialization.ideserializationcallback?view=netframework-4.8">IDeserializationCallback</a>
type, has a constructor using its parameters in conditions but the <code>IDeserializationCallback.OnDeserialization</code> method doesn’t perform any
conditional checks:</p>
<pre>
[Serializable]
public class InternalUrl : IDeserializationCallback
{
    private string url;

    public InternalUrl(string tmpUrl) // Sensitive
    {
        if(!tmpUrl.StartsWith("http://localhost/")) // there is some input validation
        {
            url= "http://localhost/default";
        }
        else
        {
            url= tmpUrl;
        }
    }

    void IDeserializationCallback.OnDeserialization(object sender) // Sensitive
    {
       // the same validation as seen in the constructor is not performed
    }
}
</pre>
<h2>Compliant Solution</h2>
<p>When using <a href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.iserializable?view=netframework-4.8">ISerializable</a>
type to control deserialization, perform the same checks inside regular constructors than in the special constructor <code>SerializationInfo info,
StreamingContext context</code> used during deserialization:</p>
<pre>
[Serializable]
public class InternalUrl : ISerializable
{
    private string url;

    public InternalUrl(string tmpUrl)
    {
        if(!tmpUrl.StartsWith("http://localhost/")) // there is some input validation
        {
            url= "http://localhost/default";
        }
        else
        {
            url= tmpUrl;
        }
    }

    // special constructor used during deserialization
    protected InternalUrl(SerializationInfo info, StreamingContext context)
    {
       string tmpUrl= (string) info.GetValue("url", typeof(string));

       if(!tmpUrl.StartsWith("http://localhost/") { // Compliant
          url= "http://localhost/default";
       }
       else {
          url= tmpUrl;
       }
     }

    void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)
    {
        info.AddValue("url", url);
    }
}
</pre>
<p>When using <a
href="https://docs.microsoft.com/fr-fr/dotnet/api/system.runtime.serialization.ideserializationcallback?view=netframework-4.8">IDeserializationCallback</a>
type to control deserialization, perform the same checks inside regular constructors than after deserialization with
<code>IDeserializationCallback.OnDeserialization</code> method:</p>
<pre>
[Serializable]
public class InternalUrl : IDeserializationCallback
{
    private string url;

    public InternalUrl(string tmpUrl)
    {
       if(!tmpUrl.StartsWith("http://localhost/")) // there is some input validation
       {
          url= "http://localhost/default";
       }
       else
       {
          url= tmpUrl;
       }
    }

    void IDeserializationCallback.OnDeserialization(object sender) // Compliant
    {
        if(!url.StartsWith("http://localhost/"))
        {
            url= "http://localhost/default";
        }
        else
        {
        }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization">OWASP Top 10 2017 Category A8</a> - Insecure
  Deserialization </li>
  <li> <a href="https://docs.microsoft.com/en-us/dotnet/framework/misc/security-and-serialization">docs.microsoft.com</a> - security-and-serialization
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/502">MITRE, CWE-502</a> - Deserialization of Untrusted Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S2257"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2257">
              csharpsquid:S2257
            </a>
          </td>
          <td >
            <details>
              <p>The use of a non-standard algorithm is dangerous because a determined attacker may be able to break the algorithm and compromise whatever data has
been protected. Standard algorithms like <code>AES</code>, <code>RSA</code>, <code>SHA</code>, …​ should be used instead.</p>
<p>This rule tracks custom implementation of these types from <code>System.Security.Cryptography</code> namespace:</p>
<ul>
  <li> <code>AsymmetricAlgorithm</code> </li>
  <li> <code>AsymmetricKeyExchangeDeformatter</code> </li>
  <li> <code>AsymmetricKeyExchangeFormatter</code> </li>
  <li> <code>AsymmetricSignatureDeformatter</code> </li>
  <li> <code>AsymmetricSignatureFormatter</code> </li>
  <li> <code>DeriveBytes</code> </li>
  <li> <code>HashAlgorithm</code> </li>
  <li> <code>ICryptoTransform</code> </li>
  <li> <code>SymmetricAlgorithm</code> </li>
</ul>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a standard algorithm instead of creating a custom one. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
public class CustomHash : HashAlgorithm // Noncompliant
{
    private byte[] result;

    public override void Initialize() =&gt; result = null;
    protected override byte[] HashFinal() =&gt; result;

    protected override void HashCore(byte[] array, int ibStart, int cbSize) =&gt;
        result ??= array.Take(8).ToArray();
}
</pre>
<h2>Compliant Solution</h2>
<pre>
SHA256 mySHA256 = SHA256.Create()
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#CUSTOM_MESSAGE_DIGEST">MessageDigest is Custom</a>
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S2255"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2255">
              csharpsquid:S2255
            </a>
          </td>
          <td >
            <details>
              <p>Using cookies is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-11639">CVE-2018-11639</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-6537">CVE-2016-6537</a> </li>
</ul>
<p>Attackers can use widely-available tools to read cookies. Any sensitive information they may contain will be exposed.</p>
<p>This rule flags code that writes cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sensitive information is stored inside the cookie. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Cookies should only be used to manage the user session. The best practice is to keep all user-related information server-side and link them to the
user session, never sending them to the client. In a very few corner cases, cookies can be used for non-sensitive information that need to live longer
than the user session.</p>
<p>Do not try to encode sensitive information in a non human-readable format before writing them in a cookie. The encoding can be reverted and the
original information will be exposed.</p>
<p>Using cookies only for session IDs doesn’t make them secure. Follow <a
href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#cookies">OWASP best practices</a> when you configure your
cookies.</p>
<p>As a side note, every information read from a cookie should be <a
href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitized</a>.</p>
<h2>Sensitive Code Example</h2>
<pre>
// === .Net Framework ===

HttpCookie myCookie = new HttpCookie("UserSettings");
myCookie["CreditCardNumber"] = "1234 1234 1234 1234"; // Sensitive; sensitive data stored
myCookie.Values["password"] = "5678"; // Sensitive
myCookie.Value = "mysecret"; // Sensitive
...
Response.Cookies.Add(myCookie);


// === .Net Core ===

Response.Headers.Add("Set-Cookie", ...); // Sensitive
Response.Cookies.Append("mykey", "myValue"); // Sensitive
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/312">MITRE, CWE-312</a> - Cleartext Storage of Sensitive Information </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#COOKIE_USAGE">COOKIE_USAGE</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S4790"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4790">
              csharpsquid:S4790
            </a>
          </td>
          <td >
            <details>
              <p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,
<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,
<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little
computational effort is enough to find two or more different inputs that produce the same hash).</p>
<h2>Ask Yourself Whether</h2>
<p>The hashed value is used in a security context like:</p>
<ul>
  <li> User-password storage. </li>
  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>
  <li> To compute some message integrity. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even
better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>
because it slows down <code>brute force attacks</code>.</p>
<h2>Sensitive Code Example</h2>
<pre>
var hashProvider1 = new MD5CryptoServiceProvider(); // Sensitive
var hashProvider2 = (HashAlgorithm)CryptoConfig.CreateFromName("MD5"); // Sensitive
var hashProvider3 = new SHA1Managed(); // Sensitive
var hashProvider4 = HashAlgorithm.Create("SHA1"); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
var hashProvider1 = new SHA512Managed(); // Compliant
var hashProvider2 = (HashAlgorithm)CryptoConfig.CreateFromName("SHA512Managed"); // Compliant
var hashProvider3 = HashAlgorithm.Create("SHA512Managed"); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1240">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4792"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4792">
              csharpsquid:S4792
            </a>
          </td>
          <td >
            <details>
              <p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285">CVE-2018-0285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127">CVE-2000-1127</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113">CVE-2017-15113</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742">CVE-2015-5742</a> </li>
</ul>
<p>Logs are useful before, during and after a security incident.</p>
<ul>
  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it
  is the first step to prevent an attack from ever happening. </li>
  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>
</ul>
<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information
logged and how they are logged.</p>
<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives
  access to them. </li>
  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>
  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the
  user can perform the action as many times as he/she wants. </li>
  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)
  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>
  <li> the logs are only stored locally instead of being backuped or replicated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Check that your production deployment doesn’t have its loggers in "debug" mode as it might write sensitive information in logs. </li>
  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>
  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the
  hostname. </li>
  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the
  impact is known and limited. </li>
  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the
  service are secure too. </li>
  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control
  the logged information. An attacker could just repeat a logged action many times. </li>
</ul>
<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your
logs:</p>
<ul>
  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user
  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>
  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user
  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example
  use all your storage space or compromise your log indexing service. </li>
  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as
  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>
  <li> Monitor the logs for any suspicious activity. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><strong>.Net Core</strong>: configure programmatically</p>
<pre>
using System;
using System.Collections;
using System.Collections.Generic;
using Microsoft.AspNetCore.Builder;
using Microsoft.AspNetCore.Hosting;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.DependencyInjection;
using Microsoft.Extensions.Logging;
using Microsoft.Extensions.Options;
using Microsoft.AspNetCore;

namespace MvcApp
{
    public class ProgramLogging
    {
        public static IWebHostBuilder CreateWebHostBuilder(string[] args) =&gt;
            WebHost.CreateDefaultBuilder(args)
                .ConfigureLogging((hostingContext, logging) =&gt; // Sensitive
                {
                    // ...
                })
                .UseStartup&lt;StartupLogging&gt;();
    }

    public class StartupLogging
    {
        public void ConfigureServices(IServiceCollection services)
        {
            services.AddLogging(logging =&gt; // Sensitive
            {
                // ...
            });
        }

        public void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory)
        {
            IConfiguration config = null;
            LogLevel level = LogLevel.Critical;
            Boolean includeScopes = false;
            Func&lt;string,Microsoft.Extensions.Logging.LogLevel,bool&gt; filter = null;
            Microsoft.Extensions.Logging.Console.IConsoleLoggerSettings consoleSettings = null;
            Microsoft.Extensions.Logging.AzureAppServices.AzureAppServicesDiagnosticsSettings azureSettings = null;
            Microsoft.Extensions.Logging.EventLog.EventLogSettings eventLogSettings = null;

            // An issue will be raised for each call to an ILoggerFactory extension methods adding loggers.
            loggerFactory.AddAzureWebAppDiagnostics(); // Sensitive
            loggerFactory.AddAzureWebAppDiagnostics(azureSettings); // Sensitive
            loggerFactory.AddConsole(); // Sensitive
            loggerFactory.AddConsole(level); // Sensitive
            loggerFactory.AddConsole(level, includeScopes); // Sensitive
            loggerFactory.AddConsole(filter); // Sensitive
            loggerFactory.AddConsole(filter, includeScopes); // Sensitive
            loggerFactory.AddConsole(config); // Sensitive
            loggerFactory.AddConsole(consoleSettings); // Sensitive
            loggerFactory.AddDebug(); // Sensitive
            loggerFactory.AddDebug(level); // Sensitive
            loggerFactory.AddDebug(filter); // Sensitive
            loggerFactory.AddEventLog(); // Sensitive
            loggerFactory.AddEventLog(eventLogSettings); // Sensitive
            loggerFactory.AddEventLog(level); // Sensitive
            loggerFactory.AddEventSourceLogger(); // Sensitive

            IEnumerable&lt;ILoggerProvider&gt; providers = null;
            LoggerFilterOptions filterOptions1 = null;
            IOptionsMonitor&lt;LoggerFilterOptions&gt; filterOptions2 = null;

            LoggerFactory factory = new LoggerFactory(); // Sensitive
            new LoggerFactory(providers); // Sensitive
            new LoggerFactory(providers, filterOptions1); // Sensitive
            new LoggerFactory(providers, filterOptions2); // Sensitive
        }
    }
}
</pre>
<p><strong>Log4Net</strong></p>
<pre>
using System;
using System.IO;
using System.Xml;
using log4net.Appender;
using log4net.Config;
using log4net.Repository;

namespace Logging
{
    class Log4netLogging
    {
        void Foo(ILoggerRepository repository, XmlElement element, FileInfo configFile, Uri configUri, Stream configStream,
        IAppender appender, params IAppender[] appenders) {
            log4net.Config.XmlConfigurator.Configure(repository); // Sensitive
            log4net.Config.XmlConfigurator.Configure(repository, element); // Sensitive
            log4net.Config.XmlConfigurator.Configure(repository, configFile); // Sensitive
            log4net.Config.XmlConfigurator.Configure(repository, configUri); // Sensitive
            log4net.Config.XmlConfigurator.Configure(repository, configStream); // Sensitive
            log4net.Config.XmlConfigurator.ConfigureAndWatch(repository, configFile); // Sensitive

            log4net.Config.DOMConfigurator.Configure(); // Sensitive
            log4net.Config.DOMConfigurator.Configure(repository); // Sensitive
            log4net.Config.DOMConfigurator.Configure(element); // Sensitive
            log4net.Config.DOMConfigurator.Configure(repository, element); // Sensitive
            log4net.Config.DOMConfigurator.Configure(configFile); // Sensitive
            log4net.Config.DOMConfigurator.Configure(repository, configFile); // Sensitive
            log4net.Config.DOMConfigurator.Configure(configStream); // Sensitive
            log4net.Config.DOMConfigurator.Configure(repository, configStream); // Sensitive
            log4net.Config.DOMConfigurator.ConfigureAndWatch(configFile); // Sensitive
            log4net.Config.DOMConfigurator.ConfigureAndWatch(repository, configFile); // Sensitive

            log4net.Config.BasicConfigurator.Configure(); // Sensitive
            log4net.Config.BasicConfigurator.Configure(appender); // Sensitive
            log4net.Config.BasicConfigurator.Configure(appenders); // Sensitive
            log4net.Config.BasicConfigurator.Configure(repository); // Sensitive
            log4net.Config.BasicConfigurator.Configure(repository, appender); // Sensitive
            log4net.Config.BasicConfigurator.Configure(repository, appenders); // Sensitive
        }
    }
}
</pre>
<p><strong>NLog</strong>: configure programmatically</p>
<pre>
namespace Logging
{
    class NLogLogging
    {
        void Foo(NLog.Config.LoggingConfiguration config) {
            NLog.LogManager.Configuration = config; // Sensitive, this changes the logging configuration.
        }
    }
}
</pre>
<p><strong>Serilog</strong></p>
<pre>
namespace Logging
{
    class SerilogLogging
    {
        void Foo() {
            new Serilog.LoggerConfiguration(); // Sensitive
        }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring">OWASP Top 10 2017 Category A10</a> -
  Insufficient Logging &amp; Monitoring </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/117">MITRE, CWE-117</a> - Improper Output Neutralization for Logs </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/532">MITRE, CWE-532</a> - Information Exposure Through Log Files </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4818"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4818">
              csharpsquid:S4818
            </a>
          </td>
          <td >
            <details>
              <p>Using sockets is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-1785">CVE-2011-178</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-5645">CVE-2017-5645</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-6597">CVE-2018-6597</a> </li>
</ul>
<p>Sockets are vulnerable in multiple ways:</p>
<ul>
  <li> They enable a software to interact with the outside world. As this world is full of attackers it is necessary to check that they cannot receive
  sensitive information or inject dangerous input. </li>
  <li> The number of sockets is limited and can be exhausted. Which makes the application unresponsive to users who need additional sockets. </li>
</ul>
<p>This rules flags code that creates sockets. It matches only the direct use of sockets, not use through frameworks or high-level APIs such as the
use of http connections.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> sockets are created without any limit every time a user performs an action. </li>
  <li> input received from sockets is used without being sanitized. </li>
  <li> sensitive data is sent via sockets without being encrypted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> In many cases there is no need to open a socket yourself. Use instead libraries and existing protocols. </li>
  <li> Encrypt all data sent if it is sensitive. Usually it is better to encrypt it even if the data is not sensitive as it might change later. </li>
  <li> <a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> any input read from the socket. </li>
  <li> Limit the number of sockets a given user can create. Close the sockets as soon as possible. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
using System.Net.Sockets;

class TestSocket
{
    public static void Run()
    {
        // Sensitive
        Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);

        // TcpClient and UdpClient simply abstract the details of creating a Socket
        TcpClient client = new TcpClient("example.com", 80); // Sensitive
        UdpClient listener = new UdpClient(80); // Sensitive
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption ('Resource Exhaustion') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S2612"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2612">
              csharpsquid:S2612
            </a>
          </td>
          <td >
            <details>
              <p>In Unix, "others" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>
<p>In Windows, "Everyone" group is similar and includes all members of the Authenticated Users group as well as the built-in Guest account, and
several other built-in security accounts.</p>
<p>Granting permissions to these groups can lead to unintended access to files.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application is designed to be run on a multi-user environment. </li>
  <li> Corresponding files and directories may contain confidential information. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
<h2>Sensitive Code Example</h2>
<p>.Net Framework:</p>
<pre>
var unsafeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Allow);

var fileSecurity = File.GetAccessControl("path");
fileSecurity.AddAccessRule(unsafeAccessRule); // Sensitive
fileSecurity.SetAccessRule(unsafeAccessRule); // Sensitive
File.SetAccessControl("fileName", fileSecurity);
</pre>
<p>.Net / .Net Core</p>
<pre>
var fileInfo = new FileInfo("path");
var fileSecurity = fileInfo.GetAccessControl();

fileSecurity.AddAccessRule(new FileSystemAccessRule("Everyone", FileSystemRights.Write, AccessControlType.Allow)); // Sensitive
fileInfo.SetAccessControl(fileSecurity);
</pre>
<p>.Net / .Net Core using Mono.Posix.NETStandard</p>
<pre>
var fileSystemEntry = UnixFileSystemInfo.GetFileSystemEntry("path");
fileSystemEntry.FileAccessPermissions = FileAccessPermissions.OtherReadWriteExecute; // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>.Net Framework</p>
<pre>
var safeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Deny);

var fileSecurity = File.GetAccessControl("path");
fileSecurity.AddAccessRule(safeAccessRule);
File.SetAccessControl("path", fileSecurity);
</pre>
<p>.Net / .Net Core</p>
<pre>
var safeAccessRule = new FileSystemAccessRule("Everyone", FileSystemRights.FullControl, AccessControlType.Deny);

var fileInfo = new FileInfo("path");
var fileSecurity = fileInfo.GetAccessControl();
fileSecurity.SetAccessRule(safeAccessRule);
fileInfo.SetAccessControl(fileSecurity);
</pre>
<p>.Net / .Net Core using Mono.Posix.NETStandard</p>
<pre>
var fs = UnixFileSystemInfo.GetFileSystemEntry("path");
fs.FileAccessPermissions = FileAccessPermissions.UserExecute;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission">OWASP File Permission</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S1313">
              csharpsquid:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
var ip = "192.168.12.42";
var address = IPAddress.Parse(ip);
</pre>
<h2>Compliant Solution</h2>
<pre>
var ip = ConfigurationManager.AppSettings["myapplication.ip"];
var address = IPAddress.Parse(ip);
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4823"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4823">
              csharpsquid:S4823
            </a>
          </td>
          <td >
            <details>
              <p>Using command line arguments is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7281">CVE-2018-7281</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12326">CVE-2018-12326</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-3198">CVE-2011-3198</a> </li>
</ul>
<p>Command line arguments can be dangerous just like any other user input. They should never be used without being first validated and sanitized.</p>
<p>Remember also that any user can retrieve the list of processes running on a system, which makes the arguments provided to them visible. Thus
passing sensitive information via command line arguments should be considered as insecure.</p>
<p>This rule raises an issue when on every program entry points (<code>main</code> methods) when command line arguments are used. The goal is to guide
security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> any of the command line arguments are used without being sanitized first. </li>
  <li> your application accepts sensitive information via command line arguments. </li>
</ul>
<p>If you answered yes to any of these questions you are at risk.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all command line arguments before using them.</p>
<p>Any user or application can list running processes and see the command line arguments they were started with. There are safer ways of providing
sensitive information to an application than exposing them in the command line. It is common to write them on the process' standard input, or give the
path to a file containing the information.</p>
<h2>Sensitive Code Example</h2>
<pre>
namespace MyNamespace
{
    class Program
    {
        static void Main(string[] args) // Sensitive if there is a reference to "args" in the method.
        {
            string myarg = args[0];
            // ...
        }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/88">MITRE, CWE-88</a> - Argument Injection or Modification </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/214">MITRE, CWE-214</a> - Information Exposure Through Process Environment </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4829"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4829">
              csharpsquid:S4829
            </a>
          </td>
          <td >
            <details>
              <p>Reading Standard Input is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-2337">CVE-2005-2337</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11449">CVE-2017-11449</a> </li>
</ul>
<p>It is common for attackers to craft inputs enabling them to exploit software vulnerabilities. Thus any data read from the standard input (stdin)
can be dangerous and should be validated.</p>
<p>This rule flags code that reads from the standard input.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> data read from the standard input is not sanitized before being used. </li>
</ul>
<p>You are at risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p><a href="https://www.owasp.org/index.php/Input_Validation_Cheat_Sheet">Sanitize</a> all data read from the standard input before using it.</p>
<h2>Sensitive Code Example</h2>
<pre>
using System;
public class C
{
    public void Main()
    {
        Console.In; // Sensitive
        var code = Console.Read(); // Sensitive
        var keyInfo = Console.ReadKey(...); // Sensitive
        var text = Console.ReadLine(); // Sensitive
        Console.OpenStandardInput(...); // Sensitive
    }
}
</pre>
<h2>Exceptions</h2>
<p>This rule does not raise issues when the return value of the <code>Console.Read</code> <code>Console.ReadKey</code> or
<code>Console.ReadLine</code> methods is ignored.</p>
<pre>
using System;
public class C
{
    public void Main()
    {
        Console.ReadKey(...); // Return value is ignored
        Console.ReadLine(); // Return value is ignored
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S4834"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4834">
              csharpsquid:S4834
            </a>
          </td>
          <td >
            <details>
              <p>The access control of an application must be properly implemented in order to restrict access to resources to authorized entities otherwise this
could lead to vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12999">CVE-2018-12999</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-10285">CVE-2018-10285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7455">CVE-2017-7455</a> </li>
</ul>
<p>Granting correct permissions to users, applications, groups or roles and defining required permissions that allow access to a resource is
sensitive, must therefore be done with care. For instance, it is obvious that only users with administrator privilege should be authorized to
add/remove the administrator permission of another user.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Granted permission to an entity (user, application) allow access to information or functionalities not needed by this entity. </li>
  <li> Privileges are easily acquired (eg: based on the location of the user, type of device used, defined by third parties, does not require approval
  …​). </li>
  <li> Inherited permission, default permission, no privileges (eg: anonymous user) is authorized to access to a protected resource. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>At minimum, an access control system should:</p>
<ul>
  <li> Use a well-defined access control model like <a href="https://en.wikipedia.org/wiki/Role-based_access_control">RBAC</a> or <a
  href="https://en.wikipedia.org/wiki/Access-control_list">ACL</a>. </li>
  <li> Entities' permissions should be reviewed regularly to remove permissions that are no longer needed. </li>
  <li> Respect <a href="https://en.wikipedia.org/wiki/Principle_of_least_privilege">the principle of least privilege</a> ("<em>an entity has access
  only the information and resources that are necessary for its legitimate purpose</em>"). </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
using System.Threading;
using System.Security.Permissions;
using System.Security.Principal;
using System.IdentityModel.Tokens;

class SecurityPrincipalDemo
{
    class MyIdentity : IIdentity // Sensitive, custom IIdentity implementations should be reviewed
    {
        // ...
    }

    class MyPrincipal : IPrincipal // Sensitive, custom IPrincipal implementations should be reviewed
    {
        // ...
    }
    [System.Security.Permissions.PrincipalPermission(SecurityAction.Demand, Role = "Administrators")] // Sensitive. The access restrictions enforced by this attribute should be reviewed.
    static void CheckAdministrator()
    {
        WindowsIdentity MyIdentity = WindowsIdentity.GetCurrent(); // Sensitive
        HttpContext.User = ...; // Sensitive: review all reference (set and get) to System.Web HttpContext.User
        AppDomain domain = AppDomain.CurrentDomain;
        domain.SetPrincipalPolicy(PrincipalPolicy.WindowsPrincipal); // Sensitive
        MyIdentity identity = new MyIdentity(); // Sensitive
        MyPrincipal MyPrincipal = new MyPrincipal(MyIdentity); // Sensitive
        Thread.CurrentPrincipal = MyPrincipal; // Sensitive
        domain.SetThreadPrincipal(MyPrincipal); // Sensitive

        // All instantiation of PrincipalPermission should be reviewed.
        PrincipalPermission principalPerm = new PrincipalPermission(null, "Administrators"); // Sensitive
        principalPerm.Demand();

        SecurityTokenHandler handler = ...;
        // Sensitive: this creates an identity.
        ReadOnlyCollection&lt;ClaimsIdentity&gt; identities = handler.ValidateToken(…);
    }

     // Sensitive: review how this function uses the identity and principal.
    void modifyPrincipal(MyIdentity identity, MyPrincipal principal)
    {
        // ...
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/276">MITRE, CWE-276</a> - Incorrect Default Permissions </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/668">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/277">MITRE, CWE-277</a> - Insecure Inherited Permissions </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5042"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5042">
              csharpsquid:S5042
            </a>
          </td>
          <td >
            <details>
              <p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can
lead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of
uncompressed data. To achieve this extreme <a href="https://en.wikipedia.org/wiki/Data_compression_ratio">compression ratio</a>, attackers will
compress irrelevant data (eg: a long string of repeated bytes).</p>
<h2>Ask Yourself Whether</h2>
<p>Archives to expand are untrusted and:</p>
<ul>
  <li> There is no validation of the number of entries in the archive. </li>
  <li> There is no validation of the total size of the uncompressed data. </li>
  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is
  1 to 3. </li>
  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>
  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in
  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
using var zipToOpen = new FileStream(@"ZipBomb.zip", FileMode.Open);
using var archive = new ZipArchive(zipToOpen, ZipArchiveMode.Read);
foreach (ZipArchiveEntry entry in archive.Entries)
{
  entry.ExtractToFile("./output_onlyfortesting.txt", true); // Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<pre>
int THRESHOLD_ENTRIES = 10000;
int THRESHOLD_SIZE = 1000000000; // 1 GB
double THRESHOLD_RATIO = 10;
int totalSizeArchive = 0;
int totalEntryArchive = 0;

using var zipToOpen = new FileStream(@"ZipBomb.zip", FileMode.Open);
using var archive = new ZipArchive(zipToOpen, ZipArchiveMode.Read);
foreach (ZipArchiveEntry entry in archive.Entries)
{
  totalEntryArchive ++;

  using (Stream st = entry.Open())
  {
    byte[] buffer = new byte[1024];
    int totalSizeEntry = 0;
    int numBytesRead = 0;

    do
    {
      numBytesRead = st.Read(buffer, 0, 1024);
      totalSizeEntry += numBytesRead;
      totalSizeArchive += numBytesRead;
      double compressionRatio = totalSizeEntry / entry.CompressedLength;

      if(compressionRatio &gt; THRESHOLD_RATIO) {
        // ratio between compressed and uncompressed data is highly suspicious, looks like a Zip Bomb Attack
        break;
      }
    }
    while (numBytesRead &gt; 0);
  }

  if(totalSizeArchive &gt; THRESHOLD_SIZE) {
      // the uncompressed data size is too much for the application resource capacity
      break;
  }

  if(totalEntryArchive &gt; THRESHOLD_ENTRIES) {
      // too much entries in this archive, can lead to inodes exhaustion of the system
      break;
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/409">MITRE, CWE-409</a> - Improper Handling of Highly Compressed Data (Data Amplification)
  </li>
  <li> <a href="https://www.bamsoftware.com/hacks/zipbomb/">bamsoftware.com</a> - A better Zip Bomb </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2068">
              csharpsquid:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
string username = "admin";
string password = "Admin123"; // Sensitive
string usernamePassword  = "user=admin&amp;password=Admin123"; // Sensitive
string url = "scheme://user:Admin123@domain.com"; // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
string username = "admin";
string password = GetEncryptedPassword();
string usernamePassword = string.Format("user={0}&amp;password={1}", GetEncryptedUsername(), GetEncryptedPassword());
string url = $"scheme://{username}:{password}@domain.com";

string url2 = "http://guest:guest@domain.com"; // Compliant
const string Password_Property = "custom.password"; // Compliant
</pre>
<h2>Exceptions</h2>
<ul>
  <li> Issue is not raised when URI username and password are the same. </li>
  <li> Issue is not raised when searched pattern is found in variable name and value. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5332">
              csharpsquid:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<pre>
var urlHttp = "http://example.com";                 // Noncompliant
var urlFtp = "ftp://anonymous@example.com";         // Noncompliant
var urlTelnet = "telnet://anonymous@example.com";   // Noncompliant
</pre>
<pre>
using var smtp = new SmtpClient("host", 25); // Noncompliant, EnableSsl is not set
using var telnet = new MyTelnet.Client("host", port); // Noncompliant, rule raises Security Hotspot on any member containing "Telnet"
</pre>
<h2>Compliant Solution</h2>
<pre>
var urlHttps = "https://example.com";
var urlSftp = "sftp://anonymous@example.com";
var urlSsh = "ssh://anonymous@example.com";
</pre>
<pre>
using var smtp = new SmtpClient("host", 25) { EnableSsl = true };
using var ssh = new MySsh.Client("host", port);
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5693"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5693">
              csharpsquid:S5693
            </a>
          </td>
          <td >
            <details>
              <p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in
order to prevents DoS attacks.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> size limits are not defined for the different resources of the web application. </li>
  <li> the web application is not protected by <a href="https://en.wikipedia.org/wiki/Rate_limiting">rate limiting</a> features. </li>
  <li> the web application infrastructure has limited resources. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> For most of the features of an application, it is recommended to limit the size of requests to:
    <ul>
      <li> lower or equal to 8mb for file uploads. </li>
      <li> lower or equal to 2mb for other requests. </li>
    </ul>  </li>
</ul>
<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>
<h2>Sensitive Code Example</h2>
<pre>
using Microsoft.AspNetCore.Mvc;

public class MyController : Controller
{
    [HttpPost]
    [DisableRequestSizeLimit] // Sensitive: No size  limit
    [RequestSizeLimit(10000000)] // Sensitive: 10MB is more than the recommended limit of 8MB
    public IActionResult PostRequest(Model model)
    {
    // ...
    }

    [HttpPost]
    [RequestFormLimits(MultipartBodyLengthLimit = 8000000)] // Sensitive: 10MB is more than the recommended limit of 8MB
    public IActionResult MultipartFormRequest(Model model)
    {
    // ...
    }
}
</pre>
<p>In Web.config:</p>
<pre>
&lt;configuration&gt;
    &lt;system.web&gt;
        &lt;httpRuntime maxRequestLength="81920" executionTimeout="3600" /&gt;
        &lt;!-- Sensitive: maxRequestLength is exprimed in KB, so 81920KB = 80MB  --&gt;
    &lt;/system.web&gt;
    &lt;system.webServer&gt;
        &lt;security&gt;
            &lt;requestFiltering&gt;
                &lt;requestLimits maxAllowedContentLength="83886080" /&gt;
                &lt;!-- Sensitive: maxAllowedContentLength is exprimed in bytes, so 83886080B = 80MB  --&gt;
            &lt;/requestFiltering&gt;
        &lt;/security&gt;
    &lt;/system.webServer&gt;
&lt;/configuration&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
using Microsoft.AspNetCore.Mvc;

public class MyController : Controller
{
    [HttpPost]
    [RequestSizeLimit(8000000)] // Compliant: 8MB
    public IActionResult PostRequest(Model model)
    {
    // ...
    }

    [HttpPost]
    [RequestFormLimits(MultipartBodyLengthLimit = 8000000)] // Compliant: 8MB
    public IActionResult MultipartFormRequest(Model model)
    {
    // ...
    }
}
</pre>
<p>In Web.config:</p>
<pre>
&lt;configuration&gt;
    &lt;system.web&gt;
        &lt;httpRuntime maxRequestLength="8192" executionTimeout="3600" /&gt;
        &lt;!-- Compliant: maxRequestLength is exprimed in KB, so 8192KB = 8MB  --&gt;
    &lt;/system.web&gt;
    &lt;system.webServer&gt;
        &lt;security&gt;
            &lt;requestFiltering&gt;
                &lt;requestLimits maxAllowedContentLength="8388608" /&gt;
                &lt;!-- Comliant: maxAllowedContentLength is exprimed in bytes, so 8388608B = 8MB  --&gt;
            &lt;/requestFiltering&gt;
        &lt;/security&gt;
    &lt;/system.webServer&gt;
&lt;/configuration&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html">Owasp Cheat Sheet</a> - Owasp Denial of Service
  Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/770">MITRE, CWE-770</a> - Allocation of Resources Without Limits or Throttling </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
  <li> <a href="https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/iis/web-config">Web.config</a> - XML-formatted config file for IIS
  applications </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S2077"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2077">
              csharpsquid:S2077
            </a>
          </td>
          <td >
            <details>
              <p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the
query. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=csharpsquid%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted
queries.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some parts of the query come from untrusted values (like user inputs). </li>
  <li> The query is repeated/duplicated in other parts of the code. </li>
  <li> The application must support different types of relational databases. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">parameterized queries, prepared
  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>
  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
public void Foo(DbContext context, string query, string param)
{
    string sensitiveQuery = string.Concat(query, param);
    context.Database.ExecuteSqlCommand(sensitiveQuery); // Sensitive
    context.Query&lt;User&gt;().FromSql(sensitiveQuery); // Sensitive

    context.Database.ExecuteSqlCommand($"SELECT * FROM mytable WHERE mycol={value}", param); // Sensitive, the FormattableString is evaluated and converted to RawSqlString
    string query = $"SELECT * FROM mytable WHERE mycol={param}";
    context.Database.ExecuteSqlCommand(query); // Sensitive, the FormattableString has already been evaluated, it won't be converted to a parametrized query.
}

public void Bar(SqlConnection connection, string param)
{
    SqlCommand command;
    string sensitiveQuery = string.Format("INSERT INTO Users (name) VALUES (\"{0}\")", param);
    command = new SqlCommand(sensitiveQuery); // Sensitive

    command.CommandText = sensitiveQuery; // Sensitive

    SqlDataAdapter adapter;
    adapter = new SqlDataAdapter(sensitiveQuery, connection); // Sensitive
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public void Foo(DbContext context, string query, string param)
{
    context.Database.ExecuteSqlCommand("SELECT * FROM mytable WHERE mycol=@p0", param); // Compliant, it's a parametrized safe query
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/89">MITRE, CWE-89</a> - Improper Neutralization of Special Elements used in an SQL Command
  </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rules <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA">Potential SQL/JPQL Injection
  (JPA)</a>, <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO">Potential SQL/JDOQL Injection (JDO)</a>, <a
  href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE">Potential SQL/HQL Injection (Hibernate)</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5443"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5443">
              csharpsquid:S5443
            </a>
          </td>
          <td >
            <details>
              <p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like
<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious
user can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,
modified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2012-2451">CVE-2012-2451</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2015-1838">CVE-2015-1838</a> </li>
</ul>
<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It
also detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code>, <code>TMPDIR</code> and
<code>TEMP</code>.</p>
<ul>
  <li> <code>/tmp</code> </li>
  <li> <code>/var/tmp</code> </li>
  <li> <code>/usr/tmp</code> </li>
  <li> <code>/dev/shm</code> </li>
  <li> <code>/dev/mqueue</code> </li>
  <li> <code>/run/lock</code> </li>
  <li> <code>/var/run/lock</code> </li>
  <li> <code>/Library/Caches</code> </li>
  <li> <code>/Users/Shared</code> </li>
  <li> <code>/private/tmp</code> </li>
  <li> <code>/private/var/tmp</code> </li>
  <li> <code>\Windows\Temp</code> </li>
  <li> <code>\Temp</code> </li>
  <li> <code>\TMP</code> </li>
  <li> <code>%USERPROFILE%\AppData\Local\Temp</code> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Files are read from or written into a publicly writable folder </li>
  <li> The application creates files with predictable names into a publicly writable folder </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Out of the box, .NET is missing secure-by-design APIs to create temporary files. To overcome this, one of the following options can be used:</p>
<ul>
  <li> Use a dedicated sub-folder with tightly controlled permissions </li>
  <li> Created temporary files in a publicly writable folder and make sure:
    <ul>
      <li> Generated filename is unpredictable </li>
      <li> File is readable and writable only by the creating user ID </li>
      <li> File descriptor is not inherited by child processes </li>
      <li> File is destroyed as soon as it is closed </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
using var writer = new StreamWriter("/tmp/f"); // Sensitive
</pre>
<pre>
var tmp = Environment.GetEnvironmentVariable("TMP"); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
var randomPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName());

// Creates a new file with write, non inheritable permissions which is deleted on close.
using var fileStream = new FileStream(randomPath, FileMode.CreateNew, FileAccess.Write, FileShare.None, 4096, FileOptions.DeleteOnClose);
using var writer = new StreamWriter(fileStream);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S6444"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S6444">
              csharpsquid:S6444
            </a>
          </td>
          <td >
            <details>
              <p>Not specifying a timeout for regular expressions can lead to a Denial-of-Service attack. Pass a timeout when using
<code>System.Text.RegularExpressions</code> to process untrusted input because a malicious user might craft a value for which the evaluation lasts
excessively long.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the input passed to the regular expression is untrusted. </li>
  <li> the regular expression contains patterns vulnerable to <a href="https://www.regular-expressions.info/catastrophic.html">catastrophic
  backtracking</a>. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> It is recommended to specify a <a
  href="https://learn.microsoft.com/dotnet/standard/base-types/best-practices#use-time-out-values"><code>matchTimeout</code></a> when executing a
  regular expression. </li>
  <li> Make sure regular expressions are not vulnerable to Denial-of-Service attacks by reviewing the patterns. </li>
  <li> Consider using a non-backtracking algorithm by specifying <a
  href="https://learn.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions?view=net-7.0"><code>RegexOptions.NonBacktracking</code></a>. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
public void RegexPattern(string input)
{
    var emailPattern = new Regex(".+@.+", RegexOptions.None);
    var isNumber = Regex.IsMatch(input, "[0-9]+");
    var isLetterA = Regex.IsMatch(input, "(a+)+");
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public void RegexPattern(string input)
{
    var emailPattern = new Regex(".+@.+", RegexOptions.None, TimeSpan.FromMilliseconds(100));
    var isNumber = Regex.IsMatch(input, "[0-9]+", RegexOptions.None, TimeSpan.FromMilliseconds(100));
    var isLetterA = Regex.IsMatch(input, "(a+)+", RegexOptions.NonBacktracking); // .Net 7 and above
    AppDomain.CurrentDomain.SetData("REGEX_DEFAULT_MATCH_TIMEOUT", TimeSpan.FromMilliseconds(100)); // process-wide setting
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1333">MITRE, CWE-1333</a> - Inefficient Regular Expression Complexity </li>
  <li> <a href="https://www.regular-expressions.info/catastrophic.html">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic
  Backtracking </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">owasp.org</a> - Regular expression Denial of
  Service - ReDoS </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1333">MITRE, CWE-1333</a> - Inefficient Regular Expression Complexity </li>
  <li> <a href="https://docs.microsoft.com/dotnet/standard/base-types/best-practices">docs.microsoft.com</a> - Best practices for regular expressions
  in .NET </li>
  <li> <a href="https://docs.microsoft.com/dotnet/standard/base-types/backtracking-in-regular-expressions">docs.microsoft.com</a> - Backtracking in
  Regular Expressions </li>
  <li> <a
  href="https://devblogs.microsoft.com/dotnet/regular-expression-improvements-in-dotnet-7/#backtracking-and-regexoptions-nonbacktracking">devblogs.microsoft.com</a> - Regular Expression Improvements in .NET 7: Backtracking (and RegexOptions.NonBacktracking) </li>
  <li> <a href="https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regex.matchtimeout">docs.microsoft.com</a> - Regex.MatchTimeout
  Property </li>
  <li> <a href="https://docs.microsoft.com/dotnet/api/system.text.regularexpressions.regexoptions?view=net-7.0">docs.microsoft.com</a> - RegexOptions
  Enum (NonBacktracking option) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4036"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4036">
              csharpsquid:S4036
            </a>
          </td>
          <td >
            <details>
              <p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>
environment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in
<code>PATH</code> is a directory under his control.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>
<h2>Sensitive Code Example</h2>
<pre>
Process p = new Process();
p.StartInfo.FileName = "binary"; // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
Process p = new Process();
p.StartInfo.FileName = @"C:\Apps\binary.exe"; // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/426">MITRE, CWE-426</a> - Untrusted Search Path </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/427">MITRE, CWE-427</a> - Uncontrolled Search Path Element </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5122"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5122">
              csharpsquid:S5122
            </a>
          </td>
          <td >
            <details>
              <p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269">CVE-2018-0269</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460">CVE-2017-14460</a> </li>
</ul>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same origin policy</a> in browsers prevents, by default and for
security-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)
from its own. The requested target can append additional HTTP headers in response, called <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>, that act like directives for the browser and change the access control policy
/ relax the same origin policy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>
  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>
  <li> Your access control policy is dynamically defined by a user-controlled input like <a
  href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin"><code>origin</code></a> header. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>
  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or
  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>ASP.NET Core MVC:</p>
<pre>
[HttpGet]
public string Get()
{
    Response.Headers.Add("Access-Control-Allow-Origin", "*"); // Sensitive
    Response.Headers.Add(HeaderNames.AccessControlAllowOrigin, "*"); // Sensitive
}
</pre>
<pre>
public void ConfigureServices(IServiceCollection services)
{
    services.AddCors(options =&gt;
    {
        options.AddDefaultPolicy(builder =&gt;
        {
            builder.WithOrigins("*"); // Sensitive
        });

        options.AddPolicy(name: "EnableAllPolicy", builder =&gt;
        {
            builder.WithOrigins("*"); // Sensitive
        });

        options.AddPolicy(name: "OtherPolicy", builder =&gt;
        {
            builder.AllowAnyOrigin(); // Sensitive
        });
    });

    services.AddControllers();
}
</pre>
<p>ASP.NET MVC:</p>
<pre>
public class HomeController : ApiController
{
    public HttpResponseMessage Get()
    {
        var response = HttpContext.Current.Response;

        response.Headers.Add("Access-Control-Allow-Origin", "*"); // Sensitive
        response.Headers.Add(HeaderNames.AccessControlAllowOrigin, "*"); // Sensitive
        response.AppendHeader(HeaderNames.AccessControlAllowOrigin, "*"); // Sensitive
    }
}
</pre>
<pre>
[EnableCors(origins: "*", headers: "*", methods: "GET")] // Sensitive
public HttpResponseMessage Get() =&gt; new HttpResponseMessage()
{
    Content = new StringContent("content")
};
</pre>
<p>User-controlled origin:</p>
<pre>
String origin = Request.Headers["Origin"];
Response.Headers.Add("Access-Control-Allow-Origin", origin); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>ASP.NET Core MVC:</p>
<pre>
[HttpGet]
public string Get()
{
    Response.Headers.Add("Access-Control-Allow-Origin", "https://trustedwebsite.com"); // Safe
    Response.Headers.Add(HeaderNames.AccessControlAllowOrigin, "https://trustedwebsite.com"); // Safe
}
</pre>
<pre>
public void ConfigureServices(IServiceCollection services)
{
    services.AddCors(options =&gt;
    {
        options.AddDefaultPolicy(builder =&gt;
        {
            builder.WithOrigins("https://trustedwebsite.com", "https://anothertrustedwebsite.com"); // Safe
        });

        options.AddPolicy(name: "EnableAllPolicy", builder =&gt;
        {
            builder.WithOrigins("https://trustedwebsite.com"); // Safe
        });
    });

    services.AddControllers();
}
</pre>
<p>ASP.Net MVC:</p>
<pre>
public class HomeController : ApiController
{
    public HttpResponseMessage Get()
    {
        var response = HttpContext.Current.Response;

        response.Headers.Add("Access-Control-Allow-Origin", "https://trustedwebsite.com");
        response.Headers.Add(HeaderNames.AccessControlAllowOrigin, "https://trustedwebsite.com");
        response.AppendHeader(HeaderNames.AccessControlAllowOrigin, "https://trustedwebsite.com");
    }
}
</pre>
<pre>
[EnableCors(origins: "https://trustedwebsite.com", headers: "*", methods: "GET")]
public HttpResponseMessage Get() =&gt; new HttpResponseMessage()
{
    Content = new StringContent("content")
};
</pre>
<p>User-controlled origin validated with an allow-list:</p>
<pre>
String origin = Request.Headers["Origin"];

if (trustedOrigins.Contains(origin))
{
    Response.Headers.Add("Access-Control-Allow-Origin", origin);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">developer.mozilla.org</a> - CORS </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">developer.mozilla.org</a> - Same origin policy </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing">OWASP HTML5 Security
  Cheat Sheet</a> - Cross Origin Resource Sharing </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/346">MITRE, CWE-346</a> - Origin Validation Error </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/942">MITRE, CWE-942</a> - Overly Permissive Cross-domain Whitelist </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S2092"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2092">
              csharpsquid:S2092
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP
request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>
  <li> it’s not sure that the website contains <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">mixed content</a> or not
  (ie HTTPS everywhere or not) </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour
  when creating cookies. </li>
  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>When the <code>HttpCookie.Secure</code> property is set to <code>false</code> then the cookie will be send during an unencrypted HTTP request:</p>
<pre>
HttpCookie myCookie = new HttpCookie("Sensitive cookie");
myCookie.Secure = false; //  Sensitive: a security-sensitive cookie is created with the secure flag set to false
</pre>
<p>The <a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.httpcookie.secure?view=netframework-4.8">default value</a> of
<code>Secure</code> flag is <code>false</code>, unless overwritten by an application’s configuration file:</p>
<pre>
HttpCookie myCookie = new HttpCookie("Sensitive cookie");
//  Sensitive: a security-sensitive cookie is created with the secure flag not defined (by default set to false)
</pre>
<h2>Compliant Solution</h2>
<p>Set the <code>HttpCookie.Secure</code> property to <code>true</code>:</p>
<pre>
HttpCookie myCookie = new HttpCookie("Sensitive cookie");
myCookie.Secure = true; // Compliant
</pre>
<p>Or change the default flag values for the whole application by editing the <a
href="https://docs.microsoft.com/en-us/previous-versions/dotnet/netframework-4.0/ms228262(v=vs.100)">Web.config configuration file</a>:</p>
<pre>
&lt;httpCookies httpOnlyCookies="true" requireSSL="true" /&gt;
</pre>
<ul>
  <li> the <code>requireSSL</code> attribute corresponds programmatically to the <code>Secure</code> field. </li>
  <li> the <code>httpOnlyCookies</code> attribute corresponds programmatically to the <code>httpOnly</code> field. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/614">MITRE, CWE-614</a> - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="xml:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S2068">
              xml:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, credentials should not be hard-coded. This is particularly true
for applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Credentials should be stored outside of the code in a configuration file, a database, or a management service for secrets.</p>
<p>This rule flags instances of hard-coded credentials used in database and LDAP connections. It looks for hard-coded credentials in connection
strings, and for variable names that match any of the patterns from the provided list.</p>
<p>It’s recommended to customize the configuration of this rule with additional credential words such as "oauthToken", "secret", …​</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Credentials allow access to a sensitive component like a database, a file storage, an API or a service. </li>
  <li> Credentials are used in production environments. </li>
  <li> Application re-distribution is required before updating the credentials. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://docs.spring.io/spring-social-twitter/docs/1.1.0.RELEASE/reference/htmlsingle/">Spring-social-twitter</a> secrets can be stored
inside a xml file:</p>
<pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;

    &lt;bean id="connectionFactoryLocator" class="org.springframework.social.connect.support.ConnectionFactoryRegistry"&gt;
      &lt;property name="connectionFactories"&gt;
          &lt;list&gt;
              &lt;bean class="org.springframework.social.twitter.connect.TwitterConnectionFactory"&gt;
                  &lt;constructor-arg value="username" /&gt;
                  &lt;constructor-arg value="very-secret-password" /&gt;   &lt;!-- Sensitive --&gt;
              &lt;/bean&gt;
          &lt;/list&gt;
      &lt;/property&gt;
  &lt;/bean&gt;
&lt;/beans&gt;
</pre>
<h2>Compliant Solution</h2>
<p>In <a href="https://docs.spring.io/spring-social-twitter/docs/1.1.0.RELEASE/reference/htmlsingle/">spring social twitter</a>, retrieve secrets from
environment variables:</p>
<pre>
@Configuration
public class SocialConfig implements SocialConfigurer {

    @Override
    public void addConnectionFactories(ConnectionFactoryConfigurer cfConfig, Environment env) {
        cfConfig.addConnectionFactory(new TwitterConnectionFactory(
            env.getProperty("twitter.consumerKey"),
            env.getProperty("twitter.consumerSecret")));  &lt;!-- Compliant --&gt;
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="xml:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S5332">
              xml:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<pre>
&lt;application
    android:usesCleartextTraffic="true"&gt; &lt;!-- Sensitive --&gt;
&lt;/application&gt;
</pre>
<p>For versions older than Android 9 (API level 28) <code>android:usesCleartextTraffic</code> is implicitely set to <code>true</code>.</p>
<pre>
&lt;application&gt; &lt;!-- Sensitive --&gt;
&lt;/application&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;application
    android:usesCleartextTraffic="false"&gt;
&lt;/application&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="xml:S3330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S3330">
              xml:S3330
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will
be able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer
to decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target
the theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS
vulnerability to steal session-cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>
  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)
  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /
  sensitive-security cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
&lt;session-config&gt;
 &lt;cookie-config&gt;
  &lt;http-only&gt;false&lt;/http-only&gt; &lt;!-- Sensitive --&gt;
 &lt;/cookie-config&gt;
&lt;/session-config&gt;

&lt;session-config&gt;
 &lt;cookie-config&gt; &lt;!-- Sensitive: http-only tag is missing defaulting to false --&gt;
 &lt;/cookie-config&gt;
&lt;/session-config&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;session-config&gt;
 &lt;cookie-config&gt;
  &lt;http-only&gt;true&lt;/http-only&gt; &lt;!-- Compliant --&gt;
 &lt;/cookie-config&gt;
&lt;/session-config&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/HttpOnly">OWASP HttpOnly</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1004">MITRE, CWE-1004</a> - Sensitive Cookie Without 'HttpOnly' Flag </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE">HTTPONLY_COOKIE</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="xml:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S4507">
              xml:S4507
            </a>
          </td>
          <td >
            <details>
              <p>In the application manifest element of an android application, setting <code><a
href="https://developer.android.com/guide/topics/manifest/application-element#debug">debuggable</a></code> property to <code>true</code> could
introduce a security risk.</p>
<p>It’s more easy to perform reverse engineering and inject arbitrary code in the context of a debuggable application.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the development of the app is completed and the <code>debuggable</code> property is set to <em>true</em> </li>
  <li> the app will be published on the Play Store or distributed in any other ways and the <code>debuggable</code> property is set to <em>true</em>
  </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is not recommended to release debuggable application. Avoid hardcoding the debug mode in the manifest because the build tool will add the
property automatically and assign the correct value depending on the build type.</p>
<h2>Sensitive Code Example</h2>
<p>In <code>AndroidManifest.xml</code> the android debuggable property is set to <code>true</code>:</p>
<pre>
&lt;application
  android:icon="@mipmap/ic_launcher"
  android:label="@string/app_name"
  android:roundIcon="@mipmap/ic_launcher_round"
  android:supportsRtl="true"
  android:debuggable="true"
  android:theme="@style/AppTheme"&gt;
&lt;/application&gt;  &lt;!-- Sensitive --&gt;
</pre>
<h2>Compliant Solution</h2>
<p>In <code>AndroidManifest.xml</code> the android debuggable property is set to <code>false</code>:</p>
<pre>
&lt;application
  android:icon="@mipmap/ic_launcher"
  android:label="@string/app_name"
  android:roundIcon="@mipmap/ic_launcher_round"
  android:supportsRtl="true"
  android:debuggable="false"
  android:theme="@style/AppTheme"&gt;
&lt;/application&gt; &lt;!-- Compliant --&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x12-v7-code_quality_and_build_setting_requirements">Mobile AppSec
  Verification Standard</a> - Code Quality and Build Setting Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m10-extraneous-functionality">OWASP Mobile Top 10 2016 Category M10</a> -
  Extraneous Functionality </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
  <li> <a href="https://developer.android.com/studio/publish/preparing">developer.android.com</a> - Prepare for release </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="xml:S6361"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S6361">
              xml:S6361
            </a>
          </td>
          <td >
            <details>
              <p><code>android:permission</code> is used to set a single permission for both reading and writing data from a content provider. In regard to the
Principle of Least Privilege, client applications that consume the content provider should only have the necessary privileges to complete their tasks.
As <code>android:permission</code> grants both read and write access, it prevents client applications from applying this principle. In practice, it
means client applications that require read-only access will have to ask for more privileges than what they need: the content provider will always
grant read and write together.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some client applications consuming the content provider may only require read permission. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Avoid using <code>android:permission</code> attribute alone. Instead <code>android:readPermission</code> and
  <code>android:writePermission</code> attributes to define separate read and write permissions. </li>
  <li> Avoid using the same permission for <code>android:readPermission</code> and <code>android:writePermission</code> attributes. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:permission="com.example.app.PERMISSION"  &lt;!-- Sensitive --&gt;
  android:exported="true"/&gt;
</pre>
<pre>
&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:readPermission="com.example.app.PERMISSION"  &lt;!-- Sensitive --&gt;
  android:writePermission="com.example.app.PERMISSION" &lt;!-- Sensitive --&gt;
  android:exported="true"/&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;provider
  android:authorities="com.example.app.MyProvider"
  android:name="com.example.app.MyProvider"
  android:readPermission="com.example.app.READ_PERMISSION"
  android:writePermission="com.example.app.WRITE_PERMISSION"
  android:exported="true"/&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://developer.android.com/guide/topics/providers/content-provider-creating#Permissions">developer.android.com</a> - Implementing
  content provider permissions </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  platform usage </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m6-insecure-authorization">OWASP Mobile Top 10 2016 Category M6</a> - Insecure
  Authorization </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1220">MITRE, CWE-1220</a> - Insufficient Granularity of Access Control </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="xml:S5322"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S5322">
              xml:S5322
            </a>
          </td>
          <td >
            <details>
              <p>Android applications can receive broadcasts from the system or other applications. Receiving intents is security-sensitive. For example, it has led
in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-1677">CVE-2019-1677</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1275">CVE-2015-1275</a> </li>
</ul>
<p>Receivers can be declared in the manifest or in the code to make them context-specific. If the receiver is declared in the manifest Android will
start the application if it is not already running once a matching broadcast is received. The receiver is an entry point into the application.</p>
<p>Other applications can send potentially malicious broadcasts, so it is important to consider broadcasts as untrusted and to limit the applications
that can send broadcasts to the receiver.</p>
<p>Permissions can be specified to restrict broadcasts to authorized applications. Restrictions can be enforced by both the sender and receiver of a
broadcast. If permissions are specified when registering a broadcast receiver, then only broadcasters who were granted this permission can send a
message to the receiver.</p>
<p>This rule raises an issue when a receiver is registered without specifying any broadcast permission.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The data extracted from intents is not sanitized. </li>
  <li> Intents broadcast is not restricted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Restrict the access to broadcasted intents. See the <a
href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> for more
information.</p>
<h2>Sensitive Code Example</h2>
<pre>
&lt;receiver android:name=".MyBroadcastReceiver" android:exported="true"&gt;  &lt;!-- Sensitive --&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="android.intent.action.AIRPLANE_MODE"/&gt;
    &lt;/intent-filter&gt;
&lt;/receiver&gt;
</pre>
<h2>Compliant Solution</h2>
<p>Enforce permissions:</p>
<pre>
&lt;receiver android:name=".MyBroadcastReceiver"
    android:permission="android.permission.SEND_SMS"
    android:exported="true"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="android.intent.action.AIRPLANE_MODE"/&gt;
    &lt;/intent-filter&gt;
&lt;/receiver&gt;
</pre>
<p>Do not export the receiver and only receive system intents:</p>
<pre>
&lt;receiver android:name=".MyBroadcastReceiver" android:exported="false"&gt;
    &lt;intent-filter&gt;
        &lt;action android:name="android.intent.action.AIRPLANE_MODE"/&gt;
    &lt;/intent-filter&gt;
&lt;/receiver&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  Platform Usage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/925">MITRE, CWE-925</a> - Improper Verification of Intent by Broadcast Receiver </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/926">MITRE, CWE-926</a> - Improper Export of Android Application Components </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> <a href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> -
  Broadcast Overview - Security considerations and best practices </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="xml:S5604"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S5604">
              xml:S5604
            </a>
          </td>
          <td >
            <details>
              <p>Permissions that can have a large impact on user privacy, marked as <a
href="https://developer.android.com/reference/android/Manifest.permission">dangerous or "not for use by third-party applications" by Android</a>,
should be requested only if they are really necessary to implement critical features of an application.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> It is not sure that <code>dangerous</code> permissions requested by the application are <a
  href="https://developer.android.com/training/permissions/usage-notes#avoid_requesting_unnecessary_permissions">really necessary</a>. </li>
  <li> The users are not <a href="https://developer.android.com/training/permissions/usage-notes#be_transparent">clearly informed</a> why and when
  dangerous permissions are requested by the application. </li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to carefully review all the permissions and to use <code>dangerous</code> ones only if they are really necessary.</p>
<h2>Sensitive Code Example</h2>
<p>In AndroidManifest.xml:</p>
<pre>
&lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /&gt; &lt;!-- Sensitive --&gt;
&lt;uses-permission android:name="android.permission.ACCESS_MEDIA_LOCATION" /&gt; &lt;!-- Sensitive --&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt; &lt;!-- Compliant --&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  Platform Usage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/250">MITRE, CWE-250</a> - Execution with Unnecessary Privileges </li>
  <li> <a href="https://developer.android.com/training/permissions/usage-notes">developer.android.com</a> - App permissions best practices </li>
  <li> <a href="https://play.google.com/about/privacy-security-deception/permissions/">Google Play</a> - Privacy, Security, and Deception -
  Permissions </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="xml:S6358"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S6358">
              xml:S6358
            </a>
          </td>
          <td >
            <details>
              <p>Android has a built-in backup mechanism that can save and restore application data. When application backup is enabled, local data from your
application can be exported to Google Cloud or to an external device via <code>adb backup</code>. Enabling Android backup exposes your application to
disclosure of sensitive data. It can also lead to corruption of local data when restoration is performed from an untrusted source.</p>
<p>By default application backup is enabled and it includes:</p>
<ul>
  <li> Shared preferences files </li>
  <li> Files saved in one of the paths returned by
    <ul>
      <li> <a href="https://developer.android.com/reference/android/content/Context#getDatabasePath(java.lang.String)">getDatabasePath(String)</a>
      </li>
      <li> <a href="https://developer.android.com/reference/android/content/Context#getFilesDir()">getFilesDir()</a> </li>
      <li> <a href="https://developer.android.com/reference/android/content/Context#getDir(java.lang.String,%20int)">getDir(String, int)</a> </li>
      <li> <a
      href="https://developer.android.com/reference/android/content/Context#getExternalFilesDir(java.lang.String)">getExternalFilesDir(String)</a>
      </li>
    </ul>  </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application backup is enabled and sensitive data is stored in local files, local databases, or shared preferences. </li>
  <li> Your application never validates data from files that are included in backups. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Disable application backup unless it is required for your application to work properly. </li>
  <li> Narrow the scope of backed-up files by using either
    <ul>
      <li> backup rules (see <code>android:fullBackupContent</code> attribute). </li>
      <li> a custom <code>BackupAgent</code>. </li>
      <li> the dedicated <code>no_backup</code> folder (see <code>android.content.Context#getNoBackupFilesDir()</code>). </li>
    </ul>  </li>
  <li> Do not back up local data containing sensitive information unless they are properly encrypted. </li>
  <li> Make sure that the keys used to encrypt backup data are not included in the backup. </li>
  <li> Validate data from backed-up files. They should be considered untrusted as they could have been restored from an untrusted source. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
&lt;application
    android:allowBackup="true"&gt; &lt;!-- Sensitive --&gt;
&lt;/application&gt;
</pre>
<h2>Compliant Solution</h2>
<p>Disable application backup.</p>
<pre>
&lt;application
    android:allowBackup="false"&gt;
&lt;/application&gt;
</pre>
<p>If targeting Android 6.0 or above (API level 23), define files to include/exclude from the application backup.</p>
<pre>
&lt;application
    android:allowBackup="true"
    android:fullBackupContent="@xml/backup.xml"&gt;
&lt;/application&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://developer.android.com/guide/topics/data/autobackup">Back up user data with Auto Backup</a> </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  platform usage </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/312">MITRE, CWE-922</a> - Insecure Storage of Sensitive Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="xml:S5122"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S5122">
              xml:S5122
            </a>
          </td>
          <td >
            <details>
              <p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269">CVE-2018-0269</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460">CVE-2017-14460</a> </li>
</ul>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same origin policy</a> in browsers prevents, by default and for
security-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)
from its own. The requested target can append additional HTTP headers in response, called <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>, that act like directives for the browser and change the access control policy
/ relax the same origin policy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>
  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>
  <li> Your access control policy is dynamically defined by a user-controlled input like <a
  href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin"><code>origin</code></a> header. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>
  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or
  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
&lt;!-- Tomcat 7+ Cors Filter --&gt;
&lt;filter&gt;
  &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;
  &lt;filter-class&gt;org.apache.catalina.filters.CorsFilter&lt;/filter-class&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;cors.allowed.origins&lt;/param-name&gt;
    &lt;param-value&gt;*&lt;/param-value&gt; &lt;!-- Sensitive --&gt;
  &lt;/init-param&gt;
&lt;/filter&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;!-- Tomcat 7+ Cors Filter --&gt;
&lt;filter&gt;
  &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;
  &lt;filter-class&gt;org.apache.catalina.filters.CorsFilter&lt;/filter-class&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;cors.allowed.origins&lt;/param-name&gt;
    &lt;param-value&gt;https://trusted1.org,https://trusted2.org&lt;/param-value&gt; &lt;!-- Compliant --&gt;
  &lt;/init-param&gt;
&lt;/filter&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">developer.mozilla.org</a> - CORS </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">developer.mozilla.org</a> - Same origin policy </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing">OWASP HTML5 Security
  Cheat Sheet</a> - Cross Origin Resource Sharing </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/346">MITRE, CWE-346</a> - Origin Validation Error </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/942">MITRE, CWE-942</a> - Overly Permissive Cross-domain Whitelist </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5852"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5852">
              java:S5852
            </a>
          </td>
          <td >
            <details>
              <p>Most of the regular expression engines use <code>backtracking</code> to try all possible execution paths of the regular expression when evaluating
an input, in some cases it can cause performance issues, called <code>catastrophic backtracking</code> situations. In the worst case, the complexity
of the regular expression is exponential in the size of the input, this means that a small carefully-crafted input (like 20 chars) can trigger
<code>catastrophic backtracking</code> and cause a denial of service of the application. Super-linear regex complexity can lead to the same impact too
with, in this case, a large carefully-crafted input (thousands chars).</p>
<p>This rule determines the runtime complexity of a regular expression and informs you of the complexity if it is not linear.</p>
<p>Note that, due to improvements to the matching algorithm, some cases of exponential runtime complexity have become impossible when run using JDK 9
or later. In such cases, an issue will only be reported if the project’s target Java version is 8 or earlier.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The input is user-controlled. </li>
  <li> The input size is not restricted to a small number of characters. </li>
  <li> There is no timeout in place to limit the regex evaluation time. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>To avoid <code>catastrophic backtracking</code> situations, make sure that none of the following conditions apply to your regular expression.</p>
<p>In all of the following cases, catastrophic backtracking can only happen if the problematic part of the regex is followed by a pattern that can
fail, causing the backtracking to actually happen. Note that when performing a full match (e.g. using <code>String.matches</code>), the end of the
regex counts as a pattern that can fail because it will only succeed when the end of the string is reached.</p>
<ul>
  <li> If you have a non-possessive repetition <code>r*</code> or <code>r*?</code>, such that the regex <code>r</code> could produce different
  possible matches (of possibly different lengths) on the same input, the worst case matching time can be exponential. This can be the case if
  <code>r</code> contains optional parts, alternations or additional repetitions (but not if the repetition is written in such a way that there’s only
  one way to match it).
    <ul>
      <li> When using JDK 9 or later an optimization applies when the repetition is greedy and the entire regex does not contain any back references.
      In that case the runtime will only be polynomial (in case of nested repetitions) or even linear (in case of alternations or optional parts).
      </li>
    </ul>  </li>
  <li> If you have multiple non-possessive repetitions that can match the same contents and are consecutive or are only separated by an optional
  separator or a separator that can be matched by both of the repetitions, the worst case matching time can be polynomial (O(n^c) where c is the
  number of problematic repetitions). For example <code>a*b*</code> is not a problem because <code>a*</code> and <code>b*</code> match different
  things and <code>a*_a*</code> is not a problem because the repetitions are separated by a <code>'_'</code> and can’t match that <code>'_'</code>.
  However, <code>a*a*</code> and <code>.*_.*</code> have quadratic runtime. </li>
  <li> If you’re performing a partial match (such as by using <code>Matcher.find</code>, <code>String.split</code>, <code>String.replaceAll</code>
  etc.) and the regex is not anchored to the beginning of the string, quadratic runtime is especially hard to avoid because whenever a match fails,
  the regex engine will try again starting at the next index. This means that any unbounded repetition (even a possessive one), if it’s followed by a
  pattern that can fail, can cause quadratic runtime on some inputs. For example <code>str.split("\\s*,")</code> will run in quadratic time on strings
  that consist entirely of spaces (or at least contain large sequences of spaces, not followed by a comma). </li>
</ul>
<p>In order to rewrite your regular expression without these patterns, consider the following strategies:</p>
<ul>
  <li> If applicable, define a maximum number of expected repetitions using the bounded quantifiers, like <code>{1,5}</code> instead of <code>+</code>
  for instance. </li>
  <li> Refactor <code>nested quantifiers</code> to limit the number of way the inner group can be matched by the outer quantifier, for instance this
  nested quantifier situation <code>(ba+)+</code> doesn’t cause performance issues, indeed, the inner group can be matched only if there exists
  exactly one <code>b</code> char per repetition of the group. </li>
  <li> Optimize regular expressions with <code>possessive quantifiers</code> and <code>atomic grouping</code>. </li>
  <li> Use negated character classes instead of <code>.</code> to exclude separators where applicable. For example the quadratic regex
  <code>.*_.*</code> can be made linear by changing it to <code>[^_]*_.*</code> </li>
</ul>
<p>Sometimes it’s not possible to rewrite the regex to be linear while still matching what you want it to match. Especially when using partial
matches, for which it is quite hard to avoid quadratic runtimes. In those cases consider the following approaches:</p>
<ul>
  <li> Solve the problem without regular expressions </li>
  <li> Use an alternative non-backtracking regex implementations such as Google’s <a href="https://github.com/google/re2">RE2</a> or <a
  href="https://github.com/google/re2j">RE2/J</a>. </li>
  <li> Use multiple passes. This could mean pre- and/or post-processing the string manually before/after applying the regular expression to it or
  using multiple regular expressions. One example of this would be to replace <code>str.split("\\s*,\\s*")</code> with <code>str.split(",")</code> and
  then trimming the spaces from the strings as a second step. </li>
  <li> When using <code>Matcher.find()</code>, it is often possible to make the regex infallible by making all the parts that could fail optional,
  which will prevent backtracking. Of course this means that you’ll accept more strings than intended, but this can be handled by using capturing
  groups to check whether the optional parts were matched or not and then ignoring the match if they weren’t. For example the regex <code>x*y</code>
  could be replaced with <code>x*(y)?</code> and then the call to <code>matcher.find()</code> could be replaced with <code>matcher.find() &amp;&amp;
  matcher.group(1) != null</code>. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>The first regex evaluation will never end in <code>JDK</code> &lt;= 9 and the second regex evaluation will never end in any versions of the
<code>JDK</code>:</p>
<pre>
java.util.regex.Pattern.compile("(a+)+").matcher(
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaa!").matches(); // Sensitive

java.util.regex.Pattern.compile("(h|h|ih(((i|a|c|c|a|i|i|j|b|a|i|b|a|a|j))+h)ahbfhba|c|i)*").matcher(
"hchcchicihcchciiicichhcichcihcchiihichiciiiihhcchi"+
"cchhcihchcihiihciichhccciccichcichiihcchcihhicchcciicchcccihiiihhihihihi"+
"chicihhcciccchihhhcchichchciihiicihciihcccciciccicciiiiiiiiicihhhiiiihchccch"+
"chhhhiiihchihcccchhhiiiiiiiicicichicihcciciihichhhhchihciiihhiccccccciciihh"+
"ichiccchhicchicihihccichicciihcichccihhiciccccccccichhhhihihhcchchihih"+
"iihhihihihicichihiiiihhhhihhhchhichiicihhiiiiihchccccchichci").matches(); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Possessive quantifiers do not keep backtracking positions, thus can be used, if possible, to avoid performance issues:</p>
<pre>
java.util.regex.Pattern.compile("(a+)++").matcher(
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"+
"aaaaaaaaaaaaaaa!").matches(); // Compliant

java.util.regex.Pattern.compile("(h|h|ih(((i|a|c|c|a|i|i|j|b|a|i|b|a|a|j))+h)ahbfhba|c|i)*+").matcher(
"hchcchicihcchciiicichhcichcihcchiihichiciiiihhcchi"+
"cchhcihchcihiihciichhccciccichcichiihcchcihhicchcciicchcccihiiihhihihihi"+
"chicihhcciccchihhhcchichchciihiicihciihcccciciccicciiiiiiiiicihhhiiiihchccch"+
"chhhhiiihchihcccchhhiiiiiiiicicichicihcciciihichhhhchihciiihhiccccccciciihh"+
"ichiccchhicchicihihccichicciihcichccihhiciccccccccichhhhihihhcchchihih"+
"iihhihihihicichihiiiihhhhihhhchhichiicihhiiiiihchccccchichci").matches(); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1333">MITRE, CWE-1333</a> - Inefficient Regular Expression Complexity </li>
  <li> <a href="https://owasp.org/www-community/attacks/Regular_expression_Denial_of_Service_-_ReDoS">owasp.org</a> - OWASP Regular expression Denial
  of Service - ReDoS </li>
  <li> <a
  href="https://web.archive.org/web/20220506215733/https://stackstatus.net/post/147710624694/outage-postmortem-july-20-2016">stackstatus.net(archived)</a> - Outage Postmortem - July 20, 2016 </li>
  <li> <a href="https://www.regular-expressions.info/catastrophic.html">regular-expressions.info</a> - Runaway Regular Expressions: Catastrophic
  Backtracking </li>
  <li> <a
  href="https://docs.microsoft.com/en-us/dotnet/standard/base-types/backtracking-in-regular-expressions#backtracking-with-nested-optional-quantifiers">docs.microsoft.com</a> - Backtracking with Nested Optional Quantifiers </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="java:S4502"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4502">
              java:S4502
            </a>
          </td>
          <td >
            <details>
              <p>A cross-site request forgery (CSRF) attack occurs when a trusted user of a web application can be forced, by an attacker, to perform sensitive
actions that he didn’t intend, such as updating his profile or sending a message, more generally anything that can change the state of the
application.</p>
<p>The attacker can trick the user/victim to click on a link, corresponding to the privileged action, or to visit a malicious web site that embeds a
hidden web request and as web browsers automatically include cookies, the actions can be authenticated and sensitive.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The web application uses cookies to authenticate users. </li>
  <li> There exist sensitive operations in the web application that can be performed when the user is authenticated. </li>
  <li> The state / resources of the web application can be modified by doing HTTP POST or HTTP DELETE requests for example. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Protection against CSRF attacks is strongly recommended:
    <ul>
      <li> to be activated by default for all <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">unsafe HTTP
      methods</a>. </li>
      <li> implemented, for example, with an unguessable CSRF token </li>
    </ul>  </li>
  <li> Of course all sensitive operations should not be performed with <a
  href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Safe_methods">safe HTTP</a> methods like <code>GET</code> which are designed to be
  used only for information retrieval. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://docs.spring.io/spring-security/site/docs/5.0.x/reference/html/csrf.html#csrf-using">Spring Security</a> provides by default a
protection against CSRF attacks which can be disabled:</p>
<pre>
@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {

  @Override
  protected void configure(HttpSecurity http) throws Exception {
    http.csrf().disable(); // Sensitive: csrf protection is entirely disabled
   // or
    http.csrf().ignoringAntMatchers("/route/"); // Sensitive: csrf protection is disabled for specific routes
  }
}
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://docs.spring.io/spring-security/site/docs/5.0.x/reference/html/csrf.html#csrf-using">Spring Security</a> CSRF protection is enabled
by default, do not disable it:</p>
<pre>
@EnableWebSecurity
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {

  @Override
  protected void configure(HttpSecurity http) throws Exception {
    // http.csrf().disable(); // Compliant
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/352">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF) </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/attacks/csrf">OWASP: Cross-Site Request Forgery</a> </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S4507"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4507">
              java:S4507
            </a>
          </td>
          <td >
            <details>
              <p>Delivering code in production with debug features activated is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-1999007">CVE-2018-1999007</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5306">CVE-2015-5306</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2006">CVE-2013-2006</a> </li>
</ul>
<p>An application’s debug features enable developers to find bugs more easily and thus facilitate also the work of attackers. It often gives access to
detailed information on both the system running the application and users.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code or configuration enabling the application debug features is deployed on production servers or distributed to end users. </li>
  <li> the application runs by default with debug features activated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not enable debug features on production servers or applications distributed to end users.</p>
<h2>Sensitive Code Example</h2>
<p><code>Throwable.printStackTrace(...)</code> prints a Throwable and its stack trace to <code>System.Err</code> (by default) which is not easily
parseable and can expose sensitive information:</p>
<pre>
try {
  /* ... */
} catch(Exception e) {
  e.printStackTrace(); // Sensitive
}
</pre>
<p><a
href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/configuration/EnableWebSecurity.html">EnableWebSecurity</a>
annotation for SpringFramework with <code>debug</code> to <code>true</code> enables debugging support:</p>
<pre>
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;

@Configuration
@EnableWebSecurity(debug = true) // Sensitive
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
  // ...
}
</pre>
<p><a
href="https://developer.android.com/reference/android/webkit/WebView#setWebContentsDebuggingEnabled(boolean)">WebView.setWebContentsDebuggingEnabled(true)</a>
for Android enables debugging support:</p>
<pre>
import android.webkit.WebView;

WebView.setWebContentsDebuggingEnabled(true); // Sensitive
WebView.getFactory().getStatics().setWebContentsDebuggingEnabled(true); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Loggers should be used (instead of <code>printStackTrace</code>) to print throwables:</p>
<pre>
try {
  /* ... */
} catch(Exception e) {
  LOGGER.log("context", e);
}
</pre>
<p><a
href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/config/annotation/web/configuration/EnableWebSecurity.html">EnableWebSecurity</a>
annotation for SpringFramework with <code>debug</code> to <code>false</code> disables debugging support:</p>
<pre>
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;

@Configuration
@EnableWebSecurity(debug = false)
public class WebSecurityConfig extends WebSecurityConfigurerAdapter {
  // ...
}
</pre>
<p><a
href="https://developer.android.com/reference/android/webkit/WebView#setWebContentsDebuggingEnabled(boolean)">WebView.setWebContentsDebuggingEnabled(false)</a>
for Android disables debugging support:</p>
<pre>
import android.webkit.WebView;

WebView.setWebContentsDebuggingEnabled(false);
WebView.getFactory().getStatics().setWebContentsDebuggingEnabled(false);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/215">MITRE, CWE-215</a> - Information Exposure Through Debug Information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S4512"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4512">
              java:S4512
            </a>
          </td>
          <td >
            <details>
              <p>Setting JavaBean properties is security sensitive. Doing it with untrusted values has led in the past to the following vulnerability:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0114">CVE-2014-0114</a> </li>
</ul>
<p>JavaBeans can have their properties or nested properties set by population functions. An attacker can leverage this feature to push into the
JavaBean malicious data that can compromise the software integrity. A typical attack will try to manipulate the ClassLoader and finally execute
malicious code.</p>
<p>This rule raises an issue when:</p>
<ul>
  <li> BeanUtils.populate(…​) or BeanUtilsBean.populate(…​) from <a href="http://commons.apache.org/proper/commons-beanutils/">Apache Commons
  BeanUtils</a> are called </li>
  <li> BeanUtils.setProperty(…​) or BeanUtilsBean.setProperty(…​) from <a href="http://commons.apache.org/proper/commons-beanutils/">Apache Commons
  BeanUtils</a> are called </li>
  <li> org.springframework.beans.BeanWrapper.setPropertyValue(…​) or org.springframework.beans.BeanWrapper.setPropertyValues(…​) from Spring is called
  </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the new property values might have been tampered with or provided by an untrusted source. </li>
  <li> sensitive properties can be modified, for example: <code>class.classLoader</code> </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Sanitize all values used as JavaBean properties.</p>
<p>Don’t set any sensitive properties. Keep full control over which properties are set. If the property names are provided by an unstrusted source,
filter them with a whitelist.</p>
<h2>Sensitive Code Example</h2>
<pre>
Company bean = new Company();
HashMap map = new HashMap();
Enumeration names = request.getParameterNames();
while (names.hasMoreElements()) {
    String name = (String) names.nextElement();
    map.put(name, request.getParameterValues(name));
}
BeanUtils.populate(bean, map); // Sensitive: "map" is populated with data coming from user input, here "request.getParameterNames()"
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/915">MITRE, CWE-915</a> - Improperly Controlled Modification of Dynamically-Determined Object
  Attributes </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/hDdGBQ">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#BEAN_PROPERTY_INJECTION">BEAN_PROPERTY_INJECTION</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S4544"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4544">
              java:S4544
            </a>
          </td>
          <td >
            <details>
              <p>Using unsafe Jackson deserialization configuration is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-4995">CVE-2017-4995</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-19362">CVE-2018-19362</a> </li>
</ul>
<p>When Jackson is configured to allow Polymorphic Type Handling (aka PTH), formerly known as Polymorphic Deserialization, "deserialization gadgets"
may allow an attacker to perform remote code execution.</p>
<p>This rule raises an issue when:</p>
<ul>
  <li> <code>enableDefaultTyping()</code> is called on an instance of <code>com.fasterxml.jackson.databind.ObjectMapper</code> or
  <code>org.codehaus.jackson.map.ObjectMapper</code>. </li>
  <li> or when the annotation <code>@JsonTypeInfo</code> is set at class, interface or field levels and configured with <code>use =
  JsonTypeInfo.Id.CLASS</code> or <code>use = Id.MINIMAL_CLASS</code>. </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You configured the Jackson deserializer as mentioned above. </li>
  <li> The serialized data might come from an untrusted source. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use the latest patch versions of <code>jackson-databind</code> blocking the already discovered "deserialization gadgets". </li>
  <li> Avoid using the default typing configuration: <code>ObjectMapper.enableDefaultTyping()</code>. </li>
  <li> If possible, use <code>@JsonTypeInfo(use = Id.NAME)</code> instead of <code>@JsonTypeInfo(use = Id.CLASS)</code> or <code>@JsonTypeInfo(use =
  Id. MINIMAL_CLASS)</code> and so rely on <code>@JsonTypeName</code> and <code>@JsonSubTypes</code>. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
ObjectMapper mapper = new ObjectMapper();
mapper.enableDefaultTyping(); // Sensitive
</pre>
<pre>
@JsonTypeInfo(use = Id.CLASS) // Sensitive
abstract class PhoneNumber {
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization">OWASP Top 10 2017 Category A8</a> - Insecure
  Deserialization </li>
  <li> OWASP - <a href="https://owasp.org/www-community/vulnerabilities/Deserialization_of_untrusted_data">Deserialization of untrusted data</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/502">MITRE, CWE-502</a> - Deserialization of Untrusted Data </li>
  <li> <a href="https://medium.com/@cowtowncoder/on-jackson-cves-dont-panic-here-is-what-you-need-to-know-54cd0d6e8062">On Jackson CVEs: Don’t
  Panic</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-15095">CVE-2017-1509</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2017-7525">CVE-2017-7525</a> </li>
  <li> Derived from FindSecBugs rule <a
  href="https://find-sec-bugs.github.io/bugs.htm#JACKSON_UNSAFE_DESERIALIZATION">JACKSON_UNSAFE_DESERIALIZATION</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S2245"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2245">
              java:S2245
            </a>
          </td>
          <td >
            <details>
              <p>Using pseudorandom number generators (PRNGs) is security-sensitive. For example, it has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-6386">CVE-2013-6386</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-3419">CVE-2006-3419</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2008-4102">CVE-2008-4102</a> </li>
</ul>
<p>When software generates predictable values in a context requiring unpredictability, it may be possible for an attacker to guess the next value that
will be generated, and use this guess to impersonate another user or access sensitive information.</p>
<p>As the <code>java.util.Random</code> class relies on a pseudorandom number generator, this class and relating <code>java.lang.Math.random()</code>
method should not be used for security-critical applications or for protecting sensitive data. In such context, the
<code>java.security.SecureRandom</code> class which relies on a cryptographically strong random number generator (RNG) should be used in place.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the code using the generated value requires it to be unpredictable. It is the case for all encryption mechanisms or when a secret value, such
  as a password, is hashed. </li>
  <li> the function you use generates a value which can be predicted (pseudo-random). </li>
  <li> the generated value is used multiple times. </li>
  <li> an attacker can access the generated value. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a cryptographically strong random number generator (RNG) like "java.security.SecureRandom" in place of this PRNG. </li>
  <li> Use the generated random values only once. </li>
  <li> You should not expose the generated random value. If you have to store it, make sure that the database or file is secure. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
Random random = new Random(); // Sensitive use of Random
byte bytes[] = new byte[20];
random.nextBytes(bytes); // Check if bytes is used for hashing, encryption, etc...
</pre>
<h2>Compliant Solution</h2>
<pre>
SecureRandom random = new SecureRandom(); // Compliant for security-sensitive use cases
byte bytes[] = new byte[20];
random.nextBytes(bytes);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/338">MITRE, CWE-338</a> - Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG)
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1241">MITRE, CWE-1241</a> - Use of Predictable Algorithm in Random Number Generator </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/oTdGBQ">CERT, MSC02-J.</a> - Generate strong random numbers </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/UNcxBQ">CERT, MSC30-C.</a> - Do not use the rand() function for generating pseudorandom numbers
  </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/2ns-BQ">CERT, MSC50-CPP.</a> - Do not use std::rand() for generating pseudorandom numbers </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#PREDICTABLE_RANDOM">Predictable Pseudo Random Number
  Generator</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S3330"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S3330">
              java:S3330
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is configured with the <code>HttpOnly</code> attribute set to <em>true</em>, the browser guaranties that no client-side script will
be able to read it. In most cases, when a cookie is created, the default value of <code>HttpOnly</code> is <em>false</em> and it’s up to the developer
to decide whether or not the content of the cookie can be read by the client-side script. As a majority of Cross-Site Scripting (XSS) attacks target
the theft of session-cookies, the <code>HttpOnly</code> attribute can help to reduce their impact as it won’t be possible to exploit the XSS
vulnerability to steal session-cookies.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is sensitive, used to authenticate the user, for instance a <em>session-cookie</em> </li>
  <li> the <code>HttpOnly</code> attribute offer an additional protection (not the case for an <em>XSRF-TOKEN cookie</em> / CSRF token for example)
  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> By default the <code>HttpOnly</code> flag should be set to <em>true</em> for most of the cookies and it’s mandatory for session /
  sensitive-security cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>If you create a security-sensitive cookie in your JAVA code:</p>
<pre>
Cookie c = new Cookie(COOKIENAME, sensitivedata);
c.setHttpOnly(false);  // Sensitive: this sensitive cookie is created with the httponly flag set to false and so it can be stolen easily in case of XSS vulnerability
</pre>
<p>By default the <a href="https://docs.oracle.com/javaee/6/api/javax/servlet/http/Cookie.html#setHttpOnly(boolean)"><code>HttpOnly</code></a> flag is
set to <em>false:</em></p>
<pre>
Cookie c = new Cookie(COOKIENAME, sensitivedata);  // Sensitive: this sensitive cookie is created with the httponly flag not defined (by default set to false) and so it can be stolen easily in case of XSS vulnerability
</pre>
<h2>Compliant Solution</h2>
<pre>
Cookie c = new Cookie(COOKIENAME, sensitivedata);
c.setHttpOnly(true); // Compliant: this sensitive cookie is protected against theft (HttpOnly=true)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-community/HttpOnly">OWASP HttpOnly</a> </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1004">MITRE, CWE-1004</a> - Sensitive Cookie Without 'HttpOnly' Flag </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#HTTPONLY_COOKIE">HTTPONLY_COOKIE</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S4434"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4434">
              java:S4434
            </a>
          </td>
          <td >
            <details>
              <p>JNDI supports the deserialization of objects from LDAP directories, which can lead to remote code execution.</p>
<p>This rule raises an issue when an LDAP search query is executed with <code>SearchControls</code> configured to allow deserialization.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application connects to an untrusted LDAP directory. </li>
  <li> User-controlled objects can be stored in the LDAP directory. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to disable deserialization of LDAP objects.</p>
<h2>Sensitive Code Example</h2>
<pre>
DirContext ctx = new InitialDirContext();
// ...
ctx.search(query, filter,
        new SearchControls(scope, countLimit, timeLimit, attributes,
            true, // Noncompliant; allows deserialization
            deref));
</pre>
<h2>Compliant Solution</h2>
<pre>
DirContext ctx = new InitialDirContext();
// ...
ctx.search(query, filter,
        new SearchControls(scope, countLimit, timeLimit, attributes,
            false, // Compliant
            deref));
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/502">MITRE, CWE-502</a> - Deserialization of Untrusted Data </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization">OWASP Top 10 2017 Category A8</a> - Insecure
  Deserialization </li>
  <li> <a href="https://www.blackhat.com/docs/us-16/materials/us-16-Munoz-A-Journey-From-JNDI-LDAP-Manipulation-To-RCE-wp.pdf">BlackHat
  presentation</a> </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#LDAP_ENTRY_POISONING">LDAP_ENTRY_POISONING</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S2257"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2257">
              java:S2257
            </a>
          </td>
          <td >
            <details>
              <p>The use of a non-standard algorithm is dangerous because a determined attacker may be able to break the algorithm and compromise whatever data has
been protected. Standard algorithms like <code>SHA-256</code>, <code>SHA-384</code>, <code>SHA-512</code>, …​ should be used instead.</p>
<p>This rule tracks creation of <code>java.security.MessageDigest</code> subclasses.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a standard algorithm instead of creating a custom one. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
public class MyCryptographicAlgorithm extends MessageDigest {
  ...
}
</pre>
<h2>Compliant Solution</h2>
<pre>
MessageDigest digest = MessageDigest.getInstance("SHA-256");
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#CUSTOM_MESSAGE_DIGEST">MessageDigest is Custom</a>
  </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S4790"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4790">
              java:S4790
            </a>
          </td>
          <td >
            <details>
              <p>Cryptographic hash algorithms such as <code>MD2</code>, <code>MD4</code>, <code>MD5</code>, <code>MD6</code>, <code>HAVAL-128</code>,
<code>HMAC-MD5</code>, <code>DSA</code> (which uses <code>SHA-1</code>), <code>RIPEMD</code>, <code>RIPEMD-128</code>, <code>RIPEMD-160</code>,
<code>HMACRIPEMD160</code> and <code>SHA-1</code> are no longer considered secure, because it is possible to have <code>collisions</code> (little
computational effort is enough to find two or more different inputs that produce the same hash).</p>
<h2>Ask Yourself Whether</h2>
<p>The hashed value is used in a security context like:</p>
<ul>
  <li> User-password storage. </li>
  <li> Security token generation (used to confirm e-mail when registering on a website, reset password, etc …​). </li>
  <li> To compute some message integrity. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Safer alternatives, such as <code>SHA-256</code>, <code>SHA-512</code>, <code>SHA-3</code> are recommended, and for password hashing, it’s even
better to use algorithms that do not compute too "quickly", like <code>bcrypt</code>, <code>scrypt</code>, <code>argon2</code> or <code>pbkdf2</code>
because it slows down <code>brute force attacks</code>.</p>
<h2>Sensitive Code Example</h2>
<pre>
MessageDigest md1 = MessageDigest.getInstance("SHA");  // Sensitive:  SHA is not a standard name, for most security providers it's an alias of SHA-1
MessageDigest md2 = MessageDigest.getInstance("SHA1");  // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
MessageDigest md1 = MessageDigest.getInstance("SHA-512"); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/1240">MITRE, CWE-1240</a> - Use of a Risky Cryptographic Primitive </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S4792"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4792">
              java:S4792
            </a>
          </td>
          <td >
            <details>
              <p>Configuring loggers is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0285">CVE-2018-0285</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2000-1127">CVE-2000-1127</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-15113">CVE-2017-15113</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5742">CVE-2015-5742</a> </li>
</ul>
<p>Logs are useful before, during and after a security incident.</p>
<ul>
  <li> Attackers will most of the time start their nefarious work by probing the system for vulnerabilities. Monitoring this activity and stopping it
  is the first step to prevent an attack from ever happening. </li>
  <li> In case of a successful attack, logs should contain enough information to understand what damage an attacker may have inflicted. </li>
</ul>
<p>Logs are also a target for attackers because they might contain sensitive information. Configuring loggers has an impact on the type of information
logged and how they are logged.</p>
<p>This rule flags for review code that initiates loggers configuration. The goal is to guide security code reviews.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> unauthorized users might have access to the logs, either because they are stored in an insecure location or because the application gives
  access to them. </li>
  <li> the logs contain sensitive information on a production server. This can happen when the logger is in debug mode. </li>
  <li> the log can grow without limit. This can happen when additional information is written into logs every time a user performs an action and the
  user can perform the action as many times as he/she wants. </li>
  <li> the logs do not contain enough information to understand the damage an attacker might have inflicted. The loggers mode (info, warn, error)
  might filter out important information. They might not print contextual information like the precise time of events or the server hostname. </li>
  <li> the logs are only stored locally instead of being backuped or replicated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Check that your production deployment doesn’t have its loggers in "debug" mode as it might write sensitive information in logs. </li>
  <li> Production logs should be stored in a secure location which is only accessible to system administrators. </li>
  <li> Configure the loggers to display all warnings, info and error messages. Write relevant information such as the precise time of events and the
  hostname. </li>
  <li> Choose log format which is easy to parse and process automatically. It is important to process logs rapidly in case of an attack so that the
  impact is known and limited. </li>
  <li> Check that the permissions of the log files are correct. If you index the logs in some other service, make sure that the transfer and the
  service are secure too. </li>
  <li> Add limits to the size of the logs and make sure that no user can fill the disk with logs. This can happen even when the user does not control
  the logged information. An attacker could just repeat a logged action many times. </li>
</ul>
<p>Remember that configuring loggers properly doesn’t make them bullet-proof. Here is a list of recommendations explaining on how to use your
logs:</p>
<ul>
  <li> Don’t log any sensitive information. This obviously includes passwords and credit card numbers but also any personal information such as user
  names, locations, etc…​ Usually any information which is protected by law is good candidate for removal. </li>
  <li> Sanitize all user inputs before writing them in the logs. This includes checking its size, content, encoding, syntax, etc…​ As for any user
  input, validate using whitelists whenever possible. Enabling users to write what they want in your logs can have many impacts. It could for example
  use all your storage space or compromise your log indexing service. </li>
  <li> Log enough information to monitor suspicious activities and evaluate the impact an attacker might have on your systems. Register events such as
  failed logins, successful logins, server side input validation failures, access denials and any important transaction. </li>
  <li> Monitor the logs for any suspicious activity. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>This rule supports the following libraries: Log4J, <code>java.util.logging</code> and Logback</p>
<pre>
// === Log4J 2 ===
import org.apache.logging.log4j.core.config.builder.api.ConfigurationBuilderFactory;
import org.apache.logging.log4j.Level;
import org.apache.logging.log4j.core.*;
import org.apache.logging.log4j.core.config.*;

// Sensitive: creating a new custom configuration
abstract class CustomConfigFactory extends ConfigurationFactory {
    // ...
}

class A {
    void foo(Configuration config, LoggerContext context, java.util.Map&lt;String, Level&gt; levelMap,
            Appender appender, java.io.InputStream stream, java.net.URI uri,
            java.io.File file, java.net.URL url, String source, ClassLoader loader, Level level, Filter filter)
            throws java.io.IOException {
        // Creating a new custom configuration
        ConfigurationBuilderFactory.newConfigurationBuilder();  // Sensitive

        // Setting loggers level can result in writing sensitive information in production
        Configurator.setAllLevels("com.example", Level.DEBUG);  // Sensitive
        Configurator.setLevel("com.example", Level.DEBUG);  // Sensitive
        Configurator.setLevel(levelMap);  // Sensitive
        Configurator.setRootLevel(Level.DEBUG);  // Sensitive

        config.addAppender(appender); // Sensitive: this modifies the configuration

        LoggerConfig loggerConfig = config.getRootLogger();
        loggerConfig.addAppender(appender, level, filter); // Sensitive
        loggerConfig.setLevel(level); // Sensitive

        context.setConfigLocation(uri); // Sensitive

        // Load the configuration from a stream or file
        new ConfigurationSource(stream);  // Sensitive
        new ConfigurationSource(stream, file);  // Sensitive
        new ConfigurationSource(stream, url);  // Sensitive
        ConfigurationSource.fromResource(source, loader);  // Sensitive
        ConfigurationSource.fromUri(uri);  // Sensitive
    }
}
</pre>
<pre>
// === java.util.logging ===
import java.util.logging.*;

class M {
    void foo(LogManager logManager, Logger logger, java.io.InputStream is, Handler handler)
            throws SecurityException, java.io.IOException {
        logManager.readConfiguration(is); // Sensitive

        logger.setLevel(Level.FINEST); // Sensitive
        logger.addHandler(handler); // Sensitive
    }
}
</pre>
<pre>
// === Logback ===
import ch.qos.logback.classic.util.ContextInitializer;
import ch.qos.logback.core.Appender;
import ch.qos.logback.classic.joran.JoranConfigurator;
import ch.qos.logback.classic.spi.ILoggingEvent;
import ch.qos.logback.classic.*;

class M {
    void foo(Logger logger, Appender&lt;ILoggingEvent&gt; fileAppender) {
        System.setProperty(ContextInitializer.CONFIG_FILE_PROPERTY, "config.xml"); // Sensitive
        JoranConfigurator configurator = new JoranConfigurator(); // Sensitive

        logger.addAppender(fileAppender); // Sensitive
        logger.setLevel(Level.DEBUG); // Sensitive
    }
}
</pre>
<h2>Exceptions</h2>
<p>Log4J 1.x is not covered as it has reached <a href="https://blogs.apache.org/foundation/entry/apache_logging_services_project_announces">end of
life</a>.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A09_2021-Security_Logging_and_Monitoring_Failures/">OWASP Top 10 2021 Category A9</a> - Security Logging and
  Monitoring Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A10_2017-Insufficient_Logging%2526Monitoring">OWASP Top 10 2017 Category A10</a> -
  Insufficient Logging &amp; Monitoring </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/117">MITRE, CWE-117</a> - Improper Output Neutralization for Logs </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/532">MITRE, CWE-532</a> - Information Exposure Through Log Files </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S2612"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2612">
              java:S2612
            </a>
          </td>
          <td >
            <details>
              <p>In Unix, "<code>others</code>" class refers to all users except the owner of the file and the members of the group assigned to this file.</p>
<p>Granting permissions to this group can lead to unintended access to files.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application is designed to be run on a multi-user environment. </li>
  <li> Corresponding files and directories may contain confidential information. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>The most restrictive possible permissions should be assigned to files and directories.</p>
<h2>Sensitive Code Example</h2>
<pre>
    public void setPermissions(String filePath) {
        Set&lt;PosixFilePermission&gt; perms = new HashSet&lt;PosixFilePermission&gt;();
        // user permission
        perms.add(PosixFilePermission.OWNER_READ);
        perms.add(PosixFilePermission.OWNER_WRITE);
        perms.add(PosixFilePermission.OWNER_EXECUTE);
        // group permissions
        perms.add(PosixFilePermission.GROUP_READ);
        perms.add(PosixFilePermission.GROUP_EXECUTE);
        // others permissions
        perms.add(PosixFilePermission.OTHERS_READ); // Sensitive
        perms.add(PosixFilePermission.OTHERS_WRITE); // Sensitive
        perms.add(PosixFilePermission.OTHERS_EXECUTE); // Sensitive

        Files.setPosixFilePermissions(Paths.get(filePath), perms);
    }
</pre>
<pre>
    public void setPermissionsUsingRuntimeExec(String filePath) {
        Runtime.getRuntime().exec("chmod 777 file.json"); // Sensitive
    }
</pre>
<pre>
    public void setOthersPermissionsHardCoded(String filePath ) {
        Files.setPosixFilePermissions(Paths.get(filePath), PosixFilePermissions.fromString("rwxrwxrwx")); // Sensitive
    }
</pre>
<h2>Compliant Solution</h2>
<p>On operating systems that implement POSIX standard. This will throw a <code>UnsupportedOperationException</code> on Windows.</p>
<pre>
    public void setPermissionsSafe(String filePath) throws IOException {
        Set&lt;PosixFilePermission&gt; perms = new HashSet&lt;PosixFilePermission&gt;();
        // user permission
        perms.add(PosixFilePermission.OWNER_READ);
        perms.add(PosixFilePermission.OWNER_WRITE);
        perms.add(PosixFilePermission.OWNER_EXECUTE);
        // group permissions
        perms.add(PosixFilePermission.GROUP_READ);
        perms.add(PosixFilePermission.GROUP_EXECUTE);
        // others permissions removed
        perms.remove(PosixFilePermission.OTHERS_READ); // Compliant
        perms.remove(PosixFilePermission.OTHERS_WRITE); // Compliant
        perms.remove(PosixFilePermission.OTHERS_EXECUTE); // Compliant

        Files.setPosixFilePermissions(Paths.get(filePath), perms);
    }
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/09-Test_File_Permission">OWASP File Permission</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/display/java/FIO01-J.+Create+files+with+appropriate+access+permissions">CERT, FIO01-J.</a> -
  Create files with appropriate access permissions </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/display/c/FIO06-C.+Create+files+with+appropriate+access+permissions">CERT, FIO06-C.</a> - Create
  files with appropriate access permissions </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S3752"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S3752">
              java:S3752
            </a>
          </td>
          <td >
            <details>
              <p>An HTTP method is safe when used to perform a read-only operation, such as retrieving information. In contrast, an unsafe HTTP method is used to
change the state of an application, for instance to update a user’s profile on a web application.</p>
<p>Common safe HTTP methods are GET, HEAD, or OPTIONS.</p>
<p>Common unsafe HTTP methods are POST, PUT and DELETE.</p>
<p>Allowing both safe and unsafe HTTP methods to perform a specific operation on a web application could impact its security, for example CSRF
protections are most of the time only protecting operations performed by unsafe HTTP methods.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> HTTP methods are not defined at all for a route/controller of the application. </li>
  <li> Safe HTTP methods are defined and used for a route/controller that can change the state of an application. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>For all the routes/controllers of an application, the authorized HTTP methods should be explicitly defined and safe HTTP methods should only be
used to perform read-only operations.</p>
<h2>Sensitive Code Example</h2>
<pre>
@RequestMapping("/delete_user")  // Sensitive: by default all HTTP methods are allowed
public String delete1(String username) {
// state of the application will be changed here
}

@RequestMapping(path = "/delete_user", method = {RequestMethod.GET, RequestMethod.POST}) // Sensitive: both safe and unsafe methods are allowed
String delete2(@RequestParam("id") String id) {
// state of the application will be changed here
}
</pre>
<h2>Compliant Solution</h2>
<pre>
@RequestMapping("/delete_user", method = RequestMethod.POST)  // Compliant
public String delete1(String username) {
// state of the application will be changed here
}

@RequestMapping(path = "/delete_user", method = RequestMethod.POST) // Compliant
String delete2(@RequestParam("id") String id) {
// state of the application will be changed here
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A5-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> -
  Broken Access Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/352">MITRE, CWE-352</a> - Cross-Site Request Forgery (CSRF) </li>
  <li> <a href="https://owasp.org/www-community/attacks/csrf">OWASP: Cross-Site Request Forgery</a> </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> <a href="https://docs.spring.io/spring-security/site/docs/5.0.x/reference/html/csrf.html#csrf-use-proper-verbs">Spring Security Official
  Documentation: Use proper HTTP verbs (CSRF protection)</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S1313"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S1313">
              java:S1313
            </a>
          </td>
          <td >
            <details>
              <p>Hardcoding IP addresses is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2006-5901">CVE-2006-5901</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2005-3725">CVE-2005-3725</a> </li>
</ul>
<p>Today’s services have an ever-changing architecture due to their scaling and redundancy needs. It is a mistake to think that a service will always
have the same IP address. When it does change, the hardcoded IP will have to be modified too. This will have an impact on the product development,
delivery, and deployment:</p>
<ul>
  <li> The developers will have to do a rapid fix every time this happens, instead of having an operation team change a configuration file. </li>
  <li> It misleads to use the same address in every environment (dev, sys, qa, prod). </li>
</ul>
<p>Last but not least it has an effect on application security. Attackers might be able to decompile the code and thereby discover a potentially
sensitive address. They can perform a Denial of Service attack on the service, try to get access to the system, or try to spoof the IP address to
bypass security checks. Such attacks can always be possible, but in the case of a hardcoded IP address solving the issue will take more time, which
will increase an attack’s impact.</p>
<h2>Ask Yourself Whether</h2>
<p>The disclosed IP address is sensitive, e.g.:</p>
<ul>
  <li> Can give information to an attacker about the network topology. </li>
  <li> It’s a personal (assigned to an identifiable person) IP address. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Don’t hard-code the IP address in the source code, instead make it configurable with environment variables, configuration files, or a similar
approach. Alternatively, if confidentially is not required a domain name can be used since it allows to change the destination quickly without having
to rebuild the software.</p>
<h2>Sensitive Code Example</h2>
<pre>
String ip = "192.168.12.42"; // Sensitive
Socket socket = new Socket(ip, 6667);
</pre>
<h2>Compliant Solution</h2>
<pre>
String ip = System.getenv("IP_ADDRESS"); // Compliant
Socket socket = new Socket(ip, 6667);
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Loopback addresses 127.0.0.0/8 in CIDR notation (from 127.0.0.0 to 127.255.255.255) </li>
  <li> Broadcast address 255.255.255.255 </li>
  <li> Non-routable address 0.0.0.0 </li>
  <li> Strings of the form <code>2.5.&lt;number&gt;.&lt;number&gt;</code> as they <a href="http://www.oid-info.com/introduction.htm">often match
  Object Identifiers</a> (OID) </li>
  <li> Addresses in the ranges 192.0.2.0/24, 198.51.100.0/24, 203.0.113.0/24, reserved for documentation purposes by <a
  href="https://datatracker.ietf.org/doc/html/rfc5737">RFC 5737</a> </li>
  <li> Addresses in the range 2001:db8::/32, reserved for documentation purposes by <a href="https://datatracker.ietf.org/doc/html/rfc3849">RFC
  3849</a> </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/OjdGBQ">CERT, MSC03-J.</a> - Never hard code sensitive information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S5804"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5804">
              java:S5804
            </a>
          </td>
          <td >
            <details>
              <p>User enumeration refers to the ability to guess existing usernames in a web application database. This can happen, for example, when using
"sign-in/sign-on/forgot password" functionalities of a website.</p>
<p>When an user tries to "sign-in" to a website with an incorrect username/login, the web application should not disclose that the username doesn’t
exist with a message similar to "this username is incorrect", instead a generic message should be used like "bad credentials", this way it’s not
possible to guess whether the username or password was incorrect during the authentication.</p>
<p>If a user-management feature discloses information about the existence of a username, attackers can use brute force attacks to retrieve a large
amount of valid usernames that will impact the privacy of corresponding users and facilitate other attacks (phishing, password guessing etc …​).</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application discloses that a username exists in its database: most of the time it’s possible to avoid this kind of leak except for the
  "registration/sign-on" part of a website because in this case the user must choose a valid username (not already taken by another user). </li>
  <li> There is no rate limiting and CAPTCHA protection in place for requests involving a username. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>When a user performs a request involving a username, it should not be possible to spot differences between a valid and incorrect username:</p>
<ul>
  <li> Error messages should be generic and not disclose if the username is valid or not. </li>
  <li> The response time must be similar for a valid username or not. </li>
  <li> CAPTCHA and other rate limiting solutions should be implemented. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>In a Spring-security web application the username leaks when:</p>
<ul>
  <li> The string used as argument of <a
  href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/core/userdetails/UserDetailsService.html">loadUserByUsername</a> method is used in an exception message: </li>
</ul>
<pre>
public String authenticate(String username, String password) {
  // ....
  MyUserDetailsService s1 = new MyUserDetailsService();
  MyUserPrincipal u1 = s1.loadUserByUsername(username);

  if(u1 == null) {
    throw new BadCredentialsException(username+" doesn't exist in our database"); // Sensitive
  }
  // ....
}
</pre>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/core/userdetails/UsernameNotFoundException.html">UsernameNotFoundException</a> is thrown (except when it is in the loadUserByUsername method): </li>
</ul>
<pre>
public String authenticate(String username, String password) {
  // ....
  if(user == null) {
      throw new UsernameNotFoundException("user not found"); // Sensitive
  }
  // ....
}
</pre>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-security/site/docs/4.0.x/apidocs/org/springframework/security/authentication/dao/AbstractUserDetailsAuthenticationProvider.html#setHideUserNotFoundExceptions-boolean-">HideUserNotFoundExceptions</a> is set to false: </li>
</ul>
<pre>
DaoAuthenticationProvider daoauth = new DaoAuthenticationProvider();
daoauth.setUserDetailsService(new MyUserDetailsService());
daoauth.setPasswordEncoder(new BCryptPasswordEncoder());
daoauth.setHideUserNotFoundExceptions(false); // Sensitive
builder.authenticationProvider(daoauth);
</pre>
<h2>Compliant Solution</h2>
<p>In a Spring-security web application:</p>
<ul>
  <li> the same message should be used regardless of whether it is the wrong user or password: </li>
</ul>
<pre>
public String authenticate(String username, String password) throws AuthenticationException {
  Details user = null;
  try {
    user = loadUserByUsername(username);
  } catch (UsernameNotFoundException | DataAccessException e) {
    // Hide this exception reason to not disclose that the username doesn't exist
  }
  if (user == null || !user.isPasswordCorrect(password)) {
     // User should not be able to guess if the bad credentials message is related to the username or the password
    throw new BadCredentialsException("Bad credentials");
  }
}
</pre>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-security/site/docs/4.0.x/apidocs/org/springframework/security/authentication/dao/AbstractUserDetailsAuthenticationProvider.html#setHideUserNotFoundExceptions-boolean-">HideUserNotFoundExceptions</a> should be set to true: </li>
</ul>
<pre>
DaoAuthenticationProvider daoauth = new DaoAuthenticationProvider();
daoauth.setUserDetailsService(new MyUserDetailsService());
daoauth.setPasswordEncoder(new BCryptPasswordEncoder());
daoauth.setHideUserNotFoundExceptions(true); // Compliant
builder.authenticationProvider(daoauth);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication">OWASP Top 10 2017 Category A2</a> -
  Broken Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6263"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6263">
              java:S6263
            </a>
          </td>
          <td >
            <details>
              <p>In AWS, long-term access keys will be valid until you manually revoke them. This makes them highly sensitive as any exposure can have serious
consequences and should be used with care.</p>
<p>This rule will trigger when encountering an instantiation of <code>com.amazonaws.auth.BasicAWSCredentials</code>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The access key is used directly in an application or AWS CLI script running on an Amazon EC2 instance. </li>
  <li> Cross-account access is needed. </li>
  <li> The access keys need to be embedded within a mobile application. </li>
  <li> Existing identity providers (SAML 2.0, on-premises identity store) already exists. </li>
</ul>
<p>For more information, see <a href="https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html#use-roles">Use IAM roles
instead of long-term access keys</a>.</p>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Consider using IAM roles or other features of the AWS Security Token Service that provide temporary credentials, limiting the risks.</p>
<h2>Sensitive Code Example</h2>
<pre>
import com.amazonaws.auth.AWSCredentials;
import com.amazonaws.auth.BasicAWSCredentials;
// ...

AWSCredentials awsCredentials = new BasicAWSCredentials(accessKeyId, secretAccessKey);
</pre>
<h2>Compliant Solution</h2>
<p>Example for AWS STS (see <a href="https://docs.aws.amazon.com/sdk-for-java/v1/developer-guide/prog-services-sts.html">Getting Temporary Credentials
with AWS STS</a>).</p>
<pre>
BasicSessionCredentials sessionCredentials = new BasicSessionCredentials(
   session_creds.getAccessKeyId(),
   session_creds.getSecretAccessKey(),
   session_creds.getSessionToken());
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html">Best practices for managing AWS access keys</a>
  </li>
  <li> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html">Managing access keys for IAM users</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6363"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6363">
              java:S6363
            </a>
          </td>
          <td >
            <details>
              <p>WebViews can be used to display web content as part of a mobile application. A browser engine is used to render and display the content. Like a web
application a mobile application that uses WebViews can be vulnerable to Cross-Site Scripting if untrusted code is rendered.</p>
<p>If malicious JavaScript code in a WebView is executed this can leak the contents of sensitive files when access to local files is enabled.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> No local files have to be accessed by the Webview. </li>
  <li> The WebView contains untrusted data that could cause harm when rendered. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to disable access to local files for WebViews unless it is necessary. In the case of a successful attack through a Cross-Site
Scripting vulnerability the attackers attack surface decreases drastically if no files can be read out.</p>
<h2>Sensitive Code Example</h2>
<pre>
import android.webkit.WebView;

WebView webView = (WebView) findViewById(R.id.webview);
webView.getSettings().setAllowFileAccess(true); // Sensitive
webView.getSettings().setAllowContentAccess(true); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.webkit.WebView;

WebView webView = (WebView) findViewById(R.id.webview);
webView.getSettings().setAllowFileAccess(false);
webView.getSettings().setAllowContentAccess(false);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6362"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6362">
              java:S6362
            </a>
          </td>
          <td >
            <details>
              <p>WebViews can be used to display web content as part of a mobile application. A browser engine is used to render and display the content. Like a web
application a mobile application that uses WebViews can be vulnerable to Cross-Site Scripting if untrusted code is rendered. In the context of a
WebView JavaScript code can exfiltrate local files that might be sensitive or even worse, access exposed functions of the application that can result
in more severe vulnerabilities such as code injection. Thus JavaScript support should not be enabled for WebViews unless it is absolutely necessary
and the authenticity of the web resources can be guaranteed.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The WebWiew only renders static web content that does not require JavaScript code to be executed. </li>
  <li> The WebView contains untrusted data that could cause harm when rendered. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to disable JavaScript support for WebViews unless it is necessary to execute JavaScript code. Only trusted pages should be
rendered.</p>
<h2>Sensitive Code Example</h2>
<pre>
import android.webkit.WebView;

WebView webView = (WebView) findViewById(R.id.webview);
webView.getSettings().setJavaScriptEnabled(true); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.webkit.WebView;

WebView webView = (WebView) findViewById(R.id.webview);
webView.getSettings().setJavaScriptEnabled(false);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S5042"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5042">
              java:S5042
            </a>
          </td>
          <td >
            <details>
              <p>Successful Zip Bomb attacks occur when an application expands untrusted archive files without controlling the size of the expanded data, which can
lead to denial of service. A Zip bomb is usually a malicious archive file of a few kilobytes of compressed data but turned into gigabytes of
uncompressed data. To achieve this extreme <a href="https://en.wikipedia.org/wiki/Data_compression_ratio">compression ratio</a>, attackers will
compress irrelevant data (eg: a long string of repeated bytes).</p>
<h2>Ask Yourself Whether</h2>
<p>Archives to expand are untrusted and:</p>
<ul>
  <li> There is no validation of the number of entries in the archive. </li>
  <li> There is no validation of the total size of the uncompressed data. </li>
  <li> There is no validation of the ratio between the compressed and uncompressed archive entry. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Define and control the ratio between compressed and uncompressed data, in general the data compression ratio for most of the legit archives is
  1 to 3. </li>
  <li> Define and control the threshold for maximum total size of the uncompressed data. </li>
  <li> Count the number of file entries extracted from the archive and abort the extraction if their number is greater than a predefined threshold, in
  particular it’s not recommended to recursively expand archives (an entry of an archive could be also an archive). </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
File f = new File("ZipBomb.zip");
ZipFile zipFile = new ZipFile(f);
Enumeration&lt;? extends ZipEntry&gt; entries = zipFile.entries(); // Sensitive

while(entries.hasMoreElements()) {
  ZipEntry ze = entries.nextElement();
  File out = new File("./output_onlyfortesting.txt");
  Files.copy(zipFile.getInputStream(ze), out.toPath(), StandardCopyOption.REPLACE_EXISTING);
}
</pre>
<h2>Compliant Solution</h2>
<p>Do not rely on <a href="https://docs.oracle.com/javase/7/docs/api/java/util/zip/ZipEntry.html#getSize()">getsize</a> to retrieve the size of an
uncompressed entry because this method returns what is defined in the archive headers which can be forged by attackers, instead calculate the actual
entry size when unzipping it:</p>
<pre>
File f = new File("ZipBomb.zip");
ZipFile zipFile = new ZipFile(f);
Enumeration&lt;? extends ZipEntry&gt; entries = zipFile.entries();

int THRESHOLD_ENTRIES = 10000;
int THRESHOLD_SIZE = 1000000000; // 1 GB
double THRESHOLD_RATIO = 10;
int totalSizeArchive = 0;
int totalEntryArchive = 0;

while(entries.hasMoreElements()) {
  ZipEntry ze = entries.nextElement();
  InputStream in = new BufferedInputStream(zipFile.getInputStream(ze));
  OutputStream out = new BufferedOutputStream(new FileOutputStream("./output_onlyfortesting.txt"));

  totalEntryArchive ++;

  int nBytes = -1;
  byte[] buffer = new byte[2048];
  int totalSizeEntry = 0;

  while((nBytes = in.read(buffer)) &gt; 0) { // Compliant
      out.write(buffer, 0, nBytes);
      totalSizeEntry += nBytes;
      totalSizeArchive += nBytes;

      double compressionRatio = totalSizeEntry / ze.getCompressedSize();
      if(compressionRatio &gt; THRESHOLD_RATIO) {
        // ratio between compressed and uncompressed data is highly suspicious, looks like a Zip Bomb Attack
        break;
      }
  }

  if(totalSizeArchive &gt; THRESHOLD_SIZE) {
      // the uncompressed data size is too much for the application resource capacity
      break;
  }

  if(totalEntryArchive &gt; THRESHOLD_ENTRIES) {
      // too much entries in this archive, can lead to inodes exhaustion of the system
      break;
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> -
  Security Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/409">MITRE, CWE-409</a> - Improper Handling of Highly Compressed Data (Data Amplification)
  </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/display/java/IDS04-J.+Safely+extract+files+from+ZipInputStream">CERT, IDS04-J.</a> - Safely
  extract files from ZipInputStream </li>
  <li> <a href="https://www.bamsoftware.com/hacks/zipbomb/">bamsoftware.com</a> - A better Zip Bomb </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="java:S6288"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6288">
              java:S6288
            </a>
          </td>
          <td >
            <details>
              <p>Android KeyStore is a secure container for storing key materials, in particular it prevents key materials extraction, i.e. when the application
process is compromised, the attacker cannot extract keys but may still be able to use them. It’s possible to enable an Android security feature, user
authentication, to restrict usage of keys to only authenticated users. The lock screen has to be unlocked with defined credentials
(pattern/PIN/password, biometric).</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The application requires prohibiting the use of keys in case of compromise of the application process. </li>
  <li> The key material is used in the context of a highly sensitive application like a e-banking mobile app. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to enable user authentication (by setting <code>setUserAuthenticationRequired</code> to <code>true</code> during key generation)
to use keys for a limited duration of time (by setting appropriate values to <code>setUserAuthenticationValidityDurationSeconds</code>), after which
the user must re-authenticate.</p>
<h2>Noncompliant Code Example</h2>
<p>Any user can use the key:</p>
<pre>
KeyGenerator keyGenerator = KeyGenerator.getInstance(KeyProperties.KEY_ALGORITHM_AES, "AndroidKeyStore");

KeyGenParameterSpec builder = new KeyGenParameterSpec.Builder("test_secret_key_noncompliant", KeyProperties.PURPOSE_ENCRYPT | KeyProperties.PURPOSE_DECRYPT) // Noncompliant
    .setBlockModes(KeyProperties.BLOCK_MODE_GCM)
    .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)
    .build();

keyGenerator.init(builder);
</pre>
<h2>Compliant Solution</h2>
<p>The use of the key is limited to authenticated users (for a duration of time defined to 60 seconds):</p>
<pre>
KeyGenerator keyGenerator = KeyGenerator.getInstance(KeyProperties.KEY_ALGORITHM_AES, "AndroidKeyStore");

KeyGenParameterSpec builder = new KeyGenParameterSpec.Builder("test_secret_key", KeyProperties.PURPOSE_ENCRYPT | KeyProperties.PURPOSE_DECRYPT)
    .setBlockModes(KeyProperties.BLOCK_MODE_GCM)
    .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_NONE)
    .setUserAuthenticationRequired(true)
    .setUserAuthenticationParameters (60, KeyProperties.AUTH_DEVICE_CREDENTIAL)
    .build();

keyGenerator.init(builder)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://developer.android.com/training/articles/keystore">developer.android.com</a> - Android keystore system </li>
  <li> <a href="https://developer.android.com/training/articles/keystore#UserAuthentication">developer.android.com</a> - Require user authentication
  for key use </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Authentication and Session Management Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication">OWASP Mobile Top 10 2016 Category M4</a> - Insecure
  Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/522">MITRE, CWE-522</a> - Insufficiently Protected Credentials </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6291"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6291">
              java:S6291
            </a>
          </td>
          <td >
            <details>
              <p>Storing data locally is a common task for mobile applications. Such data includes preferences or authentication tokens for external services, among
other things. There are many convenient solutions that allow storing data persistently, for example SQLiteDatabase, SharedPreferences, and Realm. By
default these systems store the data unencrypted, thus an attacker with physical access to the device can read them out easily. Access to sensitive
data can be harmful for the user of the application, for example when the device gets stolen.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The database contains sensitive data that could cause harm when leaked. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to password-encrypt local databases that contain sensitive information. Most systems provide secure alternatives to plain-text
storage that should be used. If no secure alternative is available the data can also be encrypted manually before it is stored.</p>
<p>The encryption password should not be hard-coded in the application. There are different approaches how the password can be provided to encrypt and
decrypt the database. In the case of <code>EncryptedSharedPreferences</code> the Android Keystore can be used to store the password. Other databases
can rely on <code>EncryptedSharedPreferences</code> to store passwords. The password can also be provided dynamically by the user of the application
or it can be fetched from a remote server if the other methods are not feasible.</p>
<h2>Sensitive Code Example</h2>
<p>For <a href="https://developer.android.com/reference/kotlin/android/database/sqlite/SQLiteDatabase">SQLiteDatabase</a>:</p>
<pre>
SQLiteDatabase db = activity.openOrCreateDatabase("test.db", Context.MODE_PRIVATE, null); // Sensitive
</pre>
<p>For <a href="https://developer.android.com/training/data-storage/shared-preferences">SharedPreferences</a>:</p>
<pre>
SharedPreferences pref = activity.getPreferences(Context.MODE_PRIVATE); // Sensitive
</pre>
<p>For <a href="https://docs.mongodb.com/realm/">Realm</a>:</p>
<pre>
RealmConfiguration config = new RealmConfiguration.Builder().build();
Realm realm = Realm.getInstance(config); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Instead of SQLiteDatabase you can use <a href="https://www.zetetic.net/sqlcipher/sqlcipher-for-android/">SQLCipher</a>:</p>
<pre>
SQLiteDatabase db = SQLiteDatabase.openOrCreateDatabase("test.db", getKey(), null);
</pre>
<p>Instead of SharedPreferences you can use <a
href="https://developer.android.com/reference/androidx/security/crypto/EncryptedSharedPreferences">EncryptedSharedPreferences</a>:</p>
<pre>
String masterKeyAlias = new MasterKeys.getOrCreate(MasterKeys.AES256_GCM_SPEC);
EncryptedSharedPreferences.create(
    "secret",
    masterKeyAlias,
    context,
    EncryptedSharedPreferences.PrefKeyEncryptionScheme.AES256_SIV,
    EncryptedSharedPreferences.PrefValueEncryptionScheme.AES256_GCM
);
</pre>
<p>For Realm an encryption key can be specified in the config:</p>
<pre>
RealmConfiguration config = new RealmConfiguration.Builder()
    .encryptionKey(getKey())
    .build();
Realm realm = Realm.getInstance(config);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6293"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6293">
              java:S6293
            </a>
          </td>
          <td >
            <details>
              <p>Android comes with Android KeyStore, a secure container for storing key materials. It’s possible to define certain keys to be unlocked when users
authenticate using biometric credentials. This way, even if the application process is compromised, the attacker cannot access keys, as presence of
the authorized user is required.</p>
<p>These keys can be used, to encrypt, sign or create a message authentication code (MAC) as proof that the authentication result has not been
tampered with. This protection defeats the scenario where an attacker with physical access to the device would try to hook into the application
process and call the <code>onAuthenticationSucceeded</code> method directly. Therefore he would be unable to extract the sensitive data or to perform
the critical operations protected by the biometric authentication.</p>
<h2>Ask Yourself Whether</h2>
<p>The application contains:</p>
<ul>
  <li> Cryptographic keys / sensitive information that need to be protected using biometric authentication. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to tie the biometric authentication to a cryptographic operation by using a <code>CryptoObject</code> during authentication.</p>
<h2>Noncompliant Code Example</h2>
<p>A <code>CryptoObject</code> is not used during authentication:</p>
<pre>
// ...
BiometricPrompt biometricPrompt = new BiometricPrompt(activity, executor, callback);
// ...
biometricPrompt.authenticate(promptInfo); // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>A <code>CryptoObject</code> is used during authentication:</p>
<pre>
// ...
BiometricPrompt biometricPrompt = new BiometricPrompt(activity, executor, callback);
// ...
biometricPrompt.authenticate(promptInfo, new BiometricPrompt.CryptoObject(cipher)); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.android.com/training/sign-in/biometric-auth">developer.android.com</a> - Use a cryptographic solution that depends
  on authentication </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m4-insecure-authentication">OWASP Mobile Top 10 Category M4</a> - Insecure
  Authentication </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x09-v4-authentication_and_session_management_requirements">OWASP
  MASVS</a> - Authentication and Session Management Requirements </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/287">MITRE, CWE-287</a> - Improper Authentication </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S2068"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2068">
              java:S2068
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, passwords should not be hard-coded. This is particularly true for
applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-13466">CVE-2019-13466</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-15389">CVE-2018-15389</a> </li>
</ul>
<p>Passwords should be stored outside of the code in a configuration file, a database, or a password management service.</p>
<p>This rule flags instances of hard-coded passwords used in database and LDAP connections. It looks for hard-coded passwords in connection strings,
and for variable names that match any of the patterns from the provided list.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The password allows access to a sensitive component like a database, a file storage, an API, or a service. </li>
  <li> The password is used in production environments. </li>
  <li> Application re-distribution is required before updating the password. </li>
</ul>
<p>There would be a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the credentials in a configuration file that is not pushed to the code repository. </li>
  <li> Store the credentials in a database. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a password has been disclosed through the source code: change it. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
String username = "steve";
String password = "blue";
Connection conn = DriverManager.getConnection("jdbc:mysql://localhost/test?" +
                  "user=" + uname + "&amp;password=" + password); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
String username = getEncryptedUser();
String password = getEncryptedPassword();
Connection conn = DriverManager.getConnection("jdbc:mysql://localhost/test?" +
                  "user=" + uname + "&amp;password=" + password);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/OjdGBQ">CERT, MSC03-J.</a> - Never hard code sensitive information </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#HARD_CODE_PASSWORD">Hard Coded Password</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5332"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5332">
              java:S5332
            </a>
          </td>
          <td >
            <details>
              <p>Clear-text protocols such as <code>ftp</code>, <code>telnet</code>, or <code>http</code> lack encryption of transported data, as well as the
capability to build an authenticated connection. It means that an attacker able to sniff traffic from the network can read, modify, or corrupt the
transported content. These protocols are not secure as they expose applications to an extensive range of risks:</p>
<ul>
  <li> sensitive data exposure </li>
  <li> traffic redirected to a malicious endpoint </li>
  <li> malware-infected software update or installer </li>
  <li> execution of client-side code </li>
  <li> corruption of critical information </li>
</ul>
<p>Even in the context of isolated networks like offline environments or segmented cloud environments, the insider threat exists. Thus, attacks
involving communications being sniffed or tampered with can still happen.</p>
<p>For example, attackers could successfully compromise prior security layers by:</p>
<ul>
  <li> bypassing isolation mechanisms </li>
  <li> compromising a component of the network </li>
  <li> getting the credentials of an internal IAM account (either from a service account or an actual person) </li>
</ul>
<p>In such cases, encrypting communications would decrease the chances of attackers to successfully leak data or steal credentials from other network
components. By layering various security practices (segmentation and encryption, for example), the application will follow the
<em>defense-in-depth</em> principle.</p>
<p>Note that using the <code>http</code> protocol is being deprecated by <a
href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http">major web browsers</a>.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-6169">CVE-2019-6169</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-12327">CVE-2019-12327</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-11065">CVE-2019-11065</a> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Application data needs to be protected against falsifications or leaks when transiting over the network. </li>
  <li> Application data transits over an untrusted network. </li>
  <li> Compliance rules require the service to encrypt data in transit. </li>
  <li> Your application renders web pages with a relaxed mixed content policy. </li>
  <li> OS-level protections against clear-text traffic are deactivated. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Make application data transit over a secure, authenticated and encrypted protocol like TLS or SSH. Here are a few alternatives to the most
  common clear-text protocols:
    <ul>
      <li> Use <code>ssh</code> as an alternative to <code>telnet</code>. </li>
      <li> Use <code>sftp</code>, <code>scp</code>, or <code>ftps</code> instead of <code>ftp</code>. </li>
      <li> Use <code>https</code> instead of <code>http</code>. </li>
      <li> Use <code>SMTP</code> over <code>SSL/TLS</code> or <code>SMTP</code> with <code>STARTTLS</code> instead of clear-text SMTP. </li>
    </ul>  </li>
  <li> Enable encryption of cloud components communications whenever it is possible. </li>
  <li> Configure your application to block mixed content when rendering web pages. </li>
  <li> If available, enforce OS-level deactivation of all clear-text traffic. </li>
</ul>
<p>It is recommended to secure all transport channels, even on local networks, as it can take a single non-secure connection to compromise an entire
application or system.</p>
<h2>Sensitive Code Example</h2>
<p>These clients from <a href="https://commons.apache.org/proper/commons-net/">Apache commons net</a> libraries are based on unencrypted protocols and
are not recommended:</p>
<pre>
TelnetClient telnet = new TelnetClient(); // Sensitive

FTPClient ftpClient = new FTPClient(); // Sensitive

SMTPClient smtpClient = new SMTPClient(); // Sensitive
</pre>
<p>Unencrypted HTTP connections, when using <a href="https://square.github.io/okhttp/https/">okhttp</a> library for instance, should be avoided:</p>
<pre>
ConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.CLEARTEXT) // Sensitive
  .build();
</pre>
<p>Android WebView can be configured to allow a secure origin to load content from any other origin, even if that origin is insecure (mixed
content);</p>
<pre>
import android.webkit.WebView

WebView webView = findViewById(R.id.webview)
webView.getSettings().setMixedContentMode(MIXED_CONTENT_ALWAYS_ALLOW); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>Use instead these clients from <a href="https://commons.apache.org/proper/commons-net/">Apache commons net</a> and <a
href="http://www.jcraft.com/jsch/">JSch/ssh</a> library:</p>
<pre>
JSch jsch = new JSch(); // Compliant

if(implicit) {
  // implicit mode is considered deprecated but offer the same security than explicit mode
  FTPSClient ftpsClient = new FTPSClient(true); // Compliant
}
else {
  FTPSClient ftpsClient = new FTPSClient(); // Compliant
}

if(implicit) {
  // implicit mode is considered deprecated but offer the same security than explicit mode
  SMTPSClient smtpsClient = new SMTPSClient(true); // Compliant
}
else {
  SMTPSClient smtpsClient = new SMTPSClient(); // Compliant
  smtpsClient.connect("127.0.0.1", 25);
  if (smtpsClient.execTLS()) {
    // commands
  }
}
</pre>
<p>Perform HTTP encrypted connections, with <a href="https://square.github.io/okhttp/https/">okhttp</a> library for instance:</p>
<pre>
ConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS) // Compliant
  .build();
</pre>
<p>The most secure mode for Android WebView is <code>MIXED_CONTENT_NEVER_ALLOW</code>;</p>
<pre>
import android.webkit.WebView

WebView webView = findViewById(R.id.webview)
webView.getSettings().setMixedContentMode(MIXED_CONTENT_NEVER_ALLOW);
</pre>
<h2>Exceptions</h2>
<p>No issue is reported for the following cases because they are not considered sensitive:</p>
<ul>
  <li> Insecure protocol scheme followed by loopback addresses like 127.0.0.1 or <code>localhost</code>. </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Exposure of Sensitive Information to an Unauthorized Actor </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/319">MITRE, CWE-319</a> - Cleartext Transmission of Sensitive Information </li>
  <li> <a href="https://security.googleblog.com/2016/09/moving-towards-more-secure-web.html">Google, Moving towards more secure web</a> </li>
  <li> <a href="https://blog.mozilla.org/security/2015/04/30/deprecating-non-secure-http/">Mozilla, Deprecating non secure http</a> </li>
  <li> <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-listeners.html">AWS Documentation</a> - Listeners
  for your Application Load Balancers </li>
  <li> <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-kinesis-stream-streamencryption.html">AWS
  Documentation</a> - Stream Encryption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6300"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6300">
              java:S6300
            </a>
          </td>
          <td >
            <details>
              <p>Storing files locally is a common task for mobile applications. Files that are stored unencrypted can be read out and modified by an attacker with
physical access to the device. Access to sensitive data can be harmful for the user of the application, for example when the device gets stolen.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The file contains sensitive data that could cause harm when leaked. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to password-encrypt local files that contain sensitive information. The class <a
href="https://developer.android.com/reference/androidx/security/crypto/EncryptedFile">EncryptedFile</a> can be used to easily encrypt files.</p>
<h2>Sensitive Code Example</h2>
<pre>
Files.write(path, content); // Sensitive

FileOutputStream out = new FileOutputStream(file); // Sensitive

FileWriter fw = new FileWriter("outfilename", false); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
String masterKeyAlias = MasterKeys.getOrCreate(MasterKeys.AES256_GCM_SPEC);

File file = new File(context.getFilesDir(), "secret_data");
EncryptedFile encryptedFile = EncryptedFile.Builder(
    file,
    context,
    masterKeyAlias,
    EncryptedFile.FileEncryptionScheme.AES256_GCM_HKDF_4KB
).build();

// write to the encrypted file
FileOutputStream encryptedOutputStream = encryptedFile.openFileOutput();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5693"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5693">
              java:S5693
            </a>
          </td>
          <td >
            <details>
              <p>Rejecting requests with significant content length is a good practice to control the network traffic intensity and thus resource consumption in
order to prevents DoS attacks.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> size limits are not defined for the different resources of the web application. </li>
  <li> the web application is not protected by <a href="https://en.wikipedia.org/wiki/Rate_limiting">rate limiting</a> features. </li>
  <li> the web application infrastructure has limited resources. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> For most of the features of an application, it is recommended to limit the size of requests to:
    <ul>
      <li> lower or equal to 8mb for file uploads. </li>
      <li> lower or equal to 2mb for other requests. </li>
    </ul>  </li>
</ul>
<p>It is recommended to customize the rule with the limit values that correspond to the web application.</p>
<h2>Sensitive Code Example</h2>
<p>With default limit value of 8388608 (8MB).</p>
<p>A 100 MB file is allowed to be uploaded:</p>
<pre>
@Bean(name = "multipartResolver")
public CommonsMultipartResolver multipartResolver() {
  CommonsMultipartResolver multipartResolver = new CommonsMultipartResolver();
  multipartResolver.setMaxUploadSize(104857600); // Sensitive (100MB)
  return multipartResolver;
}

@Bean(name = "multipartResolver")
public CommonsMultipartResolver multipartResolver() {
  CommonsMultipartResolver multipartResolver = new CommonsMultipartResolver(); // Sensitive, by default if maxUploadSize property is not defined, there is no limit and thus it's insecure
  return multipartResolver;
}

@Bean
public MultipartConfigElement multipartConfigElement() {
  MultipartConfigFactory factory = new MultipartConfigFactory(); // Sensitive, no limit by default
  return factory.createMultipartConfig();
}
</pre>
<h2>Compliant Solution</h2>
<p>File upload size is limited to 8 MB:</p>
<pre>
@Bean(name = "multipartResolver")
public CommonsMultipartResolver multipartResolver() {
  multipartResolver.setMaxUploadSize(8388608); // Compliant (8 MB)
  return multipartResolver;
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Denial_of_Service_Cheat_Sheet.html">Owasp Cheat Sheet</a> - Owasp Denial of Service
  Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/770">MITRE, CWE-770</a> - Allocation of Resources Without Limits or Throttling </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S2077"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2077">
              java:S2077
            </a>
          </td>
          <td >
            <details>
              <p>Formatted SQL queries can be difficult to maintain, debug and can increase the risk of SQL injection when concatenating untrusted values into the
query. However, this rule doesn’t detect SQL injections (unlike rule <a href='/coding_rules#rule_key=javasecurity%3AS3649'>S3649</a>), the goal is only to highlight complex/formatted queries.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Some parts of the query come from untrusted values (like user inputs). </li>
  <li> The query is repeated/duplicated in other parts of the code. </li>
  <li> The application must support different types of relational databases. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use <a href="https://cheatsheetseries.owasp.org/cheatsheets/Query_Parameterization_Cheat_Sheet.html">parameterized queries, prepared
  statements, or stored procedures</a> and bind variables to SQL query parameters. </li>
  <li> Consider using ORM frameworks if there is a need to have an abstract layer to access data. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
public User getUser(Connection con, String user) throws SQLException {

  Statement stmt1 = null;
  Statement stmt2 = null;
  PreparedStatement pstmt;
  try {
    stmt1 = con.createStatement();
    ResultSet rs1 = stmt1.executeQuery("GETDATE()"); // No issue; hardcoded query

    stmt2 = con.createStatement();
    ResultSet rs2 = stmt2.executeQuery("select FNAME, LNAME, SSN " +
                 "from USERS where UNAME=" + user);  // Sensitive

    pstmt = con.prepareStatement("select FNAME, LNAME, SSN " +
                 "from USERS where UNAME=" + user);  // Sensitive
    ResultSet rs3 = pstmt.executeQuery();

    //...
}

public User getUserHibernate(org.hibernate.Session session, String data) {

  org.hibernate.Query query = session.createQuery(
            "FROM students where fname = " + data);  // Sensitive
  // ...
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public User getUser(Connection con, String user) throws SQLException {

  Statement stmt1 = null;
  PreparedStatement pstmt = null;
  String query = "select FNAME, LNAME, SSN " +
                 "from USERS where UNAME=?"
  try {
    stmt1 = con.createStatement();
    ResultSet rs1 = stmt1.executeQuery("GETDATE()");

    pstmt = con.prepareStatement(query);
    pstmt.setString(1, user);  // Good; PreparedStatements escape their inputs.
    ResultSet rs2 = pstmt.executeQuery();

    //...
  }
}

public User getUserHibernate(org.hibernate.Session session, String data) {

  org.hibernate.Query query =  session.createQuery("FROM students where fname = ?");
  query = query.setParameter(0,data);  // Good; Parameter binding escapes all input

  org.hibernate.Query query2 =  session.createQuery("FROM students where fname = " + data); // Sensitive
  // ...
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/89">MITRE, CWE-89</a> - Improper Neutralization of Special Elements used in an SQL Command
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/564">MITRE, CWE-564</a> - SQL Injection: Hibernate </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/20">MITRE, CWE-20</a> - Improper Input Validation </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/943">MITRE, CWE-943</a> - Improper Neutralization of Special Elements in Data Query Logic </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/ITdGBQ">CERT, IDS00-J.</a> - Prevent SQL injection </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> Derived from FindSecBugs rules <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JPA">Potential SQL/JPQL Injection
  (JPA)</a>, <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_JDO">Potential SQL/JDOQL Injection (JDO)</a>, <a
  href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#SQL_INJECTION_HIBERNATE">Potential SQL/HQL Injection (Hibernate)</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="java:S5689"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5689">
              java:S5689
            </a>
          </td>
          <td >
            <details>
              <p>Disclosing technology fingerprints allows an attacker to gather information about the technologies used to develop the web application and to
perform relevant security assessments more quickly (like the identification of known vulnerable components).</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The <code>x-powered-by</code> HTTP header or similar is used by the application. </li>
  <li> Technologies used by the application are confidential and should not be easily guessed. </li>
</ul>
<p>There is a risk if you answered yes to any of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to not disclose technologies used on a website, with <code>x-powered-by</code> HTTP header for example.</p>
<p>In addition, it’s better to completely disable this HTTP header rather than setting it a random value.</p>
<h2>Sensitive Code Example</h2>
<pre>
public ResponseEntity&lt;String&gt; testResponseEntity() {
  HttpHeaders responseHeaders = new HttpHeaders();
  responseHeaders.set("x-powered-by", "myproduct"); // Sensitive

  return new ResponseEntity&lt;String&gt;("foo", responseHeaders, HttpStatus.CREATED);
}
</pre>
<h2>Compliant Solution</h2>
<p>Don’t use <code>x-powered-by</code> or <code>Server</code> HTTP header or any other means disclosing fingerprints of the application.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a
  href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/01-Information_Gathering/08-Fingerprint_Web_Application_Framework.html">OWASP Testing Guide - OTG-INFO-008</a> - Fingerprint Web Application Framework </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/200">MITRE, CWE-200</a> - Information Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5322"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5322">
              java:S5322
            </a>
          </td>
          <td >
            <details>
              <p>Android applications can receive broadcasts from the system or other applications. Receiving intents is security-sensitive. For example, it has led
in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-1677">CVE-2019-1677</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-1275">CVE-2015-1275</a> </li>
</ul>
<p>Receivers can be declared in the manifest or in the code to make them context specific. If the receiver is declared in the manifest Android will
start the application if it is not already running once a matching broadcast is received. The receiver is an entry point into the application.</p>
<p>Other applications can send potentially malicious broadcasts, so it is important to consider broadcasts as untrusted and to limit the applications
that can send broadcasts to the receiver.</p>
<p>Permissions can be specified to restrict broadcasts to authorized applications. Restrictions can be enforced by both the sender and receiver of a
broadcast. If permissions are specified when registering a broadcast receiver, then only broadcasters who were granted this permission can send a
message to the receiver.</p>
<p>This rule raises an issue when a receiver is registered without specifying any "broadcast permission".</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The data extracted from intents is not sanitized. </li>
  <li> Intents broadcast is not restricted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Restrict the access to broadcasted intents. See <a
href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> for more
information.</p>
<h2>Sensitive Code Example</h2>
<pre>
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.IntentFilter;
import android.os.Build;
import android.os.Handler;
import android.support.annotation.RequiresApi;

public class MyIntentReceiver {

    @RequiresApi(api = Build.VERSION_CODES.O)
    public void register(Context context, BroadcastReceiver receiver,
                         IntentFilter filter,
                         String broadcastPermission,
                         Handler scheduler,
                         int flags) {
        context.registerReceiver(receiver, filter); // Sensitive
        context.registerReceiver(receiver, filter, flags); // Sensitive

        // Broadcasting intent with "null" for broadcastPermission
        context.registerReceiver(receiver, filter, null, scheduler); // Sensitive
        context.registerReceiver(receiver, filter, null, scheduler, flags); // Sensitive
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.IntentFilter;
import android.os.Build;
import android.os.Handler;
import android.support.annotation.RequiresApi;

public class MyIntentReceiver {

    @RequiresApi(api = Build.VERSION_CODES.O)
    public void register(Context context, BroadcastReceiver receiver,
                         IntentFilter filter,
                         String broadcastPermission,
                         Handler scheduler,
                         int flags) {

        context.registerReceiver(receiver, filter, broadcastPermission, scheduler);
        context.registerReceiver(receiver, filter, broadcastPermission, scheduler, flags);
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  Platform Usage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/925">MITRE, CWE-925</a> - Improper Verification of Intent by Broadcast Receiver </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/926">MITRE, CWE-926</a> - Improper Export of Android Application Components </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> <a href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> -
  Broadcast Overview - Security considerations and best practices </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5443"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5443">
              java:S5443
            </a>
          </td>
          <td >
            <details>
              <p>Operating systems have global directories where any user has write access. Those folders are mostly used as temporary storage areas like
<code>/tmp</code> in Linux based systems. An application manipulating files from these folders is exposed to race conditions on filenames: a malicious
user can try to create a file with a predictable name before the application does. A successful attack can result in other files being accessed,
modified, corrupted or deleted. This risk is even higher if the application runs with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2012-2451">CVE-2012-2451</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2015-1838">CVE-2015-1838</a> </li>
</ul>
<p>This rule raises an issue whenever it detects a hard-coded path to a publicly writable directory like <code>/tmp</code> (see examples bellow). It
also detects access to environment variables that point to publicly writable directories, e.g., <code>TMP</code> and <code>TMPDIR</code>.</p>
<ul>
  <li> <code>/tmp</code> </li>
  <li> <code>/var/tmp</code> </li>
  <li> <code>/usr/tmp</code> </li>
  <li> <code>/dev/shm</code> </li>
  <li> <code>/dev/mqueue</code> </li>
  <li> <code>/run/lock</code> </li>
  <li> <code>/var/run/lock</code> </li>
  <li> <code>/Library/Caches</code> </li>
  <li> <code>/Users/Shared</code> </li>
  <li> <code>/private/tmp</code> </li>
  <li> <code>/private/var/tmp</code> </li>
  <li> <code>\Windows\Temp</code> </li>
  <li> <code>\Temp</code> </li>
  <li> <code>\TMP</code> </li>
</ul>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Files are read from or written into a publicly writable folder </li>
  <li> The application creates files with predictable names into a publicly writable folder </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use a dedicated sub-folder with tightly controlled permissions </li>
  <li> Use secure-by-design APIs to create temporary files. Such API will make sure:
    <ul>
      <li> The generated filename is unpredictable </li>
      <li> The file is readable and writable only by the creating user ID </li>
      <li> The file descriptor is not inherited by child processes </li>
      <li> The file will be destroyed as soon as it is closed </li>
    </ul>  </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
new File("/tmp/myfile.txt"); // Sensitive
Paths.get("/tmp/myfile.txt"); // Sensitive

java.io.File.createTempFile("prefix", "suffix"); // Sensitive, will be in the default temporary-file directory.
java.nio.file.Files.createTempDirectory("prefix"); // Sensitive, will be in the default temporary-file directory.
</pre>
<pre>
Map&lt;String, String&gt; env = System.getenv();
env.get("TMP"); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
new File("/myDirectory/myfile.txt");  // Compliant

File.createTempFile("prefix", "suffix", new File("/mySecureDirectory"));  // Compliant

if(SystemUtils.IS_OS_UNIX) {
  FileAttribute&lt;Set&lt;PosixFilePermission&gt;&gt; attr = PosixFilePermissions.asFileAttribute(PosixFilePermissions.fromString("rwx------"));
  Files.createTempFile("prefix", "suffix", attr); // Compliant
}
else {
  File f = Files.createTempFile("prefix", "suffix").toFile();  // Compliant
  f.setReadable(true, true);
  f.setWritable(true, true);
  f.setExecutable(true, true);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S5324"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5324">
              java:S5324
            </a>
          </td>
          <td >
            <details>
              <p>Storing data locally is a common task for mobile applications. Such data includes files among other things. One convenient way to store files is to
use the external file storage which usually offers a larger amount of disc space compared to internal storage.</p>
<p>Files created on the external storage are globally readable and writable. Therefore, a malicious application having the permissions
<code>WRITE_EXTERNAL_STORAGE</code> or <code>READ_EXTERNAL_STORAGE</code> could try to read sensitive information from the files that other
applications have stored on the external storage.</p>
<p>External storage can also be removed by the user (e.g when based on SD card) making the files unavailable to the application.</p>
<h2>Ask Yourself Whether</h2>
<p>Your application uses external storage to:</p>
<ul>
  <li> store files that contain sensitive data. </li>
  <li> store files that are not meant to be shared with other application. </li>
  <li> store files that are critical for the application to work. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use internal storage whenever possible as the system prevents other apps from accessing this location. </li>
  <li> Only use external storage if you need to share non-sensitive files with other applications. </li>
  <li> If your application has to use the external storage to store sensitive data, make sure it encrypts the files using <a
  href="https://developer.android.com/reference/androidx/security/crypto/EncryptedFile">EncryptedFile</a>. </li>
  <li> Data coming from external storage should always be considered untrusted and should be validated. </li>
  <li> As some external storage can be removed, make sure to never store files on it that are critical for the usability of your application. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
import android.content.Context;

public class AccessExternalFiles {

    public void accessFiles(Context context) {
        context.getExternalFilesDir(null); // Sensitive
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.content.Context;

public class AccessExternalFiles {

    public void accessFiles(Context context) {
        context.getFilesDir();
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://developer.android.com/training/articles/security-tips#ExternalStorage">Android Security tips on external file storage</a>
  </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/312">MITRE, CWE-312</a> - Cleartext Storage of Sensitive Information </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6418"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6418">
              java:S6418
            </a>
          </td>
          <td >
            <details>
              <p>Because it is easy to extract strings from an application source code or binary, secrets should not be hard-coded. This is particularly true for
applications that are distributed or that are open-source.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-25510">CVE-2022-25510</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-42635">CVE-2021-42635</a> </li>
</ul>
<p>Secrets should be stored outside of the source code in a configuration file or a management service for secrets.</p>
<p>This rule detects variables/fields having a name matching a list of words (secret, token, credential, auth, api[_.-]?key) being assigned a
pseudorandom hard-coded value. The pseudorandomness of the hard-coded value is based on its entropy and the probability to be human-readable. The
randomness sensibility can be adjusted if needed. Lower values will detect less random values, raising potentially more false positives.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The secret allows access to a sensitive component like a database, a file storage, an API, or a service. </li>
  <li> The secret is used in a production environment. </li>
  <li> Application re-distribution is required before updating the secret. </li>
</ul>
<p>There would be a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Store the secret in a configuration file that is not pushed to the code repository. </li>
  <li> Use your cloud provider’s service for managing secrets. </li>
  <li> If a secret has been disclosed through the source code: revoke it and create a new one. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
private static final String MY_SECRET = "47828a8dd77ee1eb9dde2d5e93cb221ce8c32b37";

public static void main(String[] args) {
  MyClass.callMyService(MY_SECRET);
}
</pre>
<h2>Compliant Solution</h2>
<p>Using <a href="https://github.com/awsdocs/aws-doc-sdk-examples/tree/main/javav2/example_code/secretsmanager">AWS Secrets Manager</a>:</p>
<pre>
import software.amazon.awssdk.services.secretsmanager.model.GetSecretValueRequest;
import software.amazon.awssdk.services.secretsmanager.model.GetSecretValueResponse;

public static void main(String[] args) {
  SecretsManagerClient secretsClient = ...
  MyClass.doSomething(secretsClient, "MY_SERVICE_SECRET");
}

public static void doSomething(SecretsManagerClient secretsClient, String secretName) {
  GetSecretValueRequest valueRequest = GetSecretValueRequest.builder()
    .secretId(secretName)
    .build();

  GetSecretValueResponse valueResponse = secretsClient.getSecretValue(valueRequest);
  String secret = valueResponse.secretString();
  // do something with the secret
  MyClass.callMyService(secret);
}
</pre>
<p>Using <a href="https://docs.microsoft.com/en-us/azure/key-vault/secrets/quick-create-java?tabs=azure-cli">Azure Key Vault Secret</a>:</p>
<pre>
import com.azure.identity.DefaultAzureCredentialBuilder;

import com.azure.security.keyvault.secrets.SecretClient;
import com.azure.security.keyvault.secrets.SecretClientBuilder;
import com.azure.security.keyvault.secrets.models.KeyVaultSecret;

public static void main(String[] args) throws InterruptedException, IllegalArgumentException {
  String keyVaultName = System.getenv("KEY_VAULT_NAME");
  String keyVaultUri = "https://" + keyVaultName + ".vault.azure.net";

  SecretClient secretClient = new SecretClientBuilder()
    .vaultUrl(keyVaultUri)
    .credential(new DefaultAzureCredentialBuilder().build())
    .buildClient();

  MyClass.doSomething(secretClient, "MY_SERVICE_SECRET");
}

public static void doSomething(SecretClient secretClient, String secretName) {
  KeyVaultSecret retrievedSecret = secretClient.getSecret(secretName);
  String secret = retrievedSecret.getValue(),

  // do something with the secret
  MyClass.callMyService(secret);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798.html">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/OjdGBQ">CERT, MSC03-J.</a> - Never hard code sensitive information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S5320"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5320">
              java:S5320
            </a>
          </td>
          <td >
            <details>
              <p>In Android applications, broadcasting intents is security-sensitive. For example, it has led in the past to the following vulnerability:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-9489">CVE-2018-9489</a> </li>
</ul>
<p>By default, broadcasted intents are visible to every application, exposing all sensitive information they contain.</p>
<p>This rule raises an issue when an intent is broadcasted without specifying any "receiver permission".</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The intent contains sensitive information. </li>
  <li> Intent reception is not restricted. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Restrict the access to broadcasted intents. See <a
href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> for more
information.</p>
<h2>Sensitive Code Example</h2>
<pre>
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Build;
import android.os.Bundle;
import android.os.Handler;
import android.os.UserHandle;
import android.support.annotation.RequiresApi;

public class MyIntentBroadcast {
    @RequiresApi(api = Build.VERSION_CODES.JELLY_BEAN_MR1)
    public void broadcast(Intent intent, Context context, UserHandle user,
                          BroadcastReceiver resultReceiver, Handler scheduler, int initialCode,
                          String initialData, Bundle initialExtras,
                          String broadcastPermission) {
        context.sendBroadcast(intent); // Sensitive
        context.sendBroadcastAsUser(intent, user); // Sensitive

        // Broadcasting intent with "null" for receiverPermission
        context.sendBroadcast(intent, null); // Sensitive
        context.sendBroadcastAsUser(intent, user, null); // Sensitive
        context.sendOrderedBroadcast(intent, null); // Sensitive
        context.sendOrderedBroadcastAsUser(intent, user, null, resultReceiver,
                scheduler, initialCode, initialData, initialExtras); // Sensitive
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.os.Build;
import android.os.Bundle;
import android.os.Handler;
import android.os.UserHandle;
import android.support.annotation.RequiresApi;

public class MyIntentBroadcast {
    @RequiresApi(api = Build.VERSION_CODES.JELLY_BEAN_MR1)
    public void broadcast(Intent intent, Context context, UserHandle user,
                          BroadcastReceiver resultReceiver, Handler scheduler, int initialCode,
                          String initialData, Bundle initialExtras,
                          String broadcastPermission) {

        context.sendBroadcast(intent, broadcastPermission);
        context.sendBroadcastAsUser(intent, user, broadcastPermission);
        context.sendOrderedBroadcast(intent, broadcastPermission);
        context.sendOrderedBroadcastAsUser(intent, user,broadcastPermission, resultReceiver,
                scheduler, initialCode, initialData, initialExtras);
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  Platform Usage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/927">MITRE, CWE-927</a> - Use of Implicit Intent for Sensitive Communication </li>
  <li> <a href="https://developer.android.com/guide/components/broadcasts.html#restricting_broadcasts_with_permissions">Android documentation</a> -
  Broadcast Overview - Security considerations and best practices </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S4036"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4036">
              java:S4036
            </a>
          </td>
          <td >
            <details>
              <p>When executing an OS command and unless you specify the full path to the executable, then the locations in your application’s <code>PATH</code>
environment variable will be searched for the executable. That search could leave an opening for an attacker if one of the elements in
<code>PATH</code> is a directory under his control.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The directories in the PATH environment variable may be defined by not trusted entities. </li>
</ul>
<p>There is a risk if you answered yes to this question.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Fully qualified/absolute path should be used to specify the OS command to execute.</p>
<h2>Sensitive Code Example</h2>
<p>The full path of the command is not specified and thus the executable will be searched in all directories listed in the <code>PATH</code>
environment variable:</p>
<pre>
Runtime.getRuntime().exec("make");  // Sensitive
Runtime.getRuntime().exec(new String[]{"make"});  // Sensitive

ProcessBuilder builder = new ProcessBuilder("make");  // Sensitive
builder.command("make");  // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>The command is defined by its full path:</p>
<pre>
Runtime.getRuntime().exec("/usr/bin/make");  // Compliant
Runtime.getRuntime().exec(new String[]{"~/bin/make"});  // Compliant

ProcessBuilder builder = new ProcessBuilder("./bin/make");  // Compliant
builder.command("../bin/make");  // Compliant
builder.command(Arrays.asList("..\bin\make", "-j8")); // Compliant

builder = new ProcessBuilder(Arrays.asList(".\make"));  // Compliant
builder.command(Arrays.asList("C:\bin\make", "-j8"));  // Compliant
builder.command(Arrays.asList("\\SERVER\bin\make"));  // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/426">MITRE, CWE-426</a> - Untrusted Search Path </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/427">MITRE, CWE-427</a> - Uncontrolled Search Path Element </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5247"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5247">
              java:S5247
            </a>
          </td>
          <td >
            <details>
              <p>To reduce the risk of cross-site scripting attacks, templating systems, such as <code>Twig</code>, <code>Django</code>, <code>Smarty</code>,
<code>Groovy's template engine</code>, allow configuration of automatic variable escaping before rendering templates. When escape occurs, characters
that make sense to the browser (eg: &lt;a&gt;) will be transformed/replaced with escaped/sanitized values (eg: &amp; lt;a&amp; gt; ).</p>
<p>Auto-escaping is not a magic feature to annihilate all cross-site scripting attacks, it depends on <a
href="https://twig.symfony.com/doc/3.x/filters/escape.html">the strategy applied</a> and the context, for example a "html auto-escaping" strategy
(which only transforms html characters into <a href="https://developer.mozilla.org/en-US/docs/Glossary/Entity">html entities</a>) will not be relevant
when variables are used in a <a href="https://en.wikipedia.org/wiki/HTML_attribute">html attribute</a> because '<code>:</code>' character is not
escaped and thus an attack as below is possible:</p>
<pre>
&lt;a href="{{ myLink }}"&gt;link&lt;/a&gt; // myLink = javascript:alert(document.cookie)
&lt;a href="javascript:alert(document.cookie)"&gt;link&lt;/a&gt; // JS injection (XSS attack)
</pre>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> Templates are used to render web content and
    <ul>
      <li> dynamic variables in templates come from untrusted locations or are user-controlled inputs </li>
      <li> there is no local mechanism in place to sanitize or validate the inputs. </li>
    </ul>  </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Enable auto-escaping by default and continue to review the use of inputs in order to be sure that the chosen auto-escaping strategy is the right
one.</p>
<h2>Sensitive Code Example</h2>
<p>With <a href="https://github.com/samskivert/jmustache">JMustache by samskivert</a>:</p>
<pre>
Mustache.compiler().escapeHTML(false).compile(template).execute(context); // Sensitive
Mustache.compiler().withEscaper(Escapers.NONE).compile(template).execute(context); // Sensitive
</pre>
<p>With <a href="https://freemarker.apache.org/">Freemarker</a>:</p>
<pre>
freemarker.template.Configuration configuration = new freemarker.template.Configuration();
configuration.setAutoEscapingPolicy(DISABLE_AUTO_ESCAPING_POLICY); // Sensitive
</pre>
<h2>Compliant Solution</h2>
<p>With <a href="https://github.com/samskivert/jmustache">JMustache by samskivert</a>:</p>
<pre>
Mustache.compiler().compile(template).execute(context); // Compliant, auto-escaping is enabled by default
Mustache.compiler().escapeHTML(true).compile(template).execute(context); // Compliant
</pre>
<p>With <a href="https://freemarker.apache.org/">Freemarker</a>. See <a
href="https://freemarker.apache.org/docs/api/freemarker/template/Configuration.html#setAutoEscapingPolicy-int-">"setAutoEscapingPolicy"
documentation</a> for more details.</p>
<pre>
freemarker.template.Configuration configuration = new freemarker.template.Configuration();
configuration.setAutoEscapingPolicy(ENABLE_IF_DEFAULT_AUTO_ESCAPING_POLICY); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md">OWASP Cheat
  Sheet</a> - XSS Prevention Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5122"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5122">
              java:S5122
            </a>
          </td>
          <td >
            <details>
              <p>Having a permissive Cross-Origin Resource Sharing policy is security-sensitive. It has led in the past to the following vulnerabilities:</p>
<ul>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0269">CVE-2018-0269</a> </li>
  <li> <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-14460">CVE-2017-14460</a> </li>
</ul>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">Same origin policy</a> in browsers prevents, by default and for
security-reasons, a javascript frontend to perform a cross-origin HTTP request to a resource that has a different origin (domain, protocol, or port)
from its own. The requested target can append additional HTTP headers in response, called <a
href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a>, that act like directives for the browser and change the access control policy
/ relax the same origin policy.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> You don’t trust the origin specified, example: <code>Access-Control-Allow-Origin: untrustedwebsite.com</code>. </li>
  <li> Access control policy is entirely disabled: <code>Access-Control-Allow-Origin: *</code> </li>
  <li> Your access control policy is dynamically defined by a user-controlled input like <a
  href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Origin"><code>origin</code></a> header. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> The <code>Access-Control-Allow-Origin</code> header should be set only for a trusted origin and for specific resources. </li>
  <li> Allow only selected, trusted domains in the <code>Access-Control-Allow-Origin</code> header. Prefer whitelisting domains over blacklisting or
  allowing any domain (do not use * wildcard nor blindly return the <code>Origin</code> header content without any checks). </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>Java servlet framework:</p>
<pre>
@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    resp.setHeader("Content-Type", "text/plain; charset=utf-8");
    resp.setHeader("Access-Control-Allow-Origin", "*"); // Sensitive
    resp.setHeader("Access-Control-Allow-Credentials", "true");
    resp.setHeader("Access-Control-Allow-Methods", "GET");
    resp.getWriter().write("response");
}
</pre>
<p>Spring MVC framework:</p>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/CrossOrigin.html">CrossOrigin</a>
  </li>
</ul>
<pre>
@CrossOrigin // Sensitive
@RequestMapping("")
public class TestController {
    public String home(ModelMap model) {
        model.addAttribute("message", "ok ");
        return "view";
    }
}
</pre>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/cors/CorsConfiguration.html">cors.CorsConfiguration</a> </li>
</ul>
<pre>
CorsConfiguration config = new CorsConfiguration();
config.addAllowedOrigin("*"); // Sensitive
config.applyPermitDefaultValues(); // Sensitive
</pre>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/CorsRegistration.html">servlet.config.annotation.CorsConfiguration</a> </li>
</ul>
<pre>
class Insecure implements WebMvcConfigurer {
  @Override
  public void addCorsMappings(CorsRegistry registry) {
    registry.addMapping("/**")
      .allowedOrigins("*"); // Sensitive
  }
}
</pre>
<p>User-controlled origin:</p>
<pre>
public ResponseEntity&lt;String&gt; userControlledOrigin(@RequestHeader("Origin") String origin) {
  HttpHeaders responseHeaders = new HttpHeaders();
  responseHeaders.add("Access-Control-Allow-Origin", origin); // Sensitive

  return new ResponseEntity&lt;&gt;("content", responseHeaders, HttpStatus.CREATED);
}
</pre>
<h2>Compliant Solution</h2>
<p>Java Servlet framework:</p>
<pre>
@Override
protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    resp.setHeader("Content-Type", "text/plain; charset=utf-8");
    resp.setHeader("Access-Control-Allow-Origin", "trustedwebsite.com"); // Compliant
    resp.setHeader("Access-Control-Allow-Credentials", "true");
    resp.setHeader("Access-Control-Allow-Methods", "GET");
    resp.getWriter().write("response");
}
</pre>
<p>Spring MVC framework:</p>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/bind/annotation/CrossOrigin.html">CrossOrigin</a>
  </li>
</ul>
<pre>
@CrossOrigin("trustedwebsite.com") // Compliant
@RequestMapping("")
public class TestController {
    public String home(ModelMap model) {
        model.addAttribute("message", "ok ");
        return "view";
    }
}
</pre>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/cors/CorsConfiguration.html">cors.CorsConfiguration</a> </li>
</ul>
<pre>
CorsConfiguration config = new CorsConfiguration();
config.addAllowedOrigin("http://domain2.com"); // Compliant
</pre>
<ul>
  <li> <a
  href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/servlet/config/annotation/CorsRegistration.html">servlet.config.annotation.CorsConfiguration</a> </li>
</ul>
<pre>
class Safe implements WebMvcConfigurer {
  @Override
  public void addCorsMappings(CorsRegistry registry) {
    registry.addMapping("/**")
      .allowedOrigins("safe.com"); // Compliant
  }
}
</pre>
<p>User-controlled origin validated with an allow-list:</p>
<pre>
public ResponseEntity&lt;String&gt; userControlledOrigin(@RequestHeader("Origin") String origin) {
  HttpHeaders responseHeaders = new HttpHeaders();
  if (trustedOrigins.contains(origin)) {
    responseHeaders.add("Access-Control-Allow-Origin", origin);
  }

  return new ResponseEntity&lt;&gt;("content", responseHeaders, HttpStatus.CREATED);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">developer.mozilla.org</a> - CORS </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy">developer.mozilla.org</a> - Same origin policy </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/HTML5_Security_Cheat_Sheet.html#cross-origin-resource-sharing">OWASP HTML5 Security
  Cheat Sheet</a> - Cross Origin Resource Sharing </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/346">MITRE, CWE-346</a> - Origin Validation Error </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/942">MITRE, CWE-942</a> - Overly Permissive Cross-domain Whitelist </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S2092"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2092">
              java:S2092
            </a>
          </td>
          <td >
            <details>
              <p>When a cookie is protected with the <code>secure</code> attribute set to <em>true</em> it will not be send by the browser over an unencrypted HTTP
request and thus cannot be observed by an unauthorized person during a man-in-the-middle attack.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> the cookie is for instance a <em>session-cookie</em> not designed to be sent over non-HTTPS communication. </li>
  <li> it’s not sure that the website contains <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Mixed_content">mixed content</a> or not
  (ie HTTPS everywhere or not) </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> It is recommended to use <code>HTTPs</code> everywhere so setting the <code>secure</code> flag to <em>true</em> should be the default behaviour
  when creating cookies. </li>
  <li> Set the <code>secure</code> flag to <em>true</em> for session-cookies. </li>
</ul>
<h2>Sensitive Code Example</h2>
<p>If you create a security-sensitive cookie in your JAVA code:</p>
<pre>
Cookie c = new Cookie(COOKIENAME, sensitivedata);
c.setSecure(false);  // Sensitive: a security-ensitive cookie is created with the secure flag set to false
</pre>
<p>By default the <a href="https://docs.oracle.com/javaee/6/api/javax/servlet/http/Cookie.html#setSecure(boolean)"><code>secure</code></a> flag is set
to <em>false:</em></p>
<pre>
Cookie c = new Cookie(COOKIENAME, sensitivedata);  // Sensitive: a security-sensitive cookie is created with the secure flag not defined (by default set to false)
</pre>
<h2>Compliant Solution</h2>
<pre>
Cookie c = new Cookie(COOKIENAME, sensitivedata);
c.setSecure(true); // Compliant: the sensitive cookie will not be send during an unencrypted HTTP request thanks to the secure flag set to true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/315">MITRE, CWE-315</a> - Cleartext Storage of Sensitive Information in a Cookie </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/614">MITRE, CWE-614</a> - Sensitive Cookie in HTTPS Session Without 'Secure' Attribute </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kubernetes:S6428"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kubernetes:S6428">
              kubernetes:S6428
            </a>
          </td>
          <td >
            <details>
              <p>Running containers in privileged mode can reduce the resilience of a cluster in the event of a security incident because it weakens the isolation
between hosts and containers.</p>
<p>Process permissions in privileged containers are essentially the same as root permissions on the host. If these processes are not protected by
robust security measures, an attacker who compromises a root process on a Pod’s host is likely to gain the ability to pivot within the cluster.<br>
Depending on how resilient the cluster is, attackers can extend their attack to the cluster by compromising the nodes from which the cluster launched
the process.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The services of this Pod are accessible to people who are not administrators of the Kubernetes cluster. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Disable privileged mode.</p>
<h2>Sensitive Code Example</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
      securityContext:
        privileged: true # Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
      securityContext:
        privileged: false
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284.html">MITRE, CWE-284</a> - Improper Access Control </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kubernetes:S6433"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kubernetes:S6433">
              kubernetes:S6433
            </a>
          </td>
          <td >
            <details>
              <p>Mounting sensitive file system paths can lead to information disclosure and compromise of the host systems.</p>
<p>System paths can contain sensitive information like configuration files or cache files. Those might be used by attackers to expand permissions or
to collect information for further attacks. System paths can also contain binaries and scripts that might be executed by the host system periodically.
A compromised or rogue container with access to sensitive files could endanger the integrity of the whole Kubernetes cluster.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The mounted file path contains sensitive information. </li>
  <li> The mounted file path contains configuration files or executables that are writable. </li>
  <li> The Pod is untrusted or might contain vulnerabilities. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to avoid mounting sensitive system file paths into containers. If it is necessary to mount such a path due to the architecture,
the least privileges should be given, for instance by making the mount read-only to prevent unwanted modifications.</p>
<h2>Sensitive Code Example</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: test
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: test-container
    volumeMounts:
    - mountPath: /data
      name: test-volume
  volumes:
  - name: test-volume
    hostPath:
      path: /etc # Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: test
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: test-container
    volumeMounts:
    - mountPath: /data
      name: test-volume
  volumes:
  - name: test-volume
    hostPath:
      path: /mnt/nfs
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://kubernetes.io/docs/concepts/storage/volumes/#hostpath">Kubernetes Documentation</a> - Volumes </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284.html">MITRE, CWE-668</a> - Exposure of Resource to Wrong Sphere </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kubernetes:S6431"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kubernetes:S6431">
              kubernetes:S6431
            </a>
          </td>
          <td >
            <details>
              <p>Using host operating system namespaces can lead to compromise of the host systems.<br> These attacks would target:</p>
<ul>
  <li> host processes </li>
  <li> host inter-process communication (IPC) mechanisms </li>
  <li> network services of the local host system </li>
</ul>
<p>These three items likely include systems that support either the internal operation of the Kubernetes cluster or the enterprise’s internal
infrastructure.</p>
<p>Opening these points to containers opens new attack surfaces for attackers who have already successfully exploited services exposed by containers.
Depending on how resilient the cluster is, attackers can extend their attack to the cluster by compromising the nodes from which the cluster started
the process.</p>
<p>Host network sharing could provide a significant performance advantage for workloads that require critical network performance. However, the
successful exploitation of this attack vector could have a catastrophic impact on confidentiality within the cluster.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The services of this Pod are accessible to people who are not administrators of the Kubernetes cluster. </li>
  <li> The cluster’s services performances do <strong>not</strong> rely on operating system namespaces. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Do not use host operating system namespaces.</p>
<h2>Sensitive Code Example</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: example
  spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
  hostPID: true     # Sensitive
  hostIPC: true     # Sensitive
  hostNetwork: true # Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: example
  spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
  hostPID: false
  hostIPC: false
  hostNetwork: false
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284.html">MITRE, CWE-284</a> - Improper Access Control </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kubernetes:S6430"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kubernetes:S6430">
              kubernetes:S6430
            </a>
          </td>
          <td >
            <details>
              <p>Allowing process privilege escalations exposes the Pod to attacks that exploit setuid binaries.</p>
<p>This field directly controls whether the <code>no_new_privs</code> flag is set in the container process.<br> When this flag is enabled, binaries
configured with setuid or setgid bits cannot change their runtime uid or gid: Potential attackers must rely on other privilege escalation techniques
to successfully operate as root on the Pod.</p>
<p>Depending on how resilient the Kubernetes cluster and Pods are, attackers can extend their attack to the cluster by compromising the nodes from
which the cluster started the Pod.</p>
<p>The <code>allowPrivilegeEscalation</code> field should not be set to true unless the Pod’s risks related to setuid or setgid bits have been
mitigated.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> This Pod is accessible to people who are not administrators of the Kubernetes cluster. </li>
  <li> This Pod contains binaries with setuid or setgid capabilities. </li>
</ul>
<p>There is a risk if you answered yes to all of these questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Disable privilege escalation.</p>
<h2>Sensitive Code Example</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
      securityContext:
        allowPrivilegeEscalation: true # Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
    - name: web
      image: nginx
      ports:
        - name: web
          containerPort: 80
          protocol: TCP
      securityContext:
        allowPrivilegeEscalation: false
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284.html">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt">Linux Kernel Archives, no_new_privs</a> - Official docs </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kubernetes:S6429"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kubernetes:S6429">
              kubernetes:S6429
            </a>
          </td>
          <td >
            <details>
              <p>Exposing Docker sockets can lead to compromise of the host systems.</p>
<p>The Docker daemon provides an API to access its functionality, for example through a UNIX domain socket. Mounting the Docker socket into a
container allows the container to control the Docker daemon of the host system, resulting in full access over the whole system. A compromised or rogue
container with access to the Docker socket could endanger the integrity of the whole Kubernetes cluster.</p>
<h2>Ask Yourself Whether</h2>
<ul>
  <li> The Pod is untrusted or might contain vulnerabilities. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It is recommended to never add a Docker socket as a volume to a Pod.</p>
<h2>Sensitive Code Example</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: test
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: test-container
    volumeMounts:
    - mountPath: /var/run/docker.sock
      name: test-volume
  volumes:
  - name: test-volume
    hostPath:
      path: /var/run/docker.sock # Sensitive
      type: Socket
</pre>
<h2>Compliant Solution</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: test
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: test-container
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://kubernetes.io/docs/concepts/storage/volumes/#hostpath">Kubernetes Documentation</a> - Volumes </li>
  <li> <a href="https://docs.docker.com/engine/reference/commandline/dockerd/#daemon-socket-option">Docker Documention</a> - Daemon socket option
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284.html">MITRE, CWE-284</a> - Improper Access Control </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kubernetes:S5849"><a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kubernetes:S5849">
              kubernetes:S5849
            </a>
          </td>
          <td >
            <details>
              <p>Setting capabilities can lead to privilege escalation and container escapes.</p>
<p>Linux capabilities allow you to assign narrow slices of <code>root</code>'s permissions to processes. A thread with capabilities bypasses the
normal kernel security checks to execute high-privilege actions such as mounting a device to a directory, without requiring additional root
privileges.</p>
<p>In a container, capabilities might allow to access resources from the host system which can result in container escapes. For example, with the
capability <code>SYS_ADMIN</code> an attacker might be able to mount devices from the host system inside of the container.</p>
<h2>Ask Yourself Whether</h2>
<p>Capabilities are granted:</p>
<ul>
  <li> To a process that does not require all capabilities to do its job. </li>
  <li> To a not trusted process. </li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Capabilities are high privileges, traditionally associated with superuser (root), thus make sure that the most restrictive and necessary
capabilities are assigned.</p>
<h2>Sensitive Code Example</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: test-container
    securityContext:
      capabilities:
        add: ["SYS_ADMIN"] # Sensitive
</pre>
<h2>Compliant Solution</h2>
<pre>
apiVersion: v1
kind: Pod
metadata:
  name: example
spec:
  containers:
  - image: k8s.gcr.io/test-webserver
    name: test-container
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/250">MITRE, CWE-250</a> - Execution with Unnecessary Privileges </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://kubernetes.io/docs/tasks/configure-pod-container/security-context/">Kubernetes Documentation</a> - Configure a Security
  Context for a Pod or Container </li>
  <li> <a href="https://man7.org/linux/man-pages/man7/capabilities.7.html">Linux manual page</a> - capabilities(7) </li>
</ul>
            </details>
          </td>
        </tr>
        
        
      </tbody>
    </table>
    
  </div>

  <div class=detail>
    
    <h3>Known Quality Rules</h3>
    <table class="rulestable">
      <thead>
        <tr>
          <th>Rule</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        
          

        <tr>
          <td id="php:S2115">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2115">
              php:S2115
            </a>
          </td>
          <td>
            <details>
              <p>When relying on the password authentication mode for the database connection, a secure password should be chosen.</p>
<p>This rule raises an issue when an empty password is used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
// example of an empty password when connecting to a mysql database
$conn = new mysqli($servername, $username, "");
</pre>
<h2>Compliant Solution</h2>
<pre>
// generate a secure password, set it to the username database, and store it in a environment variable for instance
$password = getenv('MYSQL_SECURE_PASSWORD');
// then connect to the database
$conn = new mysqli($servername, $username, $password);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication.html">OWASP Top 10 2017 Category A2</a> - Broken
  Authentication </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/521">MITRE, CWE-521</a> - Weak Password Requirements </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S2278">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2278">
              php:S2278
            </a>
          </td>
          <td>
            <details>
              <p>According to the US National Institute of Standards and Technology (NIST), the Data Encryption Standard (DES) is no longer considered secure:</p>
<blockquote>
  <p>Adopted in 1977 for federal agencies to use in protecting sensitive, unclassified information, the DES is being withdrawn because it no longer
  provides the security that is needed to protect federal government information.</p>
  <p>Federal agencies are encouraged to use the Advanced Encryption Standard, a faster and stronger algorithm approved as FIPS 197 in 2001.</p>
</blockquote>
<p>For similar reasons, RC2 should also be avoided.</p>
<h2>Noncompliant Code Example</h2>
<pre>
&lt;?php
  $ciphertext = mcrypt_encrypt(MCRYPT_DES, $key, $plaintext, $mode); // Noncompliant
  // ...
  $ciphertext = mcrypt_encrypt(MCRYPT_DES_COMPAT, $key, $plaintext, $mode); // Noncompliant
  // ...
  $ciphertext = mcrypt_encrypt(MCRYPT_TRIPLEDES, $key, $plaintext, $mode); // Noncompliant
  // ...
  $ciphertext = mcrypt_encrypt(MCRYPT_3DES, $key, $plaintext, $mode); // Noncompliant

  $cipher = "des-ede3-cfb";  // Noncompliant
  $ciphertext_raw = openssl_encrypt($plaintext, $cipher, $key, $options=OPENSSL_RAW_DATA, $iv);
?&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;?php
  $ciphertext = mcrypt_encrypt(MCRYPT_RIJNDAEL_128, $key, $plaintext, MCRYPT_MODE_CBC, $iv);
?&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#DES_USAGE">DES / DESede Unsafe</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS5547'>S5547</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S5547">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5547">
              php:S5547
            </a>
          </td>
          <td>
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Strong_cryptography">Strong cipher algorithms</a> are cryptographic systems resistant to cryptanalysis, they
are not vulnerable to well-known attacks like brute force attacks for example.</p>
<p>A general recommendation is to only use cipher algorithms intensively tested and promoted by the cryptographic community.</p>
<p>More specifically for block cipher, it’s not recommended to use algorithm with a block size inferior than 128 bits.</p>
<h2>Noncompliant Code Example</h2>
<pre>
&lt;?php
// mcrypt_encrypt is deprecated since PHP 7.1
$c1 = mcrypt_encrypt(MCRYPT_DES, $key, $plaintext, $mode);  // Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search
$c2 = mcrypt_encrypt(MCRYPT_DES_COMPAT, $key, $plaintext, $mode); // Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search
$c3 = mcrypt_encrypt(MCRYPT_TRIPLEDES, $key, $plaintext, $mode) // Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
$c4 = mcrypt_encrypt(MCRYPT_3DES, $key, $plaintext, $mode);  // Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
$c5 = mcrypt_encrypt(MCRYPT_BLOWFISH, $key, $plaintext, $mode);  // Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks
$c6 = mcrypt_encrypt(MCRYPT_RC2, $key, $plaintext, $mode);  // Noncompliant: RC2 is vulnerable to a related-key attack
$c7 = mcrypt_encrypt(MCRYPT_RC4, $key, $plaintext, $mode);  // Noncompliant: vulnerable to several attacks (see https://en.wikipedia.org/wiki/RC4#Security)

$c8 = openssl_encrypt($plaintext, "bf-ecb", $key, $options=OPENSSL_RAW_DATA, $iv); // Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks
$c9 = openssl_encrypt($plaintext, "des-ede3", $key, $options=OPENSSL_RAW_DATA, $iv);  // Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
$c10 = openssl_encrypt($plaintext, "des-ofb", $key, $options=OPENSSL_RAW_DATA, $iv);  // Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search
$c11 = openssl_encrypt($plaintext, "rc2-cbc", $key, $options=OPENSSL_RAW_DATA, $iv); // Noncompliant: RC2 is vulnerable to a related-key attack
$c12 = openssl_encrypt($plaintext, "rc4", $key, $options=OPENSSL_RAW_DATA, $iv);  // Noncompliant: vulnerable to several attacks (see https://en.wikipedia.org/wiki/RC4#Security)
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;?php
$c1= openssl_encrypt($plaintext, "aes-256-gcm", $key, $options=OPENSSL_RAW_DATA, $iv); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S2277">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2277">
              php:S2277
            </a>
          </td>
          <td>
            <details>
              <p>Without OAEP in RSA encryption, it takes less work for an attacker to decrypt the data or infer patterns from the ciphertext. This rule logs an
issue when <code>openssl_public_encrypt</code> is used with one the following padding constants: <code>OPENSSL_NO_PADDING</code> or
<code>OPENSSL_PKCS1_PADDING</code> or <code>OPENSSL_SSLV23_PADDING</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
function encrypt($data, $key) {
  $crypted='';
  openssl_public_encrypt($data, $crypted, $key, OPENSSL_NO_PADDING); // Noncompliant
  return $crypted;
}
</pre>
<h2>Compliant Solution</h2>
<pre>
function encrypt($data, $key) {
  $crypted='';
  openssl_public_encrypt($data, $crypted, $key, OPENSSL_PKCS1_OAEP_PADDING);
  return $crypted;
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/780">MITRE, CWE-780</a> - Use of RSA Algorithm without OAEP </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> Derived from FindSecBugs rule <a href="https://h3xstream.github.io/find-sec-bugs/bugs.htm#RSA_NO_PADDING">RSA NoPadding Unsafe</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS5542'>S5542</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S5542">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5542">
              php:S5542
            </a>
          </td>
          <td>
            <details>
              <p>Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity.</p>
<ul>
  <li> For block cipher encryption algorithms (like AES):
    <ul>
      <li> The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block
      always gets encrypted to the same ciphertext block. This mode should never be used. </li>
      <li> The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to <a
      href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a> when used with padding. Using CBC along with Message
      Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s
      recommended to avoid CBC with padding completely. </li>
      <li> The GCM (Galois Counter Mode) mode which <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode#Mathematical_basis">works
      internally</a> with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality.
      Other similar modes are CCM, CWC, EAX, IAPM and OCB. </li>
    </ul>  </li>
  <li> For RSA encryption algorithm, the recommended padding scheme is OAEP. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
$c01 = mcrypt_encrypt(MCRYPT_DES, $key, $plaintext, "ecb"); // Noncompliant: ECB doesn't provide serious message confidentiality
$c02 = mcrypt_encrypt(MCRYPT_DES_COMPAT, $key, $plaintext, "ecb"); // Noncompliant: ECB doesn't provide serious message confidentiality
$c03 = mcrypt_encrypt(MCRYPT_TRIPLEDES, $key, $plaintext, "ecb"); // Noncompliant: ECB doesn't provide serious message confidentiality
$c04 = mcrypt_encrypt(MCRYPT_3DES, $key, $plaintext, "ecb"); // Noncompliant: ECB doesn't provide serious message confidentiality
$c05 = mcrypt_encrypt(MCRYPT_BLOWFISH, $key, $plaintext, "ecb"); // Noncompliant: ECB doesn't provide serious message confidentiality
$c06 = mcrypt_encrypt(MCRYPT_RC2, $key, $plaintext, "ecb"); // Noncompliant: ECB doesn't provide serious message confidentiality
$c07 = mcrypt_encrypt(MCRYPT_RC4, $key, $plaintext, "ecb"); // Noncompliant: ECB doesn't provide serious message confidentiality

function encrypt1($data, $key) {
 $crypted='';
  openssl_public_encrypt($data, $crypted, $key, OPENSSL_NO_PADDING); // Noncompliant: RSA without OAEP padding scheme is not recommanded
  return $crypted;
}

$c1 = openssl_encrypt($plaintext, "BF-ECB", $key, $options=OPENSSL_RAW_DATA, $iv); // Noncompliant: ECB doesn't provide serious message confidentiality
$c2 = openssl_encrypt($plaintext, "RC2-ECB", $key, $options=OPENSSL_RAW_DATA, $iv); // Noncompliant: ECB doesn't provide serious message confidentiality
$c3 = openssl_encrypt($plaintext, "bf-ecb", $key, $options=OPENSSL_RAW_DATA, $iv); // Noncompliant: ECB doesn't provide serious message confidentiality
$c4= openssl_encrypt($plaintext, "des-ecb", $key, $options=OPENSSL_RAW_DATA, $iv); // Noncompliant: ECB doesn't provide serious message confidentiality
$c5 = openssl_encrypt($plaintext, "rc2-ecb", $key, $options=OPENSSL_RAW_DATA, $iv); // Noncompliant: ECB doesn't provide serious message confidentiality
</pre>
<h2>Compliant Solution</h2>
<pre>
$c6 = openssl_encrypt($plaintext, "aes-256-gcm", $key, $options=OPENSSL_RAW_DATA, $iv); // Compliant


function encrypt2($data, $key) {
  $crypted='';
  openssl_public_encrypt($data, $crypted, $key, OPENSSL_PKCS1_OAEP_PADDING);  // Compliant
  return $crypted;
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S3336">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3336">
              php:S3336
            </a>
          </td>
          <td>
            <details>
              <p>PHP’s <code>session.use_trans_sid</code> automatically appends the user’s session id to urls when cookies are disabled. On the face of it, this
seems like a nice way to let uncookie-able users use your site anyway. In reality, it makes those users vulnerable to having their sessions hijacked
by anyone who might:</p>
<ul>
  <li> see the URL over the user’s shoulder </li>
  <li> be sent the URL by the user </li>
  <li> retrieve the URL from browser history </li>
  <li> …​ </li>
</ul>
<p>For that reason, it’s better to practice a little "tough love" with your users and force them to turn on cookies.</p>
<p>Since <code>session.use_trans_sid</code> is off by default, this rule raises an issue when it is explicitly enabled.</p>
<h2>Noncompliant Code Example</h2>
<pre>
; php.ini
session.use_trans_sid=1  ; Noncompliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="php:S5876">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5876">
              php:S5876
            </a>
          </td>
          <td>
            <details>
              <p>Session fixation attacks occur when an attacker can force a legitimate user to use a session ID that he knows. To avoid fixation attacks, it’s a
good practice to generate a new session each time a user authenticates and delete/invalidate the existing session (the one possibly known by the
attacker).</p>
<h2>Noncompliant Code Example</h2>
<p>In a <a href="https://symfony.com/doc/current/reference/configuration/security.html#session-fixation-strategy">Symfony Security</a>'s context,
session fixation protection can be disabled with the value <code>none</code> for the <code>session_fixation_strategy</code> attribute:</p>
<pre>
namespace Symfony\Component\DependencyInjection\Loader\Configurator;

return static function (ContainerConfigurator $container) {
    $container-&gt;extension('security', [
        'session_fixation_strategy' =&gt; 'none', // Noncompliant
    ]);
};
</pre>
<h2>Compliant Solution</h2>
<p>In a <a href="https://symfony.com/doc/current/reference/configuration/security.html#session-fixation-strategy">Symfony Security</a>'s context,
session fixation protection is enabled by default. It can be explicitly enabled with the values <code>migrate</code> and <code>invalidate</code> for
the <code>session_fixation_strategy</code> attribute:</p>
<pre>
namespace Symfony\Component\DependencyInjection\Loader\Configurator;

return static function (ContainerConfigurator $container) {
    $container-&gt;extension('security', [
        'session_fixation_strategy' =&gt; 'migrate', // Compliant
    ]);
};
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication">OWASP Top 10 2017 Category A2</a> -
  Broken Authentication </li>
  <li> <a href="https://owasp.org/www-community/attacks/Session_fixation">OWASP Sesssion Fixation</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/384">MITRE, CWE-384</a> - Session Fixation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S3337">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3337">
              php:S3337
            </a>
          </td>
          <td>
            <details>
              <p><code>enable_dl</code> is on by default and allows <code>open_basedir</code> restrictions, which limit the files a script can access, to be
ignored. For that reason, it’s a dangerous option and should be explicitly turned off.</p>
<p>This rule raises an issue when <code>enable_dl</code> is not explicitly set to 0 in <em>php.ini</em>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
; php.ini
enable_dl=1  ; Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
; php.ini
enable_dl=0
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/23">MITRE, CWE-23</a> - Relative Path Traversal </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/36">MITRE, CWE-36</a> - Absolute Path Traversal </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S3334">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3334">
              php:S3334
            </a>
          </td>
          <td>
            <details>
              <p><code>allow_url_fopen</code> and <code>allow_url_include</code> allow code to be read into a script from URL’s. The ability to suck in executable
code from outside your site, coupled with imperfect input cleansing could lay your site bare to attackers. Even if your input filtering is perfect
today, are you prepared to bet your site that it will always be perfect in the future?</p>
<p>This rule raises an issue when either property is explicitly enabled in <em>php.ini</em> and when <code>allow_url_fopen</code>, which defaults to
enabled, is not explicitly disabled.</p>
<h2>Noncompliant Code Example</h2>
<pre>
; php.ini  Noncompliant; allow_url_fopen not explicitly disabled
allow_url_include=1  ; Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
; php.ini
allow_url_fopen=0
allow_url_include=0
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A03_2021-Injection/">OWASP Top 10 2021 Category A3</a> - Injection </li>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/829">MITRE, CWE-829</a> - Inclusion of Functionality from Untrusted Control Sphere </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4423">
              php:S4423
            </a>
          </td>
          <td>
            <details>
              <p>This rule raises an issue when an insecure TLS protocol version (i.e. a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2", or "DTLSv1.3") is
used or allowed.</p>
<p>It is recommended to enforce TLS 1.2 as the minimum protocol version and to disallow older versions like TLS 1.0. Failure to do so could open the
door to downgrade attacks: a malicious actor who is able to intercept the connection could modify the requested protocol version and downgrade it to a
less secure version.</p>
<p>In most cases, using the default system configuration is not compliant. Indeed, an application might get deployed on a wide range of systems with
different configurations. While using a system’s default value might be safe on modern up-to-date systems, this might not be the case on older
systems. It is therefore recommended to explicitly set a safe configuration in every case.</p>
<h2>Noncompliant Code Example</h2>
<pre>
$ctx = stream_context_create([
  'ssl' =&gt; [
    'crypto_method' =&gt;
      STREAM_CRYPTO_METHOD_TLSv1_1_CLIENT // Noncompliant
  ],
]);
</pre>
<h2>Compliant Solution</h2>
<pre>
$ctx = stream_context_create([
    'ssl' =&gt; [
        'crypto_method' =&gt; STREAM_CRYPTO_METHOD_TLSv1_2_CLIENT
    ],
]);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S4426">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4426">
              php:S4426
            </a>
          </td>
          <td>
            <details>
              <p>Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks.</p>
<p><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST recommendations</a> will be checked for these
use-cases:</p>
<p><strong>Digital Signature Generation</strong> and <strong>Verification:</strong></p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DSA (<code>p</code> is key length and <code>q</code> the modulus length) </li>
  <li> n ≥ 2048 for RSA (<code>n</code> is the key length) </li>
</ul>
<p><strong>Key Agreement</strong>:</p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DH and MQV </li>
  <li> n ≥ 224 for ECDH and ECMQV (Examples: <code>secp192r1</code> is a non-compliant curve (<code>n</code> &lt; 224) but <code>secp224k1</code> is
  compliant (<code>n</code> &gt;= 224)) </li>
</ul>
<p><strong>Symmetric keys</strong>:</p>
<ul>
  <li> key length ≥ 128 bits </li>
</ul>
<p>This rule will not raise issues for ciphers that are considered weak (no matter the key size) like <code>DES</code>, <code>Blowfish</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
$config = array(
    "digest_alg" =&gt; "sha512",
    "private_key_bits" =&gt; 1024, // Noncompliant
    "private_key_type" =&gt; OPENSSL_KEYTYPE_RSA,
);
$res = openssl_pkey_new($config);
</pre>
<h2>Compliant Solution</h2>
<pre>
$config = array(
    "digest_alg" =&gt; "sha512",
    "private_key_bits" =&gt; 2048 // Compliant
    "private_key_type" =&gt; OPENSSL_KEYTYPE_RSA,
);
$res = openssl_pkey_new($config);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST 800-131A</a> - Recommendation for Transitioning the
  Use of Cryptographic Algorithms and Key Lengths </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="php:S3332">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3332">
              php:S3332
            </a>
          </td>
          <td>
            <details>
              <p>Cookies without fixed lifetimes or expiration dates are known as non-persistent, or "session" cookies, meaning they last only as long as the
browser session, and poof away when the browser closes. Cookies with expiration dates, "persistent" cookies, are stored/persisted until those
dates.</p>
<p>Non-persistent cookies should be used for the management of logged-in sessions on web sites. To make a cookie non-persistent, simply omit the
<code>expires</code> attribute.</p>
<p>This rule raises an issue when <code>expires</code> is set for a session cookie, either programmatically or via configuration, such as
<code>session.cookie_lifetime</code>.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html#expire-and-max-age-attributes">OWASP, Session
  Management Cheat Sheet</a> - Expire and Max-Age Attributes </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#COOKIE_PERSISTENT">COOKIE_PERSISTENT</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S3335">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3335">
              php:S3335
            </a>
          </td>
          <td>
            <details>
              <p>The <code>cgi.force_redirect</code> <em>php.ini</em> configuration is on by default, and it prevents unauthenticated access to scripts when PHP is
running as a CGI. Unfortunately, it must be disabled on IIS, OmniHTTPD and Xitami, but in all other cases it should be on.</p>
<p>This rule raises an issue when when <code>cgi.force_redirect</code> is explicitly disabled.</p>
<h2>Noncompliant Code Example</h2>
<pre>
; php.ini
cgi.force_redirect=0  ; Noncompliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/305">MITRE, CWE-305</a> - Authentication Bypass by Primary Weakness </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S3333">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3333">
              php:S3333
            </a>
          </td>
          <td>
            <details>
              <p>The <code>open_basedir</code> configuration in <em>php.ini</em> limits the files the script can access using, for example, <code>include</code> and
<code>fopen()</code>. Leave it out, and there is no default limit, meaning that any file can be accessed. Include it, and PHP will refuse to access
files outside the allowed path.</p>
<p><code>open_basedir</code> should be configured with a directory, which will then be accessible recursively. However, the use of <code>.</code>
(current directory) as an <code>open_basedir</code> value should be avoided since it’s resolved dynamically during script execution, so a
<code>chdir('/')</code> command could lay the whole server open to the script.</p>
<p>This is not a fool-proof configuration; it can be reset or overridden at the script level. But its use should be seen as a minimum due diligence
step. This rule raises an issue when <code>open_basedir</code> is not present in <em>php.ini</em>, and when <code>open_basedir</code> contains root,
or the current directory (<code>.</code>) symbol.</p>
<h2>Noncompliant Code Example</h2>
<pre>
; php.ini try 1
; open_basedir="${USER}/scripts/data"  Noncompliant; commented out

; php.ini try 2
open_basedir="/:${USER}/scripts/data"  ; Noncompliant; root directory in the list
</pre>
<h2>Compliant Solution</h2>
<pre>
; php.ini try 1
open_basedir="${USER}/scripts/data"
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/23">MITRE, CWE-23</a> - Relative Path Traversal </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/36">MITRE, CWE-36</a> - Absolute Path Traversal </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="php:S3338">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S3338">
              php:S3338
            </a>
          </td>
          <td>
            <details>
              <p><code>file_uploads</code> is an on-by-default PHP configuration that allows files to be uploaded to your site. Since accepting <span>candy</span>
files from strangers is inherently dangerous, this feature should be disabled unless it is absolutely necessary for your site.</p>
<p>This rule raises an issue when <code>file_uploads</code> is not explicitly disabled.</p>
<h2>Noncompliant Code Example</h2>
<pre>
; php.ini
file_uploads=1  ; Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
; php.ini
file_uploads=0
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/434">MITRE, CWE-434</a> - Unrestricted Upload of File with Dangerous Type </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="php:S4433">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4433">
              php:S4433
            </a>
          </td>
          <td>
            <details>
              <p>An LDAP client authenticates to an LDAP server with a "bind request" which provides, among other, a <a
href="https://ldapwiki.com/wiki/Simple%20Authentication">simple authentication method</a>.</p>
<p>Simple authentication in LDAP can be used with three different mechanisms:</p>
<ul>
  <li> <em>Anonymous Authentication Mechanism</em> by performing a bind request with a username and password value of zero length. </li>
  <li> <em>Unauthenticated Authentication Mechanism</em> by performing a bind request with a password value of zero length. </li>
  <li> <em>Name/Password Authentication Mechanism</em> by performing a bind request with a password value of non-zero length. </li>
</ul>
<p>Anonymous binds and unauthenticated binds allow access to information in the LDAP directory without providing a password, their use is therefore
strongly discouraged.</p>
<h2>Noncompliant Code Example</h2>
<pre>
$ldapconn = ldap_connect("ldap.example.com");

if ($ldapconn) {
    $ldapbind = ldap_bind($ldapconn); // Noncompliant; anonymous authentication, no user/password provided
}
</pre>
<h2>Compliant Solution</h2>
<pre>
$ldaprdn  = 'uname';
$ldappass = 'password';

$ldapconn = ldap_connect("ldap.example.com");

if ($ldapconn) {
    $ldapbind = ldap_bind($ldapconn, $ldaprdn, $ldappass); // Compliant
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/521">MITRE, CWE-521</a> - Weak Password Requirements </li>
  <li> <a href="https://ldapwiki.com/wiki/Simple%20Authentication">ldapwiki.com</a>- Simple Authentication </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S5527">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5527">
              php:S5527
            </a>
          </td>
          <td>
            <details>
              <p>To establish a SSL/TLS connection not vulnerable to man-in-the-middle attacks, it’s essential to make sure the server presents the right
certificate.</p>
<p>The certificate’s hostname-specific data should match the server hostname.</p>
<p>It’s not recommended to re-invent the wheel by implementing custom hostname verification.</p>
<p>TLS/SSL libraries provide built-in hostname verification functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, FALSE); // Noncompliant
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 0);  // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2); // Compliant; default value is 2 to "check the existence of a common name and also verify that it matches the hostname provided" according to PHP's documentation
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, TRUE); // Compliant: starting from 7.66.0: treats 1 and 2 the same (https://curl.haxx.se/libcurl/c/CURLOPT_SSL_VERIFYHOST.html)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/297">MITRE, CWE-297</a> - Improper Validation of Certificate with Host Mismatch </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S2755">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2755">
              php:S2755
            </a>
          </td>
          <td>
            <details>
              <p>XML standard allows the use of entities, declared in the DOCTYPE of the document, which can be <a
href="https://www.w3.org/TR/xml/#sec-internal-ent">internal</a> or <a href="https://www.w3.org/TR/xml/#sec-external-ent">external</a>.</p>
<p>When parsing the XML file, the content of the external entities is retrieved from an external storage such as the file system or network, which may
lead, if no restrictions are put in place, to arbitrary file disclosures or <a
href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">server-side request forgery (SSRF)</a> vulnerabilities.</p>
<p>It’s recommended to limit resolution of external entities by using one of these solutions:</p>
<ul>
  <li> If DOCTYPE is not necessary, completely disable all DOCTYPE declarations. </li>
  <li> If external entities are not necessary, completely disable their declarations. </li>
  <li> If external entities are necessary then:
    <ul>
      <li> Use XML processor features, if available, to authorize only required protocols (eg: https). </li>
      <li> And use an entity resolver (and optionally an XML Catalog) to resolve only trusted entities. </li>
    </ul>  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://www.php.net/manual/fr/function.simplexml-load-string.php">SimpleXML</a> object:</p>
<pre>
$xml = file_get_contents("xxe.xml");
$doc = simplexml_load_string($xml, "SimpleXMLElement", LIBXML_NOENT); // Noncompliant (LIBXML_NOENT enable external entities substitution)
</pre>
<p><a href="https://www.php.net/manual/fr/class.domdocument.php">DOMDocument</a> object:</p>
<pre>
$doc = new DOMDocument();
$doc-&gt;load("xxe.xml", LIBXML_NOENT); // Noncompliant (LIBXML_NOENT enable external entities substitution)
</pre>
<p><a href="https://www.php.net/manual/fr/xmlreader.xml.php">XMLReader</a> object:</p>
<pre>
$reader = new XMLReader();
$reader-&gt;open("xxe.xml");
$reader-&gt;setParserProperty(XMLReader::SUBST_ENTITIES, true); // Noncompliant (SUBST_ENTITIES enable external entities substitution)
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.php.net/manual/fr/function.simplexml-load-string.php">SimpleXML</a> object:</p>
<pre>
$xml = file_get_contents("xxe.xml");
$doc = simplexml_load_string($xml, "SimpleXMLElement"); // Compliant (external entities substitution are disabled by default)
</pre>
<p><a href="https://www.php.net/manual/fr/class.domdocument.php">DOMDocument</a> object:</p>
<pre>
$doc = new DOMDocument();
$doc-&gt;load("xxe.xml"); // Compliant (external entities substitution are disabled by default)
</pre>
<p><a href="https://www.php.net/manual/fr/xmlreader.xml.php">XMLReader</a> object:</p>
<pre>
$reader = new XMLReader();
$reader-&gt;open("xxe.xml");
$reader-&gt;setParserProperty(XMLReader::SUBST_ENTITIES, false); // Compliant (SUBST_ENTITIES set to false)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#php">OWASP XXE Prevention Cheat
  Sheet</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/611">MITRE, CWE-611</a> - Information Exposure Through XML External Entity Reference </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/827">MITRE, CWE-827</a> - Improper Control of Document Type Definition </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S2070">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2070">
              php:S2070
            </a>
          </td>
          <td>
            <details>
              <p>The MD5 algorithm and its successor, SHA-1, are no longer considered secure, because it is too easy to create hash collisions with them. That is,
it takes too little computational effort to come up with a different input that produces the same MD5 or SHA-1 hash, and using the new, same-hash
value gives an attacker the same access as if he had the originally-hashed value. This applies as well to the other Message-Digest algorithms: MD2,
MD4, MD6, HAVAL-128, HMAC-MD5, DSA (which uses SHA-1), RIPEMD, RIPEMD-128, RIPEMD-160, HMACRIPEMD160.</p>
<p>Consider using safer alternatives, such as SHA-256, SHA-512 or SHA-3.</p>
<h2>Noncompliant Code Example</h2>
<pre>
$password = ...

if (md5($password) === '1f3870be274f6c49b3e31a0c6728957f') { // Noncompliant; md5() hashing algorithm is not secure for password management
   [...]
}

if (sha1($password) === 'd0be2dc421be4fcd0172e5afceea3970e2f3d940') { // Noncompliant; sha1() hashing algorithm is not secure for password management
   [...]
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/328">MITRE, CWE-328</a> - Reversible One-Way Hash </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://shattered.io/">SHAttered</a> - The first concrete collision attack against SHA-1. </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=php%3AS4790'>S4790</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S2964">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2964">
              php:S2964
            </a>
          </td>
          <td>
            <details>
              <p><code>sleep</code> is sometimes used in a mistaken attempt to prevent Denial of Service (DoS) attacks by throttling response rate. But because it
ties up a thread, each request takes longer to serve that it otherwise would, making the application <em>more</em> vulnerable to DoS attacks, rather
than less.</p>
<h2>Noncompliant Code Example</h2>
<pre>
if (is_bad_ip($requester)) {
  sleep(5);  // Noncompliant
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S2053">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S2053">
              php:S2053
            </a>
          </td>
          <td>
            <details>
              <p>In cryptography, a "salt" is an extra piece of data which is included when hashing a password. This makes <code>rainbow-table attacks</code> more
difficult. Using a cryptographic hash function without an unpredictable salt increases the likelihood that an attacker could successfully find the
hash value in databases of precomputed hashes (called <code>rainbow-tables</code>).</p>
<p>This rule raises an issue when a hashing function which has been specifically designed for hashing passwords, such as <code>PBKDF2</code>, is used
with a non-random, reused or too short salt value. It does not raise an issue on base hashing algorithms such as <code>sha1</code> or <code>md5</code>
as they should not be used to hash passwords.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use hashing functions generating their own secure salt or generate a secure random value of at least 16 bytes. </li>
  <li> The salt should be unique by user password. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
function createMyAccount() {
  $email = $_GET['email'];
  $name = $_GET['name'];
  $password = $_GET['password'];

  $hash = hash_pbkdf2('sha256', $password, $email, 100000); // Noncompliant; salt (3rd argument) is predictable because initialized with the provided $email

  $hash = hash_pbkdf2('sha256', $password, '', 100000); // Noncompliant; salt is empty

  $hash = hash_pbkdf2('sha256', $password, 'D8VxSmTZt2E2YV454mkqAY5e', 100000); // Noncompliant; salt is hardcoded

  $hash = crypt($password); // Noncompliant; salt is not provided; fails in PHP 8
  $hash = crypt($password, ""); // Noncompliant; salt is hardcoded; fails in PHP 8

  $options = [
    'cost' =&gt; 11,
    'salt' =&gt; mcrypt_create_iv(22, MCRYPT_DEV_URANDOM), // Noncompliant ; use salt generated by default
  ];
  echo password_hash("rasmuslerdorf", PASSWORD_BCRYPT, $options);
}
</pre>
<h2>Compliant Solution</h2>
<pre>
$salt = openssl_random_pseudo_bytes(16);
$hash = hash_pbkdf2("sha256", $password, $salt, $iterations, 20);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/759">MITRE, CWE-759</a> - Use of a One-Way Hash without a Salt </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/760">MITRE, CWE-760</a> - Use of a One-Way Hash with a Predictable Salt </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="php:S4830">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S4830">
              php:S4830
            </a>
          </td>
          <td>
            <details>
              <p>Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.</p>
<p>The certificate chain validation includes these steps:</p>
<ul>
  <li> The certificate is issued by its parent Certificate Authority or the root CA trusted by the system. </li>
  <li> Each CA is allowed to issue certificates. </li>
  <li> Each certificate in the chain is not expired. </li>
</ul>
<p>It’s not recommended to reinvent the wheel by implementing custom certificate chain validation.</p>
<p>TLS libraries provide built-in certificate validation functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE); // Noncompliant
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);  // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, TRUE); // Compliant; default value is TRUE
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 1);  // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S5808">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S5808">
              php:S5808
            </a>
          </td>
          <td>
            <details>
              <p>Authorizations granted or not to users to access resources of an application should be based on strong decisions. For instance, checking whether
the user is authenticated or not, has the right roles/privileges. It may also depend on the user’s location, or the date, time when the user requests
access.</p>
<h2>Noncompliant Code Example</h2>
<p>In a Symfony web application:</p>
<ul>
  <li> the <code>vote</code> method of a <a href="https://symfony.com/doc/current/security/voters.html">VoterInterface</a> type is not compliant when
  it returns only an affirmative decision (<code>ACCESS_GRANTED</code>): </li>
</ul>
<pre>
class NoncompliantVoterInterface implements VoterInterface
{
    public function vote(TokenInterface $token, $subject, array $attributes)
    {
        return self::ACCESS_GRANTED; // Noncompliant
    }
}
</pre>
<ul>
  <li> the <code>voteOnAttribute</code> method of a <a href="https://symfony.com/doc/current/security/voters.html">Voter</a> type is not compliant
  when it returns only an affirmative decision (<code>true</code>): </li>
</ul>
<pre>
class NoncompliantVoter extends Voter
{
    protected function supports(string $attribute, $subject)
    {
        return true;
    }

    protected function voteOnAttribute(string $attribute, $subject, TokenInterface $token)
    {
        return true; // Noncompliant
    }
}
</pre>
<p>In a Laravel web application:</p>
<ul>
  <li> the <code>define</code>, <code>before</code>, and <code>after</code> methods of a <a href="https://laravel.com/docs/8.x/authorization">Gate</a>
  are not compliant when they return only an affirmative decision (<code>true</code> or <code>Response::allow()</code>): </li>
</ul>
<pre>
class NoncompliantGuard
{
    public function boot()
    {
        Gate::define('xxx', function ($user) {
            return true; // Noncompliant
        });

        Gate::define('xxx', function ($user) {
            return Response::allow(); // Noncompliant
        });
    }
}
</pre>
<h2>Compliant Solution</h2>
<p>In a Symfony web application:</p>
<ul>
  <li> the <code>vote</code> method of a <a href="https://symfony.com/doc/current/security/voters.html">VoterInterface</a> type should return a
  negative decision (<code>ACCESS_DENIED</code>) or abstain from making a decision (<code>ACCESS_ABSTAIN</code>): </li>
</ul>
<pre>
class CompliantVoterInterface implements VoterInterface
{
    public function vote(TokenInterface $token, $subject, array $attributes)
    {
        if (foo()) {
            return self::ACCESS_GRANTED; // Compliant
        } else if (bar()) {
            return self::ACCESS_ABSTAIN;
        }
        return self::ACCESS_DENIED;
    }
}
</pre>
<ul>
  <li> the <code>voteOnAttribute</code> method of a <a href="https://symfony.com/doc/current/security/voters.html">Voter</a> type should return a
  negative decision (<code>false</code>): </li>
</ul>
<pre>
class CompliantVoter extends Voter
{
    protected function supports(string $attribute, $subject)
    {
        return true;
    }

    protected function voteOnAttribute(string $attribute, $subject, TokenInterface $token)
    {
        if (foo()) {
            return true; // Compliant
        }
        return false;
    }
}
</pre>
<p>In a Laravel web application:</p>
<ul>
  <li> the <code>define</code>, <code>before</code>, and <code>after</code> methods of a <a href="https://laravel.com/docs/8.x/authorization">Gate</a>
  should return a negative decision (<code>false</code> or <code>Response::deny()</code>) or abstain from making a decision (<code>null</code>): </li>
</ul>
<pre>
class NoncompliantGuard
{
    public function boot()
    {
        Gate::define('xxx', function ($user) {
            if (foo()) {
                return true; // Compliant
            }
            return false;
        });

        Gate::define('xxx', function ($user) {
            if (foo()) {
                return Response::allow(); // Compliant
            }
            return Response::deny();
        });
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/285">MITRE, CWE-285</a> - Improper Authorization </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="php:S6339">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=php:S6339">
              php:S6339
            </a>
          </td>
          <td>
            <details>
              <p>Secret keys are used in combination with an algorithm to encrypt data. A typical use case is an authentication system. For such a system to be
secure, the secret key should have a value which cannot be guessed and which is long enough to not be vulnerable to brute-force attacks.</p>
<p>A "salt" is an extra piece of data which is included when hashing data such as a password. Its value should have the same properties as a secret
key.</p>
<p>This rule raises an issue when it detects that a secret key or a salt has a predictable value or that it’s not long enough.</p>
<h2>Noncompliant Code Example</h2>
<p>WordPress:</p>
<pre>
define('AUTH_KEY', 'hello'); // Noncompliant
define('AUTH_SALT', 'hello'); // Noncompliant
define('AUTH_KEY', 'put your unique phrase here'); // Noncompliant, this is the default value
</pre>
<h2>Compliant Solution</h2>
<p>WordPress:</p>
<pre>
define('AUTH_KEY', 'D&amp;ovlU#|CvJ##uNq}bel+^MFtT&amp;.b9{UvR]g%ixsXhGlRJ7q!h}XWdEC[BOKXssj');
define('AUTH_SALT', 'FIsAsXJKL5ZlQo)iD-pt??eUbdc{_Cn&lt;4!d~yqz))&amp;B D?AwK%)+)F2aNwI|siOe');
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://wordpress.org/support/article/editing-wp-config-php/#security-keys">wordpress.org</a> - WordPress Security Keys </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="kotlin:S6301">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S6301">
              kotlin:S6301
            </a>
          </td>
          <td>
            <details>
              <p>Storing data locally is a common task for mobile applications. There are many convenient solutions that allow storing data persistently, for
example SQLiteDatabase and Realm. These systems can be initialized with a secret key in order to store the data encrypted.</p>
<p>The encryption key is meant to stay secret and should not be hard-coded in the application as it would mean that:</p>
<ul>
  <li> All user would use the same encryption key. </li>
  <li> The encryption key would be known by anyone who as access to the source code or the application binary code. </li>
  <li> Data stored encrypted in the database would not be protected. </li>
</ul>
<p>There are different approaches how the key can be provided to encrypt and decrypt the database. One of the most convinient way to is to rely on
<code>EncryptedSharedPreferences</code> to store encryption keys. It can also be provided dynamically by the user of the application or fetched from a
remote server.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://www.zetetic.net/sqlcipher/sqlcipher-for-android/">SQLCipher</a></p>
<pre>
val key = "gb09ym9ydoolp3w886d0tciczj6ve9kszqd65u7d126040gwy86xqimjpuuc788g"
val db = SQLiteDatabase.openOrCreateDatabase("test.db", key, null) // Noncompliant
</pre>
<p><a href="https://github.com/realm/realm-kotlin/">Realm</a></p>
<pre>
val key = "gb09ym9ydoolp3w886d0tciczj6ve9kszqd65u7d126040gwy86xqimjpuuc788g"
val config = RealmConfiguration.Builder()
    .encryptionKey(key.toByteArray()) // Noncompliant
    .build()
val realm = Realm.getInstance(config)
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.zetetic.net/sqlcipher/sqlcipher-for-android/">SQLCipher</a></p>
<pre>
val db = SQLiteDatabase.openOrCreateDatabase("test.db", getKey(), null)
</pre>
<p><a href="https://github.com/realm/realm-kotlin/">Realm</a></p>
<pre>
val config = RealmConfiguration.Builder()
    .encryptionKey(getKey())
    .build()
val realm = Realm.getInstance(config)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/321">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="kotlin:S6432">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S6432">
              kotlin:S6432
            </a>
          </td>
          <td>
            <details>
              <p>When encrypting data with Counter (CTR) derived block cipher modes of operation, it is essential not to reuse the same initialization vector (IV)
with a given key, such IV is called a "nonce" (number used only once). Galois/Counter (GCM) and Counter with Cipher Block Chaining-Message
Authentication Code (CCM) are both CTR-based modes of operation.</p>
<p>An attacker, who has knowledge of one plaintext (original content) and ciphertext (encrypted content) pair, is able to retrieve the corresponding
plaintext of any other ciphertext generated with the same IV and key. It also drastically decreases the key recovery computational complexity by
downgrading it to a simpler polynomial root-finding problem.</p>
<p>When using GCM, NIST recommends a 96 bit length nonce using a 'Deterministic' approach or at least 96 bits using a 'Random Bit Generator (RBG)'.
The 'Deterministic' construction involves a counter, which increments per encryption process. The 'RBG' construction, as the name suggests, generates
the nonce using a random bit generator. Collision probabilities (nonce-key pair reuse) using the 'RBG-based' approach require a shorter key rotation
period, 2^32 maximum invocations per key.</p>
<h2>Noncompliant Code Example</h2>
<pre>
fun encrypt(key: ByteArray, ptxt: ByteArray) {
    val nonce: ByteArray = "7cVgr5cbdCZV".toByteArray() // The initialization vector is a static value

    val gcmSpec  = GCMParameterSpec(128, nonce) // The initialization vector is configured here
    val skeySpec = SecretKeySpec(key, "AES")

    val cipher: Cipher = Cipher.getInstance("AES/GCM/NoPadding")
    cipher.init(Cipher.ENCRYPT_MODE, skeySpec, gcmSpec) // Noncompliant
}
</pre>
<h2>Compliant Solution</h2>
<pre>
fun encrypt(key: ByteArray, ptxt: ByteArray) {
    val random: SecureRandom = SecureRandom()
    val nonce: ByteArray     = ByteArray(12)
    random.nextBytes(nonce) // Random 96 bit IV

    val gcmSpec  = GCMParameterSpec(128, nonce)
    val skeySpec = SecretKeySpec(key, "AES")

    val cipher: Cipher = Cipher.getInstance("AES/GCM/NoPadding")
    cipher.init(Cipher.ENCRYPT_MODE, skeySpec, gcmSpec)
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure
  </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/323">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST, SP-800-38A</a> - Recommendation for Block Cipher
  Modes of Operation </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38c.pdf">NIST, SP-800-38C</a> - Recommendation for Block Cipher
  Modes of Operation: The CCM Mode for Authentication and Confidentiality </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf">NIST, SP-800-38D</a> - Recommendation for Block Cipher
  Modes of Operation: Galois/Counter Mode (GCM) and GMAC </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S3329">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S3329">
              kotlin:S3329
            </a>
          </td>
          <td>
            <details>
              <p>When encrypting data with the Cipher Block Chaining (CBC) mode an Initialization Vector (IV) is used to randomize the encryption, ie under a given
key the same plaintext doesn’t always produce the same ciphertext. The IV doesn’t need to be secret but should be unpredictable to avoid
"Chosen-Plaintext Attack".</p>
<p>To generate Initialization Vectors, NIST recommends to use a secure random number generator.</p>
<h2>Noncompliant Code Example</h2>
<pre>
val bytesIV = "7cVgr5cbdCZVw5WY".toByteArray(charset("UTF-8")) // Predictable / hardcoded IV

val iv = IvParameterSpec(bytesIV)
val skeySpec = SecretKeySpec(secretKey.toByteArray(), "AES")

val cipher: Cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING")
cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv) // Noncompliant (s3329)

val encryptedBytes: ByteArray = cipher.doFinal("foo".toByteArray())
</pre>
<h2>Compliant Solution</h2>
<pre>
val random: SecureRandom = SecureRandom()

val bytesIV: ByteArray = ByteArray(16)
random.nextBytes(bytesIV); // Unpredictable / random IV

val iv = IvParameterSpec(bytesIV)
val skeySpec = SecretKeySpec(secretKey.toByteArray(), "AES")

val cipher: Cipher = Cipher.getInstance("AES/CBC/PKCS5PADDING")
cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv) //Compliant (s3329)

val encryptedBytes: ByteArray = cipher.doFinal("foo".toByteArray())
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure
  </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/329">MITRE, CWE-329</a> - Not Using an Unpredictable IV with CBC Mode </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST, SP-800-38A</a> - Recommendation for Block Cipher
  Modes of Operation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S4347">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S4347">
              kotlin:S4347
            </a>
          </td>
          <td>
            <details>
              <p>The <code>java.security.SecureRandom</code> class provides a strong random number generator (RNG) appropriate for cryptography. However, seeding it
with a constant or another predictable value will weaken it significantly. In general, it is much safer to rely on the seed provided by the
<code>SecureRandom</code> implementation.</p>
<p>This rule raises an issue when <code>SecureRandom.setSeed()</code> or <code>SecureRandom(byte[])</code> are called with a seed that is either one
of:</p>
<ul>
  <li> a constant </li>
  <li> the system time </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
val sr = SecureRandom()
sr.setSeed(123456L) // Noncompliant
val v = sr.nextInt()
</pre>
<pre>
val sr = SecureRandom("abcdefghijklmnop".toByteArray(charset("us-ascii"))) // Noncompliant
val v = sr.nextInt()
</pre>
<h2>Compliant Solution</h2>
<pre>
val sr = SecureRandom()
val v = sr.nextInt()
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/332">MITRE, CWE-332</a> - Insufficient Entropy in PRNG </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/336">MITRE, CWE-336</a> - Same Seed in Pseudo-Random Number Generator (PRNG) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/337">MITRE, CWE-337</a> - Predictable Seed in Pseudo-Random Number Generator (PRNG) </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded">CERT, MSC63J.</a> - Ensure that
  SecureRandom is properly seeded </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="kotlin:S2053">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S2053">
              kotlin:S2053
            </a>
          </td>
          <td>
            <details>
              <p>In cryptography, a "salt" is an extra piece of data which is included when hashing a password. This makes <code>rainbow-table attacks</code> more
difficult. Using a cryptographic hash function without an unpredictable salt increases the likelihood that an attacker could successfully find the
hash value in databases of precomputed hashes (called <code>rainbow-tables</code>).</p>
<p>This rule raises an issue when a hashing function which has been specifically designed for hashing passwords, such as <code>PBKDF2</code>, is used
with a non-random, reused or too short salt value. It does not raise an issue on base hashing algorithms such as <code>sha1</code> or <code>md5</code>
as they should not be used to hash passwords.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use hashing functions generating their own secure salt or generate a secure random value of at least 16 bytes. </li>
  <li> The salt should be unique by user password. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
val salt = "notrandom".toByteArray()

val cipherSpec = PBEParameterSpec(salt, 10000) // Noncompliant, predictable salt
val spec = PBEKeySpec(password, salt, 10000, 256) // Noncompliant, predictable salt
</pre>
<h2>Compliant Solution</h2>
<pre>
val random = SecureRandom()
val salt = ByteArray(16)
random.nextBytes(salt)

val cipherSpec = PBEParameterSpec(salt, 10000) // Compliant
val spec = PBEKeySpec(password, salt, 10000, 256) // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/759">MITRE, CWE-759</a> - Use of a One-Way Hash without a Salt </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/760">MITRE, CWE-760</a> - Use of a One-Way Hash with a Predictable Salt </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="kotlin:S5542">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S5542">
              kotlin:S5542
            </a>
          </td>
          <td>
            <details>
              <p>Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity.</p>
<ul>
  <li> For block cipher encryption algorithms (like AES):
    <ul>
      <li> The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block
      always gets encrypted to the same ciphertext block. This mode should never be used. </li>
      <li> The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to <a
      href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a> when used with padding. Using CBC along with Message
      Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s
      recommended to avoid CBC with padding completely. </li>
      <li> The GCM (Galois Counter Mode) mode which <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode#Mathematical_basis">works
      internally</a> with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality.
      Other similar modes are CCM, CWC, EAX, IAPM and OCB. </li>
    </ul>  </li>
  <li> For RSA encryption algorithm, the recommended padding scheme is OAEP. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
Cipher.getInstance("AES") // Noncompliant: by default ECB mode is chosen
Cipher.getInstance("AES/ECB/NoPadding") // Noncompliant: ECB doesn't provide serious message confidentiality

Cipher.getInstance("AES/CBC/PKCS5Padding") // Noncompliant: Vulnerable to Padding Oracle attacks
Cipher.getInstance("RSA/None/NoPadding") // Noncompliant: RSA without OAEP padding scheme is not recommended
</pre>
<h2>Compliant Solution</h2>
<pre>
// Recommended for block ciphers
Cipher.getInstance("AES/GCM/NoPadding")

// Recommended for RSA
Cipher.getInstance("RSA/None/OAEPWITHSHA-256ANDMGF1PADDING")
// or the ECB mode can be used for RSA when "None" is not available with the security provider used - in that case, ECB will be treated as "None" for RSA.
Cipher.getInstance("RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING")
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/hDdGBQ">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S5547">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S5547">
              kotlin:S5547
            </a>
          </td>
          <td>
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Strong_cryptography">Strong cipher algorithms</a> are cryptographic systems resistant to cryptanalysis, they
are not vulnerable to well-known attacks like brute force attacks for example.</p>
<p>A general recommendation is to only use cipher algorithms intensively tested and promoted by the cryptographic community.</p>
<p>More specifically for block cipher, it’s not recommended to use algorithm with a block size inferior than 128 bits.</p>
<h2>Noncompliant Code Example</h2>
<pre>
import javax.crypto.NoSuchPaddingException
import java.security.NoSuchAlgorithmException
import javax.crypto.Cipher

class test {
    fun main(args: Array&lt;String&gt;) {
        try {
            val c1 = Cipher.getInstance("DES") // Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search
            val c7 = Cipher.getInstance("DESede") // Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
            val c13 = Cipher.getInstance("RC2") // Noncompliant: RC2 is vulnerable to a related-key attack
            val c19 = Cipher.getInstance("RC4") // Noncompliant: vulnerable to several attacks (see https://en.wikipedia.org/wiki/RC4#Security)
            val c25 = Cipher.getInstance("Blowfish") // Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks
            val nc = NullCipher() // Noncompliant: the NullCipher class provides an "identity cipher" one that does not transform or encrypt the plaintext in any way.


        } catch (e: NoSuchAlgorithmException) {
        } catch (e: NoSuchPaddingException) {
        }
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import javax.crypto.NoSuchPaddingException
import java.security.NoSuchAlgorithmException
import javax.crypto.Cipher

class test {
    fun main(args: Array&lt;String&gt;) {
        try {
            val c31 = Cipher.getInstance("AES/GCM/NoPadding") // Compliant

        } catch (e: NoSuchAlgorithmException) {
        } catch (e: NoSuchPaddingException) {
        }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/hDdGBQ">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="kotlin:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S4423">
              kotlin:S4423
            </a>
          </td>
          <td>
            <details>
              <p>This rule raises an issue when an insecure TLS protocol version (i.e. a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2", or "DTLSv1.3") is
used or allowed.</p>
<p>It is recommended to enforce TLS 1.2 as the minimum protocol version and to disallow older versions like TLS 1.0. Failure to do so could open the
door to downgrade attacks: a malicious actor who is able to intercept the connection could modify the requested protocol version and downgrade it to a
less secure version.</p>
<p>In most cases, using the default system configuration is not compliant. Indeed, an application might get deployed on a wide range of systems with
different configurations. While using a system’s default value might be safe on modern up-to-date systems, this might not be the case on older
systems. It is therefore recommended to explicitly set a safe configuration in every case.</p>
<h2>Noncompliant Code Example</h2>
<p><code>javax.net.ssl.SSLContext</code> library:</p>
<pre>
val sc: SSLContext = SSLContext.getInstance("TLSv1.1") // Noncompliant
</pre>
<p><a href="https://square.github.io/okhttp/">okhttp</a> library:</p>
<pre>
val spec: ConnectionSpec = ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)
                .tlsVersions(TlsVersion.TLS_1_1)  // Noncompliant
                .build()
</pre>
<h2>Compliant Solution</h2>
<p><code>javax.net.ssl.SSLContext</code> library:</p>
<pre>
val sc: SSLContext = SSLContext.getInstance("TLSv1.2") // Compliant
</pre>
<p><a href="https://square.github.io/okhttp/">okhttp</a> library:</p>
<pre>
val spec: ConnectionSpec = ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)
                .tlsVersions(TlsVersion.TLS_1_2)  // Compliant
                .build()
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S4426">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S4426">
              kotlin:S4426
            </a>
          </td>
          <td>
            <details>
              <p>Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks.</p>
<p><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST recommendations</a> will be checked for these
use-cases:</p>
<p><strong>Digital Signature Generation</strong> and <strong>Verification:</strong></p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DSA (<code>p</code> is key length and <code>q</code> the modulus length) </li>
  <li> n ≥ 2048 for RSA (<code>n</code> is the key length) </li>
</ul>
<p><strong>Key Agreement</strong>:</p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DH and MQV </li>
  <li> n ≥ 224 for ECDH and ECMQV (Examples: <code>secp192r1</code> is a non-compliant curve (<code>n</code> &lt; 224) but <code>secp224k1</code> is
  compliant (<code>n</code> &gt;= 224)) </li>
</ul>
<p><strong>Symmetric keys</strong>:</p>
<ul>
  <li> key length ≥ 128 bits </li>
</ul>
<p>This rule will not raise issues for ciphers that are considered weak (no matter the key size) like <code>DES</code>, <code>Blowfish</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
val keyPairGen1 = KeyPairGenerator.getInstance("RSA")
keyPairGen1.initialize(1024) // Noncompliant

val keyPairGen5 = KeyPairGenerator.getInstance("EC")
val ecSpec1 = ECGenParameterSpec("secp112r1") // Noncompliant
keyPairGen5.initialize(ecSpec1)

val keyGen1 = KeyGenerator.getInstance("AES")
keyGen1.init(64) // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
val keyPairGen6 = KeyPairGenerator.getInstance("RSA")
keyPairGen6.initialize(2048) // Compliant

val keyPairGen5 = KeyPairGenerator.getInstance("EC")
val ecSpec1 = ECGenParameterSpec("secp256r1") // Compliant
keyPairGen5.initialize(ecSpec1)

val keyGen2 = KeyGenerator.getInstance("AES")
keyGen2.init(128) // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST 800-131A</a> - Recommendation for Transitioning the
  Use of Cryptographic Algorithms and Key Lengths </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="kotlin:S4830">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S4830">
              kotlin:S4830
            </a>
          </td>
          <td>
            <details>
              <p>Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.</p>
<p>The certificate chain validation includes these steps:</p>
<ul>
  <li> The certificate is issued by its parent Certificate Authority or the root CA trusted by the system. </li>
  <li> Each CA is allowed to issue certificates. </li>
  <li> Each certificate in the chain is not expired. </li>
</ul>
<p>It’s not recommended to reinvent the wheel by implementing custom certificate chain validation.</p>
<p>TLS libraries provide built-in certificate validation functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<p><code>checkClientTrusted</code> and/or <code>checkServerTrusted</code> custom implementations from <code>X509TrustManager</code> interface accept
any certificates:</p>
<pre>
// Create a trust manager that does not validate certificate chains
val trustAllCerts = arrayOf&lt;TrustManager&gt;(object : X509TrustManager {
  @Throws(CertificateException::class)
  override fun checkClientTrusted(chain: Array&lt;java.security.cert.X509Certificate&gt;, authType: String) {
  } // Noncompliant (s4830)

  @Throws(CertificateException::class)
  override fun checkServerTrusted(chain: Array&lt;java.security.cert.X509Certificate&gt;, authType: String) {
  } // Noncompliant (s4830)

  override fun getAcceptedIssuers(): Array&lt;java.security.cert.X509Certificate&gt; {
   return arrayOf()
  }
 })

// Install the all-trusting trust manager
val sslContext = SSLContext.getInstance("SSL")
sslContext.init(null, trustAllCerts, java.security.SecureRandom())
</pre>
<h2>Compliant Solution</h2>
<p>By default, when a <code>TrustManager</code> is not set, <code>sslContext</code> will search for a default secure installed security provider:</p>
<pre>
val sslContext = SSLContext.getInstance("SSL")
sslContext.init(null, null, java.security.SecureRandom())
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="kotlin:S5527">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=kotlin:S5527">
              kotlin:S5527
            </a>
          </td>
          <td>
            <details>
              <p>To establish a SSL/TLS connection not vulnerable to man-in-the-middle attacks, it’s essential to make sure the server presents the right
certificate.</p>
<p>The certificate’s hostname-specific data should match the server hostname.</p>
<p>It’s not recommended to re-invent the wheel by implementing custom hostname verification.</p>
<p>TLS/SSL libraries provide built-in hostname verification functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<p>When using the <a href="https://square.github.io/okhttp/4.x/okhttp/okhttp3/-ok-http-client/-builder/hostname-verifier/">okhttp library</a>, a
custom unsecure hostname verifier accepting every hostname is used:</p>
<pre>
val builder = OkHttpClient.Builder()
builder.hostnameVerifier(object : HostnameVerifier {
  override fun verify(hostname: String?, session: SSLSession?): Boolean {
    return true // Noncompliant (s5527)
  }
})
</pre>
<h2>Compliant Solution</h2>
<p>When using the <a href="https://square.github.io/okhttp/4.x/okhttp/okhttp3/-ok-http-client/-builder/hostname-verifier/">okhttp library</a>, if
<code>hostnameVerifier</code> method is not used to set a verifier, then a built-in secure one will be used:</p>
<pre>
val builder = OkHttpClient.Builder()
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/297">MITRE, CWE-297</a> - Improper Validation of Certificate with Host Mismatch </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="cloudformation:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S4423">
              cloudformation:S4423
            </a>
          </td>
          <td>
            <details>
              <p>This rule raises an issue when an insecure TLS protocol version (i.e. a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2", or "DTLSv1.3") is
used or allowed.</p>
<p>It is recommended to enforce TLS 1.2 as the minimum protocol version and to disallow older versions like TLS 1.0. Failure to do so could open the
door to downgrade attacks: a malicious actor who is able to intercept the connection could modify the requested protocol version and downgrade it to a
less secure version.</p>
<p>In most cases, using the default system configuration is not compliant. Indeed, an application might get deployed on a wide range of systems with
different configurations. While using a system’s default value might be safe on modern up-to-date systems, this might not be the case on older
systems. It is therefore recommended to explicitly set a safe configuration in every case.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/opensearch-service/index.html">Amazon OpenSearch domains</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Example:
    Type: AWS::OpenSearchService::Domain
    Properties:
      DomainName: example
      DomainEndpointOptions:
        EnforceHTTPS: true
        TLSSecurityPolicy: "Policy-Min-TLS-1-0-2019-07"  # Noncompliant
</pre>
<p>For <a href="https://aws.amazon.com/api-gateway/">Amazon API Gateway</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  CustomApi:
    Type: AWS::ApiGateway::DomainName
    Properties:
      SecurityPolicy: "TLS_1_0"  # Noncompliant
</pre>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  CustomApi: # Noncompliant
    Type: AWS::ApiGatewayV2::DomainName
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/opensearch-service/index.html">Amazon OpenSearch domains</a>:</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09
Resources:
  Example:
    Type: AWS::OpenSearchService::Domain
    Properties:
      DomainName: example
      DomainEndpointOptions:
        EnforceHTTPS: true
        TLSSecurityPolicy: "Policy-Min-TLS-1-2-2019-07"
</pre>
<p>For <a href="https://aws.amazon.com/api-gateway/">Amazon API Gateway</a>:</p>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  CustomApi:
    Type: AWS::ApiGateway::DomainName
    Properties:
      SecurityPolicy: "TLS_1_2"
</pre>
<pre>
AWSTemplateFormatVersion: '2010-09-09'
Resources:
  CustomApi:
    Type: AWS::ApiGatewayV2::DomainName
    Properties:
      DomainNameConfigurations:
        - SecurityPolicy: "TLS_1_2"
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html">Amazon API Gateway</a> -
  Choosing a minimum TLS version </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="cloudformation:S6321">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6321">
              cloudformation:S6321
            </a>
          </td>
          <td>
            <details>
              <p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and
outbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services
traditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those
held by system administrators or those of <a href="https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls">bastion-like</a>
servers.</p>
<h2>Noncompliant Code Example</h2>
<p>An ingress rule allowing all inbound SSH traffic:</p>
<pre>
MySecurityGroup:
    Type: "AWS::EC2::SecurityGroup"
    Properties:
      GroupDescription: "noncompliant"
      VpcId: !Ref myVPC
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22 # SSH traffic
          CidrIp: "0.0.0.0/0" # from all IP addresses is authorized
</pre>
<h2>Compliant Solution</h2>
<p>An ingress rule allowing inbound SSH traffic from specific IP addresses:</p>
<pre>
MySecurityGroup:
    Type: "AWS::EC2::SecurityGroup"
    Properties:
      GroupDescription: "compliant"
      VpcId: !Ref myVPC
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 22
          ToPort: 22
          CidrIp: "1.2.3.0/24"
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">AWS Documentation</a> - Security groups for your VPC </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview">Azure Documentation</a> - Network security
  groups </li>
  <li> <a href="https://cloud.google.com/vpc/docs/using-firewalls">GCP Documentation</a> - Firewalls </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="cloudformation:S6317">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=cloudformation:S6317">
              cloudformation:S6317
            </a>
          </td>
          <td>
            <details>
              <p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy
which, when attached to an identity or a resource, defines its permissions. Policies granting permission to an Identity (a User, a Group or Role) are
called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>
<p>Here is an example of a policy document defining a limited set of permission that grants a user the ability to manage his own access keys.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "arn:aws:iam::245500951992:user/${aws:username}",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Privilege escalation generally happens when an identity policy gives an identity the ability to grant more privileges than the ones it already has.
Here is another example of a policy document that hides a privilege escalation. It allows an identity to generate a new access key for any user from
the account, including users with high privileges.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Although it looks like it grants a limited set of permissions, this policy would, in practice, give the highest privileges to the identity it’s
attached to.</p>
<p>Privilege escalation is a serious issue as it allows a malicious user to easily escalate to a high privilege identity from a low privilege identity
it took control of.</p>
<p>The example above is just one of many permission escalation vectors. Here is the list of vectors that the rule can detect:</p>
<table>
  <colgroup>
    <col style="width: 50%;">
    <col style="width: 50%;">
  </colgroup>
  <thead>
    <tr>
      <th>Vector name</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><p>Create Policy Version</p></td>
      <td><p>Create a new IAM policy and set it as default</p></td>
    </tr>
    <tr>
      <td><p>Set Default Policy Version</p></td>
      <td><p>Set a different IAM policy version as default</p></td>
    </tr>
    <tr>
      <td><p>Create AccessKey</p></td>
      <td><p>Create a new access key for any user</p></td>
    </tr>
    <tr>
      <td><p>Create Login Profile</p></td>
      <td><p>Create a login profile with a password chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Update Login Profile</p></td>
      <td><p>Update the existing password with one chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Attach User Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Group Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a group containing a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Role Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a role that can be assumed by the user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put User Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Group Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a group containing a user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Role Policy</p></td>
      <td><p>Alter an existing inline IAM role policy. The rule will then be assumed by the user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Add User to Group</p></td>
      <td><p>Add a user that the attacker controls to a group that has a larger range of permissions</p></td>
    </tr>
    <tr>
      <td><p>Update Assume Role Policy</p></td>
      <td><p>Update a role’s "AssumeRolePolicyDocument" to allow a user the attacker controls to assume it</p></td>
    </tr>
    <tr>
      <td><p>EC2</p></td>
      <td><p>Create an EC2 instance that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Invoke</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and invoke it</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Add Permission</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and grant permission to invoke it to a user or a service</p></td>
    </tr>
    <tr>
      <td><p>Lambda triggered with an external event</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and link it to an external event</p></td>
    </tr>
    <tr>
      <td><p>Update Lambda code</p></td>
      <td><p>Update the code of a Lambda function executing with high privileges</p></td>
    </tr>
    <tr>
      <td><p>CloudFormation</p></td>
      <td><p>Create a CloudFormation stack that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Data Pipeline</p></td>
      <td><p>Create a Pipeline that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Glue Development Endpoint</p></td>
      <td><p>Create a Glue Development Endpoint that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Update Glue Dev Endpoint</p></td>
      <td><p>Update the associated SSH key for the Glue endpoint</p></td>
    </tr>
  </tbody>
</table>
<p>The general recommendation to protect against privilege escalation is to restrict the resources to which sensitive permissions are granted. The
first example above is a good demonstration of sensitive permissions being used with a narrow scope of resources and where no privilege escalation is
possible.</p>
<h2>Noncompliant Code Example</h2>
<p>This policy allows to update the code of any lambda function. Updating the code of a lambda executing with high privileges will lead to privilege
escalation.</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09

Resources:
  # Update Lambda code
  lambdaUpdatePolicy:
    # Noncompliant
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: lambdaUpdatePolicy
      PolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Action:
              - lambda:UpdateFunctionCode
            Resource: "*"
</pre>
<h2>Compliant Solution</h2>
<p>Narrow the policy to only allow to update the code of certain lambda functions.</p>
<pre>
AWSTemplateFormatVersion: 2010-09-09

Resources:
  # Update Lambda code
  lambdaUpdatePolicy:
    Type: AWS::IAM::ManagedPolicy
    Properties:
      ManagedPolicyName: lambdaUpdatePolicy
      PolicyDocument:
        Version: "2012-10-17"
        Statement:
          - Effect: Allow
            Action:
              - lambda:UpdateFunctionCode
            Resource: "arn:aws:lambda:us-east-2:123456789012:function:my-function:1"
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/">Rhino Security Labs</a> - AWS IAM Privilege Escalation
  – Methods and Mitigation </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-269</a> - Improper Privilege Management </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="vbnet:S5445">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S5445">
              vbnet:S5445
            </a>
          </td>
          <td>
            <details>
              <p>Creating temporary files using insecure methods exposes the application to race conditions on filenames: a malicious user can try to create a file
with a predictable name before the application does. A successful attack can result in other files being accessed, modified, corrupted or deleted.
This risk is even higher if the application run with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-1858">CVE-2014-1858</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-1932">CVE-2014-1932</a> </li>
</ul>
<p><code>Path.GetTempFileName()</code>&nbsp;generates predictable file names and is inherently unreliable and insecure. Additionally, the&nbsp;method
will raise an&nbsp;<code>IOException</code> if it is used to create more than 65535 files without deleting previous temporary files.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Out of the box, .NET is missing secure-by-design APIs to create temporary files. To overcome this, one of the following options can be used:</p>
<ul>
  <li> Use a dedicated sub-folder with tightly controlled permissions </li>
  <li> Created temporary files in a publicly writable folder and make sure:
    <ul>
      <li> Generated filename is unpredictable </li>
      <li> File is readable and writable only by the creating user ID </li>
      <li> File descriptor is not inherited by child processes </li>
      <li> File is destroyed as soon as it is closed </li>
    </ul>  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
Dim TempPath = Path.GetTempFileName() 'Noncompliant

Using Writer As New StreamWriter(TempPath)
    Writer.WriteLine("content")
End Using
</pre>
<h2>Compliant Solution</h2>
<pre>
Dim RandomPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName())

Using FileStream As new FileStream(RandomPath, FileMode.CreateNew, FileAccess.Write, FileShare.None, 4096, FileOptions.DeleteOnClose)
    Using Writer As New StreamWriter(FileStream)
        Writer.WriteLine("content")
    End Using
End Using
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> -
  Using Components with Known Vulnerabilities </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="vbnet:S5659">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S5659">
              vbnet:S5659
            </a>
          </td>
          <td>
            <details>
              <p>If a JSON Web Token (JWT) is not signed with a strong cipher algorithm (or not signed at all) an attacker can forge it and impersonate user
identities.</p>
<ul>
  <li> Don’t use <code>none</code> algorithm to sign or verify the validity of a token. </li>
  <li> Don’t use a token without verifying its signature before. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://github.com/jwt-dotnet/jwt">jwt-dotnet</a> library:</p>
<pre>
Dim decodedtoken1 As String = decoder.Decode(token, secret, verify:= false) ' Noncompliant: signature should be verified

Dim decodedtoken2 As String = new JwtBuilder().
&nbsp; &nbsp; WithSecret(secret).
&nbsp; &nbsp; Decode(forgedtoken1) ' Noncompliant: signature should be verified
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://github.com/jwt-dotnet/jwt">jwt-dotnet</a> library:</p>
<pre>
Dim decodedtoken1 As String = decoder.Decode(forgedtoken1, secret, verify:= true) ' Compliant

Dim decodedtoken2 As String = new JwtBuilder().
&nbsp; &nbsp; WithSecret(secret).
&nbsp; &nbsp; MustVerifySignature().
&nbsp; &nbsp; Decode(token) ' Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/347">MITRE, CWE-347</a> - Improper Verification of Cryptographic Signature </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S3884">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S3884">
              vbnet:S3884
            </a>
          </td>
          <td>
            <details>
              <p><code>CoSetProxyBlanket</code> and <code>CoInitializeSecurity</code> both work to set the permissions context in which the process invoked
immediately after is executed. Calling them from within that process is useless because it’s too late at that point; the permissions context has
already been set.</p>
<p>Specifically, these methods are meant to be called from non-managed code such as a C++ wrapper that then invokes the managed, i.e. C# or VB.NET,
code.</p>
<h2>Noncompliant Code Example</h2>
<pre>
Public Class Noncompliant

    &lt;DllImport("ole32.dll")&gt;
    Public Shared Function CoSetProxyBlanket(&lt;MarshalAs(UnmanagedType.IUnknown)&gt;pProxy As Object, dwAuthnSvc as UInt32, dwAuthzSvc As UInt32, &lt;MarshalAs(UnmanagedType.LPWStr)&gt; pServerPrincName As String, dwAuthnLevel As UInt32, dwImpLevel As UInt32, pAuthInfo As IntPtr, dwCapabilities As UInt32) As Integer
    End Function

    Public Enum RpcAuthnLevel
        [Default] = 0
        None = 1
        Connect = 2
        [Call] = 3
        Pkt = 4
        PktIntegrity = 5
        PktPrivacy = 6
    End Enum

    Public Enum RpcImpLevel
        [Default] = 0
        Anonymous = 1
        Identify = 2
        Impersonate = 3
        [Delegate] = 4
    End Enum

    Public Enum EoAuthnCap
        None = &amp;H00
        MutualAuth = &amp;H01
        StaticCloaking = &amp;H20
        DynamicCloaking = &amp;H40
        AnyAuthority = &amp;H80
        MakeFullSIC = &amp;H100
        [Default] = &amp;H800
        SecureRefs = &amp;H02
        AccessControl = &amp;H04
        AppID = &amp;H08
        Dynamic = &amp;H10
        RequireFullSIC = &amp;H200
        AutoImpersonate = &amp;H400
        NoCustomMarshal = &amp;H2000
        DisableAAA = &amp;H1000
    End Enum

    &lt;DllImport("ole32.dll")&gt;
    Public Shared Function CoInitializeSecurity(pVoid As IntPtr, cAuthSvc As Integer, asAuthSvc As IntPtr, pReserved1 As IntPtr, level As RpcAuthnLevel, impers As RpcImpLevel, pAuthList As IntPtr, dwCapabilities As EoAuthnCap, pReserved3 As IntPtr) As Integer
    End Function

    Public Sub DoSomething()
        Dim Hres1 As Integer = CoSetProxyBlanket(Nothing, 0, 0, Nothing, 0, 0, IntPtr.Zero, 0) ' Noncompliant
        Dim Hres2 As Integer = CoInitializeSecurity(IntPtr.Zero, -1, IntPtr.Zero, IntPtr.Zero, RpcAuthnLevel.None, RpcImpLevel.Impersonate, IntPtr.Zero, EoAuthnCap.None, IntPtr.Zero) ' Noncompliant
    End Sub

End Class
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/648">MITRE, CWE-648</a> - Incorrect Use of Privileged APIs </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S5547">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S5547">
              vbnet:S5547
            </a>
          </td>
          <td>
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Strong_cryptography">Strong cipher algorithms</a> are cryptographic systems resistant to cryptanalysis, they
are not vulnerable to well-known attacks like brute force attacks for example.</p>
<p>A general recommendation is to only use cipher algorithms intensively tested and promoted by the cryptographic community.</p>
<p>More specifically for block cipher, it’s not recommended to use algorithm with a block size inferior than 128 bits.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography?view=netcore-3.1">System.Security.Cryptography</a> library,
these old cryptographic algorithms should no longer be used for any reason:</p>
<pre>
Dim TripleDES1 As new TripleDESCryptoServiceProvider() ' Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack

Dim SimpleDES As New DESCryptoServiceProvider() ' Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search

Dim RC2 As new RC2CryptoServiceProvider() ' Noncompliant: RC2 is vulnerable to a related-key attack
</pre>
<p>For Bouncycastle library, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1000339">AESFastEngine has a side channel leak</a>, it
is possible to gain information about the key used to initialize the cipher:</p>
<pre>
Dim AesFast As new AesFastEngine() ' Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography?view=netcore-3.1">System.Security.Cryptography</a> library,
it’s recommended to use <code>AesCryptoServiceProvider</code>:</p>
<pre>
Dim AES As new AesCryptoServiceProvider() ' Compliant
</pre>
<p>For Bouncycastle library, it’s recommended to use <code>AESEngine</code>:</p>
<pre>
Dim AES As new AESEngine() ' Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="vbnet:S5542">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S5542">
              vbnet:S5542
            </a>
          </td>
          <td>
            <details>
              <p>Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity.</p>
<ul>
  <li> For block cipher encryption algorithms (like AES):
    <ul>
      <li> The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block
      always gets encrypted to the same ciphertext block. This mode should never be used. </li>
      <li> The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to <a
      href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a> when used with padding. Using CBC along with Message
      Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s
      recommended to avoid CBC with padding completely. </li>
      <li> The GCM (Galois Counter Mode) mode which <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode#Mathematical_basis">works
      internally</a> with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality.
      Other similar modes are CCM, CWC, EAX, IAPM and OCB. </li>
    </ul>  </li>
  <li> For RSA encryption algorithm, the recommended padding scheme is OAEP. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.aesmanaged?view=netframework-4.8">AesManaged</a> object with
insecure mode:</p>
<pre>
Dim aes4 = New AesManaged With {
    .KeySize = 128,
    .BlockSize = 128,
    .Mode = CipherMode.ECB, ' Noncompliant
    .Padding = PaddingMode.PKCS7
}
</pre>
<p><a
href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rsacryptoserviceprovider?view=netframework-4.8">RSACryptoServiceProvider</a>
object without OAEP padding:</p>
<pre>
Dim RSA1 = New RSACryptoServiceProvider()
Dim encryptedData = RSA1.Encrypt(dataToEncrypt, False) ' Noncompliant: OAEP Padding is not used (second parameter set to false)
</pre>
<h2>Compliant Solution</h2>
<p>AES with GCM mode with <a href="https://www.bouncycastle.org/">bouncycastle</a> library:</p>
<pre>
Dim blockCipher As GcmBlockCipher = New GcmBlockCipher(New AesFastEngine()) ' Compliant
blockCipher.Init(True, New AeadParameters(New KeyParameter(secretKey), 128, iv, Nothing))
</pre>
<p>AES with GCM mode with <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.aesgcm?view=netcore-3.0">AesGcm</a>
object:</p>
<pre>
Dim aesGcm = New AesGcm(key) ' Compliant
</pre>
<p>RSA with OAEP padding with <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rsacryptoserviceprovider?view=netframework-4.8">RSACryptoServiceProvider</a>
object:</p>
<pre>
Dim RSA2 = New RSACryptoServiceProvider()
Dim encryptedData = RSA2.Encrypt(dataToEncrypt, True) ' Compliant: OAEP Padding is used (second parameter set to true)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="vbnet:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4423">
              vbnet:S4423
            </a>
          </td>
          <td>
            <details>
              <p>Older versions of SSL/TLS protocol like "SSLv3" have been proven to be insecure.</p>
<p>This rule raises an issue when an SSL/TLS is configured at application level with an insecure version (ie: a protocol different from "TLSv1.2" or
"TLSv1.3").</p>
<p>No issue is raised when the choice of the SSL/TLS version relies on the OS configuration. Be aware that the latest version of <a
href="https://docs.microsoft.com/en-us/windows/win32/secauthn/protocols-in-tls-ssl--schannel-ssp-">Windows 10 and Windows Server 2016 have TLSv1.0 and
TLSv1.1 enabled by default</a>. Administrators can configure the OS to enforce TLSv1.2 minumum by <a
href="https://docs.microsoft.com/en-us/windows-server/security/tls/tls-registry-settings">updateing registry settings</a> or by applying a group
policy.</p>
<h2>Noncompliant Code Example</h2>
<pre>
ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls ' Noncompliant; legacy version TLSv1 is enabled
</pre>
<p>For <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient">System.Net.Http.HttpClient</a></p>
<pre>
Dim Handler As New HttpClientHandler With {.SslProtocols = SslProtocols.Tls} ' Noncompliant; legacy version TLSv1 Is enabled
</pre>
<h2>Compliant Solution</h2>
<pre>
ServicePointManager.SecurityProtocol = SecurityProtocolType.SystemDefault  ' Compliant; choice Of the SSL/TLS versions rely On the OS configuration
ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12 Or SecurityProtocolType.Tls13  ' Compliant
</pre>
<p>For <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient">System.Net.Http.HttpClient</a></p>
<pre>
Dim HandlerA As New HttpClientHandler With {.SslProtocols = SslProtocols.Tls12} ' Compliant
Dim HandlerB As New HttpClientHandler With {.SslProtocols = SslProtocols.None}  ' Compliant; choice Of the TLS versions rely On the OS configuration
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
  <li> <a href="https://docs.microsoft.com/en-us/dotnet/framework/network-programming/tls">Transport Layer Security (TLS) best practices with the .NET
  Framework</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="vbnet:S4830">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=vbnet:S4830">
              vbnet:S4830
            </a>
          </td>
          <td>
            <details>
              <p>Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.</p>
<p>The certificate chain validation includes these steps:</p>
<ul>
  <li> The certificate is issued by its parent Certificate Authority or the root CA trusted by the system. </li>
  <li> Each CA is allowed to issue certificates. </li>
  <li> Each certificate in the chain is not expired. </li>
</ul>
<p>It’s not recommended to reinvent the wheel by implementing custom certificate chain validation.</p>
<p>TLS libraries provide built-in certificate validation functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
ServicePointManager.ServerCertificateValidationCallback =
    Function(sender, certificate, chain, errors) True ' Noncompliant: trust all certificates
</pre>
<h2>Compliant Solution</h2>
<pre>
ServicePointManager.ServerCertificateValidationCallback =
    Function(sender, certificate, chain, errors)
        If Development Then Return True ' For development, trust all certificates
        Return Errors = SslPolicyErrors.None AndAlso ValidCerts.Contains(certificate.GetCertHashString()) ' Compliant: trust only some certificates
    End Function
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="typescript:S2598">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2598">
              typescript:S2598
            </a>
          </td>
          <td>
            <details>
              <p>These minimum restrictions should be applied when handling file uploads:</p>
<ul>
  <li> the file upload folder to restrict untrusted files to a specific folder. </li>
  <li> the file extension of the uploaded file to prevent remote code execution. </li>
</ul>
<p>Also the size of the uploaded file should be limited to prevent denial of service attacks. This requirement is covered by the rule
<a href='/coding_rules#rule_key=javascript%3AS5693'>S5693</a>.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://www.npmjs.com/package/formidable">formidable</a> module:</p>
<pre>
const Formidable = require('formidable');

const form = new Formidable(); // Noncompliant, this form is not safe
form.uploadDir = ""; // because upload dir is not defined (by default os temp dir: /var/tmp or /tmp)
form.keepExtensions = true; // and file extensions are kept
</pre>
<p><a href="https://www.npmjs.com/package/multer">multer</a> (Express.js middleware) module:</p>
<pre>
const multer = require('multer');

let diskStorage = multer.diskStorage({ // Noncompliant: no destination specified
  filename: (req, file, cb) =&gt; {
    const buf = crypto.randomBytes(20);
    cb(null, buf.toString('hex'))
  }
});

// This upload is not safe as no destination specified, /var/tmp or /tmp will be used
let diskupload = multer({
  storage: diskStorage,
});
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/formidable">formidable</a> module:</p>
<pre>
const Formidable = require('formidable');

const form = new Formidable(); // Compliant
form.uploadDir = "./uploads/";
form.keepExtensions = false;
</pre>
<p><a href="https://www.npmjs.com/package/multer">multer</a> (Express.js middleware) module:</p>
<pre>
const multer = require('multer');

let diskStorage = multer.diskStorage({  // Compliant
  filename: (req, file, cb) =&gt; {
    const buf = crypto.randomBytes(20);
    cb(null, buf.toString('hex'))
  },
  destination: (req, file, cb) =&gt; {
    cb(null, './uploads/')
  }
});

let diskupload = multer({
  storage: diskStorage,
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/434">MITRE, CWE-434</a> - Unrestricted Upload of File with Dangerous Type </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload">OWASP Unrestricted File Upload</a> - Unrestricted File
  Upload </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="typescript:S5659">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5659">
              typescript:S5659
            </a>
          </td>
          <td>
            <details>
              <p>If a JSON Web Token (JWT) is not signed with a strong cipher algorithm (or not signed at all) an attacker can forge it and impersonate user
identities.</p>
<ul>
  <li> Don’t use <code>none</code> algorithm to sign or verify the validity of a token. </li>
  <li> Don’t use a token without verifying its signature before. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://www.npmjs.com/package/jsonwebtoken">jsonwebtoken</a> library:</p>
<pre>
const jwt = require('jsonwebtoken');

let token = jwt.sign({ foo: 'bar' }, key, { algorithm: 'none' }); // Noncompliant: 'none' cipher doesn't sign the JWT (no signature will be included)

jwt.verify(token, key, { expiresIn: 360000 * 5, algorithms: ['RS256', 'none'] }, callbackcheck); // Noncompliant: 'none' cipher should not be used when verifying JWT signature
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/jsonwebtoken">jsonwebtoken</a> library:</p>
<pre>
const jwt = require('jsonwebtoken');

let token = jwt.sign({ foo: 'bar' }, key, { algorithm: 'HS256' }); // Compliant

jwt.verify(token, key, { expiresIn: 360000 * 5, algorithms: ['HS256'] }, callbackcheck); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/347">MITRE, CWE-347</a> - Improper Verification of Cryptographic Signature </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S2819">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2819">
              typescript:S2819
            </a>
          </td>
          <td>
            <details>
              <p>Browsers <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">allow message exchanges</a> between Window objects of
different origins.</p>
<p>Because any window can send or receive messages from another window, it is important to verify the sender’s/receiver’s identity:</p>
<ul>
  <li> When sending a message with the postMessage method, the identity’s receiver should be defined (the wildcard keyword (<code>*</code>) should not
  be used). </li>
  <li> When receiving a message with a message event, the sender’s identity should be verified using the origin and possibly source properties. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p>When sending a message:</p>
<pre>
var iframe = document.getElementById("testiframe");
iframe.contentWindow.postMessage("secret", "*"); // Noncompliant: * is used
</pre>
<p>When receiving a message:</p>
<pre>
window.addEventListener("message", function(event) { // Noncompliant: no checks are done on the origin property.
      console.log(event.data);
 });
</pre>
<h2>Compliant Solution</h2>
<p>When sending a message:</p>
<pre>
var iframe = document.getElementById("testsecureiframe");
iframe.contentWindow.postMessage("hello", "https://secure.example.com"); // Compliant
</pre>
<p>When receiving a message:</p>
<pre>
window.addEventListener("message", function(event) {

  if (event.origin !== "http://example.org") // Compliant
    return;

  console.log(event.data)
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">developer.mozilla.org</a> - postMessage API </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/345.html">MITRE, CWE-345</a> - Insufficient Verification of Data Authenticity </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5547">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5547">
              typescript:S5547
            </a>
          </td>
          <td>
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Strong_cryptography">Strong cipher algorithms</a> are cryptographic systems resistant to cryptanalysis, they
are not vulnerable to well-known attacks like brute force attacks for example.</p>
<p>A general recommendation is to only use cipher algorithms intensively tested and promoted by the cryptographic community.</p>
<p>More specifically for block cipher, it’s not recommended to use algorithm with a block size inferior than 128 bits.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.createCipheriv("DES", key, iv); // Noncompliant: DES / 3DES is unsecure
crypto.createCipheriv("DES-EDE", key, ""); // Noncompliant: DES / 3DES is unsecure
crypto.createCipheriv("DES-EDE3", key, ""); // Noncompliant: DES / 3DES is unsecure
crypto.createCipheriv("RC2", key, iv); // Noncompliant: RC2 is vulnerable to a related-key attack
crypto.createCipheriv("RC4", key, "");// Noncompliant: RC4 is vulnerable to several attacks
crypto.createCipheriv("BF", key, iv);// Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.createCipheriv("AES-256-GCM", key, iv);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5542">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5542">
              typescript:S5542
            </a>
          </td>
          <td>
            <details>
              <p>Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity.</p>
<ul>
  <li> For block cipher encryption algorithms (like AES):
    <ul>
      <li> The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block
      always gets encrypted to the same ciphertext block. This mode should never be used. </li>
      <li> The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to <a
      href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a> when used with padding. Using CBC along with Message
      Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s
      recommended to avoid CBC with padding completely. </li>
      <li> The GCM (Galois Counter Mode) mode which <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode#Mathematical_basis">works
      internally</a> with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality.
      Other similar modes are CCM, CWC, EAX, IAPM and OCB. </li>
    </ul>  </li>
  <li> For RSA encryption algorithm, the recommended padding scheme is OAEP. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.createCipheriv("AES-128-CBC", key, iv); // Noncompliant: CBC with PKCS5/7 (set by default) is vulnerable to oracle padding attacks
crypto.createCipheriv("AES-128-ECB", key, ""); // Noncompliant: ECB doesn't provide serious message confidentiality
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.createCipheriv("AES-256-GCM", key, iv);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S5876">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5876">
              typescript:S5876
            </a>
          </td>
          <td>
            <details>
              <p>Session fixation attacks occur when an attacker can force a legitimate user to use a session ID that he knows. To avoid fixation attacks, it’s a
good practice to generate a new session each time a user authenticates and delete/invalidate the existing session (the one possibly known by the
attacker).</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="http://www.passportjs.org/">Passport.js</a>:</p>
<pre>
app.post('/login',
  passport.authenticate('local', { failureRedirect: '/login' }),
  function(req, res) {
    // Sensitive - no session.regenerate after login
    res.redirect('/');
  });
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="http://www.passportjs.org/">Passport.js</a>:</p>
<pre>
app.post('/login',
  passport.authenticate('local', { failureRedirect: '/login' }),
  function(req, res) {
    let prevSession = req.session;
    req.session.regenerate((err) =&gt; {  // Compliant
      Object.assign(req.session, prevSession);
      res.redirect('/');
    });
  });
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication">OWASP Top 10 2017 Category A2</a> -
  Broken Authentication </li>
  <li> <a href="https://owasp.org/www-community/attacks/Session_fixation">OWASP Sesssion Fixation</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/384">MITRE, CWE-384</a> - Session Fixation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4423">
              typescript:S4423
            </a>
          </td>
          <td>
            <details>
              <p>This rule raises an issue when an insecure TLS protocol version (i.e. a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2", or "DTLSv1.3") is
used or allowed.</p>
<p>It is recommended to enforce TLS 1.2 as the minimum protocol version and to disallow older versions like TLS 1.0. Failure to do so could open the
door to downgrade attacks: a malicious actor who is able to intercept the connection could modify the requested protocol version and downgrade it to a
less secure version.</p>
<p>In most cases, using the default system configuration is not compliant. Indeed, an application might get deployed on a wide range of systems with
different configurations. While using a system’s default value might be safe on modern up-to-date systems, this might not be the case on older
systems. It is therefore recommended to explicitly set a safe configuration in every case.</p>
<h2>Noncompliant Code Example</h2>
<p><code>secureProtocol</code>, <code>minVersion</code>/<code>maxVersion</code> and <code>secureOptions</code> should not be set to use weak TLS
protocols (TLSv1.1 and lower):</p>
<pre>
let options = {
  secureProtocol: 'TLSv1_method' // Noncompliant: TLS1.0 is insecure
};

let options = {
  minVersion: 'TLSv1.1',  // Noncompliant: TLS1.1 is insecure
  maxVersion: 'TLSv1.2'
};

let options = {
  secureOptions: constants.SSL_OP_NO_SSLv2 | constants.SSL_OP_NO_SSLv3 | constants.SSL_OP_NO_TLSv1
}; // Noncompliant TLS 1.1 (constants.SSL_OP_NO_TLSv1_1) is not disabled
</pre>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
});  // Noncompliant
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let socket = tls.connect(443, "www.example.com", options, () =&gt; { });  // Noncompliant
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get(options);
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.DomainName.html">aws-cdk-lib.aws_apigateway.DomainName</a>:</p>
<pre>
import { aws_apigateway as agw } from 'aws-cdk-lib';

new agw.DomainName(this, 'Example', {
    certificate: certificate,
    domainName: domainName,
    securityPolicy: agw.SecurityPolicy.TLS_1_0, // Noncompliant
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>
<pre>
import { aws_opensearchservice as os } from 'aws-cdk-lib';

new os.CfnDomain(this, 'Example', {
  domainEndpointOptions: {
    enforceHttps: true,
  },
}); // NonCompliant by default
</pre>
<h2>Compliant Solution</h2>
<p>Set either <code>secureProtocol</code> or <code>secureOptions</code> or <code>minVersion</code> to use secure protocols only (TLSv1.2 and
higher):</p>
<pre>
let options = {
  secureProtocol: 'TLSv1_2_method'
};
// or
let options = {
  secureOptions: constants.SSL_OP_NO_SSLv2 | constants.SSL_OP_NO_SSLv3 | constants.SSL_OP_NO_TLSv1 | constants.SSL_OP_NO_TLSv1_1
};
// or
let options = {
    minVersion: 'TLSv1.2'
};
</pre>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
});
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let socket = tls.connect(443, "www.example.com", options, () =&gt; { });
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get(options);
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.DomainName.html">aws-cdk-lib.aws_apigateway.DomainName</a>:</p>
<pre>
import { aws_apigateway as agw } from 'aws-cdk-lib';

new agw.DomainName(this, 'Example', {
    certificate: certificate,
    domainName: domainName,
    securityPolicy: agw.SecurityPolicy.TLS_1_2,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>
<pre>
import { aws_opensearchservice as os } from 'aws-cdk-lib';

new os.CfnDomain(this, 'Example', {
  domainEndpointOptions: {
    enforceHttps: true,
    tlsSecurityPolicy: 'Policy-Min-TLS-1-2-2019-07',
  },
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html">Amazon API Gateway</a> -
  Choosing a minimum TLS version </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="typescript:S4426">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4426">
              typescript:S4426
            </a>
          </td>
          <td>
            <details>
              <p>Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks.</p>
<p><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST recommendations</a> will be checked for these
use-cases:</p>
<p><strong>Digital Signature Generation</strong> and <strong>Verification:</strong></p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DSA (<code>p</code> is key length and <code>q</code> the modulus length) </li>
  <li> n ≥ 2048 for RSA (<code>n</code> is the key length) </li>
</ul>
<p><strong>Key Agreement</strong>:</p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DH and MQV </li>
  <li> n ≥ 224 for ECDH and ECMQV (Examples: <code>secp192r1</code> is a non-compliant curve (<code>n</code> &lt; 224) but <code>secp224k1</code> is
  compliant (<code>n</code> &gt;= 224)) </li>
</ul>
<p><strong>Symmetric keys</strong>:</p>
<ul>
  <li> key length ≥ 128 bits </li>
</ul>
<p>This rule will not raise issues for ciphers that are considered weak (no matter the key size) like <code>DES</code>, <code>Blowfish</code>.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
var { privateKey, publicKey } = crypto.generateKeyPairSync('rsa', {
  modulusLength: 1024,  // Noncompliant
  publicKeyEncoding:  { type: 'spki', format: 'pem' },
  privateKeyEncoding: { type: 'pkcs8', format: 'pem' }
}); // Noncompliant: 1024 bits is too short for a RSA key pair

crypto.generateKeyPair('ec', {
  namedCurve: 'secp112r2',
  publicKeyEncoding:  { type: 'spki', format: 'pem' },
  privateKeyEncoding: { type: 'pkcs8', format: 'pem' }
}, callback); // Noncompliant: secp112r2 curve doesn't provide enough security
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.generateKeyPair('rsa', {
  modulusLength: 2048,  // Compliant
  publicKeyEncoding:  { type: 'spki', format: 'pem' },
  privateKeyEncoding: { type: 'pkcs8', format: 'pem' }
}, callback); // Compliant

crypto.generateKeyPair('ec', {
  namedCurve: 'secp224k1',
  publicKeyEncoding:  { type: 'spki', format: 'pem' },
  privateKeyEncoding: { type: 'pkcs8', format: 'pem' }
}, callback); // compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST 800-131A</a> - Recommendation for Transitioning the
  Use of Cryptographic Algorithms and Key Lengths </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="typescript:S2817">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2817">
              typescript:S2817
            </a>
          </td>
          <td>
            <details>
              <p>The Web SQL Database standard never saw the light of day. It was first formulated, then deprecated by the W3C and was only implemented in some
browsers. (It is not supported in Firefox or IE.)</p>
<p>Further, the use of a Web SQL Database poses security concerns, since you only need its name to access such a database.</p>
<h2>Noncompliant Code Example</h2>
<pre>
var db = window.openDatabase("myDb", "1.0", "Personal secrets stored here", 2*1024*1024);  // Noncompliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> -
  Using Components with Known Vulnerabilities </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="typescript:S5527">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S5527">
              typescript:S5527
            </a>
          </td>
          <td>
            <details>
              <p>To establish a SSL/TLS connection not vulnerable to man-in-the-middle attacks, it’s essential to make sure the server presents the right
certificate.</p>
<p>The certificate’s hostname-specific data should match the server hostname.</p>
<p>It’s not recommended to re-invent the wheel by implementing custom hostname verification.</p>
<p>TLS/SSL libraries provide built-in hostname verification functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let options = {
  hostname: 'www.example.com',
  port: 443,
  path: '/',
  method: 'GET',
  secureProtocol: 'TLSv1_2_method',
  checkServerIdentity: function() {} // Noncompliant: hostname is not verified
};

let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
}); // Noncompliant
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let options = {
    secureProtocol: 'TLSv1_2_method',
    checkServerIdentity: function() {}  // Noncompliant: hostname is not verified
};

let socket = tls.connect(443, "www.example.com", options, () =&gt; {
  process.stdin.pipe(socket);
  process.stdin.resume();
});  // Noncompliant
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get({
    url: 'https://www.example.com',
    secureProtocol: 'TLSv1_2_method',
    checkServerIdentity: function() {}  // Noncompliant: hostname is not verified
});
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let options = {
  hostname: 'www.example.com',
  port: 443,
  path: '/',
  method: 'GET',
  secureProtocol: 'TLSv1_2_method'
};

let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
}); // Compliant: default checkServerIdentity function is secure
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let options = {
    secureProtocol: 'TLSv1_2_method',
    checkServerIdentity: (servername, peer) =&gt; {
        if (servername !== "www.example.com") {
            return new Error ('Error');  // Compliant: there is at least one check
        }
    }
};

let socket = tls.connect(443, "www.example.com", options, () =&gt; {
  process.stdin.pipe(socket);
  process.stdin.resume();
}); // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get({
    url: 'https://www.example.com/',
    secureProtocol: 'TLSv1_2_method' // Compliant
}); // Compliant:  default checkServerIdentity function is secure
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/297">MITRE, CWE-297</a> - Improper Validation of Certificate with Host Mismatch </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="typescript:S6317">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6317">
              typescript:S6317
            </a>
          </td>
          <td>
            <details>
              <p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy
which, when attached to an identity or a resource, defines its permissions. Policies granting permission to an Identity (a User, a Group or Role) are
called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>
<p>Here is an example of a policy document defining a limited set of permission that grants a user the ability to manage his own access keys.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "arn:aws:iam::245500951992:user/${aws:username}",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Privilege escalation generally happens when an identity policy gives an identity the ability to grant more privileges than the ones it already has.
Here is another example of a policy document that hides a privilege escalation. It allows an identity to generate a new access key for any user from
the account, including users with high privileges.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Although it looks like it grants a limited set of permissions, this policy would, in practice, give the highest privileges to the identity it’s
attached to.</p>
<p>Privilege escalation is a serious issue as it allows a malicious user to easily escalate to a high privilege identity from a low privilege identity
it took control of.</p>
<p>The example above is just one of many permission escalation vectors. Here is the list of vectors that the rule can detect:</p>
<table>
  <colgroup>
    <col style="width: 50%;">
    <col style="width: 50%;">
  </colgroup>
  <thead>
    <tr>
      <th>Vector name</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><p>Create Policy Version</p></td>
      <td><p>Create a new IAM policy and set it as default</p></td>
    </tr>
    <tr>
      <td><p>Set Default Policy Version</p></td>
      <td><p>Set a different IAM policy version as default</p></td>
    </tr>
    <tr>
      <td><p>Create AccessKey</p></td>
      <td><p>Create a new access key for any user</p></td>
    </tr>
    <tr>
      <td><p>Create Login Profile</p></td>
      <td><p>Create a login profile with a password chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Update Login Profile</p></td>
      <td><p>Update the existing password with one chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Attach User Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Group Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a group containing a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Role Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a role that can be assumed by the user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put User Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Group Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a group containing a user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Role Policy</p></td>
      <td><p>Alter an existing inline IAM role policy. The rule will then be assumed by the user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Add User to Group</p></td>
      <td><p>Add a user that the attacker controls to a group that has a larger range of permissions</p></td>
    </tr>
    <tr>
      <td><p>Update Assume Role Policy</p></td>
      <td><p>Update a role’s "AssumeRolePolicyDocument" to allow a user the attacker controls to assume it</p></td>
    </tr>
    <tr>
      <td><p>EC2</p></td>
      <td><p>Create an EC2 instance that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Invoke</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and invoke it</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Add Permission</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and grant permission to invoke it to a user or a service</p></td>
    </tr>
    <tr>
      <td><p>Lambda triggered with an external event</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and link it to an external event</p></td>
    </tr>
    <tr>
      <td><p>Update Lambda code</p></td>
      <td><p>Update the code of a Lambda function executing with high privileges</p></td>
    </tr>
    <tr>
      <td><p>CloudFormation</p></td>
      <td><p>Create a CloudFormation stack that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Data Pipeline</p></td>
      <td><p>Create a Pipeline that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Glue Development Endpoint</p></td>
      <td><p>Create a Glue Development Endpoint that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Update Glue Dev Endpoint</p></td>
      <td><p>Update the associated SSH key for the Glue endpoint</p></td>
    </tr>
  </tbody>
</table>
<p>The general recommendation to protect against privilege escalation is to restrict the resources to which sensitive permissions are granted. The
first example above is a good demonstration of sensitive permissions being used with a narrow scope of resources and where no privilege escalation is
possible.</p>
<h2>Noncompliant Code Example</h2>
<p>The following policy allows an attacker to update the code of any Lambda function. An attacker can achieve privilege escalation by altering the
code of a Lambda that executes with high privileges.</p>
<pre>
import {aws_iam as iam} from 'aws-cdk-lib'

new iam.PolicyDocument({
    statements: [new iam.PolicyStatement({
        effect: iam.Effect.ALLOW,
        actions: ["lambda:UpdateFunctionCode"],
        resources: ["*"], // Noncompliant
    })],
})
</pre>
<h2>Compliant Solution</h2>
<p>Narrow the policy such that only updates to the code of certain Lambda functions are allowed.</p>
<pre>
import {aws_iam as iam} from 'aws-cdk-lib'

new iam.PolicyDocument({
    statements: [new iam.PolicyStatement({
        effect: iam.Effect.ALLOW,
        actions: ["lambda:UpdateFunctionCode"],
        resources: ["arn:aws:lambda:us-east-2:123456789012:function:my-function:1"], // Noncompliant
    })],
})
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/">Rhino Security Labs</a> - AWS IAM Privilege Escalation
  – Methods and Mitigation </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-269</a> - Improper Privilege Management </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="typescript:S2755">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S2755">
              typescript:S2755
            </a>
          </td>
          <td>
            <details>
              <p>XML standard allows the use of entities, declared in the DOCTYPE of the document, which can be <a
href="https://www.w3.org/TR/xml/#sec-internal-ent">internal</a> or <a href="https://www.w3.org/TR/xml/#sec-external-ent">external</a>.</p>
<p>When parsing the XML file, the content of the external entities is retrieved from an external storage such as the file system or network, which may
lead, if no restrictions are put in place, to arbitrary file disclosures or <a
href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">server-side request forgery (SSRF)</a> vulnerabilities.</p>
<p>It’s recommended to limit resolution of external entities by using one of these solutions:</p>
<ul>
  <li> If DOCTYPE is not necessary, completely disable all DOCTYPE declarations. </li>
  <li> If external entities are not necessary, completely disable their declarations. </li>
  <li> If external entities are necessary then:
    <ul>
      <li> Use XML processor features, if available, to authorize only required protocols (eg: https). </li>
      <li> And use an entity resolver (and optionally an XML Catalog) to resolve only trusted entities. </li>
    </ul>  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://github.com/libxmljs/libxmljs">libxmljs</a> module:</p>
<pre>
const libxmljs = require("libxmljs");
var fs = require('fs');

var xml = fs.readFileSync('xxe.xml', 'utf8');

var xmlDoc = libxmljs.parseXmlString(xml, { noblanks: true, noent: true, nocdata: true }); // Noncompliant: noent set to true
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://github.com/libxmljs/libxmljs">libxmljs</a> module:</p>
<pre>
const libxmljs = require("libxmljs");
var fs = require('fs');

var xml = fs.readFileSync('xxe.xml', 'utf8');

var xmlDoc = libxmljs.parseXmlString(xml); // Compliant: noent set to false by default
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">OWASP XXE Prevention Cheat Sheet</a>
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/611">MITRE, CWE-611</a> - Information Exposure Through XML External Entity Reference </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/827">MITRE, CWE-827</a> - Improper Control of Document Type Definition </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="typescript:S1525">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S1525">
              typescript:S1525
            </a>
          </td>
          <td>
            <details>
              <p>The debugger statement can be placed anywhere in procedures to suspend execution. Using the debugger statement is similar to setting a breakpoint
in the code. By definition such statement must absolutely be removed from the source code to prevent any unexpected behavior or added vulnerability to
attacks in production.</p>
<h2>Noncompliant Code Example</h2>
<pre>
for (i = 1; i&lt;5; i++) {
  // Print i to the Output window.
  Debug.write("loop index is " + i);
  // Wait for user to resume.
  debugger;
}
</pre>
<h2>Compliant Solution</h2>
<pre>
for (i = 1; i&lt;5; i++) {
  // Print i to the Output window.
  Debug.write("loop index is " + i);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4507'>S4507</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="typescript:S6321">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S6321">
              typescript:S6321
            </a>
          </td>
          <td>
            <details>
              <p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and
outbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services
traditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those
held by system administrators or those of <a href="https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls">bastion-like</a>
servers.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html">aws-cdk-lib.aws_ec2.Instance</a> and other constructs
that support a <code>connections</code> attribute:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const instance = new ec2.Instance(this, "default-own-security-group",{
    instanceType: nanoT2,
    machineImage: ec2.MachineImage.latestAmazonLinux(),
    vpc: vpc,
    instanceName: "test-instance"
})

instance.connections.allowFrom(
    ec2.Peer.anyIpv4(), // Noncompliant
    ec2.Port.tcp(22),
    /*description*/ "Allows SSH from all IPv4"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html">aws-cdk-lib.aws_ec2.SecurityGroup</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const securityGroup = new ec2.SecurityGroup(this, "custom-security-group", {
    vpc: vpc
})

securityGroup.addIngressRule(
    ec2.Peer.anyIpv4(), // Noncompliant
    ec2.Port.tcpRange(1, 1024)
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroup.html">aws-cdk-lib.aws_ec2.CfnSecurityGroup</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnSecurityGroup(
    this,
    "cfn-based-security-group", {
        groupDescription: "cfn based security group",
        groupName: "cfn-based-security-group",
        vpcId: vpc.vpcId,
        securityGroupIngress: [
            {
                ipProtocol: "6",
                cidrIp: "0.0.0.0/0", // Noncompliant
                fromPort: 22,
                toPort: 22
            }
        ]
    }
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress.html">aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnSecurityGroupIngress( // Noncompliant
    this,
    "ingress-all-ip-tcp-ssh", {
        ipProtocol: "tcp",
        cidrIp: "0.0.0.0/0",
        fromPort: 22,
        toPort: 22,
        groupId: securityGroup.attrGroupId
})
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html">aws-cdk-lib.aws_ec2.Instance</a> and other constructs
that support a <code>connections</code> attribute:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const instance = new ec2.Instance(this, "default-own-security-group",{
    instanceType: nanoT2,
    machineImage: ec2.MachineImage.latestAmazonLinux(),
    vpc: vpc,
    instanceName: "test-instance"
})

instance.connections.allowFrom(
    ec2.Peer.ipv4("192.0.2.0/24"),
    ec2.Port.tcp(22),
    /*description*/ "Allows SSH from a trusted range"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html">aws-cdk-lib.aws_ec2.SecurityGroup</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const securityGroup3 = new ec2.SecurityGroup(this, "custom-security-group", {
    vpc: vpc
})

securityGroup3.addIngressRule(
    ec2.Peer.anyIpv4(),
    ec2.Port.tcpRange(1024, 1048)
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroup.html">aws-cdk-lib.aws_ec2.CfnSecurityGroup</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnSecurityGroup(
    this,
    "cfn-based-security-group", {
        groupDescription: "cfn based security group",
        groupName: "cfn-based-security-group",
        vpcId: vpc.vpcId,
        securityGroupIngress: [
            {
                ipProtocol: "6",
                cidrIp: "192.0.2.0/24", // Compliant
                fromPort: 22,
                toPort: 22
            }
        ]
    }
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress.html">aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress</a></p>
<pre>
new ec2.CfnSecurityGroupIngress(
    this,
    "ingress-all-ipv4-tcp-http", {
        ipProtocol: "6",
        cidrIp: "0.0.0.0/0",
        fromPort: 80,
        toPort: 80,
        groupId: securityGroup.attrGroupId
    }
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">AWS Documentation</a> - Security groups for your VPC </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview">Azure Documentation</a> - Network security
  groups </li>
  <li> <a href="https://cloud.google.com/vpc/docs/using-firewalls">GCP Documentation</a> - Firewalls </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="typescript:S4830">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=typescript:S4830">
              typescript:S4830
            </a>
          </td>
          <td>
            <details>
              <p>Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.</p>
<p>The certificate chain validation includes these steps:</p>
<ul>
  <li> The certificate is issued by its parent Certificate Authority or the root CA trusted by the system. </li>
  <li> Each CA is allowed to issue certificates. </li>
  <li> Each certificate in the chain is not expired. </li>
</ul>
<p>It’s not recommended to reinvent the wheel by implementing custom certificate chain validation.</p>
<p>TLS libraries provide built-in certificate validation functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<p>There is no way to disable certificate verification in tls, https and request modules but it is possible to not reject request when verification
fails.</p>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let options = {
  hostname: 'www.example.com',
  port: 443,
  path: '/',
  method: 'GET',
  secureProtocol: 'TLSv1_2_method',
  rejectUnauthorized: false ; // Noncompliant
};

let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
}); // Noncompliant
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let options = {
    secureProtocol: 'TLSv1_2_method',
    rejectUnauthorized: false ; // Noncompliant
};

let socket = tls.connect(443, "www.example.com", options, () =&gt; {
  process.stdin.pipe(socket);
  process.stdin.resume();
});  // Noncompliant
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get({
    url: 'www.example.com',
    secureProtocol: 'TLSv1_2_method',
    rejectUnauthorized: false ; // Noncompliant
});
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let options = {
  hostname: 'www.example.com',
  port: 443,
  path: '/',
  method: 'GET',
  secureProtocol: 'TLSv1_2_method'
};

let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
}); // Compliant: by default rejectUnauthorized  is set to true
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let options = {
    secureProtocol: 'TLSv1_2_method'
};

let socket = tls.connect(443, "www.example.com", options, () =&gt; {
  process.stdin.pipe(socket);
  process.stdin.resume();
}); // Compliant: by default rejectUnauthorized  is set to true
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get({
    url: 'https://www.example.com/',
    secureProtocol: 'TLSv1_2_method' // Compliant
}); // Compliant: by default rejectUnauthorized  is set to true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="flex:S1466">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=flex:S1466">
              flex:S1466
            </a>
          </td>
          <td>
            <details>
              <p>The Security.exactSettings value should remain set at the default value of true. Setting this value to false could make the SWF vulnerable to
cross-domain attacks.</p>
<h2>Noncompliant Code Example</h2>
<pre>
Security.exactSettings = false;
</pre>
<h2>Compliant Solution</h2>
<pre>
Security.exactSettings = true;
</pre>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="flex:S1465">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=flex:S1465">
              flex:S1465
            </a>
          </td>
          <td>
            <details>
              <p>A <code>LocalConnection</code> object is used to invoke a method in another <code>LocalConnection</code> object, either within a single SWF file or
between multiple SWF files. This kind of local connection should be authorized only when the origin (domain) of the other Flex applications is
perfectly defined.</p>
<h2>Noncompliant Code Example</h2>
<pre>
localConnection.allowDomain("*");
</pre>
<h2>Compliant Solution</h2>
<pre>
localConnection.allowDomain("www.myDomain.com");
</pre>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="flex:S1468">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=flex:S1468">
              flex:S1468
            </a>
          </td>
          <td>
            <details>
              <p>Calling Security.allowDomain("*") lets any domain cross-script into the domain of this SWF and exercise its functionality.</p>
<h2>Noncompliant Code Example</h2>
<pre>
Security.allowDomain("*");
</pre>
<h2>Compliant Solution</h2>
<pre>
Security.allowDomain("www.myDomain.com");
</pre>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="flex:S1951">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=flex:S1951">
              flex:S1951
            </a>
          </td>
          <td>
            <details>
              <p>The <code>trace()</code> function outputs debug statements, which can be read by anyone with a debug version of the Flash player. Because sensitive
information could easily be exposed in this manner, <code>trace()</code> should never appear in production code.</p>
<h2>Noncompliant Code Example</h2>
<pre>
    var val:Number = doCalculation();
    trace("Calculation result: " + val);  // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
    var val:Number = doCalculation();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=flex%3AS4507'>S4507</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="flex:S1442">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=flex:S1442">
              flex:S1442
            </a>
          </td>
          <td>
            <details>
              <p><code>Alert.show(...)</code> can be useful for debugging during development, but in production mode this kind of pop-up could expose sensitive
information to attackers, and should never be displayed.</p>
<h2>Noncompliant Code Example</h2>
<pre>
if (unexpectedCondition)
{
  Alert.show("Unexpected Condition");
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=flex%3AS4507'>S4507</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="docker:S6469">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=docker:S6469">
              docker:S6469
            </a>
          </td>
          <td>
            <details>
              <p>Docker offers a feature to mount files and directories for specific <code>RUN</code> instructions when building Docker images. This feature can be
used to provide secrets to the commands that are executed during the build without baking them into the image. Additionally, it can be used to access
SSH agents during the build.</p>
<p>By using the <code>mode</code> option the permissions of the secrets or agents can be modified. By default, access is limited to the root user.</p>
<p>When such secrets are exposed with lax permissions, they might get compromised during the image build process. A successful compromise can only
happen during the execution of the command the <code>mount</code> option has been added to. While this might seem like a very hard exploitation
requirement, supply chain attacks, and other related threats, should still be considered.</p>
<p>If you are executing a command as a low-privileged user and need to access secrets or agents, you can use the options <code>uid</code> and
<code>gid</code> to provide access without having to resort to world-readable or writable permissions that might expose them to unintended
parties.</p>
<h2>Noncompliant Code Example</h2>
<pre>
RUN --mount=type=secret,id=build_secret,mode=0777 ./installer.sh # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
RUN --mount=type=secret,id=build_secret,uid=1000 ./installer.sh
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://docs.docker.com/engine/reference/builder/#run---mounttypesecret">Dockerfile reference</a> - RUN --mount </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="terraform:S6385">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6385">
              terraform:S6385
            </a>
          </td>
          <td>
            <details>
              <p>Azure Resource Manager allows creating custom roles that can be assigned to users, groups, or service principals. A custom role that grants access
to all resources of a subscription will have the same capabilities as the built-in Owner role.</p>
<p>It’s recommended to limit the number of subscription owners in order to mitigate the risk of being breached by a compromised owner. Having a custom
role that grants subscription Owner capabilities makes it way more difficult to enforce this limitation.</p>
<p>This rule raises an issue when a custom role has an assignable scope set to a Subscription or a Management Group and allows all actions
(<code>*</code>)</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Apply the least privilege principle by creating a custom role with as few permissions as possible. </li>
  <li> As custom role can be updated, gradually add atomic permissions when required. </li>
  <li> Limit the assignable scopes of the custom role to a set of Resources or Ressource Groups. </li>
  <li> When necessary, use the built-in Owner role instead of a custom role granting subscription owner capabilities. </li>
  <li> Limit the assignments of Owner roles to less than three people or service principals. </li>
</ul>
<h2>Sensitive Code Example</h2>
<pre>
resource "azurerm_role_definition" "example" { # Sensitive
  name        = "example"
  scope       = data.azurerm_subscription.primary.id

  permissions {
    actions     = ["*"]
    not_actions = []
  }

  assignable_scopes = [
    data.azurerm_subscription.primary.id
  ]
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "azurerm_role_definition" "example" {
  name        = "example
  scope       = data.azurerm_subscription.primary.id

  permissions {
    actions     = ["Microsoft.Compute/*"]
    not_actions = []
  }

  assignable_scopes = [
    data.azurerm_subscription.primary.id
  ]
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control.html">OWASP Top 10 2017 Category A5</a> - Broken Access
  Control </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/266">MITRE, CWE-266</a> - Incorrect Privilege Assignment </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/custom-roles">Azure Documentation</a> - Azure custom roles </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/best-practices">Azure Documentation</a> - Best practices for Azure
  RBAC </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="terraform:S6317">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6317">
              terraform:S6317
            </a>
          </td>
          <td>
            <details>
              <p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy
which, when attached to an identity or a resource, defines its permissions. Policies granting permission to an Identity (a User, a Group or Role) are
called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>
<p>Here is an example of a policy document defining a limited set of permission that grants a user the ability to manage his own access keys.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "arn:aws:iam::245500951992:user/${aws:username}",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Privilege escalation generally happens when an identity policy gives an identity the ability to grant more privileges than the ones it already has.
Here is another example of a policy document that hides a privilege escalation. It allows an identity to generate a new access key for any user from
the account, including users with high privileges.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Although it looks like it grants a limited set of permissions, this policy would, in practice, give the highest privileges to the identity it’s
attached to.</p>
<p>Privilege escalation is a serious issue as it allows a malicious user to easily escalate to a high privilege identity from a low privilege identity
it took control of.</p>
<p>The example above is just one of many permission escalation vectors. Here is the list of vectors that the rule can detect:</p>
<table>
  <colgroup>
    <col style="width: 50%;">
    <col style="width: 50%;">
  </colgroup>
  <thead>
    <tr>
      <th>Vector name</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><p>Create Policy Version</p></td>
      <td><p>Create a new IAM policy and set it as default</p></td>
    </tr>
    <tr>
      <td><p>Set Default Policy Version</p></td>
      <td><p>Set a different IAM policy version as default</p></td>
    </tr>
    <tr>
      <td><p>Create AccessKey</p></td>
      <td><p>Create a new access key for any user</p></td>
    </tr>
    <tr>
      <td><p>Create Login Profile</p></td>
      <td><p>Create a login profile with a password chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Update Login Profile</p></td>
      <td><p>Update the existing password with one chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Attach User Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Group Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a group containing a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Role Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a role that can be assumed by the user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put User Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Group Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a group containing a user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Role Policy</p></td>
      <td><p>Alter an existing inline IAM role policy. The rule will then be assumed by the user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Add User to Group</p></td>
      <td><p>Add a user that the attacker controls to a group that has a larger range of permissions</p></td>
    </tr>
    <tr>
      <td><p>Update Assume Role Policy</p></td>
      <td><p>Update a role’s "AssumeRolePolicyDocument" to allow a user the attacker controls to assume it</p></td>
    </tr>
    <tr>
      <td><p>EC2</p></td>
      <td><p>Create an EC2 instance that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Invoke</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and invoke it</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Add Permission</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and grant permission to invoke it to a user or a service</p></td>
    </tr>
    <tr>
      <td><p>Lambda triggered with an external event</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and link it to an external event</p></td>
    </tr>
    <tr>
      <td><p>Update Lambda code</p></td>
      <td><p>Update the code of a Lambda function executing with high privileges</p></td>
    </tr>
    <tr>
      <td><p>CloudFormation</p></td>
      <td><p>Create a CloudFormation stack that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Data Pipeline</p></td>
      <td><p>Create a Pipeline that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Glue Development Endpoint</p></td>
      <td><p>Create a Glue Development Endpoint that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Update Glue Dev Endpoint</p></td>
      <td><p>Update the associated SSH key for the Glue endpoint</p></td>
    </tr>
  </tbody>
</table>
<p>The general recommendation to protect against privilege escalation is to restrict the resources to which sensitive permissions are granted. The
first example above is a good demonstration of sensitive permissions being used with a narrow scope of resources and where no privilege escalation is
possible.</p>
<h2>Noncompliant Code Example</h2>
<p>This policy allows to update the code of any lambda function. Updating the code of a lambda executing with high privileges will lead to privilege
escalation.</p>
<pre>
resource "aws_iam_policy" "lambdaUpdatePolicy" {
  name = "lambdaUpdatePolicy"
  policy =&lt;&lt;EOF
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "lambda:UpdateFunctionCode"
            ],
            "Resource": "*"
        }
    ]
}
EOF
}
</pre>
<h2>Compliant Solution</h2>
<p>Narrow the policy to only allow to update the code of certain lambda functions.</p>
<pre>
resource "aws_iam_policy" "lambdaUpdatePolicy" {
  name = "lambdaUpdatePolicy"
  policy =&lt;&lt;EOF
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "lambda:UpdateFunctionCode"
            ],
            "Resource": "arn:aws:lambda:us-east-2:123456789012:function:my-function:1"
        }
    ]
}
EOF
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/">Rhino Security Labs</a> - AWS IAM Privilege Escalation
  – Methods and Mitigation </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-269</a> - Improper Privilege Management </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="terraform:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S4423">
              terraform:S4423
            </a>
          </td>
          <td>
            <details>
              <p>This rule raises an issue when an insecure TLS protocol version (i.e. a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2", or "DTLSv1.3") is
used or allowed.</p>
<p>It is recommended to enforce TLS 1.2 as the minimum protocol version and to disallow older versions like TLS 1.0. Failure to do so could open the
door to downgrade attacks: a malicious actor who is able to intercept the connection could modify the requested protocol version and downgrade it to a
less secure version.</p>
<p>In most cases, using the default system configuration is not compliant. Indeed, an application might get deployed on a wide range of systems with
different configurations. While using a system’s default value might be safe on modern up-to-date systems, this might not be the case on older
systems. It is therefore recommended to explicitly set a safe configuration in every case.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/opensearch-service/index.html">Amazon OpenSearch domains</a>:</p>
<pre>
resource "aws_elasticsearch_domain" "example" {
  domain_name = "example"
  domain_endpoint_options {
    enforce_https = true
    tls_security_policy = "Policy-Min-TLS-1-0-2019-07" # Noncompliant
  }
</pre>
<p>For <a href="https://aws.amazon.com/api-gateway/">Amazon API Gateway</a>:</p>
<pre>
resource "aws_api_gateway_domain_name" "example" {
  domain_name = "api.example.com"
  security_policy = "TLS_1_0" # Noncompliant
}
</pre>
<pre>
resource "aws_apigatewayv2_domain_name" "example" {
  domain_name = "api.example.com"
  domain_name_configuration {} # Noncompliant
}
</pre>
<p>For <a href="https://cloud.google.com/load-balancing/docs/use-ssl-policies">Google Cloud load balancers</a></p>
<pre>
resource "google_compute_ssl_policy" "example" {
  name            = "example"
  min_tls_version = "TLS_1_0" # Noncompliant
  # ...
}
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/opensearch-service/index.html">Amazon OpenSearch domains</a>:</p>
<pre>
resource "aws_elasticsearch_domain" "example" {
  domain_name = "example"
  domain_endpoint_options {
    enforce_https = true
    tls_security_policy = "Policy-Min-TLS-1-2-2019-07"
</pre>
<p>For <a href="https://aws.amazon.com/api-gateway/">Amazon API Gateway</a>:</p>
<pre>
resource "aws_api_gateway_domain_name" "example" {
  domain_name = "api.example.com"
  security_policy = "TLS_1_2"
}
</pre>
<pre>
resource "aws_apigatewayv2_domain_name" "example" {
  domain_name = "api.example.com"
  domain_name_configuration {
    security_policy = "TLS_1_2"
  }
}
</pre>
<p>For <a href="https://cloud.google.com/load-balancing/docs/use-ssl-policies">Google Cloud load balancers</a></p>
<pre>
resource "google_compute_ssl_policy" "example" {
  name            = "example"
  min_tls_version = "TLS_1_2"
  # ...
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html">Amazon API Gateway</a> -
  Choosing a minimum TLS version </li>
  <li> <a href="https://cloud.google.com/load-balancing/docs/ssl-policies-concepts#defining_an_ssl_policy">Google Cloud Load Balancing</a> - Defining
  an SSL policy </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="terraform:S6321">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6321">
              terraform:S6321
            </a>
          </td>
          <td>
            <details>
              <p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and
outbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services
traditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those
held by system administrators or those of <a href="https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls">bastion-like</a>
servers.</p>
<h2>Noncompliant Code Example</h2>
<p>An ingress rule allowing all inbound SSH traffic for AWS:</p>
<pre>
resource "aws_security_group" "noncompliant" {
  name        = "allow_ssh_noncompliant"
  description = "allow_ssh_noncompliant"
  vpc_id      = aws_vpc.main.id

  ingress {
    description      = "SSH rule"
    from_port        = 22
    to_port          = 22
    protocol         = "tcp"
    cidr_blocks      = ["0.0.0.0/0"]  # Noncompliant
  }
}
</pre>
<p>A security rule allowing all inbound SSH traffic for Azure:</p>
<pre>
resource "azurerm_network_security_rule" "noncompliant" {
  priority                    = 100
  direction                   = "Inbound"
  access                      = "Allow"
  protocol                    = "Tcp"
  source_port_range           = "*"
  destination_port_range      = "22"
  source_address_prefix       = "*"  # Noncompliant
  destination_address_prefix  = "*"
}
</pre>
<p>A firewall rule allowing all inbound SSH traffic for GCP:</p>
<pre>
resource "google_compute_firewall" "noncompliant" {
  network = google_compute_network.default.name

  allow {
    protocol = "tcp"
    ports    = ["22"]
  }

  source_ranges = ["0.0.0.0/0"]  # Noncompliant
}
</pre>
<p>A security rule allowing all inbound SSH traffic for Azure:</p>
<pre>
resource "azurerm_network_security_rule" "noncompliant" {
  priority                    = 100
  direction                   = "Inbound"
  access                      = "Allow"
  protocol                    = "Tcp"
  source_port_range           = "*"
  destination_port_range      = "22"
  source_address_prefix       = "*"  # Noncompliant
  destination_address_prefix  = "*"
}
</pre>
<h2>Compliant Solution</h2>
<p>An ingress rule allowing inbound SSH traffic from specific IP addresses for AWS:</p>
<pre>
resource "aws_security_group" "compliant" {
  name        = "allow_ssh_compliant"
  description = "allow_ssh_compliant"
  vpc_id      = aws_vpc.main.id

  ingress {
    description      = "SSH rule"
    from_port        = 22
    to_port          = 22
    protocol         = "tcp"
    cidr_blocks      = ["1.2.3.0/24"]
  }
}
</pre>
<p>A security rule allowing inbound SSH traffic from specific IP addresses for Azure:</p>
<pre>
resource "azurerm_network_security_rule" "compliant" {
  priority                    = 100
  direction                   = "Inbound"
  access                      = "Allow"
  protocol                    = "Tcp"
  source_port_range           = "*"
  destination_port_range      = "22"
  source_address_prefix       = "1.2.3.0"
  destination_address_prefix  = "*"
}
</pre>
<p>A firewall rule allowing inbound SSH traffic from specific IP addresses for GCP:</p>
<pre>
resource "google_compute_firewall" "compliant" {
  network = google_compute_network.default.name

  allow {
    protocol = "tcp"
    ports    = ["22"]
  }

  source_ranges = ["10.0.0.1/32"]
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">AWS Documentation</a> - Security groups for your VPC </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview">Azure Documentation</a> - Network security
  groups </li>
  <li> <a href="https://cloud.google.com/vpc/docs/using-firewalls">GCP Documentation</a> - Firewalls </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="terraform:S6410">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=terraform:S6410">
              terraform:S6410
            </a>
          </td>
          <td>
            <details>
              <p>TLS configuration of Google Cloud load balancers is defined through SSL policies. There are three managed profiles to choose from:
<code>COMPATIBLE</code> (default), <code>MODERN</code> and <code>RESTRICTED</code>:</p>
<ul>
  <li> The <code>RESTRICTED</code> profile relies only on secure cipher suites and should be used by applications that require to comply with the
  highest security standards. </li>
  <li> The <code>MODERN</code> profile includes additional cipher suites that present security weaknesses like using the <code>SHA1</code> algorithm
  for signing. </li>
  <li> The <code>COMPATIBLE</code> profile offers the most common cipher suites and thus broader compatibility. Some of these use <code>SHA1</code> or
  <code>3DES</code> algorithms which are considered weak. Also, this profile includes cipher suites that rely on obsolete key-exchange mechanisms that
  don’t provide forward secrecy[<a href="https://en.wikipedia.org/wiki/Forward_secrecy">https://en.wikipedia.org/wiki/Forward_secrecy</a>] as a
  feature. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
resource "google_compute_ssl_policy" "example" {
  name            = "example"
  min_tls_version = "TLS_1_2"
  profile         = "COMPATIBLE" # Noncompliant
}
</pre>
<h2>Compliant Solution</h2>
<pre>
resource "google_compute_ssl_policy" "example" {
  name            = "example"
  min_tls_version = "TLS_1_2"
  profile         = "RESTRICTED"
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#23-use-secure-cipher-suites">SSL and TLS Deployment
  Best Practices</a> - Use Secure Cipher Suites </li>
  <li> <a href="https://cloud.google.com/load-balancing/docs/ssl-policies-concepts#defining_an_ssl_policy">Google Cloud Load Balancing</a> - Defining
  an SSL policy </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="javascript:S2598">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2598">
              javascript:S2598
            </a>
          </td>
          <td>
            <details>
              <p>These minimum restrictions should be applied when handling file uploads:</p>
<ul>
  <li> the file upload folder to restrict untrusted files to a specific folder. </li>
  <li> the file extension of the uploaded file to prevent remote code execution. </li>
</ul>
<p>Also the size of the uploaded file should be limited to prevent denial of service attacks. This requirement is covered by the rule
<a href='/coding_rules#rule_key=javascript%3AS5693'>S5693</a>.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://www.npmjs.com/package/formidable">formidable</a> module:</p>
<pre>
const Formidable = require('formidable');

const form = new Formidable(); // Noncompliant, this form is not safe
form.uploadDir = ""; // because upload dir is not defined (by default os temp dir: /var/tmp or /tmp)
form.keepExtensions = true; // and file extensions are kept
</pre>
<p><a href="https://www.npmjs.com/package/multer">multer</a> (Express.js middleware) module:</p>
<pre>
const multer = require('multer');

let diskStorage = multer.diskStorage({ // Noncompliant: no destination specified
  filename: (req, file, cb) =&gt; {
    const buf = crypto.randomBytes(20);
    cb(null, buf.toString('hex'))
  }
});

// This upload is not safe as no destination specified, /var/tmp or /tmp will be used
let diskupload = multer({
  storage: diskStorage,
});
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/formidable">formidable</a> module:</p>
<pre>
const Formidable = require('formidable');

const form = new Formidable(); // Compliant
form.uploadDir = "./uploads/";
form.keepExtensions = false;
</pre>
<p><a href="https://www.npmjs.com/package/multer">multer</a> (Express.js middleware) module:</p>
<pre>
const multer = require('multer');

let diskStorage = multer.diskStorage({  // Compliant
  filename: (req, file, cb) =&gt; {
    const buf = crypto.randomBytes(20);
    cb(null, buf.toString('hex'))
  },
  destination: (req, file, cb) =&gt; {
    cb(null, './uploads/')
  }
});

let diskupload = multer({
  storage: diskStorage,
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/434">MITRE, CWE-434</a> - Unrestricted Upload of File with Dangerous Type </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/400">MITRE, CWE-400</a> - Uncontrolled Resource Consumption </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Unrestricted_File_Upload">OWASP Unrestricted File Upload</a> - Unrestricted File
  Upload </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="javascript:S2819">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2819">
              javascript:S2819
            </a>
          </td>
          <td>
            <details>
              <p>Browsers <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">allow message exchanges</a> between Window objects of
different origins.</p>
<p>Because any window can send or receive messages from another window, it is important to verify the sender’s/receiver’s identity:</p>
<ul>
  <li> When sending a message with the postMessage method, the identity’s receiver should be defined (the wildcard keyword (<code>*</code>) should not
  be used). </li>
  <li> When receiving a message with a message event, the sender’s identity should be verified using the origin and possibly source properties. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p>When sending a message:</p>
<pre>
var iframe = document.getElementById("testiframe");
iframe.contentWindow.postMessage("secret", "*"); // Noncompliant: * is used
</pre>
<p>When receiving a message:</p>
<pre>
window.addEventListener("message", function(event) { // Noncompliant: no checks are done on the origin property.
      console.log(event.data);
 });
</pre>
<h2>Compliant Solution</h2>
<p>When sending a message:</p>
<pre>
var iframe = document.getElementById("testsecureiframe");
iframe.contentWindow.postMessage("hello", "https://secure.example.com"); // Compliant
</pre>
<p>When receiving a message:</p>
<pre>
window.addEventListener("message", function(event) {

  if (event.origin !== "http://example.org") // Compliant
    return;

  console.log(event.data)
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage">developer.mozilla.org</a> - postMessage API </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/345.html">MITRE, CWE-345</a> - Insufficient Verification of Data Authenticity </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5659">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5659">
              javascript:S5659
            </a>
          </td>
          <td>
            <details>
              <p>If a JSON Web Token (JWT) is not signed with a strong cipher algorithm (or not signed at all) an attacker can forge it and impersonate user
identities.</p>
<ul>
  <li> Don’t use <code>none</code> algorithm to sign or verify the validity of a token. </li>
  <li> Don’t use a token without verifying its signature before. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://www.npmjs.com/package/jsonwebtoken">jsonwebtoken</a> library:</p>
<pre>
const jwt = require('jsonwebtoken');

let token = jwt.sign({ foo: 'bar' }, key, { algorithm: 'none' }); // Noncompliant: 'none' cipher doesn't sign the JWT (no signature will be included)

jwt.verify(token, key, { expiresIn: 360000 * 5, algorithms: ['RS256', 'none'] }, callbackcheck); // Noncompliant: 'none' cipher should not be used when verifying JWT signature
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/jsonwebtoken">jsonwebtoken</a> library:</p>
<pre>
const jwt = require('jsonwebtoken');

let token = jwt.sign({ foo: 'bar' }, key, { algorithm: 'HS256' }); // Compliant

jwt.verify(token, key, { expiresIn: 360000 * 5, algorithms: ['HS256'] }, callbackcheck); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/347">MITRE, CWE-347</a> - Improper Verification of Cryptographic Signature </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5547">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5547">
              javascript:S5547
            </a>
          </td>
          <td>
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Strong_cryptography">Strong cipher algorithms</a> are cryptographic systems resistant to cryptanalysis, they
are not vulnerable to well-known attacks like brute force attacks for example.</p>
<p>A general recommendation is to only use cipher algorithms intensively tested and promoted by the cryptographic community.</p>
<p>More specifically for block cipher, it’s not recommended to use algorithm with a block size inferior than 128 bits.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.createCipheriv("DES", key, iv); // Noncompliant: DES / 3DES is unsecure
crypto.createCipheriv("DES-EDE", key, ""); // Noncompliant: DES / 3DES is unsecure
crypto.createCipheriv("DES-EDE3", key, ""); // Noncompliant: DES / 3DES is unsecure
crypto.createCipheriv("RC2", key, iv); // Noncompliant: RC2 is vulnerable to a related-key attack
crypto.createCipheriv("RC4", key, "");// Noncompliant: RC4 is vulnerable to several attacks
crypto.createCipheriv("BF", key, iv);// Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.createCipheriv("AES-256-GCM", key, iv);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5542">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5542">
              javascript:S5542
            </a>
          </td>
          <td>
            <details>
              <p>Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity.</p>
<ul>
  <li> For block cipher encryption algorithms (like AES):
    <ul>
      <li> The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block
      always gets encrypted to the same ciphertext block. This mode should never be used. </li>
      <li> The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to <a
      href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a> when used with padding. Using CBC along with Message
      Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s
      recommended to avoid CBC with padding completely. </li>
      <li> The GCM (Galois Counter Mode) mode which <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode#Mathematical_basis">works
      internally</a> with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality.
      Other similar modes are CCM, CWC, EAX, IAPM and OCB. </li>
    </ul>  </li>
  <li> For RSA encryption algorithm, the recommended padding scheme is OAEP. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.createCipheriv("AES-128-CBC", key, iv); // Noncompliant: CBC with PKCS5/7 (set by default) is vulnerable to oracle padding attacks
crypto.createCipheriv("AES-128-ECB", key, ""); // Noncompliant: ECB doesn't provide serious message confidentiality
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.createCipheriv("AES-256-GCM", key, iv);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="javascript:S5876">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5876">
              javascript:S5876
            </a>
          </td>
          <td>
            <details>
              <p>Session fixation attacks occur when an attacker can force a legitimate user to use a session ID that he knows. To avoid fixation attacks, it’s a
good practice to generate a new session each time a user authenticates and delete/invalidate the existing session (the one possibly known by the
attacker).</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="http://www.passportjs.org/">Passport.js</a>:</p>
<pre>
app.post('/login',
  passport.authenticate('local', { failureRedirect: '/login' }),
  function(req, res) {
    // Sensitive - no session.regenerate after login
    res.redirect('/');
  });
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="http://www.passportjs.org/">Passport.js</a>:</p>
<pre>
app.post('/login',
  passport.authenticate('local', { failureRedirect: '/login' }),
  function(req, res) {
    let prevSession = req.session;
    req.session.regenerate((err) =&gt; {  // Compliant
      Object.assign(req.session, prevSession);
      res.redirect('/');
    });
  });
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication">OWASP Top 10 2017 Category A2</a> -
  Broken Authentication </li>
  <li> <a href="https://owasp.org/www-community/attacks/Session_fixation">OWASP Sesssion Fixation</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/384">MITRE, CWE-384</a> - Session Fixation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="javascript:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4423">
              javascript:S4423
            </a>
          </td>
          <td>
            <details>
              <p>This rule raises an issue when an insecure TLS protocol version (i.e. a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2", or "DTLSv1.3") is
used or allowed.</p>
<p>It is recommended to enforce TLS 1.2 as the minimum protocol version and to disallow older versions like TLS 1.0. Failure to do so could open the
door to downgrade attacks: a malicious actor who is able to intercept the connection could modify the requested protocol version and downgrade it to a
less secure version.</p>
<p>In most cases, using the default system configuration is not compliant. Indeed, an application might get deployed on a wide range of systems with
different configurations. While using a system’s default value might be safe on modern up-to-date systems, this might not be the case on older
systems. It is therefore recommended to explicitly set a safe configuration in every case.</p>
<h2>Noncompliant Code Example</h2>
<p><code>secureProtocol</code>, <code>minVersion</code>/<code>maxVersion</code> and <code>secureOptions</code> should not be set to use weak TLS
protocols (TLSv1.1 and lower):</p>
<pre>
let options = {
  secureProtocol: 'TLSv1_method' // Noncompliant: TLS1.0 is insecure
};

let options = {
  minVersion: 'TLSv1.1',  // Noncompliant: TLS1.1 is insecure
  maxVersion: 'TLSv1.2'
};

let options = {
  secureOptions: constants.SSL_OP_NO_SSLv2 | constants.SSL_OP_NO_SSLv3 | constants.SSL_OP_NO_TLSv1
}; // Noncompliant TLS 1.1 (constants.SSL_OP_NO_TLSv1_1) is not disabled
</pre>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
});  // Noncompliant
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let socket = tls.connect(443, "www.example.com", options, () =&gt; { });  // Noncompliant
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get(options);
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.DomainName.html">aws-cdk-lib.aws_apigateway.DomainName</a>:</p>
<pre>
import { aws_apigateway as agw } from 'aws-cdk-lib';

new agw.DomainName(this, 'Example', {
    certificate: certificate,
    domainName: domainName,
    securityPolicy: agw.SecurityPolicy.TLS_1_0, // Noncompliant
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>
<pre>
import { aws_opensearchservice as os } from 'aws-cdk-lib';

new os.CfnDomain(this, 'Example', {
  domainEndpointOptions: {
    enforceHttps: true,
  },
}); // NonCompliant by default
</pre>
<h2>Compliant Solution</h2>
<p>Set either <code>secureProtocol</code> or <code>secureOptions</code> or <code>minVersion</code> to use secure protocols only (TLSv1.2 and
higher):</p>
<pre>
let options = {
  secureProtocol: 'TLSv1_2_method'
};
// or
let options = {
  secureOptions: constants.SSL_OP_NO_SSLv2 | constants.SSL_OP_NO_SSLv3 | constants.SSL_OP_NO_TLSv1 | constants.SSL_OP_NO_TLSv1_1
};
// or
let options = {
    minVersion: 'TLSv1.2'
};
</pre>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
});
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let socket = tls.connect(443, "www.example.com", options, () =&gt; { });
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get(options);
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_apigateway.DomainName.html">aws-cdk-lib.aws_apigateway.DomainName</a>:</p>
<pre>
import { aws_apigateway as agw } from 'aws-cdk-lib';

new agw.DomainName(this, 'Example', {
    certificate: certificate,
    domainName: domainName,
    securityPolicy: agw.SecurityPolicy.TLS_1_2,
});
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_opensearchservice.Domain.html">aws-cdk-lib.aws_opensearchservice.Domain</a>:</p>
<pre>
import { aws_opensearchservice as os } from 'aws-cdk-lib';

new os.CfnDomain(this, 'Example', {
  domainEndpointOptions: {
    enforceHttps: true,
    tlsSecurityPolicy: 'Policy-Min-TLS-1-2-2019-07',
  },
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html">Amazon API Gateway</a> -
  Choosing a minimum TLS version </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4426">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4426">
              javascript:S4426
            </a>
          </td>
          <td>
            <details>
              <p>Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks.</p>
<p><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST recommendations</a> will be checked for these
use-cases:</p>
<p><strong>Digital Signature Generation</strong> and <strong>Verification:</strong></p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DSA (<code>p</code> is key length and <code>q</code> the modulus length) </li>
  <li> n ≥ 2048 for RSA (<code>n</code> is the key length) </li>
</ul>
<p><strong>Key Agreement</strong>:</p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DH and MQV </li>
  <li> n ≥ 224 for ECDH and ECMQV (Examples: <code>secp192r1</code> is a non-compliant curve (<code>n</code> &lt; 224) but <code>secp224k1</code> is
  compliant (<code>n</code> &gt;= 224)) </li>
</ul>
<p><strong>Symmetric keys</strong>:</p>
<ul>
  <li> key length ≥ 128 bits </li>
</ul>
<p>This rule will not raise issues for ciphers that are considered weak (no matter the key size) like <code>DES</code>, <code>Blowfish</code>.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
var { privateKey, publicKey } = crypto.generateKeyPairSync('rsa', {
  modulusLength: 1024,  // Noncompliant
  publicKeyEncoding:  { type: 'spki', format: 'pem' },
  privateKeyEncoding: { type: 'pkcs8', format: 'pem' }
}); // Noncompliant: 1024 bits is too short for a RSA key pair

crypto.generateKeyPair('ec', {
  namedCurve: 'secp112r2',
  publicKeyEncoding:  { type: 'spki', format: 'pem' },
  privateKeyEncoding: { type: 'pkcs8', format: 'pem' }
}, callback); // Noncompliant: secp112r2 curve doesn't provide enough security
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/crypto.html">crypto</a> built-in module:</p>
<pre>
crypto.generateKeyPair('rsa', {
  modulusLength: 2048,  // Compliant
  publicKeyEncoding:  { type: 'spki', format: 'pem' },
  privateKeyEncoding: { type: 'pkcs8', format: 'pem' }
}, callback); // Compliant

crypto.generateKeyPair('ec', {
  namedCurve: 'secp224k1',
  publicKeyEncoding:  { type: 'spki', format: 'pem' },
  privateKeyEncoding: { type: 'pkcs8', format: 'pem' }
}, callback); // compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST 800-131A</a> - Recommendation for Transitioning the
  Use of Cryptographic Algorithms and Key Lengths </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="javascript:S2817">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2817">
              javascript:S2817
            </a>
          </td>
          <td>
            <details>
              <p>The Web SQL Database standard never saw the light of day. It was first formulated, then deprecated by the W3C and was only implemented in some
browsers. (It is not supported in Firefox or IE.)</p>
<p>Further, the use of a Web SQL Database poses security concerns, since you only need its name to access such a database.</p>
<h2>Noncompliant Code Example</h2>
<pre>
var db = window.openDatabase("myDb", "1.0", "Personal secrets stored here", 2*1024*1024);  // Noncompliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> -
  Using Components with Known Vulnerabilities </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated, and will eventually be removed.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S5527">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S5527">
              javascript:S5527
            </a>
          </td>
          <td>
            <details>
              <p>To establish a SSL/TLS connection not vulnerable to man-in-the-middle attacks, it’s essential to make sure the server presents the right
certificate.</p>
<p>The certificate’s hostname-specific data should match the server hostname.</p>
<p>It’s not recommended to re-invent the wheel by implementing custom hostname verification.</p>
<p>TLS/SSL libraries provide built-in hostname verification functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let options = {
  hostname: 'www.example.com',
  port: 443,
  path: '/',
  method: 'GET',
  secureProtocol: 'TLSv1_2_method',
  checkServerIdentity: function() {} // Noncompliant: hostname is not verified
};

let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
}); // Noncompliant
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let options = {
    secureProtocol: 'TLSv1_2_method',
    checkServerIdentity: function() {}  // Noncompliant: hostname is not verified
};

let socket = tls.connect(443, "www.example.com", options, () =&gt; {
  process.stdin.pipe(socket);
  process.stdin.resume();
});  // Noncompliant
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get({
    url: 'https://www.example.com',
    secureProtocol: 'TLSv1_2_method',
    checkServerIdentity: function() {}  // Noncompliant: hostname is not verified
});
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let options = {
  hostname: 'www.example.com',
  port: 443,
  path: '/',
  method: 'GET',
  secureProtocol: 'TLSv1_2_method'
};

let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
}); // Compliant: default checkServerIdentity function is secure
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let options = {
    secureProtocol: 'TLSv1_2_method',
    checkServerIdentity: (servername, peer) =&gt; {
        if (servername !== "www.example.com") {
            return new Error ('Error');  // Compliant: there is at least one check
        }
    }
};

let socket = tls.connect(443, "www.example.com", options, () =&gt; {
  process.stdin.pipe(socket);
  process.stdin.resume();
}); // Compliant
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get({
    url: 'https://www.example.com/',
    secureProtocol: 'TLSv1_2_method' // Compliant
}); // Compliant:  default checkServerIdentity function is secure
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/297">MITRE, CWE-297</a> - Improper Validation of Certificate with Host Mismatch </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="javascript:S6317">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6317">
              javascript:S6317
            </a>
          </td>
          <td>
            <details>
              <p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy
which, when attached to an identity or a resource, defines its permissions. Policies granting permission to an Identity (a User, a Group or Role) are
called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>
<p>Here is an example of a policy document defining a limited set of permission that grants a user the ability to manage his own access keys.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "arn:aws:iam::245500951992:user/${aws:username}",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Privilege escalation generally happens when an identity policy gives an identity the ability to grant more privileges than the ones it already has.
Here is another example of a policy document that hides a privilege escalation. It allows an identity to generate a new access key for any user from
the account, including users with high privileges.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Although it looks like it grants a limited set of permissions, this policy would, in practice, give the highest privileges to the identity it’s
attached to.</p>
<p>Privilege escalation is a serious issue as it allows a malicious user to easily escalate to a high privilege identity from a low privilege identity
it took control of.</p>
<p>The example above is just one of many permission escalation vectors. Here is the list of vectors that the rule can detect:</p>
<table>
  <colgroup>
    <col style="width: 50%;">
    <col style="width: 50%;">
  </colgroup>
  <thead>
    <tr>
      <th>Vector name</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><p>Create Policy Version</p></td>
      <td><p>Create a new IAM policy and set it as default</p></td>
    </tr>
    <tr>
      <td><p>Set Default Policy Version</p></td>
      <td><p>Set a different IAM policy version as default</p></td>
    </tr>
    <tr>
      <td><p>Create AccessKey</p></td>
      <td><p>Create a new access key for any user</p></td>
    </tr>
    <tr>
      <td><p>Create Login Profile</p></td>
      <td><p>Create a login profile with a password chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Update Login Profile</p></td>
      <td><p>Update the existing password with one chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Attach User Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Group Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a group containing a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Role Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a role that can be assumed by the user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put User Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Group Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a group containing a user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Role Policy</p></td>
      <td><p>Alter an existing inline IAM role policy. The rule will then be assumed by the user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Add User to Group</p></td>
      <td><p>Add a user that the attacker controls to a group that has a larger range of permissions</p></td>
    </tr>
    <tr>
      <td><p>Update Assume Role Policy</p></td>
      <td><p>Update a role’s "AssumeRolePolicyDocument" to allow a user the attacker controls to assume it</p></td>
    </tr>
    <tr>
      <td><p>EC2</p></td>
      <td><p>Create an EC2 instance that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Invoke</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and invoke it</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Add Permission</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and grant permission to invoke it to a user or a service</p></td>
    </tr>
    <tr>
      <td><p>Lambda triggered with an external event</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and link it to an external event</p></td>
    </tr>
    <tr>
      <td><p>Update Lambda code</p></td>
      <td><p>Update the code of a Lambda function executing with high privileges</p></td>
    </tr>
    <tr>
      <td><p>CloudFormation</p></td>
      <td><p>Create a CloudFormation stack that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Data Pipeline</p></td>
      <td><p>Create a Pipeline that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Glue Development Endpoint</p></td>
      <td><p>Create a Glue Development Endpoint that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Update Glue Dev Endpoint</p></td>
      <td><p>Update the associated SSH key for the Glue endpoint</p></td>
    </tr>
  </tbody>
</table>
<p>The general recommendation to protect against privilege escalation is to restrict the resources to which sensitive permissions are granted. The
first example above is a good demonstration of sensitive permissions being used with a narrow scope of resources and where no privilege escalation is
possible.</p>
<h2>Noncompliant Code Example</h2>
<p>The following policy allows an attacker to update the code of any Lambda function. An attacker can achieve privilege escalation by altering the
code of a Lambda that executes with high privileges.</p>
<pre>
import {aws_iam as iam} from 'aws-cdk-lib'

new iam.PolicyDocument({
    statements: [new iam.PolicyStatement({
        effect: iam.Effect.ALLOW,
        actions: ["lambda:UpdateFunctionCode"],
        resources: ["*"], // Noncompliant
    })],
})
</pre>
<h2>Compliant Solution</h2>
<p>Narrow the policy such that only updates to the code of certain Lambda functions are allowed.</p>
<pre>
import {aws_iam as iam} from 'aws-cdk-lib'

new iam.PolicyDocument({
    statements: [new iam.PolicyStatement({
        effect: iam.Effect.ALLOW,
        actions: ["lambda:UpdateFunctionCode"],
        resources: ["arn:aws:lambda:us-east-2:123456789012:function:my-function:1"], // Noncompliant
    })],
})
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/">Rhino Security Labs</a> - AWS IAM Privilege Escalation
  – Methods and Mitigation </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-269</a> - Improper Privilege Management </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="javascript:S2755">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S2755">
              javascript:S2755
            </a>
          </td>
          <td>
            <details>
              <p>XML standard allows the use of entities, declared in the DOCTYPE of the document, which can be <a
href="https://www.w3.org/TR/xml/#sec-internal-ent">internal</a> or <a href="https://www.w3.org/TR/xml/#sec-external-ent">external</a>.</p>
<p>When parsing the XML file, the content of the external entities is retrieved from an external storage such as the file system or network, which may
lead, if no restrictions are put in place, to arbitrary file disclosures or <a
href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">server-side request forgery (SSRF)</a> vulnerabilities.</p>
<p>It’s recommended to limit resolution of external entities by using one of these solutions:</p>
<ul>
  <li> If DOCTYPE is not necessary, completely disable all DOCTYPE declarations. </li>
  <li> If external entities are not necessary, completely disable their declarations. </li>
  <li> If external entities are necessary then:
    <ul>
      <li> Use XML processor features, if available, to authorize only required protocols (eg: https). </li>
      <li> And use an entity resolver (and optionally an XML Catalog) to resolve only trusted entities. </li>
    </ul>  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://github.com/libxmljs/libxmljs">libxmljs</a> module:</p>
<pre>
const libxmljs = require("libxmljs");
var fs = require('fs');

var xml = fs.readFileSync('xxe.xml', 'utf8');

var xmlDoc = libxmljs.parseXmlString(xml, { noblanks: true, noent: true, nocdata: true }); // Noncompliant: noent set to true
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://github.com/libxmljs/libxmljs">libxmljs</a> module:</p>
<pre>
const libxmljs = require("libxmljs");
var fs = require('fs');

var xml = fs.readFileSync('xxe.xml', 'utf8');

var xmlDoc = libxmljs.parseXmlString(xml); // Compliant: noent set to false by default
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">OWASP XXE Prevention Cheat Sheet</a>
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/611">MITRE, CWE-611</a> - Information Exposure Through XML External Entity Reference </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/827">MITRE, CWE-827</a> - Improper Control of Document Type Definition </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="javascript:S1525">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S1525">
              javascript:S1525
            </a>
          </td>
          <td>
            <details>
              <p>The debugger statement can be placed anywhere in procedures to suspend execution. Using the debugger statement is similar to setting a breakpoint
in the code. By definition such statement must absolutely be removed from the source code to prevent any unexpected behavior or added vulnerability to
attacks in production.</p>
<h2>Noncompliant Code Example</h2>
<pre>
for (i = 1; i&lt;5; i++) {
  // Print i to the Output window.
  Debug.write("loop index is " + i);
  // Wait for user to resume.
  debugger;
}
</pre>
<h2>Compliant Solution</h2>
<pre>
for (i = 1; i&lt;5; i++) {
  // Print i to the Output window.
  Debug.write("loop index is " + i);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4507'>S4507</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="javascript:S6321">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S6321">
              javascript:S6321
            </a>
          </td>
          <td>
            <details>
              <p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and
outbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services
traditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those
held by system administrators or those of <a href="https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls">bastion-like</a>
servers.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html">aws-cdk-lib.aws_ec2.Instance</a> and other constructs
that support a <code>connections</code> attribute:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const instance = new ec2.Instance(this, "default-own-security-group",{
    instanceType: nanoT2,
    machineImage: ec2.MachineImage.latestAmazonLinux(),
    vpc: vpc,
    instanceName: "test-instance"
})

instance.connections.allowFrom(
    ec2.Peer.anyIpv4(), // Noncompliant
    ec2.Port.tcp(22),
    /*description*/ "Allows SSH from all IPv4"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html">aws-cdk-lib.aws_ec2.SecurityGroup</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const securityGroup = new ec2.SecurityGroup(this, "custom-security-group", {
    vpc: vpc
})

securityGroup.addIngressRule(
    ec2.Peer.anyIpv4(), // Noncompliant
    ec2.Port.tcpRange(1, 1024)
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroup.html">aws-cdk-lib.aws_ec2.CfnSecurityGroup</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnSecurityGroup(
    this,
    "cfn-based-security-group", {
        groupDescription: "cfn based security group",
        groupName: "cfn-based-security-group",
        vpcId: vpc.vpcId,
        securityGroupIngress: [
            {
                ipProtocol: "6",
                cidrIp: "0.0.0.0/0", // Noncompliant
                fromPort: 22,
                toPort: 22
            }
        ]
    }
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress.html">aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnSecurityGroupIngress( // Noncompliant
    this,
    "ingress-all-ip-tcp-ssh", {
        ipProtocol: "tcp",
        cidrIp: "0.0.0.0/0",
        fromPort: 22,
        toPort: 22,
        groupId: securityGroup.attrGroupId
})
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.Instance.html">aws-cdk-lib.aws_ec2.Instance</a> and other constructs
that support a <code>connections</code> attribute:</p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const instance = new ec2.Instance(this, "default-own-security-group",{
    instanceType: nanoT2,
    machineImage: ec2.MachineImage.latestAmazonLinux(),
    vpc: vpc,
    instanceName: "test-instance"
})

instance.connections.allowFrom(
    ec2.Peer.ipv4("192.0.2.0/24"),
    ec2.Port.tcp(22),
    /*description*/ "Allows SSH from a trusted range"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.SecurityGroup.html">aws-cdk-lib.aws_ec2.SecurityGroup</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

const securityGroup3 = new ec2.SecurityGroup(this, "custom-security-group", {
    vpc: vpc
})

securityGroup3.addIngressRule(
    ec2.Peer.anyIpv4(),
    ec2.Port.tcpRange(1024, 1048)
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroup.html">aws-cdk-lib.aws_ec2.CfnSecurityGroup</a></p>
<pre>
import {aws_ec2 as ec2} from 'aws-cdk-lib'

new ec2.CfnSecurityGroup(
    this,
    "cfn-based-security-group", {
        groupDescription: "cfn based security group",
        groupName: "cfn-based-security-group",
        vpcId: vpc.vpcId,
        securityGroupIngress: [
            {
                ipProtocol: "6",
                cidrIp: "192.0.2.0/24", // Compliant
                fromPort: 22,
                toPort: 22
            }
        ]
    }
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/docs/aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress.html">aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress</a></p>
<pre>
new ec2.CfnSecurityGroupIngress(
    this,
    "ingress-all-ipv4-tcp-http", {
        ipProtocol: "6",
        cidrIp: "0.0.0.0/0",
        fromPort: 80,
        toPort: 80,
        groupId: securityGroup.attrGroupId
    }
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">AWS Documentation</a> - Security groups for your VPC </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview">Azure Documentation</a> - Network security
  groups </li>
  <li> <a href="https://cloud.google.com/vpc/docs/using-firewalls">GCP Documentation</a> - Firewalls </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S4830">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S4830">
              javascript:S4830
            </a>
          </td>
          <td>
            <details>
              <p>Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.</p>
<p>The certificate chain validation includes these steps:</p>
<ul>
  <li> The certificate is issued by its parent Certificate Authority or the root CA trusted by the system. </li>
  <li> Each CA is allowed to issue certificates. </li>
  <li> Each certificate in the chain is not expired. </li>
</ul>
<p>It’s not recommended to reinvent the wheel by implementing custom certificate chain validation.</p>
<p>TLS libraries provide built-in certificate validation functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<p>There is no way to disable certificate verification in tls, https and request modules but it is possible to not reject request when verification
fails.</p>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let options = {
  hostname: 'www.example.com',
  port: 443,
  path: '/',
  method: 'GET',
  secureProtocol: 'TLSv1_2_method',
  rejectUnauthorized: false ; // Noncompliant
};

let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
}); // Noncompliant
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let options = {
    secureProtocol: 'TLSv1_2_method',
    rejectUnauthorized: false ; // Noncompliant
};

let socket = tls.connect(443, "www.example.com", options, () =&gt; {
  process.stdin.pipe(socket);
  process.stdin.resume();
});  // Noncompliant
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get({
    url: 'www.example.com',
    secureProtocol: 'TLSv1_2_method',
    rejectUnauthorized: false ; // Noncompliant
});
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://nodejs.org/api/https.html">https</a> built-in module:</p>
<pre>
let options = {
  hostname: 'www.example.com',
  port: 443,
  path: '/',
  method: 'GET',
  secureProtocol: 'TLSv1_2_method'
};

let req = https.request(options, (res) =&gt; {
  res.on('data', (d) =&gt; {
    process.stdout.write(d);
  });
}); // Compliant: by default rejectUnauthorized  is set to true
</pre>
<p><a href="https://nodejs.org/api/tls.html">tls</a> built-in module:</p>
<pre>
let options = {
    secureProtocol: 'TLSv1_2_method'
};

let socket = tls.connect(443, "www.example.com", options, () =&gt; {
  process.stdin.pipe(socket);
  process.stdin.resume();
}); // Compliant: by default rejectUnauthorized  is set to true
</pre>
<p><a href="https://www.npmjs.com/package/request">request</a> module:</p>
<pre>
let socket = request.get({
    url: 'https://www.example.com/',
    secureProtocol: 'TLSv1_2_method' // Compliant
}); // Compliant: by default rejectUnauthorized  is set to true
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="javascript:S1442">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=javascript:S1442">
              javascript:S1442
            </a>
          </td>
          <td>
            <details>
              <p><code>alert(...)</code> as well as <code>confirm(...)</code> and <code>prompt(...)</code> can be useful for debugging during development, but in
production mode this kind of pop-up could expose sensitive information to attackers, and should never be displayed.</p>
<h2>Noncompliant Code Example</h2>
<pre>
if(unexpectedCondition) {
  alert("Unexpected Condition");
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/489">MITRE, CWE-489</a> - Active Debug Code </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javascript%3AS4507'>S4507</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="secrets:S6290">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=secrets:S6290">
              secrets:S6290
            </a>
          </td>
          <td>
            <details>
              <p>AWS credentials are designed to authenticate and authorize requests to AWS.</p>
<p>If your application interacts with AWS then it requires AWS credentials to access all the resources it needs to function properly. Resources that
can be accessed depend on the permission granted to the AWS account. These credentials may authenticate to the AWS account root user who has
unrestricted access to all resources in your AWS account, including billing information.</p>
<p>This rule flags instances of:</p>
<ul>
  <li> AWS Secret Access Key </li>
  <li> AWS Access ID </li>
  <li> AWS Session Token </li>
</ul>
<h2>Recommended Secure Coding Practices</h2>
<p>Only administrators should have access to the AWS credentials used by your application.</p>
<p>As a consequence, AWS credentials should not be stored along with the application code as they would grant special privilege to anyone who has
access to the application source code.</p>
<p>Credentials should be stored outside of the code in a file that is never committed to your application code repository.</p>
<p>If possible, a better alternative is to use your cloud provider’s service for managing secrets. On AWS this service is called <a
href="https://aws.amazon.com/fr/secrets-manager/">Secrets Manager</a>.</p>
<p>When credentials are disclosed in the application code, consider them as compromised and revoke them immediately.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="secrets:S6334">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=secrets:S6334">
              secrets:S6334
            </a>
          </td>
          <td>
            <details>
              <p>Google API keys are used to authenticate applications that consume Google Cloud APIs. They are especially useful for accessing public data
anonymously (like Google Maps), and are used to associate API requests with your project for quota and billing.</p>
<p>API keys are not strictly secret as they are often embedded into client side code or mobile applications that consume Google Cloud APIs. Still,
they should be secured and should never be treated as public information.</p>
<p>An unrestricted Google API key being disclosed in a public source code would be used by malicious actors to consume Google APIs on the behalf of
your application. This will have a financial impact as your organisation will be billed for the data consumed by the malicious actor. If your account
has enabled quota to cap the API consumption of your application, this quota can be exceeded, leaving your application unable to request the Google
APIs it requires to function properly.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Only administrators should have access to the Google API keys used by your application.</p>
<p>As a consequence, Google API keys should not be stored along with the application code as they could be disclosed to a large audience or could be
made public.</p>
<p>Google API keys should be stored outside of the code in a file that is never committed to your application code repository.</p>
<p>If possible, a better alternative is to use your cloud provider’s service for managing secrets. On Google Cloud this service is called <a
href="https://cloud.google.com/secret-manager">Secret Manager</a>.</p>
<p>When credentials are disclosed in the application code, consider them as compromised and revoke them immediately.</p>
<p>In addition to secure storage, it’s important to apply <a
href="https://cloud.google.com/docs/authentication/api-keys#api_key_restrictions">restrictions</a> to API keys in order to mitigate the impacts when
they are discovered by malicious actors.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://cloud.google.com/docs/authentication/api-keys">Google Cloud</a> - Using API keys </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="secrets:S6337">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=secrets:S6337">
              secrets:S6337
            </a>
          </td>
          <td>
            <details>
              <p>IBM API keys are used to authenticate applications that consume IBM Cloud APIs.</p>
<p>If your application interacts with IBM then it requires credentials to access all the resources it needs to function properly. Resources that can
be accessed depend on the permissions granted to the account. These credentials may authenticate a user who has unrestricted access to all resources
in your account, including billing information.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Only administrators should have access to the IBM API keys used by your application.</p>
<p>As a consequence, IBM API keys should not be stored along with the application code as they could be disclosed to a large audience or could be made
public.</p>
<p>IBM API keys should be stored outside of the code in a file that is never committed to your application code repository.</p>
<p>If possible, a better alternative is to use your cloud provider’s service for managing secrets. On IBM Cloud this service is called <a
href="https://www.ibm.com/cloud/secrets-manager">Secrets Manager</a>.</p>
<p>When credentials are disclosed in the application code, consider them as compromised and revoke them immediately.</p>
<p>In addition to secure storage, it’s important to apply <a
href="https://www.ibm.com/docs/it/db2oc?topic=management-identity-access-iam-cloud">restrictions</a> to API keys in order to mitigate the impacts when
they are discovered by malicious actors.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="secrets:S6338">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=secrets:S6338">
              secrets:S6338
            </a>
          </td>
          <td>
            <details>
              <p>Azure Storage Account Keys are similar to the root password, allowing full access to Azure Storage Accounts.</p>
<p>If the application interacts with Azure Cloud Storage services, access keys should be secured and not be disclosed.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Only administrators should have access to storage account keys. To authorize an application to access an Azure Storage, it’s recommended to create
a service principal and assign it the required privileges only. <a
href="https://docs.microsoft.com/en-us/azure/storage/common/storage-auth-aad-msi?toc=%2Fazure%2Fstorage%2Fblobs%2Ftoc.json#authenticate-with-the-azure-identity-library">Azure
Identity SDK</a> provides several options such as <em>DefaultAzureCredential</em> that can be used to retrieve secrets from, for instance, environment
variables.</p>
<p>Storage account keys should not be stored with the application code or saved anywhere in plain text accessible to others. Consider using an <a
href="https://azure.microsoft.com/en-us/services/key-vault/">Azure Key Vault</a> to store and manage keys.</p>
<p>When credentials are disclosed in the application code, consider them as compromised and rotate them immediately.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/storage/common/storage-account-keys-manage?tabs=azure-portal">docs.microsoft.com</a> - Manage
  storage account access keys </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="secrets:S6292">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=secrets:S6292">
              secrets:S6292
            </a>
          </td>
          <td>
            <details>
              <p>Amazon Marketplace Web Service credentials are designed to authenticate and authorize Amazon sellers.</p>
<p>If your application interacts with Amazon MWS then it requires credentials to access all the resources it needs to function properly. The
credentials authenticate to a seller account which can have access to resources like products, orders, price or shipment information.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Only administrators should have access to the MWS credentials used by your application.</p>
<p>As a consequence, MWS credentials should not be stored along with the application code as they would grant special privilege to anyone who has
access to the application source code.</p>
<p>Credentials should be stored outside of the code in a file that is never committed to your application code repository.</p>
<p>If possible, a better alternative is to use your cloud provider’s service for managing secrets. On AWS this service is called <a
href="https://aws.amazon.com/fr/secrets-manager/">Secrets Manager</a>.</p>
<p>When credentials are disclosed in the application code, consider them as compromised and revoke them immediately.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="secrets:S6335">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=secrets:S6335">
              secrets:S6335
            </a>
          </td>
          <td>
            <details>
              <p>Google Cloud service accounts are designed to authenticate and authorize requests to Google APIs.</p>
<p>If your application interacts with Google Cloud services then it requires a service account to access all the resources it needs to function
properly. Resources that can be accessed depend on the permission granted to the service account. Establishing the identity of a service account
relies on a public/private key pair. It’s common for private keys to be distributed through a JSON file that your application will then use to consume
Google APIs.</p>
<p>A key may authenticate to a high privilege which has unrestricted access to all resources in your Google Cloud project, including billing
information.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Only administrators should have access to the service account key used by your application.</p>
<p>As a consequence, service account keys should not be stored along with the application code as they would grant special privileges to anyone who
has access to the application source code.</p>
<p>Keys should be stored outside of the code in a file that is never committed to your application code repository.</p>
<p>If possible, a better alternative is to use your cloud provider’s service for managing secrets. On Google Cloud this service is called <a
href="https://cloud.google.com/secret-manager">Secret Manager</a>.</p>
<p>When keys are disclosed in the application code, consider them as compromised and revoke them immediately.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://cloud.google.com/iam/docs/creating-managing-service-account-keys">Google Cloud</a> - Creating and managing service account
  keys </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="secrets:S6336">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=secrets:S6336">
              secrets:S6336
            </a>
          </td>
          <td>
            <details>
              <p>AccessKeys are long term credentials designed to authenticate and authorize requests to Alibaba Cloud.</p>
<p>If your application interacts with Alibaba Cloud then it requires AccessKeys to access all the resources it needs to function properly. Resources
that can be accessed depend on the permissions granted to the Alibaba Cloud account. These credentials may authenticate to the account root user who
has unrestricted access to all resources in your Alibaba Cloud account, including billing information.</p>
<p>This rule flags instances of:</p>
<ul>
  <li> Alibaba Cloud AccessKey ID </li>
  <li> Alibaba Cloud AccessKey secret </li>
</ul>
<h2>Recommended Secure Coding Practices</h2>
<p>Only administrators should have access to the AccessKeys used by your application.</p>
<p>As a consequence, AccessKeys should not be stored along with the application code as they would grant special privilege to anyone who has access to
the application source code.</p>
<p>AccessKeys should be stored outside of the code in a file that is never committed to your application code repository.</p>
<p>If possible, a better alternative is to use your cloud provider’s service for managing secrets. On AlibabaCloud this service is called <a
href="https://www.alibabacloud.com/help/doc-detail/152001.htm">Secrets Manager</a>.</p>
<p>When credentials are disclosed in the application code, consider them as compromised and revoke them immediately.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S2115">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2115">
              python:S2115
            </a>
          </td>
          <td>
            <details>
              <p>When relying on the password authentication mode for the database connection, a secure password should be chosen.</p>
<p>This rule raises an issue when an empty password is used.</p>
<h2>Noncompliant Code Example</h2>
<p>Flask-SQLAlchemy</p>
<pre>
def configure_app(app):
    app.config['SQLALCHEMY_DATABASE_URI'] = "postgresql://user:@domain.com" # Noncompliant
</pre>
<p>Django</p>
<pre>
# settings.py

DATABASES = {
    'postgresql_db': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'quickdb',
        'USER': 'sonarsource',
        'PASSWORD': '', # Noncompliant
        'HOST': 'localhost',
        'PORT': '5432'
    }
}
</pre>
<p>mysql/mysql-connector-python</p>
<pre>
from mysql.connector import connection

connection.MySQLConnection(host='localhost', user='sonarsource', password='')  # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>Flask-SQLAlchemy</p>
<pre>
def configure_app(app, pwd):
    app.config['SQLALCHEMY_DATABASE_URI'] = f"postgresql://user:{pwd}@domain.com" # Compliant
</pre>
<p>Django</p>
<pre>
# settings.py
import os

DATABASES = {
    'postgresql_db': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'quickdb',
        'USER': 'sonarsource',
        'PASSWORD': os.getenv('DB_PASSWORD'),      # Compliant
        'HOST': 'localhost',
        'PORT': '5432'
    }
}
</pre>
<p>mysql/mysql-connector-python</p>
<pre>
from mysql.connector import connection
import os

db_password = os.getenv('DB_PASSWORD')
connection.MySQLConnection(host='localhost', user='sonarsource', password=db_password)  # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication.html">OWASP Top 10 2017 Category A2</a> - Broken
  Authentication </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/521">MITRE, CWE-521</a> - Weak Password Requirements </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S3329">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S3329">
              python:S3329
            </a>
          </td>
          <td>
            <details>
              <p>When encrypting data with the Cipher Block Chaining (CBC) mode an Initialization Vector (IV) is used to randomize the encryption, ie under a given
key the same plaintext doesn’t always produce the same ciphertext. The IV doesn’t need to be secret but should be unpredictable to avoid
"Chosen-Plaintext Attack".</p>
<p>To generate Initialization Vectors, NIST recommends to use a secure random number generator.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://github.com/Legrandin/pycryptodome">PyCryptodome</a> module:</p>
<pre>
from Crypto.Cipher import AES
from Crypto.Random import get_random_bytes
from Crypto.Util.Padding import pad, unpad

static_vector = b'x' * AES.block_size
cipher = AES.new(key, AES.MODE_CBC, static_vector)
cipher.encrypt(pad(data, AES.block_size))  # Noncompliant
</pre>
<p>For <a href="https://github.com/pyca/cryptography">cryptography</a> module:</p>
<pre>
from os import urandom
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes

static_vector = b'x' * 16
cipher = Cipher(algorithms.AES(key), modes.CBC(static_vector))
cipher.encryptor()  # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://github.com/Legrandin/pycryptodome">PyCryptodome</a> module:</p>
<pre>
from Crypto.Cipher import AES
from Crypto.Random import get_random_bytes
from Crypto.Util.Padding import pad, unpad

random_vector = get_random_bytes(AES.block_size)
cipher = AES.new(key, AES.MODE_CBC, random_vector)
cipher.encrypt(pad(data, AES.block_size))
</pre>
<p>For <a href="https://github.com/pyca/cryptography">cryptography</a> module:</p>
<pre>
from os import urandom
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes

random_vector = urandom(16)
cipher = Cipher(algorithms.AES(key), modes.CBC(random_vector))
cipher.encryptor()
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure
  </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/329">MITRE, CWE-329</a> - Not Using an Unpredictable IV with CBC Mode </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST, SP-800-38A</a> - Recommendation for Block Cipher
  Modes of Operation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="python:S5659">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5659">
              python:S5659
            </a>
          </td>
          <td>
            <details>
              <p>If a JSON Web Token (JWT) is not signed with a strong cipher algorithm (or not signed at all) an attacker can forge it and impersonate user
identities.</p>
<ul>
  <li> Don’t use <code>none</code> algorithm to sign or verify the validity of a token. </li>
  <li> Don’t use a token without verifying its signature before. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://github.com/jpadilla/pyjwt">pyjwt</a> module:</p>
<pre>
jwt.decode(token, verify = False)  # Noncompliant
jwt.decode(token, key, options={"verify_signature": False})  # Noncompliant
</pre>
<p>For <a href="https://github.com/davedoesdev/python-jwt">python_jwt</a> module:</p>
<pre>
jwt.process_jwt(token)  # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://github.com/jpadilla/pyjwt">pyjwt</a> module:</p>
<pre>
jwt.decode(token, key, algo)
</pre>
<p>For <a href="https://github.com/davedoesdev/python-jwt">python_jwt</a> module:</p>
<pre>
jwt.process_jwt(token)  #  Compliant because followed by verify_jwt()
jwt.verify_jwt(token, key, algo)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/347">MITRE, CWE-347</a> - Improper Verification of Cryptographic Signature </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S5547">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5547">
              python:S5547
            </a>
          </td>
          <td>
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Strong_cryptography">Strong cipher algorithms</a> are cryptographic systems resistant to cryptanalysis, they
are not vulnerable to well-known attacks like brute force attacks for example.</p>
<p>A general recommendation is to only use cipher algorithms intensively tested and promoted by the cryptographic community.</p>
<p>More specifically for block cipher, it’s not recommended to use algorithm with a block size inferior than 128 bits.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://pycryptodome.readthedocs.io">pycryptodomex</a> library:</p>
<pre>
from Cryptodome.Cipher import DES, DES3, ARC2, ARC4, Blowfish, AES
from Cryptodome.Random import get_random_bytes

key = b'-8B key-'
DES.new(key, DES.MODE_OFB) # Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search

key = DES3.adjust_key_parity(get_random_bytes(24))
cipher = DES3.new(key, DES3.MODE_CFB) # Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack

key = b'Sixteen byte key'
cipher = ARC2.new(key, ARC2.MODE_CFB) # Noncompliant: RC2 is vulnerable to a related-key attack

key = b'Very long and confidential key'
cipher = ARC4.new(key) # Noncompliant: vulnerable to several attacks (see https://en.wikipedia.org/wiki/RC4#Security)

key = b'An arbitrarily long key'
cipher = Blowfish.new(key, Blowfish.MODE_CBC) # Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks
</pre>
<p><a href="https://pycryptodome.readthedocs.io">pycryptodome</a> library:</p>
<pre>
from Crypto.Cipher import DES, DES3, ARC2, ARC4, Blowfish, AES
from Crypto.Random import get_random_bytes

key = b'-8B key-'
DES.new(key, DES.MODE_OFB) # Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search

key = DES3.adjust_key_parity(get_random_bytes(24))
cipher = DES3.new(key, DES3.MODE_CFB) # Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack

key = b'Sixteen byte key'
cipher = ARC2.new(key, ARC2.MODE_CFB) # Noncompliant: RC2 is vulnerable to a related-key attack

key = b'Very long and confidential key'
cipher = ARC4.new(key) # Noncompliant: vulnerable to several attacks (see https://en.wikipedia.org/wiki/RC4#Security)

key = b'An arbitrarily long key'
cipher = Blowfish.new(key, Blowfish.MODE_CBC) # Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks
</pre>
<p><a href="https://cryptography.io/en/latest/">pyca</a> library:</p>
<pre>
import os
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend

key = os.urandom(16)
iv = os.urandom(16)

tdes4 = Cipher(algorithms.TripleDES(key), mode=None, backend=default_backend()) # Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
bf3 = Cipher(algorithms.Blowfish(key), mode=None, backend=default_backend()) # Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks
rc42 = Cipher(algorithms.ARC4(key), mode=None, backend=default_backend()) # Noncompliant: vulnerable to several attacks (see https://en.wikipedia.org/wiki/RC4#Security)
</pre>
<p><a href="https://pypi.org/project/pyDes/">pydes</a> library:</p>
<pre>
import pyDes;

des1 = pyDes.des('ChangeIt')  # Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search
des2 = pyDes.des('ChangeIt', pyDes.CBC, "\0\0\0\0\0\0\0\0", pad=None, padmode=pyDes.PAD_PKCS5) # Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search

tdes1 = pyDes.triple_des('ChangeItWithYourKey!!!!!')  # Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
tdes2 = pyDes.triple_des('ChangeItWithYourKey!!!!!', pyDes.CBC, "\0\0\0\0\0\0\0\0", pad=None, padmode=pyDes.PAD_PKCS5) # Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
</pre>
<p><a href="https://pycrypto.readthedocs.io/en/latest/">pycrypto</a> library is not maintained and therefore should not be used:</p>
<pre>
from Crypto.Cipher import *

des3 = DES.new('ChangeIt') # Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search
tdes3 = DES3.new('ChangeItChangeIt') # Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
bf2 = Blowfish.new('ChangeItWithYourKey', Blowfish.MODE_CBC, 'ChangeIt') # Noncompliant: Blowfish use a 64-bit block size makes it
rc21 = ARC2.new('ChangeItWithYourKey', ARC2.MODE_CFB, 'ChangeIt') # Noncompliant: RC2 is vulnerable to a related-key attack
rc41 = ARC4.new('ChangeItWithYourKey') # Noncompliant: vulnerable to several attacks (see https://en.wikipedia.org/wiki/RC4#Security)
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://pycryptodome.readthedocs.io">pycryptodomex</a> library:</p>
<pre>
from Cryptodome.Cipher import AES

key = b'Sixteen byte key'
cipher = AES.new(key, AES.MODE_CCM) # Compliant
</pre>
<p><a href="https://pycryptodome.readthedocs.io">pycryptodome</a> library:</p>
<pre>
from Crypto.Cipher import AES

key = b'Sixteen byte key'
cipher = AES.new(key, AES.MODE_CCM) # Compliant
</pre>
<p><a href="https://cryptography.io/en/latest/">pyca</a> library:</p>
<pre>
import os
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend

key = os.urandom(16)
iv = os.urandom(16)

aes2 = Cipher(algorithms.AES(key), modes.CBC(iv), backend=default_backend()) # Compliant
</pre>
<p><a href="https://pycrypto.readthedocs.io/en/latest/">pycrypto</a> library is not maintained and therefore should not be used:</p>
<pre>
from Crypto.Cipher import *

aes1 = AES.new('This is a key123', AES.MODE_CBC, 'This is an IV456') # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S5542">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5542">
              python:S5542
            </a>
          </td>
          <td>
            <details>
              <p>Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity.</p>
<ul>
  <li> For block cipher encryption algorithms (like AES):
    <ul>
      <li> The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block
      always gets encrypted to the same ciphertext block. This mode should never be used. </li>
      <li> The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to <a
      href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a> when used with padding. Using CBC along with Message
      Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s
      recommended to avoid CBC with padding completely. </li>
      <li> The GCM (Galois Counter Mode) mode which <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode#Mathematical_basis">works
      internally</a> with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality.
      Other similar modes are CCM, CWC, EAX, IAPM and OCB. </li>
    </ul>  </li>
  <li> For RSA encryption algorithm, the recommended padding scheme is OAEP. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://pycryptodome.readthedocs.io">pycryptodomex</a> library:</p>
<pre>
from Cryptodome.Cipher import AES, PKCS1_OAEP,  PKCS1_v1_5
from Cryptodome.Random import get_random_bytes
from Cryptodome.PublicKey import RSA

# Example for a symmetric cipher: AES
AES.new(key, AES.MODE_ECB)  # Noncompliant
AES.new(key, AES.MODE_CBC)  # Noncompliant

# Example for a asymmetric cipher: RSA
cipher = PKCS1_v1_5.new(key) # Noncompliant
</pre>
<p><a href="https://cryptography.io/en/latest/">pyca</a> library:</p>
<pre>
import os
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend
from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.primitives import hashes

# Example for a symmetric cipher: AES
aes = Cipher(algorithms.AES(key), modes.CBC(iv), backend=default_backend())  # Noncompliant
aes = Cipher(algorithms.AES(key), modes.ECB(), backend=default_backend())  # Noncompliant

# Example for a asymmetric cipher: RSA
ciphertext = public_key.encrypt(
  message,
  padding.PKCS1v15() # Noncompliant
)

plaintext = private_key.decrypt(
  ciphertext,
  padding.PKCS1v15() # Noncompliant
)
</pre>
<p><a href="https://pypi.org/project/pyDes/">pydes</a> library:</p>
<pre>
# For DES cipher
des = pyDes.des('ChangeIt') # Noncompliant
des = pyDes.des('ChangeIt', pyDes.CBC, "\0\0\0\0\0\0\0\0", pad=None, padmode=pyDes.PAD_PKCS5) # Noncompliant
des = pyDes.des('ChangeIt', pyDes.ECB, "\0\0\0\0\0\0\0\0", pad=None, padmode=pyDes.PAD_PKCS5) # Noncompliant
</pre>
<p><a href="https://pycrypto.readthedocs.io/en/latest/">pycrypto</a> library is not maintained and therefore should not be used:</p>
<pre>
# https://pycrypto.readthedocs.io/en/latest/
from Crypto.Cipher import *
from Crypto.Random import get_random_bytes
from Crypto.Util import Counter
from Crypto.PublicKey import RSA

# Example for a symmetric cipher: AES
AES.new(key, AES.MODE_ECB)  # Noncompliant
AES.new(key, AES.MODE_CBC, IV=iv)  # Noncompliant

# Example for a asymmetric cipher: RSA
cipher = PKCS1_v1_5.new(key) # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://pycryptodome.readthedocs.io">pycryptodomex</a> library:</p>
<pre>
from Cryptodome.Cipher import AES
from Cryptodome.Random import get_random_bytes
from Cryptodome.PublicKey import RSA

# AES is the recommended symmetric cipher with GCM mode
AES.new(key, AES.MODE_GCM)  # Compliant

# RSA is the recommended asymmetric cipher with OAEP padding
cipher = PKCS1_OAEP.new(key) # Compliant
</pre>
<p><a href="https://cryptography.io/en/latest/">pyca</a> library:</p>
<pre>
import os
from cryptography.hazmat.primitives.ciphers import Cipher, algorithms, modes
from cryptography.hazmat.backends import default_backend
from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.primitives import hashes

# AES is the recommended symmetric cipher with GCM mode
aes = Cipher(algorithms.AES(key), modes.GCM(iv), backend=default_backend())  # Compliant

# RSA is the recommended asymmetric cipher with OAEP padding
ciphertext = public_key.encrypt(
  message,
  padding.OAEP( # Compliant
    mgf=padding.MGF1(algorithm=hashes.SHA256()),
    algorithm=hashes.SHA256(),
    label=None
  )
)

plaintext = private_key.decrypt(
  ciphertext,
  padding.OAEP( # Compliant
    mgf=padding.MGF1(algorithm=hashes.SHA256()),
    algorithm=hashes.SHA256(),
    label=None
  )
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4423">
              python:S4423
            </a>
          </td>
          <td>
            <details>
              <p>This rule raises an issue when an insecure TLS protocol version (i.e. a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2", or "DTLSv1.3") is
used or allowed.</p>
<p>It is recommended to enforce TLS 1.2 as the minimum protocol version and to disallow older versions like TLS 1.0. Failure to do so could open the
door to downgrade attacks: a malicious actor who is able to intercept the connection could modify the requested protocol version and downgrade it to a
less secure version.</p>
<p>In most cases, using the default system configuration is not compliant. Indeed, an application might get deployed on a wide range of systems with
different configurations. While using a system’s default value might be safe on modern up-to-date systems, this might not be the case on older
systems. It is therefore recommended to explicitly set a safe configuration in every case.</p>
<h2>Noncompliant Code Example</h2>
<pre>
from OpenSSL import SSL

SSL.Context(SSL.SSLv3_METHOD)  # Noncompliant
</pre>
<pre>
import ssl

ssl.SSLContext(ssl.PROTOCOL_SSLv3) # Noncompliant
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v1/python/aws_cdk.aws_apigateway/DomainName.html">aws_cdk.aws_apigateway.DomainName</a>:</p>
<pre>
from aws_cdk.aws_apigateway import DomainName, SecurityPolicy
class ExampleStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        DomainName(self, "example",
            domain_name="example.com",
            certificate=certificate,
            security_policy=SecurityPolicy.TLS_1_0 # Noncompliant
        )
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/CfnDomain.html">aws_cdk.aws_opensearchservice.CfnDomain</a>:</p>
<pre>
from aws_cdk.aws_opensearchservice import CfnDomain, EngineVersion
class ExampleStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        CfnDomain(self, "example",
            version=EngineVersion.OPENSEARCH_1_3
        ) # Noncompliant: enables TLS 1.0 which is a deprecated version of the protocol
</pre>
<h2>Compliant Solution</h2>
<pre>
from OpenSSL import SSL

context = SSL.Context(SSL.TLS_SERVER_METHOD)
context.set_min_proto_version(SSL.TLS1_3_VERSION)
</pre>
<pre>
import ssl

context = ssl.SSLContext(ssl.PROTOCOL_TLS_SERVER)
context.minimum_version = ssl.TLSVersion.TLSv1_3
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v1/python/aws_cdk.aws_apigateway/DomainName.html">aws_cdk.aws_apigateway.DomainName</a>:</p>
<pre>
from aws_cdk.aws_apigateway import DomainName, SecurityPolicy
class ExampleStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        DomainName(self, "example",
            domain_name="example.com",
            certificate=certificate,
            security_policy=SecurityPolicy.TLS_1_2
        )
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_opensearchservice/CfnDomain.html">aws_cdk.aws_opensearchservice.CfnDomain</a>:</p>
<pre>
from aws_cdk.aws_opensearchservice import CfnDomain, EngineVersion
class ExampleStack(Stack):
    def __init__(self, scope: Construct, construct_id: str, **kwargs) -&gt; None:
        super().__init__(scope, construct_id, **kwargs)
        CfnDomain(self, "example",
            version=EngineVersion.OPENSEARCH_1_3
            domain_endpoint_options=CfnDomain.DomainEndpointOptionsProperty(
                tls_security_policy="Policy-Min-TLS-1-2-2019-07"
            )
        )
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
  <li> <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-custom-domain-tls-version.html">Amazon API Gateway</a> -
  Choosing a minimum TLS version </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S4426">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4426">
              python:S4426
            </a>
          </td>
          <td>
            <details>
              <p>When generating cryptographic keys (or key pairs), it is important to use strong parameters. Key length, for instance, should provide enough
entropy against brute-force attacks.</p>
<ul>
  <li> For <code>RSA</code> and <code>DSA</code> algorithms key size should be at least 2048 bits long </li>
  <li> For <code>ECC</code> (elliptic curve cryptography) algorithms key size should be at least 224 bits long </li>
  <li> For <code>RSA</code> public key exponent should be at least 65537. </li>
</ul>
<p>This rule raises an issue when a <code>RSA</code>, <code>DSA</code> or <code>ECC</code> key-pair generator is initialized using weak
parameters.</p>
<p>It supports the following libraries:</p>
<ul>
  <li> <a href="https://github.com/pyca/cryptography">cryptography</a> </li>
  <li> <a href="https://github.com/dlitz/pycrypto">PyCrypto</a> </li>
  <li> <a href="https://github.com/Legrandin/pycryptodome">Cryptodome</a> </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
from cryptography.hazmat.primitives.asymmetric import rsa, ec, dsa

dsa.generate_private_key(key_size=1024, backend=backend) # Noncompliant
rsa.generate_private_key(public_exponent=999, key_size=2048, backend=backend) # Noncompliant
ec.generate_private_key(curve=ec.SECT163R2, backend=backend)  # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
from cryptography.hazmat.primitives.asymmetric import rsa, ec, dsa

dsa.generate_private_key(key_size=2048, backend=backend) # Compliant
rsa.generate_private_key(public_exponent=65537, key_size=2048, backend=backend) # Compliant
ec.generate_private_key(curve=ec.SECT409R1, backend=backend) # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://www.ssi.gouv.fr/uploads/2014/11/RGS_v-2-0_B1.pdf">ANSSI RGSv2</a> - Référentiel Général de Sécurité version 2 </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">NIST FIPS 186-4</a> - Digital Signature Standard (DSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="python:S4433">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4433">
              python:S4433
            </a>
          </td>
          <td>
            <details>
              <p>An LDAP client authenticates to an LDAP server with a "bind request" which provides, among other, a <a
href="https://ldapwiki.com/wiki/Simple%20Authentication">simple authentication method</a>.</p>
<p>Simple authentication in LDAP can be used with three different mechanisms:</p>
<ul>
  <li> <em>Anonymous Authentication Mechanism</em> by performing a bind request with a username and password value of zero length. </li>
  <li> <em>Unauthenticated Authentication Mechanism</em> by performing a bind request with a password value of zero length. </li>
  <li> <em>Name/Password Authentication Mechanism</em> by performing a bind request with a password value of non-zero length. </li>
</ul>
<p>Anonymous binds and unauthenticated binds allow access to information in the LDAP directory without providing a password, their use is therefore
strongly discouraged.</p>
<h2>Noncompliant Code Example</h2>
<pre>
import ldap

def init_ldap():
   connect = ldap.initialize('ldap://example:1389')

   connect.simple_bind('cn=root') # Noncompliant
   connect.simple_bind_s('cn=root') # Noncompliant
   connect.bind_s('cn=root', None) # Noncompliant
   connect.bind('cn=root', None) # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
import ldap
import os

def init_ldap():
   connect = ldap.initialize('ldap://example:1389')

   connect.simple_bind('cn=root', os.environ.get('LDAP_PASSWORD')) # Compliant
   connect.simple_bind_s('cn=root', os.environ.get('LDAP_PASSWORD')) # Compliant
   connect.bind_s('cn=root', os.environ.get('LDAP_PASSWORD')) # Compliant
   connect.bind('cn=root', os.environ.get('LDAP_PASSWORD')) # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/521">MITRE, CWE-521</a> - Weak Password Requirements </li>
  <li> <a href="https://ldapwiki.com/wiki/Simple%20Authentication">ldapwiki.com</a>- Simple Authentication </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S5527">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5527">
              python:S5527
            </a>
          </td>
          <td>
            <details>
              <p>To establish a SSL/TLS connection not vulnerable to man-in-the-middle attacks, it’s essential to make sure the server presents the right
certificate.</p>
<p>The certificate’s hostname-specific data should match the server hostname.</p>
<p>It’s not recommended to re-invent the wheel by implementing custom hostname verification.</p>
<p>TLS/SSL libraries provide built-in hostname verification functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<p>Python <a href="https://docs.python.org/3/library/ssl.html">ssl standard</a> library:</p>
<pre>
import ssl

ctx = ssl._create_unverified_context() # Noncompliant: by default hostname verification is not done
ctx = ssl._create_stdlib_context() # Noncompliant: by default hostname verification is not done

ctx = ssl.create_default_context()
ctx.check_hostname = False # Noncompliant

ctx = ssl._create_default_https_context()
ctx.check_hostname = False # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>Python <a href="https://docs.python.org/3/library/ssl.html">ssl standard</a> library:</p>
<pre>
import ssl

ctx = ssl._create_unverified_context()
ctx.check_hostname = True # Compliant

ctx = ssl._create_stdlib_context()
ctx.check_hostname = True # Compliant

ctx = ssl.create_default_context() # Compliant: by default hostname verification is enabled
ctx = ssl._create_default_https_context() # Compliant: by default hostname verification is enabled
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/297">MITRE, CWE-297</a> - Improper Validation of Certificate with Host Mismatch </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="python:S6317">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6317">
              python:S6317
            </a>
          </td>
          <td>
            <details>
              <p>AWS Identity and Access Management (IAM) is the service that defines access to AWS resources. One of the core components of IAM is the policy
which, when attached to an identity or a resource, defines its permissions. Policies granting permission to an Identity (a User, a Group or Role) are
called identity-based policies. They add the ability to an identity to perform a predefined set of actions on a list of resources.</p>
<p>Here is an example of a policy document defining a limited set of permission that grants a user the ability to manage his own access keys.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "arn:aws:iam::245500951992:user/${aws:username}",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Privilege escalation generally happens when an identity policy gives an identity the ability to grant more privileges than the ones it already has.
Here is another example of a policy document that hides a privilege escalation. It allows an identity to generate a new access key for any user from
the account, including users with high privileges.</p>
<pre>
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Action": [
                "iam:CreateAccessKey",
                "iam:DeleteAccessKey",
                "iam:ListAccessKeys",
                "iam:UpdateAccessKey"
            ],
            "Resource": "*",
            "Effect": "Allow",
            "Sid": "AllowManageOwnAccessKeys"
        }
    ]
}
</pre>
<p>Although it looks like it grants a limited set of permissions, this policy would, in practice, give the highest privileges to the identity it’s
attached to.</p>
<p>Privilege escalation is a serious issue as it allows a malicious user to easily escalate to a high privilege identity from a low privilege identity
it took control of.</p>
<p>The example above is just one of many permission escalation vectors. Here is the list of vectors that the rule can detect:</p>
<table>
  <colgroup>
    <col style="width: 50%;">
    <col style="width: 50%;">
  </colgroup>
  <thead>
    <tr>
      <th>Vector name</th>
      <th>Summary</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><p>Create Policy Version</p></td>
      <td><p>Create a new IAM policy and set it as default</p></td>
    </tr>
    <tr>
      <td><p>Set Default Policy Version</p></td>
      <td><p>Set a different IAM policy version as default</p></td>
    </tr>
    <tr>
      <td><p>Create AccessKey</p></td>
      <td><p>Create a new access key for any user</p></td>
    </tr>
    <tr>
      <td><p>Create Login Profile</p></td>
      <td><p>Create a login profile with a password chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Update Login Profile</p></td>
      <td><p>Update the existing password with one chosen by the attacker</p></td>
    </tr>
    <tr>
      <td><p>Attach User Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Group Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a group containing a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Attach Role Policy</p></td>
      <td><p>Attach a permissive IAM policy like "AdministratorAccess" to a role that can be assumed by the user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put User Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a user the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Group Policy</p></td>
      <td><p>Alter the existing inline IAM policy from a group containing a user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Put Role Policy</p></td>
      <td><p>Alter an existing inline IAM role policy. The rule will then be assumed by the user that the attacker controls</p></td>
    </tr>
    <tr>
      <td><p>Add User to Group</p></td>
      <td><p>Add a user that the attacker controls to a group that has a larger range of permissions</p></td>
    </tr>
    <tr>
      <td><p>Update Assume Role Policy</p></td>
      <td><p>Update a role’s "AssumeRolePolicyDocument" to allow a user the attacker controls to assume it</p></td>
    </tr>
    <tr>
      <td><p>EC2</p></td>
      <td><p>Create an EC2 instance that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Invoke</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and invoke it</p></td>
    </tr>
    <tr>
      <td><p>Lambda Create and Add Permission</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and grant permission to invoke it to a user or a service</p></td>
    </tr>
    <tr>
      <td><p>Lambda triggered with an external event</p></td>
      <td><p>Create a Lambda function that will execute with high privileges and link it to an external event</p></td>
    </tr>
    <tr>
      <td><p>Update Lambda code</p></td>
      <td><p>Update the code of a Lambda function executing with high privileges</p></td>
    </tr>
    <tr>
      <td><p>CloudFormation</p></td>
      <td><p>Create a CloudFormation stack that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Data Pipeline</p></td>
      <td><p>Create a Pipeline that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Glue Development Endpoint</p></td>
      <td><p>Create a Glue Development Endpoint that will execute with high privileges</p></td>
    </tr>
    <tr>
      <td><p>Update Glue Dev Endpoint</p></td>
      <td><p>Update the associated SSH key for the Glue endpoint</p></td>
    </tr>
  </tbody>
</table>
<p>The general recommendation to protect against privilege escalation is to restrict the resources to which sensitive permissions are granted. The
first example above is a good demonstration of sensitive permissions being used with a narrow scope of resources and where no privilege escalation is
possible.</p>
<h2>Noncompliant Code Example</h2>
<p>The following policy allows an attacker to update the code of any Lambda function. An attacker can achieve privilege escalation by altering the
code of a Lambda that executes with high privileges.</p>
<pre>
from aws_cdk.aws_iam import Effect, PolicyDocument, PolicyStatement

PolicyDocument(
    statements=[
        PolicyStatement(
            effect=Effect.ALLOW,
            actions=["lambda:UpdateFunctionCode"],
            resources=["*"]  # Noncompliant
        )
    ]
)
</pre>
<h2>Compliant Solution</h2>
<p>Narrow the policy such that only updates to the code of certain Lambda functions are allowed.</p>
<pre>
from aws_cdk.aws_iam import Effect, PolicyDocument, PolicyStatement

PolicyDocument(
    statements=[
        PolicyStatement(
            effect=Effect.ALLOW,
            actions=["lambda:UpdateFunctionCode"],
            resources=[
                "arn:aws:lambda:us-east-2:123456789012:function:my-function:1"
            ]
        )
    ]
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://rhinosecuritylabs.com/aws/aws-privilege-escalation-methods-mitigation/">Rhino Security Labs</a> - AWS IAM Privilege Escalation
  – Methods and Mitigation </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-269</a> - Improper Privilege Management </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="python:S2755">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2755">
              python:S2755
            </a>
          </td>
          <td>
            <details>
              <p>XML standard allows the use of entities, declared in the DOCTYPE of the document, which can be <a
href="https://www.w3.org/TR/xml/#sec-internal-ent">internal</a> or <a href="https://www.w3.org/TR/xml/#sec-external-ent">external</a>.</p>
<p>When parsing the XML file, the content of the external entities is retrieved from an external storage such as the file system or network, which may
lead, if no restrictions are put in place, to arbitrary file disclosures or <a
href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">server-side request forgery (SSRF)</a> vulnerabilities.</p>
<p>It’s recommended to limit resolution of external entities by using one of these solutions:</p>
<ul>
  <li> If DOCTYPE is not necessary, completely disable all DOCTYPE declarations. </li>
  <li> If external entities are not necessary, completely disable their declarations. </li>
  <li> If external entities are necessary then:
    <ul>
      <li> Use XML processor features, if available, to authorize only required protocols (eg: https). </li>
      <li> And use an entity resolver (and optionally an XML Catalog) to resolve only trusted entities. </li>
    </ul>  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://lxml.de/">lxml</a> module:</p>
<ul>
  <li> When parsing XML: </li>
</ul>
<pre>
parser = etree.XMLParser() # Noncompliant: by default resolve_entities is set to true
tree1 = etree.parse('ressources/xxe.xml', parser)
root1 = tree1.getroot()

parser = etree.XMLParser(resolve_entities=True) # Noncompliant
tree1 = etree.parse('ressources/xxe.xml', parser)
root1 = tree1.getroot()
</pre>
<ul>
  <li> When validating XML: </li>
</ul>
<pre>
parser = etree.XMLParser(resolve_entities=True) # Noncompliant
treexsd = etree.parse('ressources/xxe.xsd', parser)
rootxsd = treexsd.getroot()
schema = etree.XMLSchema(rootxsd)
</pre>
<ul>
  <li> When transforming XML: </li>
</ul>
<pre>
ac = etree.XSLTAccessControl(read_network=True, write_network=False)  # Noncompliant, read_network is set to true/network access is authorized
transform = etree.XSLT(rootxsl, access_control=ac)
</pre>
<p><a href="https://docs.python.org/3/library/xml.sax.html">xml.sax</a> module:</p>
<pre>
parser = xml.sax.make_parser()
myHandler = MyHandler()
parser.setContentHandler(myHandler)

parser.setFeature(feature_external_ges, True) # Noncompliant
parser.parse("ressources/xxe.xml")
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://lxml.de/">lxml</a> module:</p>
<ul>
  <li> When parsing XML, disable <code>resolve_entities</code> and <em>network access</em>: </li>
</ul>
<pre>
parser = etree.XMLParser(resolve_entities=False, no_network=True) # Compliant
tree1 = etree.parse('ressources/xxe.xml', parser)
root1 = tree1.getroot()
</pre>
<ul>
  <li> When validating XML (note that network access <a href="https://bugs.launchpad.net/lxml/+bug/1234114">cannot be completely disabled</a> when
  calling XMLSchema): </li>
</ul>
<pre>
parser = etree.XMLParser(resolve_entities=False) # Compliant: by default no_network is set to true
treexsd = etree.parse('ressources/xxe.xsd', parser)
rootxsd = treexsd.getroot()
schema = etree.XMLSchema(rootxsd) # Compliant
</pre>
<ul>
  <li> When transforming XML, disable access to network and file system: </li>
</ul>
<pre>
parser = etree.XMLParser(resolve_entities=False) # Compliant
treexsl = etree.parse('ressources/xxe.xsl', parser)
rootxsl = treexsl.getroot()

ac = etree.XSLTAccessControl.DENY_ALL  # Compliant
transform = etree.XSLT(rootxsl, access_control=ac) # Compliant
</pre>
<p>To prevent xxe attacks with <a href="https://docs.python.org/3/library/xml.sax.html">xml.sax</a> module (for <a
href="https://docs.python.org/3/library/xml.html#xml-vulnerabilities">other security reasons</a> than XXE, xml.sax is not recommended):</p>
<pre>
parser = xml.sax.make_parser()
myHandler = MyHandler()
parser.setContentHandler(myHandler)
parser.parse("ressources/xxe.xml") # Compliant: in version 3.7.1: The SAX parser no longer processes general external entities by default

parser.setFeature(feature_external_ges, False) # Compliant
parser.parse("ressources/xxe.xml")
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html">OWASP XXE Prevention Cheat Sheet</a>
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/611">MITRE, CWE-611</a> - Information Exposure Through XML External Entity Reference </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/827">MITRE, CWE-827</a> - Improper Control of Document Type Definition </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S5439">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5439">
              python:S5439
            </a>
          </td>
          <td>
            <details>
              <p>Template engines have an HTML autoescape mechanism that protects web applications against most common cross-site-scripting (XSS)
vulnerabilities.</p>
<p>By default, it automatically replaces HTML special characters in any template variables. This secure by design configuration should not be globally
disabled.</p>
<p>Escaping HTML from template variables prevents switching into any execution context, like <code>&lt;script&gt;</code>. Disabling autoescaping
forces developers to manually escape each template variable for the application to be safe. A more pragmatic approach is to escape by default and to
manually disable escaping when needed.</p>
<p>A successful exploitation of a cross-site-scripting vulnerability by an attacker allow him to execute malicious JavaScript code in a user’s web
browser. The most severe XSS attacks involve:</p>
<ul>
  <li> Forced redirection </li>
  <li> Modify presentation of content </li>
  <li> User accounts takeover after disclosure of sensitive information like session cookies or passwords </li>
</ul>
<p>This rule supports the following libraries:</p>
<ul>
  <li> <a href="https://github.com/django/django">Django Templates</a> </li>
  <li> <a href="https://github.com/pallets/jinja">Jinja2</a> </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
from jinja2 import Environment

env = Environment() # Noncompliant; New Jinja2 Environment has autoescape set to false
env = Environment(autoescape=False) # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
from jinja2 import Environment
env = Environment(autoescape=True) # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md">OWASP Cheat
  Sheet</a> - XSS Prevention Cheat Sheet </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/80">MITRE, CWE-80</a> - Improper Neutralization of Script-Related HTML Tags in a Web Page
  (Basic XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/81">MITRE, CWE-81</a> - Improper Neutralization of Script in an Error Message Web Page </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/82">MITRE, CWE-82</a> - Improper Neutralization of Script in Attributes of IMG Tags in a Web
  Page </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/83">MITRE, CWE-83</a> - Improper Neutralization of Script in Attributes in a Web Page </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/84">MITRE, CWE-84</a> - Improper Neutralization of Encoded URI Schemes in a Web Page </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/85">MITRE, CWE-85</a> - Doubled Character XSS Manipulations </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/86">MITRE, CWE-86</a> - Improper Neutralization of Invalid Characters in Identifiers in Web
  Pages </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/87">MITRE, CWE-87</a> - Improper Neutralization of Alternate XSS Syntax </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=python%3AS5247'>S5247</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="python:S5445">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S5445">
              python:S5445
            </a>
          </td>
          <td>
            <details>
              <p>Creating temporary files using insecure methods exposes the application to race conditions on filenames: a malicious user can try to create a file
with a predictable name before the application does. A successful attack can result in other files being accessed, modified, corrupted or deleted.
This risk is even higher if the application run with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-1858">CVE-2014-1858</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-1932">CVE-2014-1932</a> </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
import tempfile

filename = tempfile.mktemp() # Noncompliant
tmp_file = open(filename, "w+")
</pre>
<h2>Compliant Solution</h2>
<pre>
import tempfile

tmp_file1 = tempfile.NamedTemporaryFile(delete=False) # Compliant; Easy replacement to tempfile.mktemp()
tmp_file2 = tempfile.NamedTemporaryFile() # Compliant; Created file will be automatically deleted
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> -
  Using Components with Known Vulnerabilities </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
  <li> <a href="https://docs.python.org/3/library/tempfile.html#deprecated-functions-and-variables">Python tempfile module</a> </li>
  <li> <a href="https://docs.python.org/2.7/library/os.html">Python 2.7 os module</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="python:S2053">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S2053">
              python:S2053
            </a>
          </td>
          <td>
            <details>
              <p>In cryptography, a "salt" is an extra piece of data which is included when hashing a password. This makes <code>rainbow-table attacks</code> more
difficult. Using a cryptographic hash function without an unpredictable salt increases the likelihood that an attacker could successfully find the
hash value in databases of precomputed hashes (called <code>rainbow-tables</code>).</p>
<p>This rule raises an issue when a hashing function which has been specifically designed for hashing passwords, such as <code>PBKDF2</code>, is used
with a non-random, reused or too short salt value. It does not raise an issue on base hashing algorithms such as <code>sha1</code> or <code>md5</code>
as they should not be used to hash passwords.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use hashing functions generating their own secure salt or generate a secure random value of at least 16 bytes. </li>
  <li> The salt should be unique by user password. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p>hashlib</p>
<pre>
import crypt
from hashlib import pbkdf2_hmac

hash = pbkdf2_hmac('sha256', password, b'D8VxSmTZt2E2YV454mkqAY5e', 100000)    # Noncompliant: salt is hardcoded
</pre>
<p>crypt</p>
<pre>
hash = crypt.crypt(password)         # Noncompliant: salt is not provided
</pre>
<h2>Compliant Solution</h2>
<p>hashlib</p>
<pre>
import crypt
from hashlib import pbkdf2_hmac

salt = os.urandom(32)
hash = pbkdf2_hmac('sha256', password, salt, 100000)    # Compliant
</pre>
<p>crypt</p>
<pre>
salt = crypt.mksalt(crypt.METHOD_SHA256)
hash = crypt.crypt(password, salt)         # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/759">MITRE, CWE-759</a> - Use of a One-Way Hash without a Salt </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/760">MITRE, CWE-760</a> - Use of a One-Way Hash with a Predictable Salt </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="python:S4830">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S4830">
              python:S4830
            </a>
          </td>
          <td>
            <details>
              <p>Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.</p>
<p>The certificate chain validation includes these steps:</p>
<ul>
  <li> The certificate is issued by its parent Certificate Authority or the root CA trusted by the system. </li>
  <li> Each CA is allowed to issue certificates. </li>
  <li> Each certificate in the chain is not expired. </li>
</ul>
<p>It’s not recommended to reinvent the wheel by implementing custom certificate chain validation.</p>
<p>TLS libraries provide built-in certificate validation functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://github.com/psf/requests">psf/requests</a> library:</p>
<pre>
import requests

requests.request('GET', 'https://example.domain', verify=False) # Noncompliant
requests.get('https://example.domain', verify=False) # Noncompliant
</pre>
<p>Python <a href="https://docs.python.org/3/library/ssl.html">ssl standard</a> library:</p>
<pre>
import ssl

ctx1 = ssl._create_unverified_context() # Noncompliant: by default certificate validation is not done
ctx2 = ssl._create_stdlib_context() # Noncompliant: by default certificate validation is not done

ctx3 = ssl.create_default_context()
ctx3.verify_mode = ssl.CERT_NONE # Noncompliant
</pre>
<p><a href="https://github.com/pyca/pyopenssl">pyca/pyopenssl</a> library:</p>
<pre>
from OpenSSL import SSL

ctx1 = SSL.Context(SSL.TLSv1_2_METHOD) # Noncompliant: by default certificate validation is not done

ctx2 = SSL.Context(SSL.TLSv1_2_METHOD)
ctx2.set_verify(SSL.VERIFY_NONE, verify_callback) # Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://github.com/psf/requests">psf/requests</a> library:</p>
<pre>
import requests

requests.request('GET', 'https://example.domain', verify=True)
requests.request('GET', 'https://example.domain', verify='/path/to/CAbundle')
requests.get(url='https://example.domain') # by default certificate validation is enabled
</pre>
<p>Python <a href="https://docs.python.org/3/library/ssl.html">ssl standard</a> library:</p>
<pre>
import ssl

ctx = ssl.create_default_context()
ctx.verify_mode = ssl.CERT_REQUIRED

ctx = ssl._create_default_https_context() # by default certificate validation is enabled
</pre>
<p><a href="https://github.com/pyca/pyopenssl">pyca/pyopenssl</a> library:</p>
<pre>
from OpenSSL import SSL

ctx = SSL.Context(SSL.TLSv1_2_METHOD)
ctx.set_verify(SSL.VERIFY_PEER, verify_callback) # Compliant
ctx.set_verify(SSL.VERIFY_PEER | SSL.VERIFY_FAIL_IF_NO_PEER_CERT, verify_callback) # Compliant
ctx.set_verify(SSL.VERIFY_PEER | SSL.VERIFY_FAIL_IF_NO_PEER_CERT | SSL.VERIFY_CLIENT_ONCE, verify_callback) # Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="python:S6321">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=python:S6321">
              python:S6321
            </a>
          </td>
          <td>
            <details>
              <p>Cloud platforms such as AWS, Azure, or GCP support virtual firewalls that can be used to restrict access to services by controlling inbound and
outbound traffic.<br> Any firewall rule allowing traffic from all IP addresses to standard network ports on which administration services
traditionally listen, such as 22 for SSH, can expose these services to exploits and unauthorized access.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>It’s recommended to restrict access to remote administration services to only trusted IP addresses. In practice, trusted IP addresses are those
held by system administrators or those of <a href="https://aws.amazon.com/quickstart/architecture/linux-bastion/?nc1=h_ls">bastion-like</a>
servers.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/Instance.html">aws_cdk.aws_ec2.Instance</a> and other constructs that
support a <code>connections</code> attribute:</p>
<pre>
from aws_cdk import aws_ec2 as ec2

instance = ec2.Instance(
    self,
    "my_instance",
    instance_type=nano_t2,
    machine_image=ec2.MachineImage.latest_amazon_linux(),
    vpc=vpc
)

instance.connections.allow_from(
    ec2.Peer.any_ipv4(), # Noncompliant
    ec2.Port.tcp(22),
    description="Allows SSH from all IPv4"
)
instance.connections.allow_from_any_ipv4( # Noncompliant
    ec2.Port.tcp(3389),
    description="Allows Terminal Server from all IPv4"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/SecurityGroup.html">aws_cdk.aws_ec2.SecurityGroup</a></p>
<pre>
from aws_cdk import aws_ec2 as ec2
security_group = ec2.SecurityGroup(
    self,
    "custom-security-group",
    vpc=vpc
)

security_group.add_ingress_rule(
    ec2.Peer.any_ipv4(), # Noncompliant
    ec2.Port.tcp_range(1, 1024)
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnSecurityGroup.html">aws_cdk.aws_ec2.CfnSecurityGroup</a></p>
<pre>
from aws_cdk import aws_ec2 as ec2

ec2.CfnSecurityGroup(
    self,
    "cfn-based-security-group",
    group_description="cfn based security group",
    group_name="cfn-based-security-group",
    vpc_id=vpc.vpc_id,
    security_group_ingress=[
        ec2.CfnSecurityGroup.IngressProperty( # Noncompliant
            ip_protocol="6",
            cidr_ip="0.0.0.0/0",
            from_port=22,
            to_port=22
        ),
        ec2.CfnSecurityGroup.IngressProperty( # Noncompliant
            ip_protocol="tcp",
            cidr_ip="0.0.0.0/0",
            from_port=3389,
            to_port=3389
        ),
        { # Noncompliant
            "ipProtocol":"-1",
            "cidrIpv6":"::/0"
        }
    ]
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnSecurityGroupIngress.html">aws_cdk.aws_ec2.CfnSecurityGroupIngress</a></p>
<pre>
from aws_cdk import aws_ec2 as ec2

ec2.CfnSecurityGroupIngress( # Noncompliant
    self,
    "ingress-all-ip-tcp-ssh",
    ip_protocol="tcp",
    cidr_ip="0.0.0.0/0",
    from_port=22,
    to_port=22,
    group_id=security_group.attr_group_id
)

ec2.CfnSecurityGroupIngress( # Noncompliant
    self,
    "ingress-all-ipv6-all-tcp",
    ip_protocol="-1",
    cidr_ipv6="::/0",
    group_id=security_group.attr_group_id
)
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/Instance.html">aws_cdk.aws_ec2.Instance</a> and other constructs that
support a <code>connections</code> attribute:</p>
<pre>
from aws_cdk import aws_ec2 as ec2

instance = ec2.Instance(
    self,
    "my_instance",
    instance_type=nano_t2,
    machine_image=ec2.MachineImage.latest_amazon_linux(),
    vpc=vpc
)

instance.connections.allow_from_any_ipv4(
    ec2.Port.tcp(1234),
    description="Allows 1234 from all IPv4"
)

instance.connections.allow_from(
    ec2.Peer.ipv4("192.0.2.0/24"),
    ec2.Port.tcp(22),
    description="Allows SSH from all IPv4"
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/SecurityGroup.html">aws_cdk.aws_ec2.SecurityGroup</a></p>
<pre>
from aws_cdk import aws_ec2 as ec2
security_group = ec2.SecurityGroup(
    self,
    "custom-security-group",
    vpc=vpc
)

security_group.add_ingress_rule(
    ec2.Peer.any_ipv4(),
    ec2.Port.tcp_range(1024, 1048)
)
</pre>
<p>For <a href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnSecurityGroup.html">aws_cdk.aws_ec2.CfnSecurityGroup</a></p>
<pre>
from aws_cdk import aws_ec2 as ec2

ec2.CfnSecurityGroup(
    self,
    "cfn-based-security-group",
    group_description="cfn based security group",
    group_name="cfn-based-security-group",
    vpc_id=vpc.vpc_id,
    security_group_ingress=[
        ec2.CfnSecurityGroup.IngressProperty(
            ip_protocol="tcp",
            cidr_ip="0.0.0.0/0",
            from_port=1024,
            to_port=1048
        ),
        {
            "ipProtocol":"6",
            "cidrIp":"192.0.2.0/24",
            "fromPort":22,
            "toPort":22
        }
    ]
)
</pre>
<p>For <a
href="https://docs.aws.amazon.com/cdk/api/v2/python/aws_cdk.aws_ec2/CfnSecurityGroupIngress.html">aws_cdk.aws_ec2.CfnSecurityGroupIngress</a></p>
<pre>
from aws_cdk import aws_ec2 as ec2

ec2.CfnSecurityGroupIngress(
    self,
    "ingress-all-ipv4-tcp-http",
    ip_protocol="6",
    cidr_ip="0.0.0.0/0",
    from_port=80,
    to_port=80,
    group_id=security_group.attr_group_id
)

ec2.CfnSecurityGroupIngress(
    self,
    "ingress-range-tcp-rdp",
    ip_protocol="tcp",
    cidr_ip="192.0.2.0/24",
    from_port=3389,
    to_port=3389,
    group_id=security_group.attr_group_id
)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/284">MITRE, CWE-284</a> - Improper Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html">AWS Documentation</a> - Security groups for your VPC </li>
  <li> <a href="https://docs.microsoft.com/en-us/azure/virtual-network/network-security-groups-overview">Azure Documentation</a> - Network security
  groups </li>
  <li> <a href="https://cloud.google.com/vpc/docs/using-firewalls">GCP Documentation</a> - Firewalls </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S2228">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2228">
              csharpsquid:S2228
            </a>
          </td>
          <td>
            <details>
              <p>Debug statements are always useful during development. But include them in production code - particularly in code that runs client-side - and you
run the risk of inadvertently exposing sensitive information.</p>
<h2>Noncompliant Code Example</h2>
<pre>
private void DoSomething()
{
    // ...
    Console.WriteLine("so far, so good..."); // Noncompliant
    // ...
}
</pre>
<h2>Exceptions</h2>
<p>The following are ignored by this rule:</p>
<ul>
  <li> Console Applications </li>
  <li> Calls in methods decorated with <code>[Conditional ("DEBUG")]</code> </li>
  <li> Calls included in DEBUG preprocessor branches (<code>#if DEBUG</code>) </li>
</ul>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=csharpsquid%3AS106'>S106</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S2115">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2115">
              csharpsquid:S2115
            </a>
          </td>
          <td>
            <details>
              <p>When relying on the password authentication mode for the database connection, a secure password should be chosen.</p>
<p>This rule raises an issue when an empty password is used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
{
  optionsBuilder.UseSqlServer("Server=myServerAddress;Database=myDataBase;User Id=myUsername;Password="); // Noncompliant
}
</pre>
<p>In <a href="https://docs.microsoft.com/en-us/troubleshoot/aspnet/create-web-config">Web.config</a></p>
<pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="myConnection" connectionString="Server=myServerAddress;Database=myDataBase;User Id=myUsername;Password=" /&gt; &lt;!-- Noncompliant --&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
protected override void OnConfiguring(DbContextOptionsBuilder optionsBuilder)
{
  optionsBuilder.UseSqlServer("Server=myServerAddress;Database=myDataBase;Integrated Security=True");
}
</pre>
<p>In <a href="https://docs.microsoft.com/en-us/troubleshoot/aspnet/create-web-config">Web.config</a></p>
<pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="myConnection" connectionString="Server=myServerAddress;Database=myDataBase;Integrated Security=True" /&gt;
  &lt;/connectionStrings&gt;
&lt;/configuration&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication.html">OWASP Top 10 2017 Category A2</a> - Broken
  Authentication </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/521">MITRE, CWE-521</a> - Weak Password Requirements </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S3329">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S3329">
              csharpsquid:S3329
            </a>
          </td>
          <td>
            <details>
              <p>When encrypting data with the Cipher Block Chaining (CBC) mode an Initialization Vector (IV) is used to randomize the encryption, ie under a given
key the same plaintext doesn’t always produce the same ciphertext. The IV doesn’t need to be secret but should be unpredictable to avoid
"Chosen-Plaintext Attack".</p>
<p>To generate Initialization Vectors, NIST recommends to use a secure random number generator.</p>
<h2>Noncompliant Code Example</h2>
<pre>
public void Encrypt(byte[] key, byte[] data, MemoryStream target)
{
    byte[] initializationVector = new byte[] { 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16 };

    using var aes = new AesCryptoServiceProvider();
    var encryptor = aes.CreateEncryptor(key, initializationVector); // Noncompliant, hardcoded value is used

    using var cryptoStream = new CryptoStream(target, encryptor, CryptoStreamMode.Write);
    cryptoStream.Write(data);
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public byte[] Encrypt(byte[] key, byte[] data, MemoryStream target)
{
    using var aes = new AesCryptoServiceProvider();
    var encryptor = aes.CreateEncryptor(key, aes.IV); // aes.IV is automatically generated to random secure value

    using var cryptoStream = new CryptoStream(target, encryptor, CryptoStreamMode.Write);
    cryptoStream.Write(data);

    return aes.IV;
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure
  </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/329">MITRE, CWE-329</a> - Not Using an Unpredictable IV with CBC Mode </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST, SP-800-38A</a> - Recommendation for Block Cipher
  Modes of Operation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S5773">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5773">
              csharpsquid:S5773
            </a>
          </td>
          <td>
            <details>
              <p>During the deserialization process, the state of an object will be reconstructed from the serialized data stream which can contain dangerous
operations.</p>
<p>For example, a well-known attack vector consists in serializing an object of type <code><a
href="https://docs.microsoft.com/en-us/dotnet/api/system.codedom.compiler.tempfilecollection.-ctor?view=netframework-4.8#System_CodeDom_Compiler_TempFileCollection__ctor">TempFileCollection</a></code>
with arbitrary files (defined by an attacker) which will be deleted on the application deserializing this object (when the <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.codedom.compiler.tempfilecollection.finalize?view=netframework-4.8">finalize() </a>method of
the TempFileCollection object is called). This kind of types are called "<a href="https://github.com/pwntester/ysoserial.net">gadgets</a>".</p>
<p>Instead of using <code>BinaryFormatter</code> and similar serializers, it is recommended to use safer alternatives in most of the cases, such as <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.xml.serialization.xmlserializer?view=net-5.0">XmlSerializer</a> or <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.datacontractserializer?view=net-5.0">DataContractSerializer</a>. If
it’s not possible then try to mitigate the risk by restricting the types allowed to be deserialized:</p>
<ul>
  <li> by implementing an "allow-list" of types, but keep in mind that novel dangerous types are regularly discovered and this protection could be
  insufficient over time. </li>
  <li> or/and implementing a tamper protection, such as <a href="https://en.wikipedia.org/wiki/HMAC">message authentication codes</a> (MAC). This way
  only objects serialized with the correct MAC hash will be deserialized. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p>For <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter?view=netframework-4.8">BinaryFormatter</a>,
<a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.netdatacontractserializer?view=netframework-4.8">NetDataContractSerializer</a>,
<a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter?view=netframework-4.8">SoapFormatter</a>
serializers:</p>
<pre>
var myBinaryFormatter = new BinaryFormatter();
myBinaryFormatter.Deserialize(stream); // Noncompliant: a binder is not used to limit types during deserialization
</pre>
<p><a
href="https://docs.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer?view=netframework-4.8">JavaScriptSerializer</a>
should not use SimpleTypeResolver or other weak resolvers:</p>
<pre>
JavaScriptSerializer serializer1 = new JavaScriptSerializer(new SimpleTypeResolver()); // Noncompliant: SimpleTypeResolver is unsecure (every types is resolved)
serializer1.Deserialize&lt;ExpectedType&gt;(json);
</pre>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.losformatter?view=netframework-4.8">LosFormatter</a> should not be used without
MAC verification:</p>
<pre>
LosFormatter formatter = new LosFormatter(); // Noncompliant
formatter.Deserialize(fs);
</pre>
<h2>Compliant Solution</h2>
<p><a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.binary.binaryformatter?view=netframework-4.8">BinaryFormatter</a>,
<a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.netdatacontractserializer?view=netframework-4.8">NetDataContractSerializer
</a>, <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.runtime.serialization.formatters.soap.soapformatter?view=netframework-4.8">SoapFormatter</a>
serializers should use a binder implementing a whitelist approach to limit types during deserialization (at least one exception should be thrown or a
null value returned):</p>
<pre>
sealed class CustomBinder : SerializationBinder
{
   public override Type BindToType(string assemblyName, string typeName)
   {
       if (!(typeName == "type1" || typeName == "type2" || typeName == "type3"))
       {
          throw new SerializationException("Only type1, type2 and type3 are allowed"); // Compliant
       }
       return Assembly.Load(assemblyName).GetType(typeName);
   }
}

var myBinaryFormatter = new BinaryFormatter();
myBinaryFormatter.Binder = new CustomBinder();
myBinaryFormatter.Deserialize(stream);
</pre>
<p><a
href="https://docs.microsoft.com/en-us/dotnet/api/system.web.script.serialization.javascriptserializer?view=netframework-4.8">JavaScriptSerializer</a>
should use a resolver implementing a whitelist to limit types during deserialization (at least one exception should be thrown or a null value
returned):</p>
<pre>
public class CustomSafeTypeResolver : JavaScriptTypeResolver
{
   public override Type ResolveType(string id)
   {
      if(id != "ExpectedType") {
         throw new ArgumentNullException("Only ExpectedType is allowed during deserialization"); // Compliant
      }
      return Type.GetType(id);
   }
}

JavaScriptSerializer serializer = new JavaScriptSerializer(new CustomSafeTypeResolver()); // Compliant
serializer.Deserialize&lt;ExpectedType&gt;(json);
</pre>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.ui.losformatter?view=netframework-4.8">LosFormatter</a> serializer with MAC
verification:</p>
<pre>
LosFormatter formatter = new LosFormatter(true, secret); // Compliant
formatter.Deserialize(fs);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://docs.microsoft.com/en-us/dotnet/standard/serialization/binaryformatter-security-guide?s=03">docs.microsoft.com</a> -
  BinaryFormatter security guide </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization">OWASP Top 10 2017 Category A8</a> - Insecure
  Deserialization </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/134">MITRE, CWE-134</a> - Use of Externally-Controlled Format String </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/502">MITRE, CWE-502</a> - Deserialization of Untrusted Data </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat2">SANS Top 25</a> - Risky Resource Management </li>
  <li> <a href="https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Deserialization_Cheat_Sheet.md">OWASP Deserialization Cheat
  Sheet</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4564">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4564">
              csharpsquid:S4564
            </a>
          </td>
          <td>
            <details>
              <p>ASP.Net has a feature to validate HTTP requests to prevent potentially dangerous content to perform a cross-site scripting (XSS) attack. There is
no reason to disable this mechanism even if other checks to prevent XXS attacks are in place.</p>
<p>This rule raises an issue if a method with parameters is marked with <code>System.Web.Mvc.HttpPostAttribute</code> and not
<code>System.Web.Mvc.ValidateInputAttribute(true)</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
public class FooBarController : Controller
{
    [HttpPost] // Noncompliant
    [ValidateInput(false)]
    public ActionResult Purchase(string input)
    {
        return Foo(input);
    }

    [HttpPost] // Noncompliant
    public ActionResult PurchaseSomethingElse(string input)
    {
        return Foo(input);
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public class FooBarController : Controller
{
    [HttpPost]
    [ValidateInput(true)] // Compliant
    public ActionResult Purchase(string input)
    {
        return Foo(input);
    }
}
</pre>
<h2>Exceptions</h2>
<p>Parameterless methods marked with <code>System.Web.Mvc.HttpPostAttribute</code> will not trigger this issue.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A7_2017-Cross-Site_Scripting_(XSS)">OWASP Top 10 2017 Category A7</a> - Cross-Site
  Scripting (XSS) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/79">MITRE, CWE-79</a> - Improper Neutralization of Input During Web Page Generation
  ('Cross-site Scripting') </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components </li>
  <li> <a href="https://www.owasp.org/index.php/ASP.NET_Request_Validation">OWASP ASP.NET Request Validation</a> </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=csharpsquid%3AS5753'>S5753</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5659">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5659">
              csharpsquid:S5659
            </a>
          </td>
          <td>
            <details>
              <p>If a JSON Web Token (JWT) is not signed with a strong cipher algorithm (or not signed at all) an attacker can forge it and impersonate user
identities.</p>
<ul>
  <li> Don’t use <code>none</code> algorithm to sign or verify the validity of a token. </li>
  <li> Don’t use a token without verifying its signature before. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://github.com/jwt-dotnet/jwt">jwt-dotnet</a> library:</p>
<pre>
var decodedtoken1 = decoder.Decode(token, secret, verify: false); // Noncompliant: signature should be verified

var decodedtoken2 = new JwtBuilder()
   .WithSecret(secret)
   .Decode(forgedtoken1); // Noncompliant: signature should be verified
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://github.com/jwt-dotnet/jwt">jwt-dotnet</a> library:</p>
<pre>
var decodedtoken1 = decoder.Decode(forgedtoken1, secret, verify: true); // Compliant

var decodedtoken2 = new JwtBuilder()
   .WithSecret(secret)
   .MustVerifySignature()
   .Decode(token); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/347">MITRE, CWE-347</a> - Improper Verification of Cryptographic Signature </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5547">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5547">
              csharpsquid:S5547
            </a>
          </td>
          <td>
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Strong_cryptography">Strong cipher algorithms</a> are cryptographic systems resistant to cryptanalysis, they
are not vulnerable to well-known attacks like brute force attacks for example.</p>
<p>A general recommendation is to only use cipher algorithms intensively tested and promoted by the cryptographic community.</p>
<p>More specifically for block cipher, it’s not recommended to use algorithm with a block size inferior than 128 bits.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography?view=netcore-3.1">System.Security.Cryptography</a> library,
these old cryptographic algorithms should no longer be used for any reason:</p>
<pre>
var tripleDES1 = new TripleDESCryptoServiceProvider(); // Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack

var simpleDES = new DESCryptoServiceProvider(); // Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search

var RC2 = new RC2CryptoServiceProvider(); // Noncompliant: RC2 is vulnerable to a related-key attack
</pre>
<p>For Bouncycastle library, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-1000339">AESFastEngine has a side channel leak</a>, it
is possible to gain information about the key used to initialize the cipher:</p>
<pre>
AesFastEngine aesFast = new AesFastEngine(); // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography?view=netcore-3.1">System.Security.Cryptography</a> library,
it’s recommended to use <code>AesCryptoServiceProvider</code>:</p>
<pre>
var AES = new AesCryptoServiceProvider(); // Compliant
</pre>
<p>For Bouncycastle library, it’s recommended to use <code>AESEngine</code>:</p>
<pre>
var AES = new AESEngine(); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4211">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4211">
              csharpsquid:S4211
            </a>
          </td>
          <td>
            <details>
              <p>Transparency attributes, <code>SecurityCriticalAttribute</code> and <code>SecuritySafeCriticalAttribute</code> are used to identify code that
performs security-critical operations. The second one indicates that it is safe to call this code from transparent, while the first one does not.
Since the transparency attributes of code elements with larger scope take precedence over transparency attributes of code elements that are contained
in the first element a class, for instance, with a <code>SecurityCriticalAttribute</code> can not contain a method with a
<code>SecuritySafeCriticalAttribute</code>.</p>
<p>This rule raises an issue when a member is marked with a <code>System.Security</code> security attribute that has a different transparency than the
security attribute of a container of the member.</p>
<h2>Noncompliant Code Example</h2>
<pre>
using System;
using System.Security;

namespace MyLibrary
{

    [SecurityCritical]
    public class Foo
    {
        [SecuritySafeCritical] // Noncompliant
        public void Bar()
        {
        }
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
using System;
using System.Security;

namespace MyLibrary
{

    [SecurityCritical]
    public class Foo
    {
        public void Bar()
        {
        }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S5542">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5542">
              csharpsquid:S5542
            </a>
          </td>
          <td>
            <details>
              <p>Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity.</p>
<ul>
  <li> For block cipher encryption algorithms (like AES):
    <ul>
      <li> The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block
      always gets encrypted to the same ciphertext block. This mode should never be used. </li>
      <li> The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to <a
      href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a> when used with padding. Using CBC along with Message
      Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s
      recommended to avoid CBC with padding completely. </li>
      <li> The GCM (Galois Counter Mode) mode which <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode#Mathematical_basis">works
      internally</a> with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality.
      Other similar modes are CCM, CWC, EAX, IAPM and OCB. </li>
    </ul>  </li>
  <li> For RSA encryption algorithm, the recommended padding scheme is OAEP. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p><a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.aesmanaged?view=netframework-4.8">AesManaged</a> object with
insecure mode:</p>
<pre>
AesManaged aes4 = new AesManaged
{
  KeySize = 128,
  BlockSize = 128,
  Mode = CipherMode.ECB, // Noncompliant
  Padding = PaddingMode.PKCS7
};
</pre>
<p><a
href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rsacryptoserviceprovider?view=netframework-4.8">RSACryptoServiceProvider</a>
object without OAEP padding:</p>
<pre>
RSACryptoServiceProvider RSA1 = new RSACryptoServiceProvider();
encryptedData = RSA1.Encrypt(dataToEncrypt, false); // Noncompliant: OAEP Padding is not used (second parameter set to false)
</pre>
<h2>Compliant Solution</h2>
<p>AES with GCM mode with <a href="https://www.bouncycastle.org/">bouncycastle</a> library:</p>
<pre>
GcmBlockCipher blockCipher = new GcmBlockCipher(new AesEngine()); // Compliant
blockCipher.Init(true, new AeadParameters(new KeyParameter(secretKey), 128, iv, null));
</pre>
<p>AES with GCM mode with <a href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.aesgcm?view=netcore-3.0">AesGcm</a>
object:</p>
<pre>
var aesGcm = new AesGcm(key); // Compliant
</pre>
<p>RSA with OAEP padding with <a
href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rsacryptoserviceprovider?view=netframework-4.8">RSACryptoServiceProvider</a>
object:</p>
<pre>
RSACryptoServiceProvider RSA2 = new RSACryptoServiceProvider();
encryptedData = RSA2.Encrypt(dataToEncrypt, true); // Compliant: OAEP Padding is used (second parameter set to true)
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S4212">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4212">
              csharpsquid:S4212
            </a>
          </td>
          <td>
            <details>
              <p>Because serialization constructors allocate and initialize objects, security checks that are present on regular constructors must also be present
on a serialization constructor. Failure to do so would allow callers that could not otherwise create an instance to use the serialization constructor
to do this.</p>
<p>This rule raises an issue when a type implements the <code>System.Runtime.Serialization.ISerializable</code> interface, is not a delegate or
interface, is declared in an assembly that allows partially trusted callers and has a constructor that takes a
<code>System.Runtime.Serialization.SerializationInfo</code> object and a <code>System.Runtime.Serialization.StreamingContext</code> object which is
not secured by a security check, but one or more of the regular constructors in the type is secured.</p>
<h2>Noncompliant Code Example</h2>
<pre>
using System;
using System.IO;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters.Binary;
using System.Security;
using System.Security.Permissions;

[assembly: AllowPartiallyTrustedCallersAttribute()]
namespace MyLibrary
{
    [Serializable]
    public class Foo : ISerializable
    {
        private int n;

        [FileIOPermissionAttribute(SecurityAction.Demand, Unrestricted = true)]
        public Foo()
        {
           n = -1;
        }

        protected Foo(SerializationInfo info, StreamingContext context) // Noncompliant
        {
           n = (int)info.GetValue("n", typeof(int));
        }

        void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)
        {
           info.AddValue("n", n);
        }
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
using System;
using System.IO;
using System.Runtime.Serialization;
using System.Runtime.Serialization.Formatters.Binary;
using System.Security;
using System.Security.Permissions;

[assembly: AllowPartiallyTrustedCallersAttribute()]
namespace MyLibrary
{
    [Serializable]
    public class Foo : ISerializable
    {
        private int n;

        [FileIOPermissionAttribute(SecurityAction.Demand, Unrestricted = true)]
        public Foo()
        {
           n = -1;
        }

        [FileIOPermissionAttribute(SecurityAction.Demand, Unrestricted = true)]
        protected Foo(SerializationInfo info, StreamingContext context)
        {
           n = (int)info.GetValue("n", typeof(int));
        }

        void ISerializable.GetObjectData(SerializationInfo info, StreamingContext context)
        {
           info.AddValue("n", n);
        }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization">OWASP Top 10 2017 Category A8</a> - Insecure
  Deserialization </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4423">
              csharpsquid:S4423
            </a>
          </td>
          <td>
            <details>
              <p>Older versions of SSL/TLS protocol like "SSLv3" have been proven to be insecure.</p>
<p>This rule raises an issue when an SSL/TLS is configured at application level with an insecure version (ie: a protocol different from "TLSv1.2" or
"TLSv1.3").</p>
<p>No issue is raised when the choice of the SSL/TLS version relies on the OS configuration. Be aware that the latest version of <a
href="https://docs.microsoft.com/en-us/windows/win32/secauthn/protocols-in-tls-ssl--schannel-ssp-">Windows 10 and Windows Server 2016 have TLSv1.0 and
TLSv1.1 enabled by default</a>. Administrators can configure the OS to enforce TLSv1.2 minumum by <a
href="https://docs.microsoft.com/en-us/windows-server/security/tls/tls-registry-settings">updateing registry settings</a> or by applying a group
policy.</p>
<h2>Noncompliant Code Example</h2>
<pre>
ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls; // Noncompliant; legacy version TLSv1 is enabled
</pre>
<p>For <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient">System.Net.Http.HttpClient</a></p>
<pre>
new HttpClientHandler
{
    SslProtocols = SslProtocols.Tls // Noncompliant; legacy version TLSv1 is enabled
};
</pre>
<h2>Compliant Solution</h2>
<pre>
ServicePointManager.SecurityProtocol = SecurityProtocolType.SystemDefault; // Compliant; choice of the SSL/TLS versions rely on the OS configuration
ServicePointManager.SecurityProtocol = SecurityProtocolType.Tls12 | SecurityProtocolType.Tls13; // Compliant
</pre>
<p>For <a href="https://docs.microsoft.com/en-us/dotnet/api/system.net.http.httpclient">System.Net.Http.HttpClient</a></p>
<pre>
new HttpClientHandler
{
    SslProtocols = SslProtocols.Tls12 // Compliant
};

new HttpClientHandler
{
    SslProtocols = SslProtocols.None // Compliant; choice of the TLS versions rely on the OS configuration
};
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
  <li> <a href="https://docs.microsoft.com/en-us/dotnet/framework/network-programming/tls">Transport Layer Security (TLS) best practices with the .NET
  Framework</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S4426">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4426">
              csharpsquid:S4426
            </a>
          </td>
          <td>
            <details>
              <p>Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks.</p>
<p><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST recommendations</a> will be checked for these
use-cases:</p>
<p><strong>Digital Signature Generation</strong> and <strong>Verification:</strong></p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DSA (<code>p</code> is key length and <code>q</code> the modulus length) </li>
  <li> n ≥ 2048 for RSA (<code>n</code> is the key length) </li>
</ul>
<p><strong>Key Agreement</strong>:</p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DH and MQV </li>
  <li> n ≥ 224 for ECDH and ECMQV (Examples: <code>secp192r1</code> is a non-compliant curve (<code>n</code> &lt; 224) but <code>secp224k1</code> is
  compliant (<code>n</code> &gt;= 224)) </li>
</ul>
<p><strong>Symmetric keys</strong>:</p>
<ul>
  <li> key length ≥ 128 bits </li>
</ul>
<p>This rule will not raise issues for ciphers that are considered weak (no matter the key size) like <code>DES</code>, <code>Blowfish</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
using System;
using System.Security.Cryptography;

namespace MyLibrary
{
    public class MyCryptoClass
    {
        static void Main()
        {
            var dsa1 = new DSACryptoServiceProvider(); // Noncompliant - default key size is 1024
            dsa1.KeySize = 2048; // Noncompliant - the setter does not update the underlying key size for the DSACryptoServiceProvider class

            var dsa2 = new DSACryptoServiceProvider(2048); // Noncompliant - cannot create DSACryptoServiceProvider with a key size bigger than 1024

            var rsa1 = new RSACryptoServiceProvider(); // Noncompliant - default key size is 1024
            rsa1.KeySize = 2048; // Noncompliant - the setter does not update the underlying key size for the RSACryptoServiceProvider class

            var rsa2 = new RSACng(1024); // Noncompliant

            // ...
        }
    }
}
</pre>
<p>KeySize property of DSACryptoServiceProvider and RSACryptoServiceProvider does not change the value of underlying KeySize for the algorithm.
Property setter is ignored without error and KeySize can be changed only by using constructor overload. See:</p>
<ul>
  <li> <a
  href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.dsacryptoserviceprovider.keysize">DSACryptoServiceProvider.KeySize
  Property</a> </li>
  <li> <a
  href="https://docs.microsoft.com/en-us/dotnet/api/system.security.cryptography.rsacryptoserviceprovider.keysize">RSACryptoServiceProvider.KeySize
  Property</a> </li>
</ul>
<h2>Compliant Solution</h2>
<pre>
using System;
using System.Security.Cryptography;

namespace MyLibrary
{
    public class MyCryptoClass
    {
        static void Main()
        {
            var dsa1 = new DSACng(); // Compliant - default key size is 2048
            var dsa2 = new DSACng(2048); // Compliant
            var rsa1 = new RSACryptoServiceProvider(2048); // Compliant
            var rsa2 = new RSACng(); // Compliant - default key size is 2048

            // ...
        }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST 800-131A</a> - Recommendation for Transitioning the
  Use of Cryptographic Algorithms and Key Lengths </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S4433">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4433">
              csharpsquid:S4433
            </a>
          </td>
          <td>
            <details>
              <p>An LDAP client authenticates to an LDAP server with a "bind request" which provides, among other, a <a
href="https://ldapwiki.com/wiki/Simple%20Authentication">simple authentication method</a>.</p>
<p>Simple authentication in LDAP can be used with three different mechanisms:</p>
<ul>
  <li> <em>Anonymous Authentication Mechanism</em> by performing a bind request with a username and password value of zero length. </li>
  <li> <em>Unauthenticated Authentication Mechanism</em> by performing a bind request with a password value of zero length. </li>
  <li> <em>Name/Password Authentication Mechanism</em> by performing a bind request with a password value of non-zero length. </li>
</ul>
<p>Anonymous binds and unauthenticated binds allow access to information in the LDAP directory without providing a password, their use is therefore
strongly discouraged.</p>
<h2>Noncompliant Code Example</h2>
<p>This rule raises an issue when an LDAP connection is created with <code>AuthenticationTypes.Anonymous</code> or
<code>AuthenticationTypes.None</code>.</p>
<pre>
DirectoryEntry myDirectoryEntry = new DirectoryEntry(adPath);
myDirectoryEntry.AuthenticationType = AuthenticationTypes.None; // Noncompliant

DirectoryEntry myDirectoryEntry = new DirectoryEntry(adPath, "u", "p", AuthenticationTypes.None); // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
DirectoryEntry myDirectoryEntry = new DirectoryEntry(myADSPath); // Compliant; default DirectoryEntry.AuthenticationType property value is "Secure" since .NET Framework 2.0

DirectoryEntry myDirectoryEntry = new DirectoryEntry(myADSPath, "u", "p", AuthenticationTypes.Secure);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/521">MITRE, CWE-521</a> - Weak Password Requirements </li>
  <li> <a href="https://ldapwiki.com/wiki/Simple%20Authentication">ldapwiki.com</a>- Simple Authentication </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S2755">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2755">
              csharpsquid:S2755
            </a>
          </td>
          <td>
            <details>
              <p>XML standard allows the use of entities, declared in the DOCTYPE of the document, which can be <a
href="https://www.w3.org/TR/xml/#sec-internal-ent">internal</a> or <a href="https://www.w3.org/TR/xml/#sec-external-ent">external</a>.</p>
<p>When parsing the XML file, the content of the external entities is retrieved from an external storage such as the file system or network, which may
lead, if no restrictions are put in place, to arbitrary file disclosures or <a
href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">server-side request forgery (SSRF)</a> vulnerabilities.</p>
<p>It’s recommended to limit resolution of external entities by using one of these solutions:</p>
<ul>
  <li> If DOCTYPE is not necessary, completely disable all DOCTYPE declarations. </li>
  <li> If external entities are not necessary, completely disable their declarations. </li>
  <li> If external entities are necessary then:
    <ul>
      <li> Use XML processor features, if available, to authorize only required protocols (eg: https). </li>
      <li> And use an entity resolver (and optionally an XML Catalog) to resolve only trusted entities. </li>
    </ul>  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p>System.Xml.XmlDocument</p>
<pre>
// .NET Framework &lt; 4.5.2
XmlDocument parser = new XmlDocument(); // Noncompliant: XmlDocument is not safe by default
parser.LoadXml("xxe.xml");

or

// .NET Framework 4.5.2+
XmlDocument parser = new XmlDocument();
parser.XmlResolver = new XmlUrlResolver(); // Noncompliant: XmlDocument.XmlResolver configured with XmlUrlResolver that makes it unsafe
parser.LoadXml("xxe.xml");
</pre>
<p>System.Xml.XmlTextReader</p>
<pre>
// .NET Framework &lt; 4.5.2
XmlTextReader reader = new XmlTextReader("xxe.xml"); // Noncompliant: XmlTextReady is not safe by default
while (reader.Read())
{ ... }

or

// .NET Framework 4.5.2+
XmlTextReader reader = new XmlTextReader("xxe.xml");
reader.XmlResolver = new XmlUrlResolver(); // Noncompliant: XmlTextRead.XmlResolver configured with XmlUrlResolver that makes it unsafe
while (reader.Read())
{ ... }
</pre>
<p>System.Xml.XmlReader</p>
<pre>
// .NET Framework 4.5.2+
XmlReaderSettings settings = new XmlReaderSettings();
settings.DtdProcessing = DtdProcessing.Parse;
settings.XmlResolver = new XmlUrlResolver();
XmlReader reader = XmlReader.Create("xxe.xml", settings); // Noncompliant: XmlReader is safe by default and becomes unsafe if DtdProcessing = Parse and XmlResolver is not null
while (reader.Read())
{ ... }
</pre>
<p>System.Xml.XPath.XPathDocument</p>
<pre>
// prior to .NET 4.5.2
XPathDocument doc = new XPathDocument("example.xml"); // Noncompliant
XPathNavigator nav = doc.CreateNavigator();
string xml = nav.InnerXml.ToString();
</pre>
<h2>Compliant Solution</h2>
<p>System.Xml.XmlDocument</p>
<pre>
XmlDocument parser = new XmlDocument();
parser.XmlResolver = null; // Compliant: XmlResolver has been set to null
parser.LoadXml("xxe.xml");

or

XmlDocument parser = new XmlDocument(); // Compliant: XmlDocument is safe by default in  .NET Framework 4.5.2+ because XmlResolver is set by default to null
parser.LoadXml("xxe.xml");
</pre>
<p>System.Xml.XmlTextReader</p>
<pre>
// .NET 4.5.2+
XmlTextReader reader = new XmlTextReader("xxe.xml"); // Compliant: XmlTextReader is safe by default in  .NET Framework 4.5.2+ because XmlResolver is set by default to null
while (reader.Read())
{ ... }

// .NET 4.0 to .NET 4.5.1
XmlTextReader reader = new XmlTextReader("xxe.xml");
reader.DtdProcessing = DtdProcessing.Prohibit; // Compliant: XmlTextReader is safe by default in  .NET Framework 4.5.2+ because XmlResolver is set by default to null

// &lt; .NET 4.0
XmlTextReader reader = new XmlTextReader(stream);
reader.ProhibitDtd = true; // Compliant: default is false
</pre>
<p>System.Xml.XmlReader</p>
<pre>
XmlReader reader = XmlReader.Create("xxe.xml"); // Compliant: XmlReader is safe by default
while (reader.Read())
{ ... }
</pre>
<p>System.Xml.XPath.XPathDocument</p>
<pre>
// prior to .NET 4.5.2
XmlReader reader = XmlReader.Create("example.xml");
XPathDocument doc = new XPathDocument(reader); // Compliant: XPathDocument is safe when being given a safe XmlReader
XPathNavigator nav = doc.CreateNavigator();
string xml = nav.InnerXml.ToString();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#net">OWASP XXE Prevention Cheat
  Sheet</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/611">MITRE, CWE-611</a> - Information Exposure Through XML External Entity Reference </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/827">MITRE, CWE-827</a> - Improper Control of Document Type Definition </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="csharpsquid:S3884">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S3884">
              csharpsquid:S3884
            </a>
          </td>
          <td>
            <details>
              <p><code>CoSetProxyBlanket</code> and <code>CoInitializeSecurity</code> both work to set the permissions context in which the process invoked
immediately after is executed. Calling them from within that process is useless because it’s too late at that point; the permissions context has
already been set.</p>
<p>Specifically, these methods are meant to be called from non-managed code such as a C++ wrapper that then invokes the managed, i.e. C# or VB.NET,
code.</p>
<h2>Noncompliant Code Example</h2>
<pre>
[DllImport("ole32.dll")]
static extern int CoSetProxyBlanket([MarshalAs(UnmanagedType.IUnknown)]object pProxy, uint dwAuthnSvc, uint dwAuthzSvc,
	[MarshalAs(UnmanagedType.LPWStr)] string pServerPrincName, uint dwAuthnLevel, uint dwImpLevel, IntPtr pAuthInfo,
	uint dwCapabilities);

public enum RpcAuthnLevel
{
	Default = 0,
	None = 1,
	Connect = 2,
	Call = 3,
	Pkt = 4,
	PktIntegrity = 5,
	PktPrivacy = 6
}

public enum RpcImpLevel
{
	Default = 0,
	Anonymous = 1,
	Identify = 2,
	Impersonate = 3,
	Delegate = 4
}

public enum EoAuthnCap
{
	None = 0x00,
	MutualAuth = 0x01,
	StaticCloaking = 0x20,
	DynamicCloaking = 0x40,
	AnyAuthority = 0x80,
	MakeFullSIC = 0x100,
	Default = 0x800,
	SecureRefs = 0x02,
	AccessControl = 0x04,
	AppID = 0x08,
	Dynamic = 0x10,
	RequireFullSIC = 0x200,
	AutoImpersonate = 0x400,
	NoCustomMarshal = 0x2000,
	DisableAAA = 0x1000
}

[DllImport("ole32.dll")]
public static extern int CoInitializeSecurity(IntPtr pVoid, int cAuthSvc, IntPtr asAuthSvc, IntPtr pReserved1,
	RpcAuthnLevel level, RpcImpLevel impers, IntPtr pAuthList, EoAuthnCap dwCapabilities, IntPtr pReserved3);

static void Main(string[] args)
{
	var hres1 = CoSetProxyBlanket(null, 0, 0, null, 0, 0, IntPtr.Zero, 0); // Noncompliant

	var hres2 = CoInitializeSecurity(IntPtr.Zero, -1, IntPtr.Zero, IntPtr.Zero, RpcAuthnLevel.None,
		RpcImpLevel.Impersonate, IntPtr.Zero, EoAuthnCap.None, IntPtr.Zero); // Noncompliant
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/648">MITRE, CWE-648</a> - Incorrect Use of Privileged APIs </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S4830">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S4830">
              csharpsquid:S4830
            </a>
          </td>
          <td>
            <details>
              <p>Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.</p>
<p>The certificate chain validation includes these steps:</p>
<ul>
  <li> The certificate is issued by its parent Certificate Authority or the root CA trusted by the system. </li>
  <li> Each CA is allowed to issue certificates. </li>
  <li> Each certificate in the chain is not expired. </li>
</ul>
<p>It’s not recommended to reinvent the wheel by implementing custom certificate chain validation.</p>
<p>TLS libraries provide built-in certificate validation functions that should be used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
ServicePointManager.ServerCertificateValidationCallback +=
    (sender, certificate, chain, errors) =&gt; {
        return true; // Noncompliant: trust all certificates
    };
</pre>
<h2>Compliant Solution</h2>
<pre>
ServicePointManager.ServerCertificateValidationCallback +=
    (sender, certificate, chain, errors) =&gt;
    {
        if (development) return true; // for development, trust all certificates
        return errors == SslPolicyErrors.None
            &amp;&amp; validCerts.Contains(certificate.GetCertHashString()); // Compliant: trust only some certificates
    };
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x10-v5-network_communication_requirements">Mobile AppSec Verification
  Standard</a> - Network Communication Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m3-insecure-communication">OWASP Mobile Top 10 2016 Category M3</a> - Insecure
  Communication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="csharpsquid:S5445">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S5445">
              csharpsquid:S5445
            </a>
          </td>
          <td>
            <details>
              <p>Creating temporary files using insecure methods exposes the application to race conditions on filenames: a malicious user can try to create a file
with a predictable name before the application does. A successful attack can result in other files being accessed, modified, corrupted or deleted.
This risk is even higher if the application run with elevated permissions.</p>
<p>In the past, it has led to the following vulnerabilities:</p>
<ul>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-1858">CVE-2014-1858</a> </li>
  <li> <a href="https://nvd.nist.gov/vuln/detail/CVE-2014-1932">CVE-2014-1932</a> </li>
</ul>
<p><code>Path.GetTempFileName()</code>&nbsp;generates predictable file names and is inherently unreliable and insecure. Additionally, the&nbsp;method
will raise an&nbsp;<code>IOException</code> if it is used to create more than 65535 files without deleting previous temporary files.</p>
<h2>Recommended Secure Coding Practices</h2>
<p>Out of the box, .NET is missing secure-by-design APIs to create temporary files. To overcome this, one of the following options can be used:</p>
<ul>
  <li> Use a dedicated sub-folder with tightly controlled permissions </li>
  <li> Created temporary files in a publicly writable folder and make sure:
    <ul>
      <li> Generated filename is unpredictable </li>
      <li> File is readable and writable only by the creating user ID </li>
      <li> File descriptor is not inherited by child processes </li>
      <li> File is destroyed as soon as it is closed </li>
    </ul>  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
var tempPath = Path.GetTempFileName();  // Noncompliant

using (var writer = new StreamWriter(tempPath))
{
    writer.WriteLine("content");
}
</pre>
<h2>Compliant Solution</h2>
<pre>
var randomPath = Path.Combine(Path.GetTempPath(), Path.GetRandomFileName());

// Creates a new file with write, non inheritable permissions which is deleted on close.
using (var fileStream = new FileStream(randomPath, FileMode.CreateNew, FileAccess.Write, FileShare.None, 4096, FileOptions.DeleteOnClose))
using (var writer = new StreamWriter(fileStream))
{
    writer.WriteLine("content");
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> -
  Using Components with Known Vulnerabilities </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="csharpsquid:S2053">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=csharpsquid:S2053">
              csharpsquid:S2053
            </a>
          </td>
          <td>
            <details>
              <p>In cryptography, a "salt" is an extra piece of data which is included when hashing a password. This makes <code>rainbow-table attacks</code> more
difficult. Using a cryptographic hash function without an unpredictable salt increases the likelihood that an attacker could successfully find the
hash value in databases of precomputed hashes (called <code>rainbow-tables</code>).</p>
<p>This rule raises an issue when a hashing function which has been specifically designed for hashing passwords, such as <code>PBKDF2</code>, is used
with a non-random, reused or too short salt value. It does not raise an issue on base hashing algorithms such as <code>sha1</code> or <code>md5</code>
as they should not be used to hash passwords.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use hashing functions generating their own secure salt or generate a secure random value of at least 16 bytes. </li>
  <li> The salt should be unique by user password. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
public void Hash(string password)
{
    var salt = Encoding.UTF8.GetBytes("Hardcoded salt");
    var fromHardcoded = new Rfc2898DeriveBytes(password, salt);     // Noncompliant, salt is hardcoded

    salt = Encoding.UTF8.GetBytes(password);
    var fromPassword = new Rfc2898DeriveBytes(password, salt);     // Noncompliant, password should not be used as a salt as it makes it predictable

    var shortSalt = new byte[8];
    RandomNumberGenerator.Create().GetBytes(shortSalt);
    var fromShort = new Rfc2898DeriveBytes(password, shortSalt);   // Noncompliant, salt is too short (should be at least 16 bytes, not 8)
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public DeriveBytes Hash(string password)
{
    return new Rfc2898DeriveBytes(password, 16);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/759">MITRE, CWE-759</a> - Use of a One-Way Hash without a Salt </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/760">MITRE, CWE-760</a> - Use of a One-Way Hash with a Predictable Salt </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="xml:S3355">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S3355">
              xml:S3355
            </a>
          </td>
          <td>
            <details>
              <p>Every filter defined in <code>web.xml</code> file should be used in a <code>&lt;filter-mapping&gt;</code> element. Otherwise such filters are not
invoked.</p>
<h2>Noncompliant Code Example</h2>
<pre>
  &lt;filter&gt;
     &lt;filter-name&gt;DefinedNotUsed&lt;/filter-name&gt;
     &lt;filter-class&gt;com.myco.servlet.ValidationFilter&lt;/filter-class&gt;
  &lt;/filter&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
  &lt;filter&gt;
     &lt;filter-name&gt;ValidationFilter&lt;/filter-name&gt;
     &lt;filter-class&gt;com.myco.servlet.ValidationFilter&lt;/filter-class&gt;
  &lt;/filter&gt;

  &lt;filter-mapping&gt;
     &lt;filter-name&gt;ValidationFilter&lt;/filter-name&gt;
     &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="xml:S3374">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S3374">
              xml:S3374
            </a>
          </td>
          <td>
            <details>
              <p>According to the Common Weakness Enumeration,</p>
<blockquote>
  <p>If two validation forms have the same name, the Struts Validator arbitrarily chooses one of the forms to use for input validation and discards
  the other. This decision might not correspond to the programmer’s expectations…​</p>
</blockquote>
<p>In such a case, it is likely that the two forms should be combined. At the very least, one should be removed.</p>
<h2>Noncompliant Code Example</h2>
<pre>
&lt;form-validation&gt;
  &lt;formset&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;  &lt;!-- Noncompliant --&gt;
  &lt;/formset&gt;
&lt;/form-validation&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;form-validation&gt;
  &lt;formset&gt;
    &lt;form name="BookForm"&gt; ... &lt;/form&gt;
  &lt;/formset&gt;
&lt;/form-validation&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://cwe.mitre.org/data/definitions/102">MITRE, CWE-102</a> - Struts: Duplicate Validation Forms </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Improper_Data_Validation">OWASP, Improper Data Validation</a> - Struts: Duplicate
  Validation Forms </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="xml:S2647">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S2647">
              xml:S2647
            </a>
          </td>
          <td>
            <details>
              <p>Basic authentication’s only means of obfuscation is Base64 encoding. Since Base64 encoding is easily recognized and reversed, it offers only the
thinnest veil of protection to your users, and should not be used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
// in web.xml
&lt;web-app  ...&gt;
  &lt;!--  ...  --&gt;
  &lt;login-config&gt;
    &lt;auth-method&gt;BASIC&lt;/auth-method&gt;
  &lt;/login-config&gt;
&lt;/web-app&gt;
</pre>
<h2>Exceptions</h2>
<p>The rule will not raise any issue if HTTPS is enabled, on any URL-pattern.</p>
<pre>
&lt;web-app  ...&gt;
  &lt;!--  ...  --&gt;
  &lt;security-constraint&gt;
    &lt;web-resource-collection&gt;
      &lt;web-resource-name&gt;HTTPS enabled&lt;/web-resource-name&gt;
      &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;/web-resource-collection&gt;
    &lt;user-data-constraint&gt;
      &lt;transport-guarantee&gt;CONFIDENTIAL&lt;/transport-guarantee&gt;
    &lt;/user-data-constraint&gt;
  &lt;/security-constraint&gt;
&lt;/web-app&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Web_Service_Security_Cheat_Sheet.html#user-authentication">OWASP Web Service Security
  Cheat Sheet</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/522">MITRE, CWE-522</a> - Insufficiently Protected Credentials </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="xml:S5594">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S5594">
              xml:S5594
            </a>
          </td>
          <td>
            <details>
              <p>Once an Android component has been exported, it can be used by attackers to launch malicious actions and might also give access to other components
that are not exported.</p>
<p>As a result, sensitive user data can be stolen, and components can be launched unexpectedly.</p>
<p>For this reason, the following components should be protected:</p>
<ul>
  <li> Providers </li>
  <li> Activities </li>
  <li> Activity-aliases </li>
  <li> Services </li>
</ul>
<p>To do so, it is recommended to either set <code>exported</code> to <code>false</code>, add <code>android:readPermission</code> and
<code>android:writePermission</code> attributes, or add a <code>&lt;permission&gt;</code> tag.</p>
<p><strong>Warning</strong>: When targeting Android&nbsp;versions lower than 12, the presence of intent filters will cause <code>exported</code> to be
set to <code>true</code> by default.</p>
<p>If a component must be exported, use a <code>&lt;permission&gt;</code> tag and the <a
href="https://developer.android.com/guide/topics/manifest/permission-element#plevel">protection level</a> that matches your use case and data
confidentiality requirements.<br> For example, <a href="https://developer.android.com/training/sync-adapters">Sync adapters</a> should use a
<code>signature</code> protection level to remain both exported <strong>and</strong> protected.</p>
<h2>Noncompliant Code Example</h2>
<p>The following components are vulnerable because permissions are undefined or partially defined:</p>
<pre>
&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:exported="true"
  android:readPermission="com.example.app.READ_PERMISSION" /&gt;  &lt;!-- Noncompliant: write permission is not defined --&gt;
</pre>
<pre>
&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:exported="true"
  android:writePermission="com.example.app.WRITE_PERMISSION" /&gt;  &lt;!-- Noncompliant: read permission is not defined --&gt;
</pre>
<pre>
&lt;activity android:name="com.example.activity.Activity"&gt;  &lt;!-- Noncompliant: permissions are not defined --&gt;
  &lt;intent-filter&gt;
    &lt;action android:name="com.example.OPEN_UI"/&gt;
    &lt;category android:name="android.intent.category.DEFAULT"/&gt;
  &lt;/intent-filter&gt;
&lt;/activity&gt;
</pre>
<h2>Compliant Solution</h2>
<p>If the component’s capabilities or data are not intended to be shared with other apps, its <code>exported</code> attribute should be set to
<code>false</code>:</p>
<pre>
&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:exported="false" /&gt;
</pre>
<p>Otherwise, implement permissions:</p>
<pre>
&lt;provider
  android:authorities="com.example.app.Provider"
  android:name="com.example.app.Provider"
  android:exported="true"
  android:readPermission="com.example.app.READ_PERMISSION"
  android:writePermission="com.example.app.WRITE_PERMISSION" /&gt;

&lt;activity android:name="com.example.activity.Activity"
          android:permission="com.example.app.PERMISSION" &gt;
  &lt;intent-filter&gt;
    &lt;action android:name="com.example.OPEN_UI"/&gt;
    &lt;category android:name="android.intent.category.DEFAULT" /&gt;
  &lt;/intent-filter&gt;
&lt;/activity&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://developer.android.com/guide/topics/providers/content-provider-creating#Permissions">developer.android.com</a> - Implementing
  content provider permissions </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  platform usage </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/926">MITRE, CWE-926</a> - Improper Export of Android Application Components </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="xml:S6359">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S6359">
              xml:S6359
            </a>
          </td>
          <td>
            <details>
              <p>Defining a custom permission in the <code>android.permission</code> namespace may result in an unexpected permission assignment if a newer version
of Android adds a permission with the same name. It is recommended to use a namespace specific to the application for custom permissions.</p>
<h2>Noncompliant Code Example</h2>
<pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.organization.app"&gt;

    &lt;permission
        android:name="android.permission.MYPERMISSION" /&gt; &lt;!-- Noncompliant --&gt;

&lt;/manifest&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.organization.app"&gt;

    &lt;permission
        android:name="com.organization.app.permission.MYPERMISSION" /&gt;

&lt;/manifest&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x11-v6-interaction_with_the_environment">Mobile AppSec Verification
  Standard</a> - Platform Interaction Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m1-improper-platform-usage">OWASP Mobile Top 10 2016 Category M1</a> - Improper
  Platform Usage </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/265">MITRE, CWE-265</a> - Privilege Issues </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/732">MITRE, CWE-732</a> - Incorrect Permission Assignment for Critical Resource </li>
  <li> <a href="https://developer.android.com/guide/topics/permissions/defining">developer.android.com</a> - Define a Custom App Permission </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="xml:S3281">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=xml:S3281">
              xml:S3281
            </a>
          </td>
          <td>
            <details>
              <p>Default interceptors, such as application security interceptors, must be listed in the <code>ejb-jar.xml</code> file, or they will not be treated
as default.</p>
<p>This rule applies to projects that contain JEE Beans (any one of <code>javax.ejb.Singleton</code>, <code>MessageDriven</code>,
<code>Stateless</code> or <code>Stateful</code>).</p>
<h2>Noncompliant Code Example</h2>
<pre>
// file: ejb-interceptors.xml
&lt;assembly-descriptor&gt;
 &lt;interceptor-binding&gt; &lt;!-- should be declared in ejb-jar.xml --&gt;
      &lt;ejb-name&gt;*&lt;/ejb-name&gt;
      &lt;interceptor-class&gt;com.myco.ImportantInterceptor&lt;/interceptor-class&gt; &lt;!-- Noncompliant; will NOT be treated as default --&gt;
   &lt;/interceptor-binding&gt;
&lt;/assembly-descriptor&gt;
</pre>
<h2>Compliant Solution</h2>
<pre>
// file: ejb-jar.xml
&lt;assembly-descriptor&gt;
 &lt;interceptor-binding&gt;
      &lt;ejb-name&gt;*&lt;/ejb-name&gt;
      &lt;interceptor-class&gt;com.myco.ImportantInterceptor&lt;/interceptor-class&gt;
   &lt;/interceptor-binding&gt;
&lt;/assembly-descriptor&gt;
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="java:S2115">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2115">
              java:S2115
            </a>
          </td>
          <td>
            <details>
              <p>When relying on the password authentication mode for the database connection, a secure password should be chosen.</p>
<p>This rule raises an issue when an empty password is used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
Connection conn = DriverManager.getConnection("jdbc:derby:memory:myDB;create=true", "login", "");
</pre>
<h2>Compliant Solution</h2>
<pre>
String password = System.getProperty("database.password");
Connection conn = DriverManager.getConnection("jdbc:derby:memory:myDB;create=true", "login", password);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication.html">OWASP Top 10 2017 Category A2</a> - Broken
  Authentication </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/521">MITRE, CWE-521</a> - Weak Password Requirements </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S3329">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S3329">
              java:S3329
            </a>
          </td>
          <td>
            <details>
              <p>When encrypting data with the Cipher Block Chaining (CBC) mode an Initialization Vector (IV) is used to randomize the encryption, ie under a given
key the same plaintext doesn’t always produce the same ciphertext. The IV doesn’t need to be secret but should be unpredictable to avoid
"Chosen-Plaintext Attack".</p>
<p>To generate Initialization Vectors, NIST recommends to use a secure random number generator.</p>
<h2>Noncompliant Code Example</h2>
<pre>
public void encrypt(String key, String plainText) throws GeneralSecurityException {
    byte[] bytesIV = "7cVgr5cbdCZVw5WY".getBytes(StandardCharsets.UTF_8); // secondary

    GCMParameterSpec iv = new GCMParameterSpec(128,bytesIV);  // secondary
    SecretKeySpec skeySpec = new SecretKeySpec(key.getBytes(StandardCharsets.UTF_8), "AES");

    Cipher cipher = Cipher.getInstance("AES/CBC/NoPadding");
    cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv); // Noncompliant
  }
</pre>
<h2>Compliant Solution</h2>
<pre>
public void encrypt(String key, String plainText) throws GeneralSecurityException {
    SecureRandom random = new SecureRandom();
    byte[] bytesIV = new byte[16];
    random.nextBytes(bytesIV); // Random initialization vector

    GCMParameterSpec iv = new GCMParameterSpec(128, bytesIV);
    SecretKeySpec skeySpec = new SecretKeySpec(key.getBytes(StandardCharsets.UTF_8), "AES");

    Cipher cipher = Cipher.getInstance("AES/CBC/NoPadding");
    cipher.init(Cipher.ENCRYPT_MODE, skeySpec, iv);
  }
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure
  </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/329">MITRE, CWE-329</a> - Not Using an Unpredictable IV with CBC Mode </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST, SP-800-38A</a> - Recommendation for Block Cipher
  Modes of Operation </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#STATIC_IV">STATIC_IV</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S4684">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4684">
              java:S4684
            </a>
          </td>
          <td>
            <details>
              <p>On one side, Spring MVC automatically bind request parameters to beans declared as arguments of methods annotated with
<code>@RequestMapping</code>. Because of this automatic binding feature, it’s possible to feed some unexpected fields on the arguments of the
<code>@RequestMapping</code> annotated methods.</p>
<p>On the other end, persistent objects (<code>@Entity</code> or <code>@Document</code>) are linked to the underlying database and updated
automatically by a persistence framework, such as Hibernate, JPA or Spring Data MongoDB.</p>
<p>These two facts combined together can lead to malicious attack: if a persistent object is used as an argument of a method annotated with
<code>@RequestMapping</code>, it’s possible from a specially crafted user input, to change the content of unexpected fields into the database.</p>
<p>For this reason, using <code>@Entity</code> or <code>@Document</code> objects as arguments of methods annotated with <code>@RequestMapping</code>
should be avoided.</p>
<p>In addition to <code>@RequestMapping</code>, this rule also considers the annotations introduced in Spring Framework 4.3: <code>@GetMapping</code>,
<code>@PostMapping</code>, <code>@PutMapping</code>, <code>@DeleteMapping</code>, <code>@PatchMapping</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
import javax.persistence.Entity;

@Entity
public class Wish {
  Long productId;
  Long quantity;
  Client client;
}

@Entity
public class Client {
  String clientId;
  String name;
  String password;
}

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
public class WishListController {

  @PostMapping(path = "/saveForLater")
  public String saveForLater(Wish wish) {
    session.save(wish);
  }

  @RequestMapping(path = "/saveForLater", method = RequestMethod.POST)
  public String saveForLater(Wish wish) {
    session.save(wish);
  }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public class WishDTO {
  Long productId;
  Long quantity;
  Long clientId;
}

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;

@Controller
public class PurchaseOrderController {

  @PostMapping(path = "/saveForLater")
  public String saveForLater(WishDTO wish) {
    Wish persistentWish = new Wish();
    // do the mapping between "wish" and "persistentWish"
    [...]
    session.save(persistentWish);
  }

  @RequestMapping(path = "/saveForLater", method = RequestMethod.POST)
  public String saveForLater(WishDTO wish) {
    Wish persistentWish = new Wish();
    // do the mapping between "wish" and "persistentWish"
    [...]
    session.save(persistentWish);
  }
}
</pre>
<h2>Exceptions</h2>
<p>No issue is reported when the parameter is annotated with <code>@PathVariable</code> from Spring Framework, since the lookup will be done via id,
the object cannot be forged on client side.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/915">MITRE, CWE-915</a> - Improperly Controlled Modification of Dynamically-Determined Object
  Attributes </li>
  <li> <a href="https://o2platform.files.wordpress.com/2011/07/ounce_springframework_vulnerabilities.pdf">Two Security Vulnerabilities in the Spring
  Framework’s MVC by Ryan Berg and Dinis Cruz</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5659">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5659">
              java:S5659
            </a>
          </td>
          <td>
            <details>
              <p>If a JSON Web Token (JWT) is not signed with a strong cipher algorithm (or not signed at all) an attacker can forge it and impersonate user
identities.</p>
<ul>
  <li> Don’t use <code>none</code> algorithm to sign or verify the validity of a token. </li>
  <li> Don’t use a token without verifying its signature before. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p>Using <a href="https://github.com/jwtk/jjwt">jwtk/Java JWT</a> library (to verify a signed token (containing a JWS) don’t use the
<code>parse</code> method as it doesn’t throw an exception if an unsigned token is provided):</p>
<pre>
// Signing:
io.jsonwebtoken.Jwts.builder() // Noncompliant, token is not signed.
  .setSubject(USER_LOGIN)
  .compact();
// Verifying:
io.jsonwebtoken.Jwts.parser().setSigningKey(SECRET_KEY).parse(token).getBody(); // Noncompliant
</pre>
<p>Using <a href="https://github.com/auth0/java-jwt">auth0/Java JWT</a> library:</p>
<pre>
// Signing:
com.auth0.jwt.JWT.create()
  .withSubject(SUBJECT)
  .sign(Algorithm.none()); // Noncompliant, use only strong cipher algorithms when signing this JWT.
// Verifying:
JWTVerifier nonCompliantVerifier = com.auth0.jwt.JWT.require(Algorithm.none()) // Noncompliant
  .withSubject(LOGIN)
  .build();
</pre>
<h2>Compliant Solution</h2>
<p>Using <a href="https://github.com/jwtk/jjwt">Java JWT</a> library (to verify a signed token (containing a JWS) use the <code>parseClaimsJws</code>
method that will throw an exception if an unsigned token is provided):</p>
<pre>
// Signing:
Jwts.builder() // Compliant
  .setSubject(USER_LOGIN)
  .signWith(SignatureAlgorithm.HS256, SECRET_KEY)
  .compact();
// Verifying:
Jwts.parser().setSigningKey(SECRET_KEY).parseClaimsJws(token).getBody(); // Compliant
</pre>
<p>Using <a href="https://github.com/auth0/java-jwt">auth0/Java JWT</a> library. I</p>
<pre>
// Signing:
JWT.create()
  .withSubject(SUBJECT)
  .sign(Algorithm.HMAC256(SECRET_KEY)); // Compliant
// Verifying:
JWTVerifier nonCompliantVerifier = JWT.require(Algorithm.HMAC256(SECRET_KEY)) // Compliant
  .withSubject(LOGIN)
  .build();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/347">MITRE, CWE-347</a> - Improper Verification of Cryptographic Signature </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5547">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5547">
              java:S5547
            </a>
          </td>
          <td>
            <details>
              <p><a href="https://en.wikipedia.org/wiki/Strong_cryptography">Strong cipher algorithms</a> are cryptographic systems resistant to cryptanalysis, they
are not vulnerable to well-known attacks like brute force attacks for example.</p>
<p>A general recommendation is to only use cipher algorithms intensively tested and promoted by the cryptographic community.</p>
<p>More specifically for block cipher, it’s not recommended to use algorithm with a block size inferior than 128 bits.</p>
<h2>Noncompliant Code Example</h2>
<pre>
import javax.crypto.Cipher;
import java.security.NoSuchAlgorithmException;
import javax.crypto.NoSuchPaddingException;

public class test {

    public static void main(String[] args) {
      try
      {
        Cipher c1 = Cipher.getInstance("DES"); // Noncompliant: DES works with 56-bit keys allow attacks via exhaustive search
        Cipher c7 = Cipher.getInstance("DESede"); // Noncompliant: Triple DES is vulnerable to meet-in-the-middle attack
        Cipher c13 = Cipher.getInstance("RC2"); // Noncompliant: RC2 is vulnerable to a related-key attack
        Cipher c19 = Cipher.getInstance("RC4"); // Noncompliant: vulnerable to several attacks (see https://en.wikipedia.org/wiki/RC4#Security)
        Cipher c25 = Cipher.getInstance("Blowfish"); // Noncompliant: Blowfish use a 64-bit block size makes it vulnerable to birthday attacks

        NullCipher nc = new NullCipher(); // Noncompliant: the NullCipher class provides an "identity cipher" one that does not transform or encrypt the plaintext in any way.
      }
      catch(NoSuchAlgorithmException|NoSuchPaddingException e)
      {
      }
    }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import javax.crypto.Cipher;
import java.security.NoSuchAlgorithmException;
import javax.crypto.NoSuchPaddingException;

public class test {

    public static void main(String[] args) {
      try
      {
        Cipher c31 = Cipher.getInstance("AES/GCM/NoPadding"); // Compliant
      }
      catch(NoSuchAlgorithmException|NoSuchPaddingException e)
      {
      }
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/hDdGBQ">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5542">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5542">
              java:S5542
            </a>
          </td>
          <td>
            <details>
              <p>Encryption algorithms should use secure modes and padding schemes where appropriate to guarantee data confidentiality and integrity.</p>
<ul>
  <li> For block cipher encryption algorithms (like AES):
    <ul>
      <li> The ECB (Electronic Codebook) cipher mode doesn’t provide serious message confidentiality: under a given key any given plaintext block
      always gets encrypted to the same ciphertext block. This mode should never be used. </li>
      <li> The CBC (Cipher Block Chaining) mode by itself provides only data confidentiality. This cipher mode is also vulnerable to <a
      href="https://en.wikipedia.org/wiki/Padding_oracle_attack">padding oracle attacks</a> when used with padding. Using CBC along with Message
      Authentication Code can provide data integrity and should prevent such attacks. In practice the implementation has many pitfalls and it’s
      recommended to avoid CBC with padding completely. </li>
      <li> The GCM (Galois Counter Mode) mode which <a href="https://en.wikipedia.org/wiki/Galois/Counter_Mode#Mathematical_basis">works
      internally</a> with zero/no padding scheme, is recommended, as it is designed to provide both data authenticity (integrity) and confidentiality.
      Other similar modes are CCM, CWC, EAX, IAPM and OCB. </li>
    </ul>  </li>
  <li> For RSA encryption algorithm, the recommended padding scheme is OAEP. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
Cipher.getInstance("AES"); // Noncompliant: by default ECB mode is chosen
Cipher.getInstance("AES/ECB/NoPadding"); // Noncompliant: ECB doesn't provide serious message confidentiality

Cipher.getInstance("AES/CBC/PKCS5Padding"); // Noncompliant: Vulnerable to Padding Oracle attacks

Cipher.getInstance("RSA/None/NoPadding"); // Noncompliant: RSA without OAEP padding scheme is not recommended
</pre>
<h2>Compliant Solution</h2>
<pre>
Cipher.getInstance("AES/GCM/NoPadding");

Cipher.getInstance("RSA/None/OAEPWITHSHA-256ANDMGF1PADDING");
// or the ECB mode can be used for RSA when "None" is not available with the security provider used - in that case, ECB will be treated as "None" for RSA.
Cipher.getInstance("RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING");
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-327</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/hDdGBQ">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5301">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5301">
              java:S5301
            </a>
          </td>
          <td>
            <details>
              <p>ActiveMQ can send/receive JMS Object messages (named ObjectMessage in ActiveMQ context) to comply with JMS specification. Internally, ActiveMQ
relies on Java serialization mechanism for marshaling/unmarshalling of the message payload. Deserialization based on data supplied by the user could
lead to remote code execution attacks, where the structure of the serialized data is changed to modify the behavior of the object being
unserialized.</p>
<p>To limit the risk to be victim of such attack, ActiveMQ 5.12.2+ enforces developers to explicitly whitelist packages that can be exchanged using
ObjectMessages.</p>
<h2>Noncompliant Code Example</h2>
<pre>
ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("tcp://localhost:61616");
factory.setTrustAllPackages(true); // Noncompliant

ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("tcp://localhost:61616");
// no call to factory.setTrustedPackages(...);
</pre>
<h2>Compliant Solution</h2>
<pre>
ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory("tcp://localhost:61616");
factory.setTrustedPackages(Arrays.asList("org.mypackage1", "org.mypackage2"));
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A08_2021-Software_and_Data_Integrity_Failures/">OWASP Top 10 2021 Category A8</a> - Software and Data
  Integrity Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A8_2017-Insecure_Deserialization">OWASP Top 10 2017 Category A8</a> - Insecure
  Deserialization </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/502">MITRE, CWE-502</a> - Deserialization of Untrusted Data </li>
  <li> <a href="https://activemq.apache.org/objectmessage.html">ActiveMQ ObjectMessage Security Advisory</a> </li>
  <li> <a href="https://activemq.apache.org/security-advisories.data/CVE-2015-5254-announcement.txt">CVE-2015-5254</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5876">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5876">
              java:S5876
            </a>
          </td>
          <td>
            <details>
              <p>Session fixation attacks occur when an attacker can force a legitimate user to use a session ID that he knows. To avoid fixation attacks, it’s a
good practice to generate a new session each time a user authenticates and delete/invalidate the existing session (the one possibly known by the
attacker).</p>
<h2>Noncompliant Code Example</h2>
<p>In a Spring Security’s context, session fixation protection is enabled by default but can be disabled with <code>sessionFixation().none()</code>
method:</p>
<pre>
@Override
protected void configure(HttpSecurity http) throws Exception {
   http.sessionManagement()
     .sessionFixation().none(); // Noncompliant: the existing session will continue
}
</pre>
<h2>Compliant Solution</h2>
<p>In a Spring Security’s context, session fixation protection can be enabled as follows:</p>
<pre>
@Override
protected void configure(HttpSecurity http) throws Exception {
  http.sessionManagement()
     .sessionFixation().newSession(); // Compliant: a new session is created without any of the attributes from the old session being copied over

  // or

  http.sessionManagement()
     .sessionFixation().migrateSession(); // Compliant: a new session is created, the old one is invalidated and the attributes from the old session are copied over.
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/OWASP_Top_Ten_2017/Top_10-2017_A2-Broken_Authentication">OWASP Top 10 2017 Category A2</a> -
  Broken Authentication </li>
  <li> <a href="https://owasp.org/www-community/attacks/Session_fixation">OWASP Sesssion Fixation</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/384">MITRE, CWE-384</a> - Session Fixation </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S4423">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4423">
              java:S4423
            </a>
          </td>
          <td>
            <details>
              <p>This rule raises an issue when an insecure TLS protocol version (i.e. a protocol different from "TLSv1.2", "TLSv1.3", "DTLSv1.2", or "DTLSv1.3") is
used or allowed.</p>
<p>It is recommended to enforce TLS 1.2 as the minimum protocol version and to disallow older versions like TLS 1.0. Failure to do so could open the
door to downgrade attacks: a malicious actor who is able to intercept the connection could modify the requested protocol version and downgrade it to a
less secure version.</p>
<p>In most cases, using the default system configuration is not compliant. Indeed, an application might get deployed on a wide range of systems with
different configurations. While using a system’s default value might be safe on modern up-to-date systems, this might not be the case on older
systems. It is therefore recommended to explicitly set a safe configuration in every case.</p>
<h2>Noncompliant Code Example</h2>
<p><code>javax.net.ssl.SSLContext</code> library:</p>
<pre>
context = SSLContext.getInstance("TLSv1.1"); // Noncompliant
</pre>
<p><a href="https://square.github.io/okhttp/">okhttp</a> library:</p>
<pre>
ConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)
      .tlsVersions(TlsVersion.TLS_1_1) // Noncompliant
      .build();
</pre>
<h2>Compliant Solution</h2>
<p><code>javax.net.ssl.SSLContext</code> library:</p>
<pre>
context = SSLContext.getInstance("TLSv1.2"); // Compliant
</pre>
<p><a href="https://square.github.io/okhttp/">okhttp</a> library:</p>
<pre>
ConnectionSpec spec = new ConnectionSpec.Builder(ConnectionSpec.MODERN_TLS)
      .tlsVersions(TlsVersion.TLS_1_2) // Compliant
      .build();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-327</a> - Inadequate Encryption Strength </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/327">MITRE, CWE-326</a> - Use of a Broken or Risky Cryptographic Algorithm </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
  <li> <a href="https://blogs.oracle.com/java-platform-group/diagnosing-tls,-ssl,-and-https">Diagnosing TLS, SSL, and HTTPS</a> </li>
  <li> <a href="https://github.com/ssllabs/research/wiki/SSL-and-TLS-Deployment-Best-Practices#22-use-secure-protocols">SSL and TLS Deployment Best
  Practices - Use secure protocols</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="java:S4426">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4426">
              java:S4426
            </a>
          </td>
          <td>
            <details>
              <p>Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks.</p>
<p><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST recommendations</a> will be checked for these
use-cases:</p>
<p><strong>Digital Signature Generation</strong> and <strong>Verification:</strong></p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DSA (<code>p</code> is key length and <code>q</code> the modulus length) </li>
  <li> n ≥ 2048 for RSA (<code>n</code> is the key length) </li>
</ul>
<p><strong>Key Agreement</strong>:</p>
<ul>
  <li> p ≥ 2048 AND q ≥ 224 for DH and MQV </li>
  <li> n ≥ 224 for ECDH and ECMQV (Examples: <code>secp192r1</code> is a non-compliant curve (<code>n</code> &lt; 224) but <code>secp224k1</code> is
  compliant (<code>n</code> &gt;= 224)) </li>
</ul>
<p><strong>Symmetric keys</strong>:</p>
<ul>
  <li> key length ≥ 128 bits </li>
</ul>
<p>This rule will not raise issues for ciphers that are considered weak (no matter the key size) like <code>DES</code>, <code>Blowfish</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
KeyPairGenerator keyPairGen1 = KeyPairGenerator.getInstance("RSA");
keyPairGen1.initialize(1024); // Noncompliant

KeyPairGenerator keyPairGen5 = KeyPairGenerator.getInstance("EC");
ECGenParameterSpec ecSpec1 = new ECGenParameterSpec("secp112r1"); // Noncompliant
keyPairGen5.initialize(ecSpec1);

KeyGenerator keyGen1 = KeyGenerator.getInstance("AES");
keyGen1.init(64); // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
KeyPairGenerator keyPairGen6 = KeyPairGenerator.getInstance("RSA");
keyPairGen6.initialize(2048); // Compliant

KeyPairGenerator keyPairGen5 = KeyPairGenerator.getInstance("EC");
ECGenParameterSpec ecSpec10 = new ECGenParameterSpec("secp256r1"); // compliant
keyPairGen5.initialize(ecSpec10);

KeyGenerator keyGen2 = KeyGenerator.getInstance("AES");
keyGen2.init(128); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST 800-131A</a> - Recommendation for Transitioning the
  Use of Cryptographic Algorithms and Key Lengths </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/326">MITRE, CWE-326</a> - Inadequate Encryption Strength </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S2254">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2254">
              java:S2254
            </a>
          </td>
          <td>
            <details>
              <p>According to the Oracle Java API, the <code>HttpServletRequest.getRequestedSessionId()</code> method:</p>
<blockquote>
  <p>Returns the session ID specified by the client. This may not be the same as the ID of the current valid session for this request. If the client
  did not specify a session ID, this method returns null.</p>
</blockquote>
<p>The session ID it returns is either transmitted in a cookie or a URL parameter so by definition, nothing prevents the end-user from manually
updating the value of this session ID in the HTTP request.</p>
<p>Here is an example of a updated HTTP header:</p>
<pre>
GET /pageSomeWhere HTTP/1.1
Host: webSite.com
User-Agent: Mozilla/5.0
Cookie: JSESSIONID=Hacked_Session_Value'''"&gt;
</pre>
<p>Due to the ability of the end-user to manually change the value, the session ID in the request should only be used by a servlet container (E.G.
Tomcat or Jetty) to see if the value matches the ID of an an existing session. If it does not, the user should be considered unauthenticated.
Moreover, this session ID should never be logged as is but using a one-way hash to prevent hijacking of active sessions.</p>
<h2>Noncompliant Code Example</h2>
<pre>
if(isActiveSession(request.getRequestedSessionId()) ){
  ...
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/807">MITRE, CWE-807</a> - Reliance on Untrusted Inputs in a Security Decision </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S4433">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4433">
              java:S4433
            </a>
          </td>
          <td>
            <details>
              <p>An LDAP client authenticates to an LDAP server with a "bind request" which provides, among other, a <a
href="https://ldapwiki.com/wiki/Simple%20Authentication">simple authentication method</a>.</p>
<p>Simple authentication in LDAP can be used with three different mechanisms:</p>
<ul>
  <li> <em>Anonymous Authentication Mechanism</em> by performing a bind request with a username and password value of zero length. </li>
  <li> <em>Unauthenticated Authentication Mechanism</em> by performing a bind request with a password value of zero length. </li>
  <li> <em>Name/Password Authentication Mechanism</em> by performing a bind request with a password value of non-zero length. </li>
</ul>
<p>Anonymous binds and unauthenticated binds allow access to information in the LDAP directory without providing a password, their use is therefore
strongly discouraged.</p>
<h2>Noncompliant Code Example</h2>
<p>This rule raises an issue when an LDAP connection is created with <code>Context.SECURITY_AUTHENTICATION</code> set to <code>"none"</code>.</p>
<pre>
// Set up the environment for creating the initial context
Hashtable&lt;String, Object&gt; env = new Hashtable&lt;String, Object&gt;();
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/o=JNDITutorial");

// Use anonymous authentication
env.put(Context.SECURITY_AUTHENTICATION, "none"); // Noncompliant

// Create the initial context
DirContext ctx = new InitialDirContext(env);
</pre>
<h2>Compliant Solution</h2>
<pre>
// Set up the environment for creating the initial context
Hashtable&lt;String, Object&gt; env = new Hashtable&lt;String, Object&gt;();
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/o=JNDITutorial");

// Use simple authentication
env.put(Context.SECURITY_AUTHENTICATION, "simple");
env.put(Context.SECURITY_PRINCIPAL, "cn=S. User, ou=NewHires, o=JNDITutorial");
env.put(Context.SECURITY_CREDENTIALS, getLDAPPassword());

// Create the initial context
DirContext ctx = new InitialDirContext(env);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/521">MITRE, CWE-521</a> - Weak Password Requirements </li>
  <li> <a href="https://ldapwiki.com/wiki/Simple%20Authentication">ldapwiki.com</a>- Simple Authentication </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5527">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5527">
              java:S5527
            </a>
          </td>
          <td>
            <details>
              <p>To establish a SSL/TLS connection not vulnerable to man-in-the-middle attacks, it’s essential to make sure the server presents the right
certificate.</p>
<p>The certificate’s hostname-specific data should match the server hostname.</p>
<p>It’s not recommended to re-invent the wheel by implementing custom hostname verification.</p>
<p>TLS/SSL libraries provide built-in hostname verification functions that should be used.</p>
<p>This rule raises an issue when:</p>
<ul>
  <li> <code>HostnameVerifier.verify()</code> method always returns <code>true</code> </li>
  <li> a JavaMail’s <code>javax.mail.Session</code> is created with a <code>Properties</code> object having no
  <code>mail.smtp.ssl.checkserveridentity</code> or <code>mail.smtps.ssl.checkserveridentity</code> not configured to <code>true</code> </li>
  <li> a Apache Common Emails’s <code>org.apache.commons.mail.SimpleEmail</code> is used with <code>setSSLOnConnect(true)</code> or
  <code>setStartTLSEnabled(true)</code> or <code>setStartTLSRequired(true)</code> without a call to <code>setSSLCheckServerIdentity(true)</code> </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
URL url = new URL("https://example.org/");
HttpsURLConnection urlConnection = (HttpsURLConnection)url.openConnection();
urlConnection.setHostnameVerifier(new HostnameVerifier() {
  @Override
  public boolean verify(String requestedHost, SSLSession remoteServerSession) {
    return true;  // Noncompliant
  }
});
InputStream in = urlConnection.getInputStream();
</pre>
<p>SimpleEmail example:</p>
<pre>
Email email = new SimpleEmail();
email.setSmtpPort(465);
email.setAuthenticator(new DefaultAuthenticator(username, password));
email.setSSLOnConnect(true); // Noncompliant; setSSLCheckServerIdentity(true) should also be called before sending the email
email.send();
</pre>
<p>JavaMail’s example:</p>
<pre>
Properties props = new Properties();
props.put("mail.smtp.host", "smtp.gmail.com");
props.put("mail.smtp.socketFactory.port", "465");
props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory"); // Noncompliant; Session is created without having "mail.smtp.ssl.checkserveridentity" set to true
props.put("mail.smtp.auth", "true");
props.put("mail.smtp.port", "465");
Session session = Session.getDefaultInstance(props, new javax.mail.Authenticator() {
  protected PasswordAuthentication getPasswordAuthentication() {
    return new PasswordAuthentication("username@gmail.com", "password");
  }
});
</pre>
<h2>Compliant Solution</h2>
<pre>
URL url = new URL("https://example.org/");
HttpsURLConnection urlConnection = (HttpsURLConnection)url.openConnection();
// Compliant; Use the default HostnameVerifier
InputStream in = urlConnection.getInputStream();
</pre>
<p>SimpleEmail example:</p>
<pre>
Email email = new SimpleEmail();
email.setSmtpPort(465);
email.setAuthenticator(new DefaultAuthenticator(username, password));
email.setSSLOnConnect(true);
email.setSSLCheckServerIdentity(true); // Compliant
email.send();
</pre>
<p>JavaMail’s example:</p>
<pre>
Properties props = new Properties();
props.put("mail.smtp.host", "smtp.gmail.com");
props.put("mail.smtp.socketFactory.port", "465");
props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
props.put("mail.smtp.auth", "true");
props.put("mail.smtp.port", "465");
props.put("mail.smtp.ssl.checkserveridentity", true); // Compliant
Session session = Session.getDefaultInstance(props, new javax.mail.Authenticator() {
  protected PasswordAuthentication getPasswordAuthentication() {
    return new PasswordAuthentication("username@gmail.com", "password");
  }
});
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
  <li> Derived from FindSecBugs rule <a href="https://find-sec-bugs.github.io/bugs.htm#WEAK_HOSTNAME_VERIFIER">WEAK_HOSTNAME_VERIFIER</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="java:S2755">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2755">
              java:S2755
            </a>
          </td>
          <td>
            <details>
              <p>XML standard allows the use of entities, declared in the DOCTYPE of the document, which can be <a
href="https://www.w3.org/TR/xml/#sec-internal-ent">internal</a> or <a href="https://www.w3.org/TR/xml/#sec-external-ent">external</a>.</p>
<p>When parsing the XML file, the content of the external entities is retrieved from an external storage such as the file system or network, which may
lead, if no restrictions are put in place, to arbitrary file disclosures or <a
href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">server-side request forgery (SSRF)</a> vulnerabilities.</p>
<p>It’s recommended to limit resolution of external entities by using one of these solutions:</p>
<ul>
  <li> If DOCTYPE is not necessary, completely disable all DOCTYPE declarations. </li>
  <li> If external entities are not necessary, completely disable their declarations. </li>
  <li> If external entities are necessary then:
    <ul>
      <li> Use XML processor features, if available, to authorize only required protocols (eg: https). </li>
      <li> And use an entity resolver (and optionally an XML Catalog) to resolve only trusted entities. == Noncompliant Code Example </li>
    </ul>  </li>
</ul>
<p>For <a href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">DocumentBuilder</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html">SAXParser</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/stream/XMLInputFactory.html">XMLInput</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/transform/TransformerFactory.html">Transformer</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html">Schema</a> JAPX factories:</p>
<pre>
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance(); // Noncompliant

SAXParserFactory factory = SAXParserFactory.newInstance(); // Noncompliant

XMLInputFactory factory = XMLInputFactory.newInstance(); // Noncompliant

TransformerFactory factory = javax.xml.transform.TransformerFactory.newInstance();  // Noncompliant

SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);  // Noncompliant
</pre>
<p>For <a href="https://dom4j.github.io/">Dom4j</a> library:</p>
<pre>
SAXReader xmlReader = new SAXReader(); // Noncompliant
</pre>
<p>For <a href="http://www.jdom.org/">Jdom2</a> library:</p>
<pre>
SAXBuilder builder = new SAXBuilder(); // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">DocumentBuilder</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html">SAXParser</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/stream/XMLInputFactory.html">XMLInput</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/transform/TransformerFactory.html">Transformer</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html">Schema</a> JAPX factories:</p>
<pre>
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
// to be compliant, completely disable DOCTYPE declaration:
factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
// or completely disable external entities declarations:
factory.setFeature("http://xml.org/sax/features/external-general-entities", false);
factory.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
// or prohibit the use of all protocols by external entities:
factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "");
factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "");
// or disable entity expansion but keep in mind that this doesn't prevent fetching external entities
// and this solution is not correct for OpenJDK &lt; 13 due to a bug: https://bugs.openjdk.java.net/browse/JDK-8206132
factory.setExpandEntityReferences(false);


SAXParserFactory factory = SAXParserFactory.newInstance();
// to be compliant, completely disable DOCTYPE declaration:
factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
// or completely disable external entities declarations:
factory.setFeature("http://xml.org/sax/features/external-general-entities", false);
factory.setFeature("http://xml.org/sax/features/external-parameter-entities", false);
// or prohibit the use of all protocols by external entities:
SAXParser parser = factory.newSAXParser(); // Noncompliant
parser.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, "");
parser.setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "");

XMLInputFactory factory = XMLInputFactory.newInstance();
// to be compliant, completely disable DOCTYPE declaration:
factory.setProperty(XMLInputFactory.SUPPORT_DTD, false);
// or completely disable external entities declarations:
factory.setProperty(XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES, Boolean.FALSE);
// or prohibit the use of all protocols by external entities:
factory.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, "");
factory.setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "");

TransformerFactory factory = javax.xml.transform.TransformerFactory.newInstance();
// to be compliant, prohibit the use of all protocols by external entities:
factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_DTD, "");
factory.setAttribute(XMLConstants.ACCESS_EXTERNAL_STYLESHEET, "");

SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
// to be compliant, completely disable DOCTYPE declaration:
factory.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
// or prohibit the use of all protocols by external entities:
factory.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, "");
factory.setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "");
</pre>
<p>For <a href="https://dom4j.github.io/">Dom4j</a> library:</p>
<pre>
SAXReader xmlReader = new SAXReader();
xmlReader.setFeature("http://apache.org/xml/features/disallow-doctype-decl", true);
</pre>
<p>For <a href="http://www.jdom.org/">Jdom2</a> library:</p>
<pre>
SAXBuilder builder = new SAXBuilder();
builder.setProperty(XMLConstants.ACCESS_EXTERNAL_DTD, "");
builder.setProperty(XMLConstants.ACCESS_EXTERNAL_SCHEMA, "");
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a
  href="https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-8CD65EF5-D113-4D5C-A564-B875C8625FAC">Oracle Java Documentation</a> - XML External Entity Injection Attack </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java">OWASP XXE Prevention Cheat
  Sheet</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/611">MITRE, CWE-611</a> - Information Exposure Through XML External Entity Reference </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/827">MITRE, CWE-827</a> - Improper Control of Document Type Definition </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="java:S4601">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4601">
              java:S4601
            </a>
          </td>
          <td>
            <details>
              <p>URL patterns configured on a <code>HttpSecurity.authorizeRequests()</code> method are considered in the order they were declared. It’s easy to make
a mistake and declare a less restrictive configuration before a more restrictive one. Therefore, it’s required to review the order of the
"antMatchers" declarations. The <code>/**</code> one should be the last one if it is declared.</p>
<p>This rule raises an issue when:</p>
<ul>
  <li> A pattern is preceded by another that ends with <code>**</code> and has the same beginning. E.g.: <code>/page*-admin/db/**</code> is after
  <code>/page*-admin/**</code> </li>
  <li> A pattern without wildcard characters is preceded by another that matches. E.g.: <code>/page-index/db</code> is after <code>/page*/**</code>
  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
  protected void configure(HttpSecurity http) throws Exception {
    http.authorizeRequests()
      .antMatchers("/resources/**", "/signup", "/about").permitAll() // Compliant
      .antMatchers("/admin/**").hasRole("ADMIN")
      .antMatchers("/admin/login").permitAll() // Noncompliant; the pattern "/admin/login" should appear before "/admin/**"
      .antMatchers("/**", "/home").permitAll()
      .antMatchers("/db/**").access("hasRole('ADMIN') and hasRole('DBA')") // Noncompliant; the pattern "/db/**" should occurs before "/**"
      .and().formLogin().loginPage("/login").permitAll().and().logout().permitAll();
  }
</pre>
<h2>Compliant Solution</h2>
<pre>
  protected void configure(HttpSecurity http) throws Exception {
    http.authorizeRequests()
      .antMatchers("/resources/**", "/signup", "/about").permitAll() // Compliant
      .antMatchers("/admin/login").permitAll()
      .antMatchers("/admin/**").hasRole("ADMIN") // Compliant
      .antMatchers("/db/**").access("hasRole('ADMIN') and hasRole('DBA')")
      .antMatchers("/**", "/home").permitAll() // Compliant; "/**" is the last one
      .and().formLogin().loginPage("/login").permitAll().and().logout().permitAll();
  }
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S2647">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2647">
              java:S2647
            </a>
          </td>
          <td>
            <details>
              <p>Basic authentication’s only means of obfuscation is Base64 encoding. Since Base64 encoding is easily recognized and reversed, it offers only the
thinnest veil of protection to your users, and should not be used.</p>
<h2>Noncompliant Code Example</h2>
<pre>
// Using HttpPost from Apache HttpClient
String encoding = Base64Encoder.encode ("login:passwd");
org.apache.http.client.methods.HttpPost httppost = new HttpPost(url);
httppost.setHeader("Authorization", "Basic " + encoding);  // Noncompliant

or

// Using HttpURLConnection
String encoding = Base64.getEncoder().encodeToString(("login:passwd").getBytes(‌"UTF‌​-8"​));
HttpURLConnection conn = (HttpURLConnection) url.openConnection();
conn.setRequestMethod("POST");
conn.setDoOutput(true);
conn.setRequestProperty("Authorization", "Basic " + encoding); // Noncompliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Web_Service_Security_Cheat_Sheet.html#user-authentication">OWASP Web Service Security
  Cheat Sheet</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/522">MITRE, CWE-522</a> - Insufficiently Protected Credentials </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S4830">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4830">
              java:S4830
            </a>
          </td>
          <td>
            <details>
              <p>Validation of X.509 certificates is essential to create secure SSL/TLS sessions not vulnerable to man-in-the-middle attacks.</p>
<p>The certificate chain validation includes these steps:</p>
<ul>
  <li> The certificate is issued by its parent Certificate Authority or the root CA trusted by the system. </li>
  <li> Each CA is allowed to issue certificates. </li>
  <li> Each certificate in the chain is not expired. </li>
</ul>
<p>This rule raises an issue when an implementation of X509TrustManager is not controlling the validity of the certificate (ie: no exception is
raised). Empty implementations of the <code>X509TrustManager</code> interface are often created to disable certificate validation. The correct
solution is to provide an appropriate trust store.</p>
<h2>Noncompliant Code Example</h2>
<pre>
class TrustAllManager implements X509TrustManager {

    @Override
    public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException {  // Noncompliant, nothing means trust any client
    }

    @Override
    public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException { // Noncompliant, this method never throws exception, it means trust any server
        LOG.log(Level.SEVERE, ERROR_MESSAGE);
    }

    @Override
    public X509Certificate[] getAcceptedIssuers() {
        return null;
    }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A05_2021-Security_Misconfiguration/">OWASP Top 10 2021 Category A5</a> - Security Misconfiguration </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/295">MITRE, CWE-295</a> - Improper Certificate Validation </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/hDdGBQ">CERT, MSC61-J.</a> - Do not use insecure or weak cryptographic algorithms </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S3749">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S3749">
              java:S3749
            </a>
          </td>
          <td>
            <details>
              <p>Spring <code>@Component</code>, <code>@Controller</code>, <code>@Service</code>, and <code>@Repository</code> classes are singletons by default,
meaning only one instance of the class is ever instantiated in the application. Typically such a class might have a few <code>static</code> members,
such as a logger, but all non-<code>static</code> members should be managed by Spring. That is, they should have one of these annotations:
<code>@Resource</code>, <code>@Inject</code>, <code>@Autowired</code> or <code>@Value</code>.</p>
<p>Having non-injected members in one of these classes could indicate an attempt to manage state. Because they are singletons, such an attempt is
almost guaranteed to eventually expose data from User1’s session to User2.</p>
<p>This rule raises an issue when a singleton <code>@Component</code>, <code>@Controller</code>, <code>@Service</code>, or <code>@Repository</code>,
not annotated with <code>@ConfigurationProperties</code>, has non-<code>static</code> members that are not annotated with one of:</p>
<ul>
  <li> <code>org.springframework.beans.factory.annotation.Autowired</code> </li>
  <li> <code>org.springframework.beans.factory.annotation.Value</code> </li>
  <li> <code>javax.annotation.Inject</code> </li>
  <li> <code>javax.annotation.Resource</code> </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
@Controller
public class HelloWorld {

  private String name = null;

  @RequestMapping("/greet", method = GET)
  public String greet(String greetee) {

    if (greetee != null) {
      this.name = greetee;
    }

    return "Hello " + this.name;  // if greetee is null, you see the previous user's data
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5808">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5808">
              java:S5808
            </a>
          </td>
          <td>
            <details>
              <p>Authorizations granted or not to users to access resources of an application should be based on strong decisions. For instance, checking whether
the user is authenticated or not, has the right roles/privileges. It may also depend on the user’s location, or the date, time when the user requests
access.</p>
<h2>Noncompliant Code Example</h2>
<p>In a Spring-security web application:</p>
<ul>
  <li> the <code>vote</code> method of an <a
  href="https://docs.spring.io/spring-security/site/docs/4.0.x/apidocs/org/springframework/security/access/AccessDecisionVoter.html">AccessDecisionVoter</a> type is not compliant when it returns only an affirmative decision (<code>ACCESS_GRANTED</code>) or abstains to make a decision (<code>ACCESS_ABSTAIN</code>): </li>
</ul>
<pre>
public class WeakNightVoter implements AccessDecisionVoter {
    @Override
    public int vote(Authentication authentication, Object object, Collection collection) {  // Noncompliant

      Calendar calendar = Calendar.getInstance();

      int currentHour = calendar.get(Calendar.HOUR_OF_DAY);

      if(currentHour &gt;= 8 &amp;&amp; currentHour &lt;= 19) {
        return ACCESS_GRANTED; // Noncompliant
      }

      // when users connect during the night, do not make decision
      return ACCESS_ABSTAIN; // Noncompliant
    }
}
</pre>
<ul>
  <li> the <code>hasPermission</code> method of a <a
  href="https://docs.spring.io/spring-security/site/docs/4.2.13.RELEASE/apidocs/org/springframework/security/access/PermissionEvaluator.html">PermissionEvaluator</a> type is not compliant when it doesn’t return <code>false</code>: </li>
</ul>
<pre>
public class MyPermissionEvaluator implements PermissionEvaluator {
    @Override
    public boolean hasPermission(Authentication authentication, Object targetDomainObject, Object permission) {
        //Getting subject
        Object user = authentication.getPrincipal();

        if(user.getRole().equals(permission)) {
              return true; // Noncompliant
        }

        return true;  // Noncompliant
    }
}
</pre>
<h2>Compliant Solution</h2>
<p>In a Spring-security web application:</p>
<ul>
  <li> the <code>vote</code> method of an <a
  href="https://docs.spring.io/spring-security/site/docs/4.0.x/apidocs/org/springframework/security/access/AccessDecisionVoter.html">AccessDecisionVoter</a> type should return a negative decision (<code>ACCESS_DENIED</code>): </li>
</ul>
<pre>
public class StrongNightVoter implements AccessDecisionVoter {
    @Override
    public int vote(Authentication authentication, Object object, Collection collection) {

      Calendar calendar = Calendar.getInstance();

      int currentHour = calendar.get(Calendar.HOUR_OF_DAY);

      if(currentHour &gt;= 8 &amp;&amp; currentHour &lt;= 19) {
        return ACCESS_GRANTED;
      }

      // users are not allowed to connect during the night
      return ACCESS_DENIED; // Compliant
    }
}
</pre>
<ul>
  <li> the <code>hasPermission</code> method of a <a
  href="https://docs.spring.io/spring-security/site/docs/4.2.13.RELEASE/apidocs/org/springframework/security/access/PermissionEvaluator.html">PermissionEvaluator</a> type should return <code>false</code>: </li>
</ul>
<pre>
public class MyPermissionEvaluator implements PermissionEvaluator {
    @Override
    public boolean hasPermission(Authentication authentication, Object targetDomainObject, Object permission) {
        //Getting subject
        Object user = authentication.getPrincipal();

        if(user.getRole().equals(permission)) {
              return true;
        }

        return false; // Compliant
    }
}
</pre>
<h2>Exceptions</h2>
<p>No issue is reported when the method throws an exception as it might be used to indicate a strong decision.</p>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A5_2017-Broken_Access_Control">OWASP Top 10 2017 Category A5</a> - Broken Access Control
  </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/285">MITRE, CWE-285</a> - Improper Authorization </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S2658">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2658">
              java:S2658
            </a>
          </td>
          <td>
            <details>
              <p>Dynamically loaded classes could contain malicious code executed by a static class initializer. I.E. you wouldn’t even have to instantiate or
explicitly invoke methods on such classes to be vulnerable to an attack.</p>
<p>This rule raises an issue for each use of dynamic class loading.</p>
<h2>Noncompliant Code Example</h2>
<pre>
String className = System.getProperty("messageClassName");
Class clazz = Class.forName(className);  // Noncompliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A1_2017-Injection">OWASP Top 10 2017 Category A1</a> - Injection </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/470">MITRE, CWE-470</a> - Use of Externally-Controlled Input to Select Classes or Code ('Unsafe
  Reflection') </li>
</ul>
<h2>Deprecated</h2>
<p>This rule is deprecated; use <a href='/coding_rules#rule_key=javasecurity%3AS6173'>S6173</a> instead.</p>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S6374">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6374">
              java:S6374
            </a>
          </td>
          <td>
            <details>
              <p>By default XML processors attempt to load all XML schemas and DTD (their locations are defined with <code>xsi:schemaLocation</code> attributes and
<code>DOCTYPE</code> declarations), potentially from an external storage such as file system or network, which may lead, if no restrictions are put in
place, to <a href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">server-side request forgery (SSRF)</a> vulnerabilities.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">DocumentBuilder</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html">SAXParser</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html">Schema</a> JAPX factories:</p>
<pre>
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setValidating(true); // Noncompliant
factory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", true); // Noncompliant

SAXParserFactory factory = SAXParserFactory.newInstance();
factory.setValidating(true); // Noncompliant
factory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", true); // Noncompliant

SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
schemaFactory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", true); // Noncompliant
</pre>
<p>For <a href="https://dom4j.github.io/">Dom4j</a> library:</p>
<pre>
SAXReader xmlReader = new SAXReader(); // Noncompliant
xmlReader.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", true);  // Noncompliant
</pre>
<p>For <a href="http://www.jdom.org/">Jdom2</a> library:</p>
<pre>
SAXBuilder builder = new SAXBuilder();
builder.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", true); // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">DocumentBuilder</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html">SAXParser</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html">Schema</a> JAPX factories:</p>
<pre>
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);

SAXParserFactory factory = SAXParserFactory.newInstance();
factory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);

SchemaFactory schemaFactory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
schemaFactory.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);
</pre>
<p>For <a href="https://dom4j.github.io/">Dom4j</a> library:</p>
<pre>
SAXReader xmlReader = new SAXReader(); // Noncompliant
xmlReader.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);
</pre>
<p>For <a href="http://www.jdom.org/">Jdom2</a> library:</p>
<pre>
SAXBuilder builder = new SAXBuilder();
builder.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", false);
</pre>
<h2>Exceptions</h2>
<p>This rules does not raise an issue when an <code>EntityResolver</code> is set.</p>
<pre>
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setValidating(true);
DocumentBuilder builder = factory.newDocumentBuilder();
builder.setEntityResolver(new MyEntityResolver());

SAXBuilder builder = new SAXBuilder();
builder.setFeature("http://apache.org/xml/features/nonvalidating/load-external-dtd", true);
builder.setEntityResolver(new EntityResolver());
</pre>
<h2>See</h2>
<ul>
  <li> <a
  href="https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-8CD65EF5-D113-4D5C-A564-B875C8625FAC">Oracle Java Documentation</a> - XML External Entity Injection Attack </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java">OWASP XXE Prevention Cheat
  Sheet</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/611">MITRE, CWE-611</a> - Information Exposure Through XML External Entity Reference </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/827">MITRE, CWE-827</a> - Improper Control of Document Type Definition </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6377">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6377">
              java:S6377
            </a>
          </td>
          <td>
            <details>
              <p>XML signature validations work by parsing third-party data that cannot be trusted until it is actually validated.</p>
<p>As with any other parsing process, unrestricted validation of third-party XML signatures can lead to security vulnerabilities. In this case,
threats range from denial of service to confidentiality breaches.</p>
<p>By default, the Java XML Digital Signature API does not apply restrictions on XML signature validation, unless the application runs with a security
manager.<br> To protect the application from these vulnerabilities, set the <code>org.jcp.xml.dsig.secureValidation</code> attribute to
<code>true</code> with the <code>javax.xml.crypto.dsig.dom.DOMValidateContext.setProperty</code> method.<br> This attribute ensures that the code
enforces the following restrictions:</p>
<ul>
  <li> Forbids the use of XSLT transforms </li>
  <li> Restricts the number of <code>SignedInfo</code> or <code>Manifest Reference</code> elements to 30 or less </li>
  <li> Restricts the number of <code>Reference</code> transforms to 5 or less </li>
  <li> Forbids the use of MD5-related signatures or MAC algorithms </li>
  <li> Ensures that <code>Reference</code> IDs are unique to help prevent signature wrapping attacks </li>
  <li> Forbids Reference URIs of type <code>http</code>, <code>https</code>, or <code>file</code> </li>
  <li> Does not allow a <code>RetrievalMethod</code> element to reference another <code>RetrievalMethod</code> element </li>
  <li> Forbids RSA or DSA keys less than 1024 bits </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
NodeList signatureElement = doc.getElementsByTagNameNS(XMLSignature.XMLNS, "Signature");

XMLSignatureFactory fac = XMLSignatureFactory.getInstance("DOM");
DOMValidateContext valContext = new DOMValidateContext(new KeyValueKeySelector(), signatureElement.item(0)); // Noncompliant
XMLSignature signature = fac.unmarshalXMLSignature(valContext);

boolean signatureValidity = signature.validate(valContext);
</pre>
<h2>Compliant Solution</h2>
<p>In order to benefit from this secure validation mode, set the DOMValidateContext’s <code>org.jcp.xml.dsig.secureValidation</code> property to
<code>TRUE</code>.</p>
<pre>
NodeList signatureElement = doc.getElementsByTagNameNS(XMLSignature.XMLNS, "Signature");

XMLSignatureFactory fac = XMLSignatureFactory.getInstance("DOM");
DOMValidateContext valContext = new DOMValidateContext(new KeyValueKeySelector(), signatureElement.item(0));
valContext.setProperty("org.jcp.xml.dsig.secureValidation", Boolean.TRUE);
XMLSignature signature = fac.unmarshalXMLSignature(valContext);

boolean signatureValidity = signature.validate(valContext);
</pre>
<h2>See</h2>
<ul>
  <li> <a
  href="https://docs.oracle.com/en/java/javase/14/security/java-xml-digital-signature-api-overview-and-tutorial.html#GUID-DB46A001-6DBD-4571-BDBC-1BBC394BF61E">Oracle Java Documentation</a> - XML Digital Signature API Overview and Tutorial </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/347">MITRE, CWE-347</a> - Improper Verification of Cryptographic Signature </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6373">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6373">
              java:S6373
            </a>
          </td>
          <td>
            <details>
              <p>XML standard allows the inclusion of xml files with the <a href="https://www.w3.org/TR/xinclude-11/">xinclude</a> element.</p>
<p>XML processors will replace an xinclude element with the content of the file located at the URI defined in the href attribute, potentially from an
external storage such as file system or network, which may lead, if no restrictions are put in place, to arbitrary file disclosures or <a
href="https://owasp.org/www-community/attacks/Server_Side_Request_Forgery">server-side request forgery (SSRF)</a> vulnerabilities.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">DocumentBuilder</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html">SAXParser</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/stream/XMLInputFactory.html">XMLInput</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/transform/TransformerFactory.html">Transformer</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html">Schema</a> JAPX factories:</p>
<pre>
factory.setXIncludeAware(true); // Noncompliant
// or
factory.setFeature("http://apache.org/xml/features/xinclude", true); // Noncompliant
</pre>
<p>For <a href="https://dom4j.github.io/">Dom4j</a> library:</p>
<pre>
SAXReader xmlReader = new SAXReader();
xmlReader.setFeature("http://apache.org/xml/features/xinclude", true); // Noncompliant
</pre>
<p>For <a href="http://www.jdom.org/">Jdom2</a> library:</p>
<pre>
SAXBuilder builder = new SAXBuilder();
builder.setFeature("http://apache.org/xml/features/xinclude", true); // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>Xinclude is disabled by default and can be explicitely disabled like below.</p>
<p>For <a href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">DocumentBuilder</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html">SAXParser</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/stream/XMLInputFactory.html">XMLInput</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/transform/TransformerFactory.html">Transformer</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html">Schema</a> JAPX factories:</p>
<pre>
factory.setXIncludeAware(false);
// or
factory.setFeature("http://apache.org/xml/features/xinclude", false);
</pre>
<p>For <a href="https://dom4j.github.io/">Dom4j</a> library:</p>
<pre>
SAXReader xmlReader = new SAXReader();
xmlReader.setFeature("http://apache.org/xml/features/xinclude", false);
</pre>
<p>For <a href="http://www.jdom.org/">Jdom2</a> library:</p>
<pre>
SAXBuilder builder = new SAXBuilder();
builder.setFeature("http://apache.org/xml/features/xinclude", false);
</pre>
<h2>Exceptions</h2>
<p>This rule does not raise issues when Xinclude is enabled with a custom <code>EntityResolver</code>:</p>
<p>For DocumentBuilderFactory:</p>
<pre>
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setXIncludeAware(true);
// ...
DocumentBuilder builder = factory.newDocumentBuilder();
builder.setEntityResolver((publicId, systemId) -&gt; new MySafeEntityResolver(publicId, systemId));
</pre>
<p>For SAXBuilder:</p>
<pre>
SAXBuilder builder = new SAXBuilder();
builder.setFeature("http://apache.org/xml/features/xinclude", true);
builder.setEntityResolver((publicId, systemId) -&gt; new MySafeEntityResolver(publicId, systemId));
</pre>
<p>For SAXReader:</p>
<pre>
SAXReader xmlReader = new SAXReader();
xmlReader.setFeature("http://apache.org/xml/features/xinclude", true);
xmlReader.setEntityResolver((publicId, systemId) -&gt; new MySafeEntityResolver(publicId, systemId));
</pre>
<p>For XMLInputFactory:</p>
<pre>
XMLInputFactory factory = XMLInputFactory.newInstance();
factory.setProperty("http://apache.org/xml/features/xinclude", true);
factory.setXMLResolver(new MySafeEntityResolver());
</pre>
<h2>See</h2>
<ul>
  <li> <a
  href="https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-8CD65EF5-D113-4D5C-A564-B875C8625FAC">Oracle Java Documentation</a> - XML External Entity Injection Attack </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java">OWASP XXE Prevention Cheat
  Sheet</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/611">MITRE, CWE-611</a> - Information Exposure Through XML External Entity Reference </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/827">MITRE, CWE-827</a> - Improper Control of Document Type Definition </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S6376">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6376">
              java:S6376
            </a>
          </td>
          <td>
            <details>
              <p>An XML bomb / <a href="https://en.wikipedia.org/wiki/Billion_laughs_attack">billion laughs</a> attack is a malicious XML document containing the
same large entity repeated over and over again. If no restrictions is in place, such a limit on the number of entity expansions, the XML processor can
consume a lot memory and time during the parsing of such documents leading to Denial of Service.</p>
<h2>Noncompliant Code Example</h2>
<p>For <a href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">DocumentBuilder</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html">SAXParser</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html">Schema</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/transform/TransformerFactory.html">Transformer</a> JAPX factories:</p>
<pre>
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, false); // Noncompliant

SAXParserFactory factory = SAXParserFactory.newInstance();
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, false); // Noncompliant

SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, false); // Noncompliant

TransformerFactory factory = javax.xml.transform.TransformerFactory.newInstance();
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, false); // Noncompliant
</pre>
<p>For <a href="https://dom4j.github.io/">Dom4j</a> library:</p>
<pre>
SAXReader xmlReader = new SAXReader();
xmlReader.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, false); // Noncompliant
</pre>
<p>For <a href="http://www.jdom.org/">Jdom2</a> library:</p>
<pre>
SAXBuilder builder = new SAXBuilder();
builder.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, false);  // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>For <a href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/DocumentBuilderFactory.html">DocumentBuilder</a>, <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/parsers/SAXParserFactory.html">SAXParser</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/validation/SchemaFactory.html">Schema</a> and <a
href="https://docs.oracle.com/javase/9/docs/api/javax/xml/transform/TransformerFactory.html">Transformer</a> JAPX factories:</p>
<pre>
DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);

SAXParserFactory factory = SAXParserFactory.newInstance();
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);

SchemaFactory factory = SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);

TransformerFactory factory = javax.xml.transform.TransformerFactory.newInstance();
factory.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
</pre>
<p>For <a href="https://dom4j.github.io/">Dom4j</a> library:</p>
<pre>
SAXReader xmlReader = new SAXReader();
xmlReader.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
</pre>
<p>For <a href="http://www.jdom.org/">Jdom2</a> library:</p>
<pre>
SAXBuilder builder = new SAXBuilder();
builder.setFeature(XMLConstants.FEATURE_SECURE_PROCESSING, true);
</pre>
<h2>See</h2>
<ul>
  <li> <a
  href="https://docs.oracle.com/en/java/javase/13/security/java-api-xml-processing-jaxp-security-guide.html#GUID-8CD65EF5-D113-4D5C-A564-B875C8625FAC">Oracle Java Documentation</a> - XML External Entity Injection Attack </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A4_2017-XML_External_Entities_(XXE)">OWASP Top 10 2017 Category A4</a> - XML External
  Entities (XXE) </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html#java">OWASP XXE Prevention Cheat
  Sheet</a> </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/776">MITRE, CWE-776</a> - Improper Restriction of Recursive Entity References in DTDs ('XML
  Entity Expansion') </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S1989">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S1989">
              java:S1989
            </a>
          </td>
          <td>
            <details>
              <p>Even though the signatures for methods in a servlet include <code>throws IOException, ServletException</code>, it’s a bad idea to let such
exceptions be thrown. Failure to catch exceptions in a servlet could leave a system in a vulnerable state, possibly resulting in denial-of-service
attacks, or the exposure of sensitive information because when a servlet throws an exception, the servlet container typically sends debugging
information back to the user. And that information could be very valuable to an attacker.</p>
<p>This rule checks all exceptions in methods named "do*" are explicitly handled in servlet classes.</p>
<h2>Noncompliant Code Example</h2>
<pre>
public void doGet(HttpServletRequest request, HttpServletResponse response)
  throws IOException, ServletException {
  String ip = request.getRemoteAddr();
  InetAddress addr = InetAddress.getByName(ip); // Noncompliant; getByName(String) throws UnknownHostException
  //...
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public void doGet(HttpServletRequest request, HttpServletResponse response)
  throws IOException, ServletException {
  try {
    String ip = request.getRemoteAddr();
    InetAddress addr = InetAddress.getByName(ip);
    //...
  }
  catch (UnknownHostException uhex) {
    //...
  }
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/600">MITRE, CWE-600</a> - Uncaught Exception in Servlet </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/-zZGBQ">CERT, ERR01-J.</a> - Do not allow exceptions to expose sensitive information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S6301">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6301">
              java:S6301
            </a>
          </td>
          <td>
            <details>
              <p>Storing data locally is a common task for mobile applications. There are many convenient solutions that allow storing data persistently, for
example SQLiteDatabase and Realm. These systems can be initialized with a secret key in order to store the data encrypted.</p>
<p>The encryption key is meant to stay secret and should not be hard-coded in the application as it would mean that:</p>
<ul>
  <li> All user would use the same encryption key. </li>
  <li> The encryption key would be known by anyone who as access to the source code or the application binary code. </li>
  <li> Data stored encrypted in the database would not be protected. </li>
</ul>
<p>There are different approaches how the key can be provided to encrypt and decrypt the database. One of the most convinient way to is to rely on
<code>EncryptedSharedPreferences</code> to store encryption keys. It can also be provided dynamically by the user of the application or fetched from a
remote server.</p>
<h2>Noncompliant Code Example</h2>
<p><a href="https://www.zetetic.net/sqlcipher/sqlcipher-for-android/">SQLCipher</a></p>
<pre>
String key = "gb09ym9ydoolp3w886d0tciczj6ve9kszqd65u7d126040gwy86xqimjpuuc788g";
SQLiteDatabase db = SQLiteDatabase.openOrCreateDatabase("test.db", key, null); // Noncompliant
</pre>
<p><a href="https://github.com/realm/realm-java/">Realm</a></p>
<pre>
String key = "gb09ym9ydoolp3w886d0tciczj6ve9kszqd65u7d126040gwy86xqimjpuuc788g";
RealmConfiguration config = new RealmConfiguration.Builder();
    .encryptionKey(key.toByteArray()) // Noncompliant
    .build();
Realm realm = Realm.getInstance(config);
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.zetetic.net/sqlcipher/sqlcipher-for-android/">SQLCipher</a></p>
<pre>
SQLiteDatabase db = SQLiteDatabase.openOrCreateDatabase("test.db", getKey(), null);
</pre>
<p><a href="https://github.com/realm/realm-java/">Realm</a></p>
<pre>
RealmConfiguration config = new RealmConfiguration.Builder()
    .encryptionKey(getKey())
    .build();
Realm realm = Realm.getInstance(config);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x07-v2-data_storage_and_privacy_requirements">Mobile AppSec
  Verification Standard</a> - Data Storage and Privacy Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m2-insecure-data-storage">OWASP Mobile Top 10 2016 Category M2</a> - Insecure
  Data Storage </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration.html">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/311">MITRE, CWE-311</a> - Missing Encryption of Sensitive Data </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/321">MITRE, CWE-321</a> - Use of Hard-coded Cryptographic Key </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S6437">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6437">
              java:S6437
            </a>
          </td>
          <td>
            <details>
              <p>A hard-coded secret has been found in your code. You should quickly list where this secret is used, revoke it, and then change it in every system
that uses it.</p>
<p>Passwords, secrets, and any type of credentials should only be used to authenticate a single entity (a person or a system).</p>
<p>If you allow third parties to authenticate as another system or person, they can impersonate legitimate identities and undermine trust within the
organization.<br> It does not matter if the impersonation is malicious: In either case, it is a clear breach of trust in the system, as the systems
involved falsely assume that the authenticated entity is who it claims to be.<br> The consequences can be catastrophic.</p>
<p>Keeping credentials in plain text in a code base is tantamount to sharing that password with anyone who has access to the source code and runtime
servers.<br> Thus, it is a breach of trust, as these individuals have the ability to impersonate others.</p>
<p>Secret management services are the most efficient tools to store credentials and protect the identities associated with them.<br> Cloud providers
and on-premise services can be used for this purpose.</p>
<p>If storing credentials in a secret data management service is not possible, follow these guidelines:</p>
<ul>
  <li> Do not store credentials in a file that an excessive number of people can access.
    <ul>
      <li> For example, not in code, not in a spreadsheet, not on a sticky note, and not on a shared drive. </li>
    </ul>  </li>
  <li> Use the production operating system to protect password access control.
    <ul>
      <li> For example, in a file whose permissions are restricted and protected with chmod and chown. </li>
    </ul>  </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
import org.h2.security.SHA256;

String inputString = "s3cr37";
byte[] key         = inputString.getBytes();

SHA256.getHMAC(key, message);  // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<p>Using <a href="https://github.com/awsdocs/aws-doc-sdk-examples/tree/main/javav2/example_code/secretsmanager">AWS Secrets Manager</a>:</p>
<pre>
import software.amazon.awssdk.services.secretsmanager.SecretsManagerClient;
import software.amazon.awssdk.services.secretsmanager.model.GetSecretValueRequest;
import software.amazon.awssdk.services.secretsmanager.model.GetSecretValueResponse;
import org.h2.security.SHA256;

public static void doSomething(SecretsManagerClient secretsClient, String secretName) {
  GetSecretValueRequest valueRequest = GetSecretValueRequest.builder()
    .secretId(secretName)
    .build();

  GetSecretValueResponse valueResponse = secretsClient.getSecretValue(valueRequest);
  String secret                        = valueResponse.secretString();

  byte[] key = secret.getBytes();
  SHA256.getHMAC(key, message);
}
</pre>
<p>Using <a href="https://docs.microsoft.com/en-us/azure/key-vault/secrets/quick-create-java?tabs=azure-cli">Azure Key Vault Secret</a>:</p>
<pre>
import com.azure.identity.DefaultAzureCredentialBuilder;
import com.azure.security.keyvault.secrets.SecretClient;
import com.azure.security.keyvault.secrets.SecretClientBuilder;
import com.azure.security.keyvault.secrets.models.KeyVaultSecret;
import org.h2.security.SHA256;

public static void doSomething(SecretClient secretClient, String secretName) {
  KeyVaultSecret retrievedSecret = secretClient.getSecret(secretName);
  String secret = retrievedSecret.getValue();

  byte[] key = secret.getBytes();
  SHA256.getHMAC(key, message);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://aws.amazon.com/fr/secrets-manager/">AWS</a> - Secret Manager </li>
  <li> <a href="https://azure.microsoft.com/fr-fr/services/key-vault/">Azure</a> - Key Vault </li>
  <li> <a href="https://cloud.google.com/secret-manager">GCP</a> - Secret Manager </li>
  <li> <a href="https://www.vaultproject.io/">Hashicorp Vault</a> - Secret Management </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/798.html">MITRE, CWE-798</a> - Use of Hard-coded Credentials </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/259.html">MITRE, CWE-259</a> - Use of Hard-coded Password </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/x/OjdGBQ">CERT, MSC03-J.</a> - Never hard code sensitive information </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5344">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5344">
              java:S5344
            </a>
          </td>
          <td>
            <details>
              <p>A user password should never be stored in clear-text, instead a hash should be produced from it using a secure algorithm:</p>
<ul>
  <li> not vulnerable to <code>brute force attacks</code>. </li>
  <li> not vulnerable to <code>collision attacks</code> (see rule s4790). </li>
  <li> and a salt should be added to the password to lower the risk of <code>rainbow table attacks</code> (see rule s2053). </li>
</ul>
<p>This rule raises an issue when a password is stored in clear-text or with a hash algorithm vulnerable to <code>bruce force attacks</code>. These
algorithms, like <code>md5</code> or <code>SHA-family</code> functions are fast to compute the hash and therefore brute force attacks are possible
(it’s easier to exhaust the entire space of all possible passwords) especially with hardware like GPU, FPGA or ASIC. Modern password hashing
algorithms such as <code>bcrypt</code>, <code>PBKDF2</code> or <code>argon2</code> are recommended.</p>
<h2>Noncompliant Code Example</h2>
<pre>
@Autowired
public void configureGlobal(AuthenticationManagerBuilder auth, DataSource dataSource) throws Exception {
  auth.jdbcAuthentication()
    .dataSource(dataSource)
    .usersByUsernameQuery("SELECT * FROM users WHERE username = ?")
    .passwordEncoder(new StandardPasswordEncoder()); // Noncompliant

  // OR
  auth.jdbcAuthentication()
    .dataSource(dataSource)
    .usersByUsernameQuery("SELECT * FROM users WHERE username = ?"); // Noncompliant; default uses plain-text

  // OR
  auth.userDetailsService(...); // Noncompliant; default uses plain-text
  // OR
  auth.userDetailsService(...).passwordEncoder(new StandardPasswordEncoder()); // Noncompliant
}
</pre>
<h2>Compliant Solution</h2>
<pre>
@Autowired
public void configureGlobal(AuthenticationManagerBuilder auth, DataSource dataSource) throws Exception {
  auth.jdbcAuthentication()
    .dataSource(dataSource)
    .usersByUsernameQuery("Select * from users where username=?")
    .passwordEncoder(new BCryptPasswordEncoder());

  // or
  auth.userDetailsService(null).passwordEncoder(new BCryptPasswordEncoder());
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/Top10/A04_2021-Insecure_Design/">OWASP Top 10 2021 Category A4</a> - Insecure Design </li>
  <li> <a href="https://cheatsheetseries.owasp.org/cheatsheets/Password_Storage_Cheat_Sheet.html">OWASP CheatSheet</a> - Password Storage Cheat Sheet
  </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/256">MITRE, CWE-256</a> - Plaintext Storage of a Password </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/916">MITRE, CWE-916</a> - Use of Password Hash With Insufficient Computational Effort </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S6432">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S6432">
              java:S6432
            </a>
          </td>
          <td>
            <details>
              <p>When encrypting data with Counter (CTR) derived block cipher modes of operation, it is essential not to reuse the same initialization vector (IV)
with a given key, such IV is called a "nonce" (number used only once). Galois/Counter (GCM) and Counter with Cipher Block Chaining-Message
Authentication Code (CCM) are both CTR-based modes of operation.</p>
<p>An attacker, who has knowledge of one plaintext (original content) and ciphertext (encrypted content) pair, is able to retrieve the corresponding
plaintext of any other ciphertext generated with the same IV and key. It also drastically decreases the key recovery computational complexity by
downgrading it to a simpler polynomial root-finding problem.</p>
<p>When using GCM, NIST recommends a 96 bit length nonce using a 'Deterministic' approach or at least 96 bits using a 'Random Bit Generator (RBG)'.
The 'Deterministic' construction involves a counter, which increments per encryption process. The 'RBG' construction, as the name suggests, generates
the nonce using a random bit generator. Collision probabilities (nonce-key pair reuse) using the 'RBG-based' approach require a shorter key rotation
period, 2^32 maximum invocations per key.</p>
<h2>Noncompliant Code Example</h2>
<pre>
public void encrypt(byte[] key, byte[] ptxt) {
    byte[] bytesIV = "7cVgr5cbdCZV".getBytes("UTF-8"); // The initialization vector is a static value

    GCMParameterSpec gcmSpec    = new GCMParameterSpec(128, nonce); // The initialization vector is configured here
    SecretKeySpec keySpec       = new SecretKeySpec(key, "AES");

    Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
    cipher.init(Cipher.ENCRYPT_MODE, keySpec, iv);  // Noncompliant
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public void encrypt(byte[] key, byte[] ptxt) {
    SecureRandom random = new SecureRandom();
    byte[] bytesIV = new byte[12];
    random.nextBytes(bytesIV); // Random 96 bit IV

    GCMParameterSpec gcmSpec    = new GCMParameterSpec(128, nonce);
    SecretKeySpec keySpec       = new SecretKeySpec(key, "AES");

    Cipher cipher = Cipher.getInstance("AES/GCM/NoPadding");
    cipher.init(Cipher.ENCRYPT_MODE, keySpec, iv);
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure
  </li>
  <li> <a href="https://mobile-security.gitbook.io/masvs/security-requirements/0x08-v3-cryptography_verification_requirements">Mobile AppSec
  Verification Standard</a> - Cryptography Requirements </li>
  <li> <a href="https://owasp.org/www-project-mobile-top-10/2016-risks/m5-insufficient-cryptography">OWASP Mobile Top 10 2016 Category M5</a> -
  Insufficient Cryptography </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/323">MITRE, CWE-323</a> - Reusing a Nonce, Key Pair in Encryption </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">NIST, SP-800-38A</a> - Recommendation for Block Cipher
  Modes of Operation </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38c.pdf">NIST, SP-800-38C</a> - Recommendation for Block Cipher
  Modes of Operation: The CCM Mode for Authentication and Confidentiality </li>
  <li> <a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf">NIST, SP-800-38D</a> - Recommendation for Block Cipher
  Modes of Operation: Galois/Counter Mode (GCM) and GMAC </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          

        <tr>
          <td id="java:S4347">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S4347">
              java:S4347
            </a>
          </td>
          <td>
            <details>
              <p>The <code>java.security.SecureRandom</code> class provides a strong random number generator (RNG) appropriate for cryptography. However, seeding it
with a constant or another predictable value will weaken it significantly. In general, it is much safer to rely on the seed provided by the
<code>SecureRandom</code> implementation.</p>
<p>This rule raises an issue when <code>SecureRandom.setSeed()</code> or <code>SecureRandom(byte[])</code> are called with a seed that is either one
of:</p>
<ul>
  <li> a constant </li>
  <li> the system time </li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
SecureRandom sr = new SecureRandom();
sr.setSeed(123456L); // Noncompliant
int v = sr.next(32);

sr = new SecureRandom("abcdefghijklmnop".getBytes("us-ascii")); // Noncompliant
v = sr.next(32);
</pre>
<h2>Compliant Solution</h2>
<pre>
SecureRandom sr = new SecureRandom();
int v = sr.next(32);
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A6_2017-Security_Misconfiguration">OWASP Top 10 2017 Category A6</a> - Security
  Misconfiguration </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/330">MITRE, CWE-330</a> - Use of Insufficiently Random Values </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/332">MITRE, CWE-332</a> - Insufficient Entropy in PRNG </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/336">MITRE, CWE-336</a> - Same Seed in Pseudo-Random Number Generator (PRNG) </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/337">MITRE, CWE-337</a> - Predictable Seed in Pseudo-Random Number Generator (PRNG) </li>
  <li> <a href="https://wiki.sei.cmu.edu/confluence/display/java/MSC63-J.+Ensure+that+SecureRandom+is+properly+seeded">CERT, MSC63J.</a> - Ensure that
  SecureRandom is properly seeded </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          

        <tr>
          <td id="java:S5679">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5679">
              java:S5679
            </a>
          </td>
          <td>
            <details>
              <p>In 2018, Duo Security found a new vulnerability class that affects SAML-based single sign-on (SSO) systems and this led to the following
vulnerabilities being disclosed: <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11427">CVE-2017-11427</a>, <a
href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11428">CVE-2017-11428</a>, <a
href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11429">CVE-2017-11429</a>, <a
href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-11430">CVE-2017-11430</a>, <a
href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-0489">CVE-2018-0489</a>, <a
href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-7340">CVE-2018-7340</a>.</p>
<p>From a specially crafted <code>&lt;SAMLResponse&gt;</code> file, an attacker having already access to the SAML system with his own account can
bypass the authentication mechanism and be authenticated as another user.</p>
<p>This is due to the fact that SAML protocol rely on XML format and how the underlying XML parser interprets XML comments.</p>
<p>If an attacker manage to change the <code>&lt;NameID&gt;</code> field identifying the authenticated user with XML comments, he can exploit the
vulnerability.</p>
<p>Here is an example of a potential payload:</p>
<pre>
&lt;SAMLResponse&gt;
  [...]
  &lt;Subject&gt;
    &lt;NameID&gt;admin@domain.com&lt;!----&gt;.evil.com&lt;/NameID&gt;
  &lt;/Subject&gt;
  [...]
&lt;/SAMLResponse&gt;
</pre>
<p>The attacker will manage to generate a valid &lt;SAMLResponse&gt; content with the account "admin@domain.com.evil.com". He will modify it with XML
comments to finally be authenticated as "admin@domain.com". To prevent this vulnerability on application using Spring Security SAML relying on
OpenSAML2, XML comments should be ignored thanks to the property <code>ignoreComments</code> set to <code>true</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
import org.opensaml.xml.parse.BasicParserPool;
import org.opensaml.xml.parse.ParserPool;
import org.opensaml.xml.parse.StaticBasicParserPool;

public ParserPool parserPool() {
  StaticBasicParserPool staticBasicParserPool = new StaticBasicParserPool();
  staticBasicParserPool.setIgnoreComments(false); // Noncompliant: comments are not ignored during parsing opening the door to exploit the vulnerability
  return staticBasicParserPool;
}
</pre>
<pre>
public ParserPool parserPool() {
  BasicParserPool basicParserPool = new BasicParserPool();
  basicParserPool.setIgnoreComments(false); // Noncompliant
  return basicParserPool;
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public ParserPool parserPool() {
  return new StaticBasicParserPool(); // Compliant: "ignoreComments" is set to "true" in StaticBasicParserPool constructor
}
</pre>
<pre>
public ParserPool parserPool() {
  return new BasicParserPool();  // Compliant: "ignoreComments" is set to "true" in BasicParserPool constructor
}
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A06_2021-Vulnerable_and_Outdated_Components/">OWASP Top 10 2021 Category A6</a> - Vulnerable and Outdated
  Components </li>
  <li> <a href="https://owasp.org/Top10/A07_2021-Identification_and_Authentication_Failures/">OWASP Top 10 2021 Category A7</a> - Identification and
  Authentication Failures </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">OWASP Top 10 2017 Category A2</a> - Broken Authentication
  </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> -
  Using Components with Known Vulnerabilities </li>
  <li> <a href="https://duo.com/blog/duo-finds-saml-vulnerabilities-affecting-multiple-implementations">Duo Finds SAML Vulnerabilities Affecting
  Multiple Implementations</a> </li>
  <li> <a href="https://spring.io/blog/2018/03/01/spring-security-saml-and-this-week-s-saml-vulnerability">Spring Security SAML and this week’s SAML
  Vulnerability</a> </li>
  <li> <a href="https://github.com/spring-projects/spring-security-saml/issues/228">Spring Security SAML: Issue #228</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          

        <tr>
          <td id="java:S5445">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S5445">
              java:S5445
            </a>
          </td>
          <td>
            <details>
              <p>Using <code>File.createTempFile</code> as the first step in creating a temporary directory causes a race condition and is inherently unreliable and
insecure. Instead, <code>Files.createTempDirectory</code> (Java 7+) should be used.</p>
<p>This rule raises an issue when the following steps are taken in immediate sequence:</p>
<ul>
  <li> call to <code>File.createTempFile</code> </li>
  <li> delete resulting file </li>
  <li> call <code>mkdir</code> on the File object </li>
</ul>
<p><strong>Note</strong> that this rule is automatically disabled when the project’s <code>sonar.java.source</code> is lower than <code>7</code>.</p>
<h2>Noncompliant Code Example</h2>
<pre>
File tempDir;
tempDir = File.createTempFile("", ".");
tempDir.delete();
tempDir.mkdir();  // Noncompliant
</pre>
<h2>Compliant Solution</h2>
<pre>
Path tempPath = Files.createTempDirectory("");
File tempDir = tempPath.toFile();
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A01_2021-Broken_Access_Control/">OWASP Top 10 2021 Category A1</a> - Broken Access Control </li>
  <li> <a href="https://owasp.org/www-project-top-ten/2017/A9_2017-Using_Components_with_Known_Vulnerabilities">OWASP Top 10 2017 Category A9</a> -
  Using Components with Known Vulnerabilities </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/377">MITRE, CWE-377</a> - Insecure Temporary File </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/379">MITRE, CWE-379</a> - Creation of Temporary File in Directory with Incorrect Permissions
  </li>
  <li> <a href="https://owasp.org/www-community/vulnerabilities/Insecure_Temporary_File">OWASP, Insecure Temporary File</a> </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          

        <tr>
          <td id="java:S2053">
            <a href="https://next.sonarqube.com/sonarqube/coding_rules#rule_key=java:S2053">
              java:S2053
            </a>
          </td>
          <td>
            <details>
              <p>In cryptography, a "salt" is an extra piece of data which is included when hashing a password. This makes <code>rainbow-table attacks</code> more
difficult. Using a cryptographic hash function without an unpredictable salt increases the likelihood that an attacker could successfully find the
hash value in databases of precomputed hashes (called <code>rainbow-tables</code>).</p>
<p>This rule raises an issue when a hashing function which has been specifically designed for hashing passwords, such as <code>PBKDF2</code>, is used
with a non-random, reused or too short salt value. It does not raise an issue on base hashing algorithms such as <code>sha1</code> or <code>md5</code>
as they should not be used to hash passwords.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
  <li> Use hashing functions generating their own secure salt or generate a secure random value of at least 16 bytes. </li>
  <li> The salt should be unique by user password. </li>
</ul>
<h2>Noncompliant Code Example</h2>
<p>Below, the hashed password use a predictable salt:</p>
<pre>
byte[] salt = "notrandom".getBytes();

PBEParameterSpec cipherSpec = new PBEParameterSpec(salt, 10000); // Noncompliant, predictable salt
PBEKeySpec spec = new PBEKeySpec(chars, salt, 10000, 256); // Noncompliant, predictable salt
</pre>
<h2>Compliant Solution</h2>
<p>Use <code>java.security.SecureRandom</code> to generate an unpredictable salt:</p>
<pre>
SecureRandom random = new SecureRandom();
byte[] salt = new byte[16];
random.nextBytes(salt);

PBEParameterSpec cipherSpec = new PBEParameterSpec(salt, 10000); // Compliant
PBEKeySpec spec = new PBEKeySpec(chars, salt, 10000, 256); // Compliant
</pre>
<h2>See</h2>
<ul>
  <li> <a href="https://owasp.org/Top10/A02_2021-Cryptographic_Failures/">OWASP Top 10 2021 Category A2</a> - Cryptographic Failures </li>
  <li> <a href="https://www.owasp.org/www-project-top-ten/2017/A3_2017-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data
  Exposure </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/759">MITRE, CWE-759</a> - Use of a One-Way Hash without a Salt </li>
  <li> <a href="https://cwe.mitre.org/data/definitions/760">MITRE, CWE-760</a> - Use of a One-Way Hash with a Predictable Salt </li>
  <li> <a href="https://www.sans.org/top25-software-errors/#cat3">SANS Top 25</a> - Porous Defenses </li>
</ul>
            </details>
          </td>
        </tr>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </tbody>
    </table>
    
  </div>

  
  
</body>

</html>